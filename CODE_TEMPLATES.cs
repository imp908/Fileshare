///Hierarhy
namespace Parts{
	#region Names
	public Groups
	{
		public Technics
		{
			public Methods
			{
				
			}
		}
	}
	#endregion
}

///
 
namespace Books
{

#region Overall

public void Unsorted()
{
	
По алгоритмам:
- Роберт Седжвик. Фундаментальные алгоритмы на С++ (две книги, 1-4 часть и 5 часть во втором томе).
- А.В. Ахо, Д.Э.Хопкрофт, Д.Д.Ульман - Структуры данных и алгоритмы.
- Кормен, Лейзерсон, Ривест. Алгоритмы - построение и анализ.
Ну и 4 тома Кнута - хотя бы пролистать. =)
По шарпу - мне помогли такие книги:
- Эндрю Троелсен. ЯЗЫК ПРОГРАММИРОВАНИЯ C#5.0 И ПЛАТФОРМА .NET 4.5
- Герберт Шилдт. Полное руководство C# 4.0
- Ватсон Б. C# 4.0 на примерах

}

#endregion
	 
}
 
namespace CodeExamples 
{

//Usefull links
public void mostUsefullLinks()
{

//dev guide
https://msdn.microsoft.com/en-us/library/hh156542(v=vs.110).aspx

//Applications essential
https://msdn.microsoft.com/en-us/library/ms172157(v=vs.110).aspx

//simple List<t> class
https://msdn.microsoft.com/en-us/library/6sh2ey19(v=vs.110).aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-2


//LINQ to DataSet
http://blogs.msdn.com/b/adonet/archive/2007/01/26/querying-datasets-introduction-to-linq-to-dataset.aspx

//correct d3 charts addition
//<script type="application/javascript" charset="utf-8" src="http://d3js.org/d3.v3.js"></script>

//charts from excel to poweerpoint copy
https://social.msdn.microsoft.com/Forums/ru-RU/b00e1da3-908d-4ae1-8c68-2ea5108d1cd0/-excel-powerpoint-vba?forum=programminglanguageru

//codplex library addres for excel files read
http://exceldatareader.codeplex.com/

//never use TWO DOTS
http://www.thecodingforums.com/threads/asp-net-cant-kill-excel-exe-with-office-pia.123703/#post-528575

//newtonsoft JSON serializer
http://www.newtonsoft.com/json/help/html/serializingjson.htm

//ASP.NET Web Deployment - Recommended Resources
http://www.asp.net/whitepapers/aspnet-web-deployment-content-map

//Advanced Entity Framework 6 Scenarios for an MVC 5 + usefull links
http://www.asp.net/mvc/overview/getting-started/getting-started-with-ef-using-mvc/advanced-entity-framework-scenarios-for-an-mvc-web-application#rawsql

//ASP.NET Data Access - Recommended Resources
http://www.asp.net/whitepapers/aspnet-data-access-content-map

//ASP.NET Data Access Options
https://msdn.microsoft.com/en-us/library/ms178359.aspx#webservice

//scafolding
https://blogs.msdn.microsoft.com/webdev/2014/04/03/creating-a-custom-scaffolder-for-visual-studio/

//Data Source Web Server Controls
https://msdn.microsoft.com/en-us/library/ms247258.aspx

//James chamber 30 days ov MVC
http://jameschambers.com/2014/07/day-27-rendering-data-in-a-bootstrap-table/

//Post javascrip to mvc action
http://vault.lozanotek.com/archive/2010/04/16/posting_json_data_to_mvc_controllers.aspx

///{LINQ}
//Create dynamic "Select", "SelectMany" and "GroupBy" clauses
http://drc.ideablade.com/xwiki/bin/view/Documentation/dynamic-projection

//Programming Entity Framework, 2nd Edition
https://www.safaribooksonline.com/library/view/programming-entity-framework/9780596807276/ch04.html

//Dynamic LINQ Queries with Expression Trees
https://www.simple-talk.com/dotnet/net-framework/dynamic-linq-queries-with-expression-trees/

//Calling functions in LINQ queries
http://tomasp.net/blog/linq-expand.aspx/

//sql commands types
https://msdn.microsoft.com/en-us/library/yy6y35y8(v=vs.110).aspx

//HTML5 plupload
http://www.plupload.com/

//How to add Dynamic Behavior to Data-Bound Controls
https://msdn.microsoft.com/en-us/library/cc488562.aspx

//WebForms
https://msdn.microsoft.com/en-us/library/jj822927(v=vs.110).aspx

//ASP.NET Dynamic Data
https://msdn.microsoft.com/en-us/library/ee845452.aspx

//LINQ chaining
https://blogs.msdn.microsoft.com/meek/2008/05/02/linq-to-entities-combining-predicates/



//MVC OWIN Aothentication
https://blogs.msdn.microsoft.com/webdev/2013/07/03/understanding-owin-forms-authentication-in-mvc-5/
https://weblog.west-wind.com/posts/2015/Apr/29/Adding-minimal-OWIN-Identity-Authentication-to-an-Existing-ASPNET-MVC-Application

//MIGRATIONS
https://msdn.microsoft.com/en-US/data/dn481501


//WCF distributed
https://chsakell.com/2013/04/17/distributed-transactions-in-wcf-services-part-1/
//WCF sample
https://www.codeproject.com/Articles/571813/A-Beginners-Tutorial-on-Creating-WCF-REST-Services
//WCF with entity
https://www.codeproject.com/Articles/127395/Implementing-a-WCF-Service-with-Entity-Framework
//WCF generate contracts from POCO
https://www.codeproject.com/Articles/1081015/Autogenerate-DataContracts-for-WCF-from-POCO-Class
//WCF transactions
https://www.codeproject.com/Articles/1160537/WCF-Windows-Communication-Foundation-Transaction-S


//WebApi
//WebApi controller
https://docs.microsoft.com/en-us/aspnet/web-api/overview/getting-started-with-aspnet-web-api/tutorial-your-first-web-api
//WCF WebApi
http://blogs.microsoft.co.il/idof/2012/03/05/wcf-or-aspnet-web-apis-my-two-cents-on-the-subject/


//vNext
https://blogs.msdn.microsoft.com/dotnet/2014/05/12/the-next-generation-of-net-asp-net-vnext/


//EF
//Data acces content map
https://docs.microsoft.com/en-us/aspnet/whitepapers/aspnet-data-access-content-map
//Code first to database
https://msdn.microsoft.com/en-us/data/jj200620
//EF bulk insert
https://weblog.west-wind.com/posts/2013/Dec/22/Entity-Framework-and-slow-bulk-INSERTs#ContextBloatandLargeLists
//Entity Framework initializer methods
https://blog.oneunicorn.com/2013/05/28/database-initializer-and-migrations-seed-methods/
// Code First Migrations with an existing database
https://msdn.microsoft.com/en-us/data/dn579398


//REPOSITORY
//Generic Repository is BAD
http://rob.conery.io/2014/03/04/repositories-and-unitofwork-are-not-a-good-idea/
//generic Repository
http://techbrij.com/generic-repository-unit-of-work-entity-framework-unit-testing-asp-net-mvc
//Generic repository
https://docs.microsoft.com/en-us/aspnet/mvc/overview/older-versions/getting-started-with-ef-5-using-mvc-4/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application
//A trully generic repository
http://cpratt.co/truly-generic-repository/



//Single Page Application
https://docs.microsoft.com/en-us/aspnet/single-page-application/overview/introduction/knockoutjs-template

//JS good practices
http://james.padolsey.com/javascript/javascript-bad-practices/
//JS no more frameworks
https://bitworking.org/news/2014/05/zero_framework_manifesto

//ORM vs plain sql strategies
http://softwareengineering.stackexchange.com/questions/117357/is-entity-framework-suitable-for-high-traffic-websites

//msdn C# posts
https://blogs.msdn.microsoft.com/ruericlippert/tag/type-inference/

//TOP 10 C# errors
https://www.upwork.com/hiring/development/common-mistakes-in-c-sharp-programming/
https://www.toptal.com/c-sharp/top-10-mistakes-that-c-sharp-programmers-make

//SOLID
http://sergeyteplyakov.blogspot.ru/2014/10/solid.html
http://www.c-sharpcorner.com/uploadfile/damubetha/solid-principles-in-c-sharp/
https://www.codeproject.com/Articles/703634/SOLID-architecture-principles-using-simple-Csharp

//Learn C# building-a-simple-rpg-index
http://scottlilly.com/learn-c-by-building-a-simple-rpg-index/

//Loading type MSDN + (Loading types, lazy loading turning off)
https://msdn.microsoft.com/en-us/library/jj574232(v=vs.113).aspx

//C# Delegates, Actions, Funcs, Lambdas?Keeping it super simple
https://blogs.msdn.microsoft.com/brunoterkaly/2012/03/02/c-delegates-actions-funcs-lambdaskeeping-it-super-simple/

//Unit test
https://msdn.microsoft.com/en-us/library/hh694602.aspx
https://lostechies.com/derekgreer/2011/03/28/effective-tests-a-test-first-example-part-1/
https://www.rhyous.com/2012/03/17/unit-test-best-practices-and-guidelines/

/*
filtering inherited types classes in base class list of classes
google
c# base class list contains inherited classes
stack
*/
http://stackoverflow.com/questions/2074779/identifying-derived-types-from-a-list-of-base-class-objects



}



#region SourceControl

public Bug Trackers
{
	public GIT hub
	{
		https://www.atlassian.com/git
		
		
		git push -u origin branchname {!!!<pushing to branch>!!!}
		
		git remote -v -> check remotes
		git branch -> check what branch you are in
		
		EXISTING LOCAL PROJECT TO NEW GIT REPO FIRST PUSH
		create new in git web
		cd -> moove to directory	 
		git remote add origin \\url_to_project
		git pull origin master
		git init -> initialize git
		git add . -a //no files changed
		git commit -m "Commit text"
		git push -u origin master
		
		NEW BRANCH
		create new branch in web
		git checkout -b \\url to branch		
		add commit push section 
		
		REMOVE REPO
		git remote rm origin			
		
		CHANGE STATE/FILES
		git log --oneline -> REVISION ID		
		git checkout master - > REVERT HEAD TO PROJECT COMMIT STATE		
		git checkout a1e8fb5 - > CHANGE PROJECT STATE TO COMMIT		
		git checkout <commit> <file> - > REVERT FILE TO COMMIT
		git checkout a1e8fb5 hello.py 			
		git revert <commit> - > REVERTS CHECKOUT with new COMMIT undoing changes
		
		git clean -n -> see what untracked files
		git clean -f -> removes files from directory		
		git clean -> remove .o and .exe from C before build
		
		{
# Edit some existing files
# Add some new files
# Realize you have no idea what you're doing
# Undo changes in tracked files
git reset --hard
# Remove untracked files
git clean -df
		}

		GIT RESET - > pemannently unstages all tracked files
		git reset --hard - > throws out all uncommited changes
		git reset <commit> - > reset to branch 
		{		
# Edit both hello.py and main.py
# Stage everything in the current directory
git add .
# Realize that the changes in hello.py and main.py
# should be committed in different snapshots
# Unstage main.py
git reset main.py
# Commit only hello.py
git commit -m "Make some changes to hello.py"
# Commit main.py in a separate snapshot
git add main.py
git commit -m "Edit main.py"
		
# Create a new file called `foo.py` and add some code to it
# Commit it to the project history
git add foo.py
git commit -m "Start developing a crazy feature"
# Edit `foo.py` again and change some other tracked files, too
# Commit another snapshot
git commit -a -m "Continue my crazy feature"
# Decide to scrap the feature and remove the associated commits
git reset --hard HEAD~2 -> move 2 branchs back and clean history Only LOCAL
		}
		
		
		https://www.atlassian.com/git/tutorials/rewriting-history
		CHANGE HISTORY
		git commit --amend -> rewrite prev commit ; combine staged commit with previous, edit prev commit
		{
# Edit hello.py and main.py
git add hello.py
git commit

# Realize you forgot to add the changes from main.py
git add main.py
git commit --amend --no-edit			
		}
		
		git rebase <base> -> rebase current branch to new ID, commit, tag , branch reference
		{
			
# Start a new feature
git checkout -b new-feature master
# Edit files
git commit -a -m "Start developing a feature"

In the middle of our feature, we realize there’s a security hole in our project

# Create a hotfix branch based off of master
git checkout -b hotfix master
# Edit files
git commit -a -m "Fix security hole"
# Merge back into master
git checkout master
git merge hotfix
git branch -d hotfix

After merging the hotfix into master, we have a forked project history. Instead of a plain git merge, we’ll integrate the feature branch with a rebase to maintain a linear history:

git checkout new-feature
git rebase master

This moves new-feature to the tip of master, which lets us do a standard fast-forward merge from master:

git checkout master
git merge new-feature
		}
		
		git reflog - > track updates
		
		
	}

}

public Issuer Trackers
{
	
}

#endregion

#region C#

//Forums
public stackoverflow
{


/*
filtering inherited types classes in base class list of classes
google
c# base class list contains inherited classes
stack
*/
http://stackoverflow.com/questions/2074779/identifying-derived-types-from-a-list-of-base-class-objects

//wrong CompiledQuery
http://stackoverflow.com/questions/8125581/pre-compiling-linq-queries-when-using-entity-framework

//null false grouping in linq to entities
http://stackoverflow.com/questions/33286297/linq-groupby-with-a-dynamic-group-of-columns

//HttpPostedFileBase always return null in ASP.NET MVC
http://stackoverflow.com/questions/8551528/httppostedfilebase-always-return-null-in-asp-net-mvc

//MVC Upload,DOwnload
http://www.mikesdotnetting.com/article/125/asp-net-mvc-uploading-and-downloading-files
http://rachelappel.com/upload-and-download-files-using-asp-net-mvc/

//MVC values in postback
https://www.syncfusion.com/kb/5427/how-to-get-the-form-control-values-in-postback

//IIS max size change
https://www.iis.net/configreference/system.webserver/security/requestfiltering/requestlimits

//C++ stdio include
http://stackoverflow.com/questions/31736361/visual-studio-2015-gives-me-errors-upon-creating-a-simple-test-console-program

//c# linq datetime filter type to oracle database entity context
http://stackoverflow.com/questions/4146300/linq-to-entityframework-datetime

//Bookmarks Toolbar include
http://stackoverflow.com/questions/29742174/how-to-add-bookmark-toolbar-in-visual-studio-2012

//validation errors publish
http://stackoverflow.com/questions/5400530/validation-failed-for-one-or-more-entities-while-saving-changes-to-sql-server-da

//get current method name
http://stackoverflow.com/questions/2652460/how-to-get-the-name-of-the-current-method-from-code
http://stackoverflow.com/questions/2652460/how-to-get-the-name-of-the-current-method-from-code

//link to entities Query style
https://stackoverflow.com/questions/9720225/how-to-perform-join-between-multiple-tables-in-linq-lambda
}

//structure
public OverallC#
{
	
	public  Description(){
		annonymous Type - varibale type from code context
		weak reference - allow GC collect large class even if referenced
		generics default - default(T) bind default value to generic varibale
		generic with generic parameter - interface IGarrage<TCar,TOther> where TCar : IGenericCar<TOther> { ... }
		c++\CLI - wrap c++ code in .net
		CAS - Computer Algebra Systems
	}
	
	public  Platform(){
		.net 2.0 - delegates begininvoke endinvoke
		--anonimous 
		.net 3.0 - lambda
		.net 4.0 - System.Threading.tasks - task parallel lib
		.net 4.5 - task based asynchronous (async,await)
	}	
	
	public Ideas()
	{
		DRY:
		Common library - leads to a lot links to one unrelated code
		Common source code - file in proj folder leds to diverse versions/getting-started-with-ef-5-using-mvc-4/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application
		Service - one service in use. Large progects with latency and failures understood and managed
		NuGET - managing layers
		
		
		Interfaces use not only to loose coupling
		Highly Generic code could be used from many places
		
	}

	
}


public class External_Libraries(){
//reading excel
http://epplus.codeplex.com/
}


public class IssuesErrors(){

	//Issues\Errors
	public void .NET()
	{

		public CannotFindObject()
		{
		WHEN:
		incorrect connection string in : DbContext initialization parameters

		WHAT:
		Cannot find the object because it does not exist or you do not have permissions

		HOW:
		correct DbContext initialization
		}

		public ReferencePermissionWasDenied()
		{
		WHEN:
		migrating with code first model, with navigation properties and collection.
		Creating foreign key, constraint.

		WHAT:
		error:
		the reference permission was denied on the object '' database '', schema ''
		Cannot find the object '' because it does not exist or you do not have permissions
		could not create constraint.

		HOW:
		simle:
		(trying to migrate one after another commenting out not works - migrates both simultaneosly )
		create table with primary key. In sql manager give to users pemission rights
		Create table with collection.

		correct:
		change model to correct collection - navigation property. Collection in parent,
		foreign key with patent item property in child
		grant privilages
		use DWH_REPLICA;
		grant references To guest;
		go
		}

		public MethodFunctionNotFound()
		{
			WHEN:
			no EF in project referencing repository project

			WHAT: update EF
		}

		public System.Security.SecurityException()
		{
			WHEN:
			while windows service with InstallUtil.exe installation
			
			WHAT:
			Syste.Security.SecurityException
			
			HOW:
			start console with administrative
		}
		
		//Adding OWIN authorisation to code first projectthrows
		//http://articles.runtings.co.uk/2014/12/solved-aspnet-identity-2-throws.html
		public IdentityUserLogin_has_no_key_defined()
		{
			
			WHEN:
				Connectin OWIN acoount validation to code first project. 
				When FluentApi added to OnModelCreating method;
			WHAT:
				Throws validation errors for login, claims tables that lack ID keys defined
					IdentityUserLogin
					IdentityUserRoles
					IdentityUserLogins
					that has no keys defined
			WHOW:
				add to end of OnModelCreating method
				base.OnModelCreating(modelBuilder);
		
		}		
	}

	public void SSAS()
	{
		
		///Installation
		///Donload instal SSDT from MS VS
		///Create Analysis services projects from VS templates
	
		public void Impersonation()
		{
			
			WHEN:
			While trying to proccess any item of olap cube from VS to create new database
			
			WHAT:
			Severity	Code	Description	Project	File	Line	Suppression State
			Error		?????????????? ??????????: ???????? ????????? ??? ??????? ImpersonationInfo. ???? ???????? ImpersonateAccount ???????????? ?????? ImpersonationInfo, ???????? Account ?? ????? ???? ??????.			0	
			
			HOW:
			in datasourses name rightclick ViewDesigner, in Impersonation Information input credentials
						
		}
	
		public void Database NameChange()
		{
			
			WHEN:
			
			WHAT:
			change olap database name
			
			WHOW:
			rtclck project properties - > deployment
			
		}
		
		public void DimensionProcessError()
		{
			
			WHEN:
			connecting via wrong login (Datasource base login instead of OLAP base)
			
			WHAT:
			cannot connect to database while login 
			
			WHOW:
			change credentials
			
		}
		
		
		
	}
	
	
}


///Examples
public class Examples
{
	
	//Override reminder
	public void OvverrideReminder()
	{


		//override reminder exmpl
		//------------------------------------
		public class test1
		{
		public int a = 1;
		public test1()
		{

		}
		public virtual void countt()
		{
		a = a * 2;
		}
		public virtual int getA()
		{
		return a;
		}
		}
		public class test2 : test1
		{
		public int a = 1;
		public test2()
		{

		}
		public override void countt()
		{
		a = a * 3;
		}
		public override int getA()
		{
		return a;
		}
		}
		public class testt
		{
		public test1 t1;

		public testt(test1 t_)
		{
		t1 = t_;
		}
		}
		public int overridetest()
		{
		testt tt = new testt(new test1());
		tt.t1.countt();
		return tt.t1.getA();
		}
		//------------------------------------


	}
	
	public void EntityFramework()
	{
		
		public Migrations()
		{
			
			Enable-Migrations
			add-migration 0
			update-database
			
			//Update with new connection string
			//need guest permission to create database 
			update-database -Verbose -ConnectionStringName "SQLDB_J"
			
		}
		
		public connectionStrings()
		{
			
			<add name="SQLDB" connectionString="data source=AAAPC\AAASQL; initial catalog=SQLDB; integrated security=SSPI; App=EntityFramework" providerName="System.Data.SqlClient" />
			<add name="SQLHR" connectionString="data source=AAAPC\AAASQL; initial catalog=SQLHR; integrated security=SSPI; App=EntityFramework" providerName="System.Data.SqlClient" />
			<add name="SQLDB_J" connectionString="data source=.\SQLDE; initial catalog=SQLDB; integrated security=SSPI; App=EntityFramework" providerName="System.Data.SqlClient" />
			<add name="OracleDbContext" providerName="Oracle.ManagedDataAccess.Client" connectionString="User Id=oracle_user;Password=oracle_user_password;Data Source=oracle" />  
			<add name="OracleDbContext" providerName="Oracle.ManagedDataAccess.Client"
			connectionString="User Id=oracle_user;Password=oracle_useSQr_password;Data Source=oracle"/>
			<add name="DWH_entities"
			connectionString="metadata=res://*/DAL.DWH_model.csdl|res://*/DAL.DWH_model.ssdl|res://*/DAL.DWH_model.msl;provider=Oracle.ManagedDataAccess.Client;provider connection string=&quot;DATA SOURCE=DWH.RS.RU;PASSWORD=awsedrDRSEAW;PERSIST SECURITY INFO=True;USER ID=NEPRINTSEV_IA&quot;"
			providerName="System.Data.EntityClient"/>
			<add name="SQL_entities" connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=DWH_REPLICA;Integrated Security=SSPI;"
			providerName="System.Data.SqlClient"/>
			<add name="SQL_DE" connectionString="Data Source=.\SQLDE;Initial Catalog=DWH_REPLICA;Integrated Security=SSPI;"
			providerName="System.Data.SqlClient"/>
		
		}
		
	}

	public void SB()
	{
		
		    #region IoC
			/// <summary>
			/// Interface inheritance vs interface + class inheritance IoC
			/// </summary>
			public interface IRead
			{
				void Read_();
			}
			public interface IEdit
			{
				void Edit_();
			}
			public interface Ire : IEdit, IRead
			{

			}
			public class Read : IRead
			{
				public void Read_()
				{
					System.Diagnostics.Trace.WriteLine("Read_");
				}
			}
			public class Edit : IEdit
			{
				public void Edit_()
				{
					System.Diagnostics.Trace.WriteLine("Edit_");
				}
			}
			public class ReadEditCl : Read, IEdit
			{
				public void Edit_()
				{
					System.Diagnostics.Trace.WriteLine("Edit_");
				}
			}
			public class RE : Ire
			{
				public void Edit_()
				{
					System.Diagnostics.Trace.WriteLine("Edit_");
				}
				public void Read_()
				{
					System.Diagnostics.Trace.WriteLine("Read_");
				}
			}
			public static class ReadEditCheck
			{
				static IEdit edit;
				static IRead read;

				public static void GO()
				{
					Read r = new Read();
					r.Read_();
					Edit e = new Edit();
					e.Edit_();
					ReadEditCl re = new ReadEditCl();
					re.Read_();
					re.Edit_();
					RE RE = new RE();
					
					System.Diagnostics.Trace.WriteLine(@"---");
					IeditBind(e);
					IreadBind(r);
					edit.Edit_();
					read.Read_();

					System.Diagnostics.Trace.WriteLine(@"---");
					IeditBind(re);
					IreadBind(re);
					edit.Edit_();
					read.Read_();

					System.Diagnostics.Trace.WriteLine(@"---");
					RE.Edit_();
					RE.Read_();
				}
				public static void IeditBind(IEdit edit_)
				{
					edit = edit_;
				}
				public static void IreadBind(IRead read_)
				{
					read = read_;
				}
			}
    
			#endregion
		
	}

}


public class Unsorted {
		
	//delete from oracle table and link parametrized insert command to connection
	public class oracle_queries(){
	oracleConnection.Open();
	oracleDeleteCommand.Connection = oracleConnection;
	oracleDeleteCommand.CommandText = oracleQueriesBank.unparametrizedDelete;
	oracleDeleteCommand.ExecuteNonQuery();

	OracleCommand oracleInsertCommand = new OracleCommand();
	oracleInsertCommand.Connection = oracleConnection;
	oracleInsertCommand.CommandText = oracleQueriesBank.parametrizedInsert;

	oracleConnection.Open();
	oracleTablePresence.Connection = oracleConnection;
	oracleTablePresence.CommandText = oracleQueriesBank.tablePresenceTest;
	oracleTablePresence.Parameters.Add(new OracleParameter("tablename", "MERCHANT_LIST"));
	tablecount = oracleTablePresence.ExecuteScalar().ToString();

	oracleTablePresence.CommandText = oracleQueriesBank.tableColumnTest;
	oracleTablePresence.Parameters.Add(new OracleParameter("tablename", "MERCHANT_LIST"));
	oracleTablePresence.Parameters.Add(new OracleParameter("columnname", "ID_MERCHANT"));
	columncount = oracleTablePresence.ExecuteScalar().ToString();

	connectionInitialize(oracleConnection);
	OracleCommand oracleTableCount = new OracleCommand();
	oracleConnection.Open();
	oracleTableCount.Connection = oracleConnection;
	oracleTableCount.CommandText = oracleQueriesBank.unparametrizedRowCount;

	oracleTableCount.CommandText = oracleQueriesBank.tableColumnTest;
	rowcount = oracleTableCount.ExecuteScalar().ToString();
	}

	//oracle service query texts
	public class servi?e_queries(){
	//used for parametrized insert from import datagridview to oracle table
	//occurs in dataGridView_Import_DoubleClick throught OracleQueryExecutor class
	sampleInsert = "insert into merchant_list (ID_MERCHANT) values ('test_val')";

	unparametrizedDelete = "delete from merchant_list";
	parametrizedInsert = "insert into merchant_list values (:value)";
	unparametrizedRowCount = "select max(rownum) from merchant_list";

	//used for detecting marchant_list table presence and it's creation
	tablePresenceTest = "select max(rownum) from user_tables where table_name = (:tablename)";
	//detecting rownumbers in table
	tableColumnTest = "select max(rownum) from user_tab_columns where table_name = (:tablename) and column_name = (:columnname)";
	createTable = "create table MERCHANT_LIST (ID_MERCHANT varchar(50))";
	}

	//SERIALIZE DESERIALIZE
	public class serealization_deserialization(){
	public void Serialize(String path, List<OracleQueriesListClass> myArray)
	{
	BinaryFormatter formatter = new BinaryFormatter();
	using (FileStream stream = new FileStream(path, FileMode.Create, FileAccess.Write))
	{
	formatter.Serialize(stream, myArray);
	}
	}

	public List<OracleQueriesListClass> DeserializeList(String path)
	{
	BinaryFormatter formatter = new BinaryFormatter();
	using (FileStream stream = new FileStream(path, FileMode.Open, FileAccess.Read))
	{
	List<OracleQueriesListClass> myList = (List<OracleQueriesListClass>)formatter.Deserialize(stream);
	return myList;
	}
	}
	}

	//app setting connstrings example
	public class connstrings(){

	//requesting connString from appsettings
	System.Configuration.ConfigurationSettings.AppSettings["ConnectionString"];
	System.Configuration.ConfigurationManager.ConnectionStrings["connectionStringName"].ConnectionString;
	</startup>
	<appSettings>
	<add key="ConnectionString" value="Data Source=dwh.rs.ru;User ID=LoginReplacePatch;Password=PasswordReplacePatch" />
	<add key="ClientSettingsProvider.ServiceUri" value="" />
	<add key="excelConnectionString" value="OLEDB;Provider=MSDAORA.1;Password=PasswordReplacePatch;User ID=LoginReplacePatch;Data Source=dwh.rs.ru;" />
	</appSettings>
	}

	public class ExcelIntegration(){
		

	//create excel xlsx with OPEN xml
	private void OPENxmlCreate(){
	string fileName = @"C:\111\test.xlsx";
	using (SpreadsheetDocument document = SpreadsheetDocument.Create(fileName, SpreadsheetDocumentType.Workbook))
	{
	WorkbookPart workbookPart = document.AddWorkbookPart();
	workbookPart.Workbook = new Workbook();

	WorksheetPart worksheetPart = workbookPart.AddNewPart<WorksheetPart>();
	worksheetPart.Worksheet = new Worksheet(new SheetData());

	Sheets sheets = workbookPart.Workbook.AppendChild(new Sheets());

	Sheet sheet = new Sheet() { Id = workbookPart.GetIdOfPart(worksheetPart), SheetId = 1, Name = "Test Sheet" };

	sheets.Append(sheet);

	workbookPart.Workbook.Save();
	}
	}

	}

	/////

	//connection strings
	public void connectionStrings()
	{

	//connection to local SQL express from MVC
	//<add name="BookContext" connectionString="Data Source=.\SQLEXPRESS2;Initial Catalog=text_db;Integrated Security=SSPI;" providerName="System.Data.SqlClient"/>

	//<add name="SoocerContext" connectionString="Data Source=.\SQLEXPRESS2;Initial Catalog=tempdb;Integrated Security=SSPI;" providerName="System.Data.SqlClient"/>

	//connection from console app
	//string connectionString = @"Initial Catalog=tempdb;Data Source=.\SQLEXPRESS2;Integrated Security=SSPI;";

	//string connectionStringORCL = @"User Id=neprintsev_ia; password = awsedrDRSEAW; Data Source = dwh.rs.ru; Pooling=false;";
	//string connectionStringSQL = @"Data Source=.\SQLEXPRESS;Initial Catalog=DWH_replica;Integrated Security=SSPI;";

	}

	//----------------------------------------------


	//mvc tempaltes
	public void MVC_templates()
	{

	//view add button with rediraect
	<input type="button" value="ClickMe" onclick="location.href='@Url.Action("Migrate","Home")'"

	//view submit button
	<input type="submit" value="Save" class="btn btn-default" />

	//view actionlink
	@Html.ActionLink("Back to List", "Index")

	// Refresh model in controller if passing values after changes in layer
	if(ModelState.IsValid)
	{
	ModelState.Clear();
	}

	//start wcf service async
	Task.Run(() => migrateService.migrate_((DateTime)DateFrom, (DateTime)DateTo));

	//one of multiple buttons
	//controller part
	[HttpPost]
	[MultipleButton(Name = "action", Argument = "Stop")]
	public ActionResult Stop(int ID, DateTime? DateFrom, DateTime? DateTo)
	{}

	//view part
	<td>
	<input type="submit" value="Stop" name="action:Stop" />
	</td>

	//pass multiple parameters to controller from view
	<td>
	<input type="text" id="DateTo" name="DateTo" value="@tab.DateTo" />
	</td>

	//parametrized groupping linq to entity
	var a = from s in db.FD_ACQ_D
	where DbFunctions.CreateDateTime(s.DT_REG.Year, s.DT_REG.Month,01,0,0,0) ==
	DbFunctions.CreateDateTime(fromDate.Year, fromDate.Month, 01, 0, 0, 0)
	group s by new { DT_REG= DbFunctions.CreateDateTime(s.DT_REG.Year, s.DT_REG.Month, 01, 0, 0, 0), TYPE_TRANSACTION=s.TYPE_TRANSACTION, PAY_SYSTEM=s.PAY_SYS} into g
	select new
	{
	DT_REG = g.Key.DT_REG,
	TYPE_TRANSACTION = g.Key.TYPE_TRANSACTION,
	PAY_SYSTEM=g.Key.PAY_SYSTEM,
	AMT = g.Sum(s => s.AMT)
	};
	foreach(var b in a)
	{
	this.FD_ACQ_D.Add(new FD_RES { DT_REG = b.DT_REG, TYPE_TRANSACTION = b.TYPE_TRANSACTION, AMT = b.AMT, PAY_SYS=b.PAY_SYSTEM });
	}


	//return json from controller public string GetJson()
	{
	ml.GetACQ(db);
	string jsn = JsonConvert.SerializeObject(ml.FD_ACQ_D);
	return jsn;
	}

	}

	//json serialization with newtonsoft dll
	public void jsonserialization()
	{

	string json2 = JsonConvert.SerializeObject(jst1, Formatting.Indented);
	File.WriteAllText(@"C:\test\insert\json.json", json2);

	string json3 = "";
	json3 = File.ReadAllText(@"C:\test\insert\json.json");
	json_tst_par jDes = JsonConvert.DeserializeObject<json_tst_par>(json3);

	}

	public void StoreValuesToSettings()
	{

	//storing values to settings
	WindowsFormsApplication2.Properties.Settings.Default.Upgrade();
	//changes
	WindowsFormsApplication2.Properties.Settings.Default.Save();

	//Initializing Form Elements in form methods
	TextBox tb = (TextBox)sender;

	//datetime defenition
	DateTime dt = new DateTime(1, 1, 1, 0, 0, 0)
	}

	//default connection strings for oracle and excel
	public void connectionStrings()
	{
	<appSettings>
	<add key="ConnectionString" value="Data Source=dwh.rs.ru;User ID=LoginReplacePatch;Password=PasswordReplacePatch;" />
	<add key="ClientSettingsProvider.ServiceUri" value="" />
	<add key="excelConnectionString" value="OLEDB;Provider=MSDAORA.1;Password=PasswordReplacePatch;User ID=LoginReplacePatch;Data Source=dwh.rs.ru;Pooling=false;" />
	</appSettings>
	}

	//List object on excel list REFRESH
	if (lob.Name == liobName)
	{
	lob.QueryTable.CommandText = queryText__;
	lob.QueryTable.Connection = connectionString;
	lob.QueryTable.BackgroundQuery = true;
	lob.QueryTable.SaveData = true;
	lob.QueryTable.EnableRefresh = true;
	//lob.QueryTable.Refresh(false);
	try
	{
	lob.QueryTable.Refresh(false);
	}
	catch (Exception e)
	{

	}
	}

	//List object on excel list PLACE
	if (ws.Name==wsName)
	{

	ExcelInterop.Range worksheetRange = ws.get_Range("A1");
	string tableName=Path.GetRandomFileName().Replace(".","");
	tableName = Regex.Replace(tableName, @"\d", "");


	ExcelInterop.ListObject ListObject = ws.ListObjects.Add(ExcelInterop.XlListObjectSourceType.xlSrcQuery,
	((object)connectionString), false, ExcelInterop.XlYesNoGuess.xlYes, worksheetRange);

	//ListObject.QueryTable.CommandText = ((object)excelCommand);
	ListObject.QueryTable.CommandText = ((object)queryText__);
	ListObject.QueryTable.RowNumbers = false;
	ListObject.QueryTable.FillAdjacentFormulas = false;
	ListObject.QueryTable.PreserveFormatting = true;
	ListObject.QueryTable.RefreshOnFileOpen = false;
	ListObject.QueryTable.BackgroundQuery = true;
	ListObject.QueryTable.SavePassword = false;
	ListObject.QueryTable.SaveData = true;
	ListObject.QueryTable.AdjustColumnWidth = true;
	ListObject.QueryTable.RefreshPeriod = 10;
	ListObject.QueryTable.PreserveColumnInfo = true;
	ListObject.QueryTable.ListObject.DisplayName = tableName; //tabName;
	ListObject.QueryTable.EnableRefresh = true;
	ListObject.QueryTable.Refresh(false);

	}

	//searchs all processes and finds id for passed main window title
	//apl.Caption for excell aplications
	public int GetProcessIdByWindowTitle(string windowTitle)
	{

	int processID;
	processID = 0;
	foreach (System.Diagnostics.Process proc in System.Diagnostics.Process.GetProcessesByName("Excel"))
	{
	if (proc.MainWindowTitle == windowTitle)
	processID = proc.Id;
	}
	return processID;
	}

	//kills process with current ID
	public void processKill(int ID)
	{
	foreach (System.Diagnostics.Process proc in System.Diagnostics.Process.GetProcessesByName("Excel"))
	{
	if (proc.Id == ID)
	proc.Kill();
	}
	}

	//creates file for current excel workbook with path
	public void fileSave(ExcelInterop.Workbook wb, string OutputFileName)
	{
	if (!Directory.Exists(Path.GetDirectoryName(OutputFileName)))
	{
	Directory.CreateDirectory(Path.GetDirectoryName(OutputFileName));
	}

	wb.SaveAs(OutputFileName, ExcelInterop.XlFileFormat.xlWorkbookDefault,
	Missing.Value, Missing.Value, Missing.Value, Missing.Value,
	ExcelInterop.XlSaveAsAccessMode.xlExclusive,
	Missing.Value, Missing.Value, Missing.Value,
	Missing.Value, Missing.Value);
	wb.Close();
	}

	//correct excel application killing
	public void ExcelApplicationTest()
	{
	xlNS.Application apl2;
	apl2 = new xlNS.Application();

	xlNS.Workbooks wbs2;
	wbs2 = apl2.Workbooks;

	xlNS.Workbook wb2;
	xlNS.Worksheet ws2;

	 

	if(!File.Exists(ExcelPath))
	{
	wb2 = wbs2.Add(xlNS.XlWBATemplate.xlWBATWorksheet);
	//ws2 = (xlNS.Worksheet)wb2.Worksheets[1];
	wb2.SaveAs(ExcelPath);
	}
	else
	{
	wb2 = wbs2.Open(ExcelPath);
	}

	wb2.Close();
	apl2.Quit();
	wbs2.Close();

	Marshal.ReleaseComObject(wb2);
	Marshal.ReleaseComObject(wbs2);
	Marshal.ReleaseComObject(apl2);

	wb2 = null;
	apl2 = null;
	wbs2 = null;

	}

	//Opens filedialog and inserts results from excel to datagrid view
	public void dataGridSelectedFill(DataGridView dg, FilePath FilePath_)
	{
	OpenFileDialog ofd = new OpenFileDialog();
	Stream stream = null;

	ofd.Filter = "excel files (*.xls)|*.xls|excel files (*.xlsx)|*.xlsx";
	ofd.FilterIndex = 2;
	ofd.RestoreDirectory = true;

	if (ofd.ShowDialog() == DialogResult.OK)
	{
	if (File.Exists(ofd.FileName))
	{
	FilePath_.inputFilePath = ofd.FileName;

	try
	{
	ofd.InitialDirectory = FilePath_.inputFileFolder;

	try
	{
	if ((stream = ofd.OpenFile()) != null)
	{
	WindowsFormsApplication2.Properties.Settings.Default.InputFilePath = ofd.FileName;
	WindowsFormsApplication2.Properties.Settings.Default.Save();

	using (stream)
	{
	//calls main method for excel file from filedialog open and dataset to datagrid bnding
	dg.DataSource = StreamToGrid(stream, ofd.FileName);
	//new BindingSource(result.Tables[0], null);
	}

	}
	}
	catch (Exception ex)
	{
	MessageBox.Show("Error: Could not read file from disk. Original error: " + ex.Message);
	}

	}
	catch (Exception ex)
	{
	MessageBox.Show("Error: no file folder exists!" + ex.Message);
	}
	}
	}
	}

	//converts stream of file to datagrid for xls,xlsx
	//with CodePlex data reader http://exceldatareader.codeplex.com/
	public DataTable StreamToGrid(Stream stream, string ofd)
	{
	IExcelDataReader excelReader = null;
	DataSet result = new DataSet();

	string ExcelExtension= Path.GetExtension(ofd);


	if (ExcelExtension == ".xls")
	{
	excelReader = ExcelReaderFactory.CreateBinaryReader(stream);
	result = excelReader.AsDataSet();
	}

	if (ExcelExtension == ".xlsx")
	{
	excelReader = ExcelReaderFactory.CreateOpenXmlReader(stream);
	excelReader.IsFirstRowAsColumnNames = true;
	result = excelReader.AsDataSet();
	}


	//6. Free resources (IExcelDataReader is IDisposable)
	excelReader.Close();

	return result.Tables[0];

	}

	 

	//Initializes and starts new form from another one (for excel worksheet selection)
	private void wsSelectShow(ExcelInterop.Workbook wb, ExcelExport ee, string connectionString)
	{
	ListObjects_ liob = new ListObjects_();
	wsSelect wsSelect_ = new wsSelect(wb, ee, connectionString);
	wsSelect_.Show();
	}

	//publishing of excel list object
	public void listObjectPublish(){

	ExcelInterop.ListObject ListObject = ws.ListObjects.Add(ExcelInterop.XlListObjectSourceType.xlSrcQuery,
	((object)connectionString), false, ExcelInterop.XlYesNoGuess.xlYes, worksheetRange);

	//ListObject.QueryTable.CommandText = ((object)excelCommand);
	ListObject.QueryTable.CommandText = ((object)queryText__);
	ListObject.QueryTable.RowNumbers = false;
	ListObject.QueryTable.FillAdjacentFormulas = false;
	ListObject.QueryTable.PreserveFormatting = true;
	ListObject.QueryTable.RefreshOnFileOpen = false;
	ListObject.QueryTable.BackgroundQuery = true;
	ListObject.QueryTable.SavePassword = false;
	ListObject.QueryTable.SaveData = true;
	ListObject.QueryTable.AdjustColumnWidth = true;
	ListObject.QueryTable.RefreshPeriod = 10;
	ListObject.QueryTable.PreserveColumnInfo = true;
	ListObject.QueryTable.ListObject.DisplayName = tableName; //tabName;
	ListObject.QueryTable.EnableRefresh = true;
	ListObject.QueryTable.Refresh(false);
	}

	//refreshing of list objects on excel
	public void ListObject refresh()
	{
	lob.QueryTable.CommandText = queryText__;
	lob.QueryTable.Connection = connectionString;
	lob.QueryTable.BackgroundQuery = true;
	lob.QueryTable.SaveData = true;
	lob.QueryTable.EnableRefresh = true;
	lob.QueryTable.Refresh(false);
	}

	//Connection string and query for reading excel files with OLEDB and storing to datatable to excel
	public void readExcelOledbStoreDTtoExcel()
	{
	//string for oledb to excel query
	string conString = @"Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + fileToParse + ";" + "Extended Properties=" + "\"" + @"Excel 12.0;HDR=NO;TypeGuessRows=0;ImportMixedTypes=Text""";

	OleDbConnection oleCon = new OleDbConnection(conString);
	OleDbCommand oleCmd = new OleDbCommand(req, oleCon);
	DataTable dt = new DataTable("Output");

	oleCon.Open();
	dt.Load(oleCmd.ExecuteReader());

	//save dt as xml
	dt.WriteXml(folder + @"\" + @"output.xml",XmlWriteMode.WriteSchema, false);

	Excel.Application excel_ = new Excel.Application();
	Excel.Workbook wb_ = excel_.Workbooks.Add(true);
	Excel.Worksheet ws_ = wb_.Worksheets[1];

	ws_ = wb_.Worksheets[1];


	//worksheet.Cells["A1"].LoadFromDataTable(dataToExcel, true,


	//passing datatable to array of objects dim to dim
	var data = new object[dt.Rows.Count+1, dt.Columns.Count+1];
	int drC = 0;
	int drR = 0;

	foreach(DataRow dr in dt.Rows)
	{
	drR = drR + 1;
	foreach(DataColumn dc in dt.Columns)
	{
	drC = drC + 1;
	data[drR, drC] = dt.Rows[drR-1][drC-1];
	}
	drC = 0;
	}

	var startCell = (Excel.Range)ws_.Cells[1, 1];
	var endCell = (Excel.Range)ws_.Cells[dt.Rows.Count + 1, dt.Columns.Count + 1];
	var writeRange = ws_.Range[startCell, endCell];

	//passing array of objects to excel list
	writeRange.Value2 = data;
	wb_.SaveAs(folder + @"\" + @"output.xlsx");

	wb_.Close();

	//read stored xml to datatable increases values if datatable not empty
	dt.ReadXml(folder + @"\" + @"output.xml");
	dt.WriteXml(folder + @"\" + @"output2.xml", XmlWriteMode.WriteSchema, false);

	oleCon.Close();

	}

	//Get current application folder console
	public void ApplicationFolder()
	{
	Application.StartupPath
	System.IO.Path.GetDirectoryName(
	System.Reflection.Assembly.GetExecutingAssembly().Location)
	AppDomain.CurrentDomain.BaseDirectory //Priority
	System.IO.Directory.GetCurrentDirectory()
	Environment.CurrentDirectory
	System.IO.Path.GetDirectoryName(
	System.Reflection.Assembly.GetExecutingAssembly().GetName().CodeBase)
	System.IO.Path.GetDirectory(Application.ExecutablePath)
	}

	//Get current application folder models
	public void Application folder()
	{
	AppDomain.CurrentDomain.GetData("DataDirectory").ToString();
	}

	//Get current application folder view
	public void Application_view()
	{
	HttpContext.Server.MapPath("~/App_Date/");
	}

	//using Interface IENUMERABLE for looping throught dates in list
	public void loopThroughDates()
	{

	public IEnumerable<DateTime> EachDay(DateTime from, DateTime thru)
	{
	for (var day = from.Date; day.Date <= thru.Date; day = day.AddDays(1))
	yield return day;
	}

	foreach(DateTime date in EachDay(startDate,finishDate))
	{
	DatesRequested.Add(date);
	}
	}

	//reads excel contents into datatable and stores it as xml
	public void readExceloledb()
	{

	public string oledbRequest = "SELECT F2,sum(F3) FROM [????1$] where F4 like '929%' or F4 like '959%' and F2 <> '' and F2 is not null group by F2 ";

	string conString = @"Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + fileToParse + ";" + "Extended Properties=" + "\"" + @"Excel 12.0;HDR=NO;TypeGuessRows=0;ImportMixedTypes=Text""";

	OleDbConnection oleCon = new OleDbConnection(conString);
	OleDbCommand oleCmd = new OleDbCommand(req, oleCon);
	DataTable dt = new DataTable("Output");

	oleCon.Open();

	//dt is datatable
	dt.Load(oleCmd.ExecuteReader());

	//save dt as xml
	dt.WriteXml(folder + @"\" + @"output.xml",XmlWriteMode.WriteSchema, false);

	}

	//reads datatable , convets it to excel array on worksheet and saves xlsx
	public void storeDatatableAsXLSX()
	{

	Excel.Application excel_ = new Excel.Application();
	Excel.Workbook wb_ = excel_.Workbooks.Add(true);
	Excel.Worksheet ws_ = wb_.Worksheets[1];

	ws_ = wb_.Worksheets[1];


	//worksheet.Cells["A1"].LoadFromDataTable(dataToExcel, true,


	//passing datatable to array of objects dim to dim
	var data = new object[dt.Rows.Count+1, dt.Columns.Count+1];
	int drC = 0;
	int drR = 0;

	foreach(DataRow dr in dt.Rows)
	{
	drR = drR + 1;
	foreach(DataColumn dc in dt.Columns)
	{
	drC = drC + 1;
	data[drR, drC] = dt.Rows[drR-1][drC-1];
	}
	drC = 0;
	}


	var startCell = (Excel.Range)ws_.Cells[1, 1];
	var endCell = (Excel.Range)ws_.Cells[dt.Rows.Count + 1, dt.Columns.Count + 1];
	var writeRange = ws_.Range[startCell, endCell];

	//passing array of objects to excel list
	writeRange.Value2 = data;
	wb_.SaveAs(folder + @"\" + @"output.xlsx");

	}



	//openXMLread
	public void openXML()
	{
	// open the document read-only
	SpreadsheetDocument document = SpreadsheetDocument.Open(fileName, false);
	SharedStringTable sharedStringTable = document.WorkbookPart.SharedStringTablePart.SharedStringTable;
	string cellValue = null;

	foreach (WorksheetPart worksheetPart in document.WorkbookPart.WorksheetParts)
	{
	foreach (SheetData sheetData in worksheetPart.Worksheet.Elements<SheetData>())
	{
	if (sheetData.HasChildren)
	{
	foreach (Row row in sheetData.Elements<Row>())
	{
	foreach (Cell cell in row.Elements<Cell>())
	{
	cellValue = cell.InnerText;

	/*
	try
	{
	if (cell.DataType == CellValues.SharedString)
	{
	Console.WriteLine("cell val: " + sharedStringTable.ElementAt(Int32.Parse(cellValue)).InnerText);
	}
	else
	{
	Console.WriteLine("cell val: " + cellValue);
	}
	}
	catch(Exception e)
	{
	if(e.Message=="Error in implicit conversion. Cannot convert null object.")
	{
	MessageBox.Show(e.Message);
	}
	}
	* */
	}
	}
	}
	}
	}
	document.Close();

	}


	//select max ID from list of classes
	public void LINQlogic()
	{
	//add list of objects to ienumerable
	IEnumerable<QueryTextNew> Queries =
	from QueryTextNew in querytextList
	select QueryTextNew;

	//select max ID catching empty element exception
	int itemsMax;

	try
	{
	itemsMax = Queries.Max(x => x.ID);
	}
	catch(Exception e )
	{
	itemsMax = 0;
	}

	}

	//creating procedure for dataset return
	public void oracleprocedurefordataset()
	{
	create or replace
	procedure get_daily(out_dt out SYS_REFCURSOR)
	AS
	BEGIN
	OPEN out_dt FOR SELECT * FROM neprintsev_ia.temp_acq_d where rownum <=10;
	END get_daily;
	}

	//get dataset from oracle procedure and store result datatable in xml
	public void datasetget()
	{

	string fileToParse = @"C:\test\daily\output\01022015report + fee2.xlsx";
	string oledbRequest = @"SELECT F5,F4,sum(F9) FROM [????1$] where F2 like '929%' or F2 like '959%' and F3 <> '' and F3 is not null group by F5,F4 ";
	string conString = @"Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + fileToParse + ";" + "Extended Properties=" + "\"" + @"Excel 12.0;HDR=NO;TypeGuessRows=0;ImportMixedTypes=Text""";

	string connString = @"Data Source=dwh.rs.ru;User ID=neprintsev_ia;Password=awsedrRDESWA;";
	string oracleQuery = "get_daily";

	OracleConnection oracleConn = new OracleConnection(connString);

	OracleCommand oracleComm = new OracleCommand(oracleQuery, oracleConn);
	oracleComm.CommandType = CommandType.StoredProcedure;
	DataSet orads = new DataSet();
	oracleComm.Parameters.Add("out_dt", OracleType.Cursor).Direction=ParameterDirection.Output;

	oracleConn.Open();
	oracleComm.ExecuteNonQuery();

	OracleDataReader reader =
	oracleComm.Parameters["out_dt"].Value as OracleDataReader;

	OracleDataAdapter oracleAdapt = new OracleDataAdapter(oracleComm);

	oracleAdapt.Fill(orads);

	foreach (DataTable dtt in orads.Tables)
	{
	dtt.WriteXml(Path.GetDirectoryName(fileToParse) + @"\" + @"f_output.xml", XmlWriteMode.WriteSchema, false);
	}


	}

	//populate datatable to excel for current rowcolumn number
	public void populatedatatble to excel()
	{

	public void populateDataTable(DataTable dt,Excel.Worksheet ws_,int x,int y )
	{
	var data = new object[dt.Rows.Count , dt.Columns.Count ];
	int drC = -1;
	int drR = -1;

	foreach (DataRow drr in dt.Rows)
	{
	drR = drR + 1;
	foreach (DataColumn dcc in dt.Columns)
	{
	drC = drC + 1;
	data[drR, drC] = dt.Rows[drR ][drC];
	}
	drC = -1;
	}


	var startCell = (Excel.Range)ws_.Cells[x, y];
	var endCell = (Excel.Range)ws_.Cells[x+dt.Rows.Count-1, y+dt.Columns.Count-1];
	var writeRange = ws_.Range[startCell, endCell];

	writeRange.Value2 = data;

	}

	}

	//copy as embedded cahrt to powerpoint (editable) with smoexecute
	public void copytopowerpoiny(){
	pptSlide.Application.CommandBars.ExecuteMso("PasteExcelChartSourceFormatting");
	}


	//copy as ambeded and select object in powerpoint
	public void powerPoint(){
	//chartobject
	ch.Copy();

	pptSlide.Application.CommandBars.ExecuteMso("PasteExcelChartSourceFormatting");
	Thread.Sleep(1000);
	var a = pptSlide.Application.ActiveWindow.Selection;

	a.ShapeRange.Left = 10;
	a.ShapeRange.Top = 10;
	a.ShapeRange.Height = 200;
	a.ShapeRange.Width = 200;
	}


	//JSON serialization
	//Read write to filestream using memorystream
	public void JSONserialize(){

	MemoryStream ms = new MemoryStream();
	DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(rQueries_ih));
	ser.WriteObject(ms, q);

	ms.Position = 0;

	using (FileStream fs = new FileStream(@"C:\test\insert\json.txt",
	FileMode.Create, System.IO.FileAccess.Write))
	{
	ms.WriteTo(fs);
	ms.Close();
	}

	using (FileStream fs = new FileStream(@"C:\test\insert\json.txt",
	FileMode.Open, System.IO.FileAccess.Read))
	{
	MemoryStream ms2 = new MemoryStream();
	byte[] bytes = new byte[fs.Length];
	fs.Read(bytes, 0, (int)fs.Length);
	ms2.Write(bytes, 0, (int)fs.Length);

	ms2.Position = 0;
	q2 = (rQueries_ih)ser.ReadObject(ms2);
	ms2.Close();
	}

	}


	//inheritance
	public Inheritance()
	{
	A:B:C:D
	void -> new (virtual)-> virtual -> override
	void -> virtual-> override -> override
	A : D(C) => A

	virtual -> new virtual -> override
	A:C(D) =>A

	A:B:C:D
	virtual -> override-> virtual -> override
	A(B):D => B, C(D):D => D

	A,B:A,C:A
	virtual -> new
	B:B => A
	virtual -> override
	C:C => C


	}

	//copy past excel range to powwerpoint
	public void CopyRangeEmbeded(xlNS.Range rn_, pptNS.Slide ptSld, pptNS.Shape sh)
	{

	rn_.Application.Visible = true;
	rn_.Worksheet.Activate();
	rn_.Select();
	rn_.Copy();
	ptSld.Select();
	sh.Select();

	//needs thread sleep activation - unstable
	/*
	Thread.Sleep(500);
	sh.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
	Application.DoEvents();
	*/

	//copy but with standart format
	//ptSld.Application.ActiveWindow.View.PasteSpecial();
	//ptSld.Application.ActiveWindow.View.Paste();


	//ptSld.Shapes.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault, Microsoft.Office.Core.MsoTriState.msoFalse, "", 0, "", Microsoft.Office.Core.MsoTriState.msoTrue);
	//ptSld.Shapes.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault,,,,,);

	//ptSld.Application.ActiveWindow.View.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault);


	//PasteDestinationTheme
	//PasteAsEmbedded
	//PasteSourceFormatting
	//PasteExcelTableSourceFormatting


	//powerpointApplication.ActiveWindow.View.PasteSpecial();

	//only working example with correct shape and format
	//worked after first type commenting
	try
	{
	sh.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
	}
	catch (Exception e)
	{
	Logger.LogAddDebug(e.Message);
	}

	//sh.Application.ActiveWindow.Selection.Unselect();
	//sl.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
	}

	//copy pasy excel sheet to powwerpoint
	public void CopyChartEmbeded(xlNS.Shape ch, pptNS.Slide sl, pptNS.Shape sh)
	{
	ch.Copy();
	sl.Select();
	sh.Select();

	//paste as link
	//pptSlide.Shapes.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault, Microsoft.Office.Core.MsoTriState.msoFalse, "", 0, "", Microsoft.Office.Core.MsoTriState.msoTrue);
	//sh.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
	//sh.Application.ActiveWindow.Selection.Unselect();
	//sl.Application.CommandBars.ExecuteMso("PasteSourceFormatting");

	try
	{
	sl.Application.CommandBars.ExecuteMso("PasteExcelChartSourceFormatting");
	}
	catch (Exception e)
	{
	Logger.LogAddDebug(e.Message);
	}
	//Thread.Sleep(1000);
	var a = sl.Application.ActiveWindow.Selection;
	}

}

#endregion

#region C++ 

public Code theory
{
	
	
	
	Escape characters{
		\n //new line
		\r //carriage return
		\t //tab
		\\ //backslash \
		\" quotation "
	}
	
	Operators
	{
		a %= b //a = a % b; 1 = 5/2;
		
		((cond) ? "true" : "false"); // ((i>2) ? "yes" :: "no");
		
		//pointers declaration
		int* a;
		int *a;
		
		
		
	}
	
	Structures
	{

		class enum Name 
		{
			T field
			,T2 field2
		};
		
		struct Name{
			T field;
			T2 field2;
		};		
		
		Pointers {
			//pointers with int address initialize
			int b=0;
			//&b - > address of b
			a=&b;
			//*a - > get pointed variable value with Dereference Operator
			
			char* pstr ;
			
			//Pointer addresses substraction
			char buffer[50];
			char* pbuffer = &buffer[0];
			while(*pbuffer){pbuffer++};
			int sbstr = pbuffer - buffer;
			
			double bean[3][4];
			double* pbean = &bean[0][0];
			double pb = *(*(bean+0)+0);
			double pb2 = *(bean[1]+2);
			double pb3 = *(bean+1)[2];
			double pb4 = (*(bean+1))[2];

			*(*(arr+i)+j)
		}
						
		
		
	}

	
	
}

public Code Examples
{
	
	HowTo's
	{		
		sample_empty{
			
			//standart minimum include for cout
			#include <iostream>

			//namespace initialization
			using namespace std;

			int main()
			{
			cout << "HW";
			return 0;
			}
		}
		
		custom namespaceAdd{
			
//standart minimum include for cout
#include <iostream>

//namespace initialization
using namespace std;

//custom namespace
namespace ms {
	//function in namespace
	int return_zero()
	{
		return 0;
	}

	//void func
	void foo()
	{
		std::cout << "Empty foo() callsed";
	};
}

int main()
{
	cout << "HW \n";

	//using void fucnt
	ms::foo();
	//using custom namespace
	return ms::return_zero();
}

		}
		
		HelowWorld extended{
//standart minimum include for cout
#include <iostream>
#include <array>

//namespace initialization
using namespace std;

//class structures
namespace Classes_
{
	//enum classs
	enum class MyEnum
	{
		value1, value2 = 10, value3
	};

	//struc 
	struct Record {
		int ID;
		int num;
		char letter;
	};
}

namespace Functions_
{
	void Function1()
	{	
		std::cout << "Function started - > " << __func__ << "; \r\n";
	}

	int Function2(int a, int b)
	{
		std::cout << "Function started - > " << __func__ << "; \r\n";
		return 0;
	}
	
	auto Function3() -> int
	{
		return 0;
	}

	auto Function4(double a, double b)
	{
		if (b == 0) { std::cout << "1" << __func__ << a / b; }
		std::cout << "2" << __func__ << a / b;
		return a / b;
	}
}
//custom namespace
namespace ms {

	//function in namespace
	int return_zero()
	{
		return 0;
	}

	//void func
	void foo()
	{
		std::cout << "Empty foo() callsed";
	};

	void nl()
	{
		std::cout << "\r\n";
	}
	
	//Variables demonstration
	void Variables()
	{
		int uninitialized = 12;
		int initialized = 11;

		nl();

		std::cout << "Uninitialized->" << uninitialized << "\r\n";
		std::cout << "Initialized->" << uninitialized << "\r\n";

		std:cout << "nl->" << nl;
	}

	//Int cast and operator
	void Operators()
	{
		int i, x;
		i = 8;
		x = 2;
		i %= x;

		float flt = 1.234;
		int y;

		nl();
		std::cout << "  i % = x -> " << i << " i,x: " << i << ";" << x;
		
		nl();
		std::cout << "Float(f): " << flt << " (int)f -> " << (int)flt << "\r\n";
		std::cout << "Float(f): " << flt << " int(f) -> " << int(flt) << "\r\n";
		std::cout << "Float(f): " << flt << " static_cast<int>(f) -> " << static_cast<int>(flt) << "\r\n";

		nl();
		int i2 = 32767;
		short shrt;

		i2 *= 20;
		i2 += 153;

		i2 = 32769;

		nl();
		std::cout << "i2 -> " << i2;
		
		shrt = static_cast<short>(i2);

		nl();
		std::cout << "i2 % 32767 -> " << i2 % 32767 << "\r\n";
		std::cout << "shrt -> " << shrt;

		std::cout << "short 32768 to int -> " << static_cast<int>((short)32767) << "\r\n";
		std::cout << "short 32768 to int -> " << static_cast<int>((short)32768) << "\r\n";
		std::cout << "short 32769 to int -> " << static_cast<int>((short)32769) << "\r\n";
		std::cout << "short 32770 to int -> " << static_cast<int>((short)32770) << "\r\n";

		std::cout << "short 32770 to int -> " << static_cast<int>((short)(32768*2)) << "\r\n";
	}

	//enumerator print
	void EnumPrint()
	{
		Classes_::MyEnum  i = Classes_::MyEnum::value1;
		
		nl();
		std::cout<< "Classes_::MyEnum::Value1 -> " << (int)i;
		std::cout << "Classes_::MyEnum::Value1 -> " << (int)Classes_::MyEnum::value2;
	}
	
	//struct print
	void StructPrint()
	{
		Classes_::Record record = Classes_::Record();
		record.ID = 1;
		record.num = 15;
		record.letter = 'A';

		nl();
		std::cout << "Record -> " << record.ID << " " << record.letter << " " << record.num ;

		nl();
		
	}
	
	void Array()
	{
		std::array<int, 4> arr1;
		arr1 = { 9,8,7,6 };

		nl();
		for (int i = 0; i < arr1.size(); i++)
		{
			std::cout << " i=" << i << "; Arr[i]=" << arr1[i] << "; ";
		}


		//unexpected for i > declared
		//nl();
		//for (int i : arr1)
		//{
		//	std::cout << " i=" << i << "; Arr[i]=" << arr1[i] << "; ";
		//}

	}
	
	void Functions()
	{
		nl();
		Functions_::Function1();
		nl();
		Functions_::Function2(0, 1);
		nl();
		Functions_::Function3();
		nl();
		Functions_::Function4(5, 0);
		nl();
		Functions_::Function4(5, 3);
	}

	void Pointers()
	{
		int a = 10;
		int* p = &a;
		int** c = &p;

		std::cout << "a p &p &a *p-> " << a << " " << p << " " << &a << " " << &p << " " << *p;
		ms::nl();
		std::cout << "p c &p &c *p *c-> " << p << " " << c << " " << &p << " " << &c << " " << *p << " " << *c;
	}

}


int main()
{
	cout << "HW \n";
	
	//using void fucnt
	ms::foo();

	ms::Variables();
	
	ms::Operators();

	ms::EnumPrint();

	ms::StructPrint();

	ms::Array();

	ms::Functions();

	//using custom namespace
	return ms::return_zero();
}



		}
		
	}
	
}

#endregion

#region JS

//js templates
public void JS_templates()
{

$(document).ready(function () {

$(function () {
var data = [50, 90, 30, 10, 70, 20];
var w = 500;
var h = 100;
var svg = d3.select("#barChart")
.attr("width", w)
.attr("height", h);

svg.selectAll("rect")
.data(data)
.enter()
.append("rect")
.attr("x", function (d, i) {
return i * 21; //Bar width of 20 plus 1 for padding
})
.attr("y", function (d) {
return h - d; //Height minus data value
})
.attr("width", 20)
.attr("height", function (d) {
return d; //Just the data value
})
.attr("fill", function (d) {
return "rgb(0, 0, " + (d * 3) + ")";
});
});

$("#GO").click(
function () {

//load data from Json action
//$.getJSON("/Home/GetJson", databind);

$.getJSON("GetJson", databind);

//add d3 container
var tableDiv = d3.select('body').append('div').attr('id', 'tableDiv').attr('class', 'table table-hover');
console.log("Added container : ", tableDiv);

//bind data from callback
function databind(data) {
console.log(data);

var data3 = JSON.parse(JSON.stringify(data));
console.log(data3);

tabulate(data3, ['DT_REG', 'PAY_SYS', 'AMT']);

};

 

}
);


});

function tabulate(data, columns) {
console.log('Started tabulate for ', data);
var table = d3.select('body').append('table').attr('id', 'tabulated').attr('class', 'table table-hover');
var thead = table.append('thead');
var tbody = table.append('tbody');

// append the header row
thead.append('tr')
.selectAll('th')
.data(columns).enter()
.append('th')
.text(function (column) { return column; });

// create a row for each object in the data
var rows = tbody.selectAll('tr')
.data(data)
.enter()
.append('tr');

// create a cell in each row for each column
var cells = rows.selectAll('td')
.data(function (row) {
return columns.map(function (column) {
return { column: column, value: row[column] };
});
})
.enter()
.append('td')
.text(function (d) { return d.value; });

return table;
}
}

//JS vendors
public void JSvendors()
{
<!--Links from vendors JQuery, jQyery UI, Bootstrap, D3 + styles-->
<!--
<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
<link rel="nofollow" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js"></script>
<script type="application/javascript" charset="utf-8" src="http://d3js.org/d3.v3.min.js"></script>
<link rel="nofollow" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
-->
}


//----------------------------------------------
#endregion

#region SQL

//ORACLE
//PL - sql server script templates

public void PL_SQL()
{
	
	public protected class ScriptExmaples()
	{
		
		public internal class Selection()
		{
			
			public datetime()
			{
				
				define ReqFnDate=to_date('30.06.2017 23:59:59','dd.mm.yyyy hh24:mi:ss');
				define ReqStDate=add_months(trunc(&ReqFnDate,'mm'),0);
				define TrStDate=add_months(&ReqStDate,-5);
				define TrFnDate=add_months(&ReqFnDate,+1);
				
			}

			public tableCreate()
			{
				
				//table with prim,sec keys
				create table teble(
				ID int not null identity(0,1), --not nullable id increasing from 0 by 1 every insert
				SEC_ID int null, --foreign key
				primary key(ID), -- indicates primary key
				foreign key(SEC_ID) references SEC_NAMES(ID), -- indicates secondary key and according key in other table
				)

				//create table add key add foreign key
				create table DWH_replica.dbo.table2 (
				ID int not null identity(0,1),
				TXT varchar(50),
				DT Datetime);

				alter table DWH_replica.dbo.table2
				add primary key (ID);

				create table DWH_replica.dbo.table1 (
				ID int not null identity(0,1),
				SEC_ID int null,
				primary key (ID),
				foreign key (SEC_ID) references DWH_replica.dbo.table2(ID));

			}
						
			public join_update()
			{
				
				/*update from join*/
				--\\\\\\\\\\\\\\\\\\
				update acquiring_month tt
				set (center,division) = (
				select f.rc,f.rp from tms.v_merchants t 
				join mtr_rc_rp_fins f on f.GEOGRAPHIC=t.GEOGRAPHIC_GID 
				where t.merchant=tt.merchant
				)
				where exists(
				select t.merchant,f.rc,f.rp from tms.v_merchants t 
				join mtr_rc_rp_fins f on f.GEOGRAPHIC=t.GEOGRAPHIC_GID 
				where t.merchant=tt.merchant
				)
				and tt.center is null and tt.division is null 
				--//////////////////


				--update from join with merge into 
				--\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

				select * from test1;
				select * from test2;

				delete from test1; delete from test2;

				insert into test1 (c1,c2) values ('A','1');
				insert into test1 (c1,c2) values ('B','1');
				insert into test1 (c1,c2) values ('C','1');
				insert into test1 (c1,c2) values ('D','1');
				insert into test1 (c1,c2) values ('E','1');
				insert into test1 (c1,c2) values ('F','1');

				insert into test2 (c1,c2) values ('A','2');
				insert into test2 (c1,c2) values ('B','3');
				insert into test2 (c1,c2) values ('C','4');

				merge into test1 t1
				using (select * from test2 t2) p
				on (t1.c1=p.c1)
				when matched then
				update set t1.c2=p.c2
				;

				--//////////////////////////////

			}

			public LEVEL()
			{
				
			--//level1
			SELECT * FROM

			(SELECT LEVEL R0 FROM dual CONNECT BY LEVEL <3),
			(SELECT LEVEL R1 FROM dual CONNECT BY LEVEL <5),
			(SELECT LEVEL R2 FROM dual CONNECT BY LEVEL <4)
			--///

			--// levle2
			select * from 
			( select level "C1" from dual connect by level <=10 ) t1
			full outer join ( select level "C1" from dual connect by level <=3 ) t2 on t1.c1<>t2.c1

			union all

			select * from 
			( select level "C1" from dual connect by level <=10 ) t1
			join ( select level "C1" from dual connect by level <=3 ) t2 on t1.c1=t2.c1
			--///

			}

			public partition_over()
			{
				
			select 
			min(rownum) 
			from (
			select t.*,count(*) over (partition by t.bin,t.bank) "CNT" from neprintsev_ia.ref_bin t
			) where cnt>1 group by bin,bank

			}

			public delete_duplicates()
			{
				
			delete from neprintsev_ia.ref_bin 
			where rowid in (
			select min(rowid) "RN" from neprintsev_ia.ref_bin  where bin in (
			select bin from neprintsev_ia.ref_bin having count(bin)>1 group by bin
			) group by bin
			)

			}

			public CURSOR()
			{
				/*SAMPLE CURSOR*/
				set serveroutput on;
				begin
				for cr in ( select merchant,reg_nr from ref_merchants )
				loop 
				  dbms_output.put_line('drop table ' || cr.merchant || ';');
				end loop;
				end ;

			}
			
			
		}
		
		public internal class MAINTANANCE()
		{
			
			public REFERENCES()
			{
				
				--//roles
				select * from role_tab_privs
				--//granted privileges
				select * from table_privileges
				revoke  select on acquiring_month from kokorina_jv
				--//all  user objects
				select * from user_objects
				--// TABLE modifications INSERT,DELETE,UPDATE
				select * from user_tab_modifications;

				
				/*Unreferenced table names*/
				select distinct table_name,'select * from ' || table_name || ';' from all_tables where owner like '%NEPRIN%'
				and table_name not in (
				select distinct "REFERENCED_NAME" from user_dependencies 
				)
				;

				/*Unref and ungranted tables*/
				select distinct table_name,'select * from ' || table_name || ';' from all_tables where 1=1 
				and owner like '%NEPRIN%'
				--all tables that referenced from smwh
				and table_name not in (select distinct "REFERENCED_NAME" from user_dependencies )
				--all tables granted to somb
				and table_name not in (select table_name from user_tab_privs where owner like '%NEPRIN%')
				and table_name not like 'REF%'
				order by table_name asc
				;

				/*TABLE SIZE*/
				select segment_name "TABLE_NAME",bytes /1024/1024  "SIZE_MB" from 
				user_segments 
				order by "SIZE" desc 
				;
				
			}			
						
			public Priviledges
			{
				revoke  select on acquiring_month from kokorina_jv
			}
			
			public TABLES_ALTER()
			{
				//change column type
				alter table ref_mc_ird_rates modify mcc varchar (50) 
			}
			
			public EXPLAIN_PLAN()
			{

			--//eplain table
			delete from PLAN_TABLE;
			EXPLAIN PLAN for
			select * from dual;
			select operation,options,object_name,cost , t.* from PLAN_TABLE t;
			--//


			--//display cursor
			select * from table (DBMS_XPLAN.DISPLAY_CURSOR(null,null,'basic'))
			--// privilege needed: SELECT privilege on V$SQL_PLAN, V$SQL_PLAN_DETAIL,SELECT_CATALOG_ROLE
			--//

			--//Gather statistic
			Execute DBMS_STATS.GATHER_TABLE_STATS('neprintsev_ia','AMS_MC_BINS_',method_opt=>'FOR COLUMNS SIZE 254 columnName')
			--//

			}
			
			public DB_LINK()
			{
				
				
			drop  DATABASE LINK "DB_LINK.US.ORACLE.COM";

			CREATE DATABASE LINK "DB_LINK.US.ORACLE.COM"
			CONNECT TO DACQ_NEPRINTSEV
			IDENTIFIED BY  x2y4uecbbo
			USING '  (DESCRIPTION=
				(ADDRESS=
				  (PROTOCOL=TCP)
				  (HOST=exdt01-scan.rs.ru)
				  (PORT=1521)
				)
				(CONNECT_DATA=
				  (SERVER=dedicated)
				  (SERVICE_NAME=BUS)
				)
			  )
			'
			;
			}
					
			public JOBS()
			{
				
				select job,broken,interval,what,last_date,last_sec,next_date,next_sec from user_jobs order by job desc;
			
				DECLARE
				l_job NUMBER := 0;
				BEGIN
				DBMS_JOB.SUBMIT( l_job,what=>'P_TEMPLATE_DATE(sysdate,null,null);', 
				next_date=>trunc(sysdate,'dd')+1+2.5/24/60/60, -- start next hour 
				interval => 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+3+2.5/24');
				commit;
				END;



				exec dbms_job.run(163038);commit;

				BEGIN
				DBMS_JOB.REMOVE(131572);
				COMMIT;
				END;

				begin 
				dbms_job.change(158018, null,to_date('12.09.2014 18:00:00','dd.mm.yyyy hh24:mi:ss'), 'trunc(sysdate+2,' || '''' ||  'dd' || '''' ||  ')+18/24');
				end;

				--unBroke JOB
				EXEC DBMS_JOB.BROKEN(206923,FALSE);

				--change next date time
				EXECUTE dbms_job.change(206923,null,to_date('03.04.2017 00:00:00','dd.mm.yyyy hh24:mi:ss'),'add_months(trunc(sysdate,''mm''),1)+3');

		

		 begin 
		 DBMS_JOB.CHANGE
		   (213653
		   ,'P_BANK_FN(sysdate,''%*%'');'
		   ,trunc(sysdate,'dd')+1+1.5/24/60
		   ,'add_months(TRUNC(SYSDATE,''mm''),1)+3+1.5/24');
		   end ;
		   
			exec dbms_job.run(131571);commit;

			BEGIN
			   DBMS_JOB.REMOVE(131572);
			   COMMIT;
			END;
			
			/*JOBS UNBROKE*/
				/* Filename on companion disk: job5.sql */*
				CREATE OR REPLACE PROCEDURE job_fixer
				AS
				   /*
				   || calls DBMS_JOB.BROKEN to try and set
				   || any broken jobs to unbroken
				   */
				   
				   /* cursor selects user's broken jobs */
				   CURSOR broken_jobs_cur
				   IS
				   SELECT job
					 FROM user_jobs
					WHERE broken = 'Y';
					
				BEGIN
				   FOR job_rec IN broken_jobs_cur
				   LOOP
					  DBMS_JOB.BROKEN(job_rec.job,FALSE);
				   END LOOP;
				END job_fixer;
				
													

			}
			
			public alter_session_lang()
			{
				ALTER SESSION SET NLS_DATE_LANGUAGE = 'ENGLISH'
				select to_char(sysdate,'Month') from dual 
			}
			
			public  DROP_TABLES_BY_LIST()
			{
		
			--TEST--
			-------------------------
			drop table temp3;
			drop table temp4;

			create table temp3 (c1 varchar (10));
			create table temp4 (c1 varchar (10),C2 INT);

			insert into temp3 (c1) values ('aa b aa');
			insert into temp3 (c1) values ('aa c aa');
			insert into temp3 (c1) values ('aa d aa');
			insert into temp3 (c1) values ('aa e aa');

			insert into temp4 (c1) values ('c');
			insert into temp4 (c1) values ('e');

			commit;

			set serveroutput on
			begin
			for c_c1 in (select c1 from temp3) loop
				for c_c2 in (select c1 from temp4) loop         
				  if c_c1.c1  like  '%' || c_c2.c1  || '%' then 
				  dbms_output.put_line(c_c1.c1  || ' like ' || '''%' || c_c2.c1  || '%'''); 
				  --insert into T_output (c1) VALUES (c_c1.c1  || ' like ' || '''%' || c_c2.c1  || '%''');
				  UPDATE TEMP4 SET C2 =1 WHERE C1=c_c2.C1;
				  end if;
				end loop;
			  end loop;
			end;
			-------------------------


			--BATTLE--
			-------------------------

			drop table t_table_to_delete;
			create table t_table_to_delete (t_name varchar(250),inprocedures int);

			--search selected tables in procedures and if used mark inprocedures as 1
			set serveroutput on
			begin
			for c_c1 in ( SELECT TEXT  FROM USER_SOURCE) loop
				for c_c2 in ( SELECT T_NAME   FROM T_TABLE_TO_DELETE) loop         
				  if c_c1.TEXT  like  '%' || c_c2.T_NAME  || '%' then 
				  dbms_output.put_line(c_c1.TEXT  || ' like ' || '''%' || c_c2.T_NAME  || '%'''); 
				  update T_TABLE_TO_DELETE set inprocedures =1 where t_name =c_c2.T_NAME and t_name not in 
				  (select distinct table_name from table_privileges );
				  end if;
				end loop;
			  end loop;
			end;


			--very very bad drop;
			set serveroutput on
			begin
			for c_c in (select * from t_table_to_delete where inprocedures !=1 and t_name not in 
				  (select distinct table_name from table_privileges )) loop
			  execute immediate ('drop table ' || c_c.t_name );
			  dbms_output.put_line('dropped :' || c_c.t_name);
			end loop;
			end ;
			-------------------------
			}
					
			
		}
		
		public internal class PLsql()
		{
			
			public P_TEMPLATE()
			{
				
				create or replace
				PROCEDURE P_EWALLET_D (ReqStIn date, ReqFnIn date, comment_ varchar )
				AUTHID CURRENT_USER
				IS
				jobStarted date; --sysdate of currentprocedure started
				jobFinished date; --sysdate of currentprocedure finished

				ReqStDate date;
				ReqFnDate date;

				rows_processed number;
				commentary varchar(200);

				BEGIN
				DBMS_OUTPUT.PUT_LINE('\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\');
				DBMS_OUTPUT.PUT_LINE('P_EWALLET_D STARTED');
				jobStarted := sysdate;
				rows_processed := 0;



				if(comment_ is null or comment_ = '' ) then 
				commentary := 'UNKNOWN' ;
				else
				commentary := comment_;
				end if;

				if(ReqStIn is not null and ReqFnIn is not null ) then
				ReqStDate := trunc(ReqStIn,'mm') ;
				ReqFnDate := trunc(ReqFnIn,'mm') ;
				else
				if(ReqStIn is null and ReqFnIn is null ) then
				ReqStDate := add_months(trunc(sysdate,'mm'),-1);
				ReqFnDate := add_months(ReqStDate,1)-1/24/60/60;
				else

				if(ReqStIn is null) then
				ReqStDate := trunc(ReqFnIn,'mm');
				ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
				end if;

				if(ReqFnIn is null) then 
				ReqStDate := trunc(ReqStIn,'mm');
				ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
				end if;
				end if;

				end if;









				--printing all date values to log

				DBMS_OUTPUT.PUT_LINE('Actual sysdate - ' || to_char(sysdate,'dd.mm.yyyy hh24:mi:ss') || ';');
				DBMS_OUTPUT.PUT_LINE('Received sysdate - ' || to_char(jobStarted,'dd.mm.yyyy hh24:mi:ss') || ';');
				DBMS_OUTPUT.PUT_LINE('Data period start date  - ' || to_char(ReqStDate,'dd.mm.yyyy hh24:mi:ss') || ';');
				DBMS_OUTPUT.PUT_LINE('Data period finish date  - ' || to_char(ReqFnDate,'dd.mm.yyyy hh24:mi:ss') || ';');


				--all procedure specific code goes here
				-->>>HERE<<<

				/*
				delete from T_EWALLETS_D where DATE_D between ReqStDate  and ReqFnDate;

				insert into T_EWALLETS_D


				select 
				trunc(m.request_date,'dd') "DATE_D",
				cast(fld_042 as varchar(10)) "MERCHANT",
				CASE
				WHEN fld_119 LIKE '%061150139059239%'
				THEN 'APP'
				WHEN fld_119 LIKE '%061150110030273%'
				THEN 'SMP'
				WHEN fld_119 LIKE '%061150120834693%'
				THEN 'ARP'
				ELSE '0'
				END "EWALLET",

				sum(m.FLD_004/100) "AMT",
				count(m.FLD_004) "CNT"

				FROM tms.RTPS_MESSAGES_LOG m
				where 1=1
				and m.request_date between ReqStDate  and ReqFnDate
				and cast(fld_042 as varchar(10)) in (
				select merchant from ref_merchants --where reg_nr = '7743543761'
				)
				and FLD_039 = '000'

				group by trunc(m.request_date,'dd') , cast(m.fld_042 as varchar(10)) ,
				CASE
				WHEN fld_119 LIKE '%061150139059239%'
				THEN 'APP'
				WHEN fld_119 LIKE '%061150110030273%'
				THEN 'SMP'
				WHEN fld_119 LIKE '%061150120834693%'
				THEN 'ARP'
				ELSE '0'
				END
				;

				commit;
				*/

				--ref_report_table
				--select max(rownum) into rows_processed from neprintsev_ia.T_ACQ_D where "DATE" between startRefresh and endRefresh;
				jobFinished:=sysdate;
				insert into neprintsev_ia.ref_report_table ("NAME",job_started,job_finished,data_start,data_finish,rows_processed, commentary) 
				values ('P_EWALLET_D', jobStarted,jobFinished,ReqStDate,ReqFnDate,rows_processed,commentary);
				DBMS_OUTPUT.PUT_LINE('P_EWALLET_D EXECUTED');
				DBMS_OUTPUT.PUT_LINE('//////////////////////////////////////////////////////////');

				--current procedure execution example
				/*
				set serveroutput on;
				execute P_TEMPLATE(sysdate);
				*/
				END P_EWALLET_D;
			}
			
			public P_TEMPLATE_DATE()
			{
				
				create or replace
				PROCEDURE P_TEMPLATE_DATE (ReqStIn date, ReqFnIn date, comment_ varchar )
				AUTHID CURRENT_USER
				IS
				jobStarted date; --sysdate of currentprocedure started
				jobFinished date; --sysdate of currentprocedure finished

				dataDate date;  --date wich is default for data quering (sysdate-2 for acquiring queries)
				dataStart date; --data period start date
				dataFinish date; --data period finish date

				rows_processed number;
				commentary varchar(200);

				ReqStDate date;
				ReqFnDate date;


				BEGIN
				DBMS_OUTPUT.PUT_LINE('\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\');
				DBMS_OUTPUT.PUT_LINE('P_TEMPLATE_DATE STARTED');
				jobStarted := sysdate;
				rows_processed := 0;


				if(comment_ is null or comment_ = '' ) then 
				commentary := 'UNKNOWN' ;
				else
				commentary := comment_;
				end if;

				if(ReqStIn is not null and ReqFnIn is not null ) then
				ReqStDate := trunc(ReqStIn,'mm') ;
				ReqFnDate := trunc(ReqFnIn,'mm') ;
				else
				if(ReqStIn is null and ReqFnIn is null ) then
				ReqStDate := add_months(trunc(sysdate,'mm'),-1);
				ReqFnDate := add_months(ReqStDate,1)-1/24/60/60;
				else

				if(ReqStIn is null) then
				ReqStDate := trunc(ReqFnIn,'mm');
				ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
				end if;

				if(ReqFnIn is null) then 
				ReqStDate := trunc(ReqStIn,'mm');
				ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
				end if;
				end if;

				end if;

				dataDate:=sysdate-2; --data default for most reports sysdate - 2
				dataStart:=trunc(dataDate,'mm'); --defining data date range start of month 
				dataFinish:=trunc(dataStart,'dd')-1/24/60/60; --defining data date range finish of month

				--printing all date values to log

				DBMS_OUTPUT.PUT_LINE('Actual sysdate - ' || to_char(sysdate,'dd.mm.yyyy hh24:mi:ss') || ';');
				DBMS_OUTPUT.PUT_LINE('Received sysdate - ' || to_char(jobStarted,'dd.mm.yyyy hh24:mi:ss') || ';');
				DBMS_OUTPUT.PUT_LINE('Data sysdate defined - ' || to_char(dataDate,'dd.mm.yyyy hh24:mi:ss') || ';');
				DBMS_OUTPUT.PUT_LINE('Data period start date  - ' || to_char(dataStart,'dd.mm.yyyy hh24:mi:ss') || ';');
				DBMS_OUTPUT.PUT_LINE('Data period finish date  - ' || to_char(dataFinish,'dd.mm.yyyy hh24:mi:ss') || ';');


				--all procedure specific code goes here
				-->>>HERE<<<


				--ref_report_table
				--select max(rownum) into rows_processed from neprintsev_ia.T_ACQ_D where "DATE" between startRefresh and endRefresh;
				jobFinished:=sysdate;
				insert into neprintsev_ia.ref_report_table ("NAME",job_started,job_finished,data_start,data_finish,rows_processed, commentary) 
				values ('P_TEMPLATE_DATE', jobStarted,jobFinished,dataStart,dataFinish,rows_processed,comment_);
				DBMS_OUTPUT.PUT_LINE('P_TEMPLATE_DATE EXECUTED');
				DBMS_OUTPUT.PUT_LINE('//////////////////////////////////////////////////////////');

				--current procedure execution example
				/*
				set serveroutput on;
				execute P_TEMPLATE(sysdate);
				*/
				END P_TEMPLATE_DATE;
				
			}
			
			public LoopByNumWithLevel()
			{
				
				set serveroutput on
				begin 
				for c1 in ( SELECT LEVEL R0 FROM dual CONNECT BY LEVEL <3 ) loop

				/*
				define dt = add_months(trunc(sysdate,'dd'),0) ;
				set serveroutput on
				execute P_ECOM_M_REFRESH(&dt);
				commit;
				*/
				DBMS_OUTPUT.put_line('Print ' || c1.R0 );

				end loop;
				end ;

			}
		}
		
		public internal class UNSORTED()
		{
		

with t1 as
(
select 
b.slip_count sCnt,
b.department dep
from tms.batches b
where 
b.card_type IN ('32','01','02','10','21','95','99','50')
AND b.batch_date>='08.07.2013'
AND b.batch_date <='14.07.2013'
and b.department=9293963112
)
,
t2 as (
select 
m.merchant merch
from tms.merchants m
join temp2 t on m.merchant=t.c1
--where m.merchant=9290575240
)

select 
t2.merch,
sum(t1.sCnt) 
from t1
join t2 on t1.dep=t2.merch

group by 
t2.merch



with t1 as
(
select 
b.slip_count sCnt,
b.department dep
from tms.batches b
where 
b.card_type IN ('32','01','02','10','21','95','99','50')
AND to_char(b.batch_date,'IW')='28'
and b.department=9293963112
)
,
t2 as (
select 
m.merchant merch,
m.street address
from tms.merchants m
join temp2 t on m.merchant=t.c1
--where m.merchant=9290575240
)

select 
t2.merch,
t2.address,
sum(t1.sCnt) 
from t1
join t2 on t1.dep=t2.merch

group by 
t2.merch,
t2.address



select * from (
with t1 as
(
select 
b.slip_count sCnt,
b.department dep,
to_char(b.batch_date,'IW') wCnt
from tms.batches b
where 
b.card_type IN ('32','01','02','10','21','95','99','50')
AND to_char(b.batch_date,'IW') between '27' and '30'
and to_char(b.batch_date,'yyyy') = '2013'
and b.department=9293963112
),t2 as (
select 
m.merchant merch,
m.street address
from tms.merchants m
join temp2 t on m.merchant=t.c1
--where m.merchant=9290575240
)

select 
t2.merch,
t2.address,
t1.wCnt wCnt ,
sum(t1.sCnt)  sCnt
from t1
join t2 on t1.dep=t2.merch

group by 
t2.merch,
t2.address,
t1.wCnt
)
pivot 
(
sum(sCnt) for wCnt in ('27','28','29','30')
)



/*disaster*/
select  * from (
with t1 as
(
select 
b.slip_count sCnt,
b.department dep,
to_char(b.batch_date,'IW') wCnt
from tms.batches b
where 
b.card_type IN ('32','01','02','10','21','95','99','50')
AND to_char(b.batch_date,'IW') between '27' and '32'
and to_char(b.batch_date,'yyyy') = '2013'
--and b.department=9293963112
)
,
t2 as (
select 
m.merchant merch,
m.street address
from tms.merchants m
join temp2 t on m.merchant=t.c1
--where m.merchant=9290575240
)

select 
t2.merch,
t2.address,
t1.wCnt wCnt ,
sum(t1.sCnt)  sCnt
from t1
join t2 on t1.dep=t2.merch

group by 
t2.merch,
t2.address,
t1.wCnt
)
pivot 
(
sum(sCnt) for wCnt in ('27','28','29','30','31','32')
)




create table disaster2  as

select
t.merchant merch,
sum(sCnt) sCnt,
t1.yYear || '_' || t1.wWeek wekkYear

from 
reg_journal_merchants t

left join 
(select 
substr(p.chr1,instr(p.chr1,'#')+1, length(p.chr1)-instr(p.chr1,'#')) men_aqu,
o.main_industry ind,
m.merchant merch,
m.street address,
b.slip_count sCnt,
b.department dep,
to_char(b.batch_date,'IW') wWeek,
to_char(b.batch_date,'yyyy') yYear

from tms.merchants m

join tms.batches b on b.department=m.merchant
join orabis1.industry_code o on o.mcc=m.mcc
join tms.merchant_par p on p.merchant=m.merchant

where 
b.card_type IN ('32','01','02','10','21','95','99','50')
--where m.merchant=9290575240
and to_char(b.batch_date,'IW')= '30'
and to_char(b.batch_date,'yyyy') ='2013'
)t1 on t.merchant=t1.merch

group by 
t.merchant,
t1.yYear || '_' || t1.wWeek 


select
us.segment_name tName
,to_char(us.bytes/us.max_size*100,'999.999') "AMT_RATE"
,to_char((us.bytes/1024)/1024,'9999') "AMT_MBs"
,to_char((us.max_size/1024)/1024 ,'9999') "mMax_(Mbs)"
from
user_segments us
order by "AMT_MBs" desc
;


"
"select
us.segment_name tName
,to_char(us.bytes/us.max_size*100,'90.99') "amount_%"
,to_char((us.bytes/1024)/1024,'9999') "iIs_(Mbs)"
,to_char((us.max_size/1024)/1024 ,'9999') "mMax_(Mbs)"
from
user_segments us

union all 

select 
'All',
to_char(sum(us2.bytes)/us2.max_size*100,'90,99')
,to_char(sum(us2.bytes)/1024/1024,'9999')
,to_char(us2.max_size/1024/1024,'9999')
from user_segments us2
group by 
'all',us2.max_size
"
"select
us.segment_name,
to_char(us.bytes/1024/1024,'999990.99') "MB",
to_char(us.max_size/1024/1024,'9999') "MD",
to_char((us.bytes/1024/1024)/(us.max_size/1024/1024)*100,'9.99')
from 
user_segments us
"
"select * from temp4 
select * from user_jobs;
select * from user_procedures;




execute  send_mail('ia-neprintsev@rsb.ru','ia-neprintsev@rsb.ru','EX-MB-05.rs.ru',25)

create table disaster_tst
as 

select 
t1.ind industry,t1.merch merchant,t2.yCnt || '_' || t2.wCnt week,sum(t2.sCnt) sCnt
from 
(
select
substr(p.chr1,instr(p.chr1,'#')+1, length(p.chr1)-instr(p.chr1,'#')) men_aqu,
o.main_industry ind,
m.merchant merch,
m.street address
from 
tms.merchants m
join reg_Journal_merchants t on m.merchant=t.merchant
join orabis1.industry_code o on o.mcc=m.mcc
join tms.merchant_par p on p.merchant=m.merchant
where
M.REGION='082' AND (M.MERCHANT LIKE '929%' OR M.MERCHANT LIKE '959%')
) t1

left join

(
select
b.slip_count sCnt,
b.department dep,
to_char(b.batch_date,'IW') wCnt,
to_char(b.batch_date,'yyyy') yCnt
from
tms.batches b
where 
b.card_type IN ('32','01','02','10','21','95','99','50')
AND to_char(b.batch_date,'IW') between '29' and '29'
and to_char(b.batch_date,'yyyy') = '2013'
)t2

on t1.merch=t2.dep

group by

t1.ind,t1.merch,t2.yCnt || '_' || t2.wCnt"
"insert into DC_hash (mMonth,dt_reg , pay_sys,  type_transaction
, abrv_name ,main_industry , merchant, issuer_type ,rc 
,dbv_rub ,merchant_fee ,cnt_trans )

SELECT /*+  ordered parallel(s,8) full(T) */ 
to_char(s.dt_reg,'yyyy') || '_' || to_char(s.dt_reg,'mm') ,
	   s.dt_reg,
	   s.pay_sys pay_sys,      
	   s.type_transaction,     
	   m.abrv_name,
	   nvl(MC.main_industry,'Lodging') MAIN_INDUSTRY,
	   m.merchant,
	   s.issuer_type,
	   decode(rc.center,'??????','?????????????',rc.center) RC, 
	   SUM (-s.vl_rub) dbv_rub,
	   SUM (s.fee_merchant) merchant_fee,
	   SUM(s.cnt) cnt_trans 
FROM vitr.V$SLIP_ACQ_D@db_link S
LEFT JOIN TMS.MERCHANTS M ON (S.merchant=m.merchant)
LEFT JOIN PRIV_DRR.ACQUIRING_REGION RC ON RC.REG_ID=M.REGION
LEFT JOIN orabis1.industry_code MC ON (m.mcc = mc.MCC)
where (s.type_transaction in ('Goods and service','Returns'))
and s.merchant not in (9900000003, 9900000005, 9292121431, 9292296399, 9292434867, 9292886660, 9293471306) 
AND nvl (s.acquire_bank, 'RS_RUS') != 'RS_UKR'      
AND m.abrv_name NOT LIKE 'IB %'                                                     
AND M.FULL_NAME NOT LIKE '%?????????%'
AND M.FULL_NAME  != '??? ?? ???????'
AND m.full_name  != '??? ??? ????????? ??????? ??????'  
AND s.is_linked = 'N'
AND s.dt_reg BETWEEN 
TO_DATE('01.08.2013'||' 00:00:00','dd.mm.yyyy hh24:mi:ss') 
AND 
TO_DATE('24.08.2013'||' 23:59:59','dd.mm.yyyy hh24:mi:ss')

GROUP BY  
to_char(s.dt_reg,'yyyy') || '_' || to_char(s.dt_reg,'mm') ,
s.dt_reg,
s.pay_sys,      
s.type_transaction,     
m.abrv_name,
nvl(MC.main_industry,'Lodging'),
m.merchant,
s.issuer_type,
decode(rc.center,'??????','?????????????',rc.center) 
  "
"create table temp (c1 varchar(50),c2 varchar(50))

insert into dc_base (merchant,create_date,year_num,week_num)

select 
t.c1,to_date(t.c2,'mm.dd.yyyy'),'2013','2'
from
temp t
"
"select * from temp4 
select * from user_jobs;
select * from user_procedures;


DECLARE
  l_job NUMBER := 0;
BEGIN
  DBMS_JOB.SUBMIT( l_job,what=>'P_CONTACTLESS;', 
   next_date=>trunc(sysdate,'dd')+1, -- start next hour 
   interval=>'trunc(sysdate,' || '''' || 'dd' || '''' ||')+1+1/24' );
   commit;
END;


exec dbms_job.run(163038);commit;

BEGIN
   DBMS_JOB.REMOVE(131572);
   COMMIT;
END;

begin 
dbms_job.change(158018, null,to_date('12.09.2014 18:00:00','dd.mm.yyyy hh24:mi:ss'), 'trunc(sysdate+2,' || '''' ||  'dd' || '''' ||  ')+18/24');
end;


select to_char ( 'trunc(sysdate,' || '''' || 'dd' || '''' ||'+1/24' ) from dual 

"
"
--jobs
DECLARE
  l_job NUMBER := 0;
BEGIN
  DBMS_JOB.SUBMIT( l_job,what=>'procedure1;',
   next_date=>SYSDATE, -- start next hour 
   interval=>'SYSDATE+5/1440');
   commit;
END;

'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+2'

exec dbms_job.interval(131622, 'sysdate+1/86400'); --every second
exec dbms_job.interval(131622, 'trunc(sysdate)+24/24+6/24');

select * from user_jobs;

exec dbms_job.run(131634);commit;
--11:15:43 11:17:49

BEGIN
   DBMS_JOB.REMOVE(131623);
   COMMIT;
END;
"
"select
us.segment_name tName
,to_char(us.bytes/us.max_size*100,'90.99') "amount_%"
,to_char((us.bytes/1024)/1024,'9999') "iIs_(Mbs)"
,to_char((us.max_size/1024)/1024 ,'9999') "mMax_(Mbs)"
from
user_segments us

union all 

select 
'All',
to_char(sum(us2.bytes)/us2.max_size*100,'90,99')
,to_char(sum(us2.bytes)/1024/1024,'9999')
,to_char(us2.max_size/1024/1024,'9999')
from user_segments us2
group by 
'all',us2.max_size
"
"select
us.segment_name,
to_char(us.bytes/1024/1024,'999990.99') "MB",
to_char(us.max_size/1024/1024,'9999') "MD",
to_char((us.bytes/1024/1024)/(us.max_size/1024/1024)*100,'9.99')
from 
user_segments us
"
"create or replace
PROCEDURE P_CONTACTLESS
IS

T_START VARCHAR2(256);
T_END VARCHAR2(256);


BEGIN
  
  T_START := TO_CHAR(sysdate, 'DD-MON-YYYY HH24:MI:SS');
  
 
  DELETE T_CONTACTLESS
  WHERE  TR_DATETIME >= TO_DATE(TO_CHAR(TRUNC(SYSDATE-7),'dd.mm.yyyy')||' 00:00:00','dd.mm.yyyy hh24:mi:ss');
  
  COMMIT;
  
  
  
  insert into T_CONTACTLESS ( IDMERCHANT,
							  TERM_ID,
							  TR_DATETIME,
							  REG_DATETIME,
							  CARD,
							  PROC_CODE,
							  TR_AMOUNT_RUR,
							  TR_COMMISSION_RUR,
							  FULL_NAME,
							  ABRV_NAME,
							  PAY_SYSTEM,
							  STREET,
							  DIVISION,
							  RC  
							)                 
  WITH MSTR_F_SL AS (SELECT /*+ parallel(T,4) full(T) full(M) full(RC) */
									 T.IDMERCHANT,
									 T.TERM_ID,
									 T.BATCH_NR,
									 T.SLIP,
									 T.TR_DATE AS TR_DATETIME, -- ???? ? ????? ??????????
									 T.REG_DATE AS REG_DATETIME, -- ???? ? ????? ???????????
									 T.CARD,
									 T.BIN,
									 CASE WHEN T.PROC_CODE='20'
										  THEN 'Returns'
										  WHEN T.PROC_CODE='00'
										  THEN 'Goods and service'
									 END AS PROC_CODE,                                       
									 T.AMOUNT_RUR AS TR_AMOUNT_RUR,
									 T.COMMISSION_RUR AS TR_COMMISSION_RUR,
									 M.FULL_NAME,
									 M.ABRV_NAME,
									 M.CITY,
									 M.STREET,
								  CASE WHEN T.PAY_SYSTEM_ID=1
									   THEN 'A'
									   WHEN T.PAY_SYSTEM_ID=2
									   THEN 'V'
									   WHEN T.PAY_SYSTEM_ID IN (3,4) AND T.CARD_TYPE NOT IN ('85','80','60','70')
									   THEN 'M'
									   ELSE 'OTHER'
								  END AS PAY_SYSTEM,
								  RC.DIVISION,
								  DECODE(RC.CENTER,'??????','?????????????',RC.CENTER) RC 
								FROM MART.STG_MPCS_SLIPS_FACT T
								 LEFT JOIN TMS.MERCHANTS M ON TO_CHAR(T.IDMERCHANT)=M.MERCHANT
								 LEFT JOIN PRIV_DRR.ACQUIRING_REGION RC ON RC.REG_ID=M.REGION
					  WHERE T.TR_DATE>=TO_DATE(TO_CHAR(TRUNC(SYSDATE-30),'dd.mm.yyyy')||' 00:00:00','dd.mm.yyyy hh24:mi:ss')
						AND T.TR_DATE<=TO_DATE(TO_CHAR(TRUNC(SYSDATE),'dd.mm.yyyy')||' 23:59:59','dd.mm.yyyy hh24:mi:ss')
						AND 
						   (
							  (    T.PROC_CODE IN ('20')
								  AND T.TR_TYPE = '06'
							  )
							 OR (    T.PROC_CODE IN ('00')
									 AND T.TR_TYPE = '05'
								)
							)
				   )
  SELECT /*+ parallel(A12,4) full(a11) full(a12) */
  A11.IDMERCHANT,
  A11.TERM_ID,
  A11.TR_DATETIME,
  A11.REG_DATETIME,
  A11.CARD,
  A11.PROC_CODE,
  A11.TR_AMOUNT_RUR,
  A11.TR_COMMISSION_RUR,
  A11.FULL_NAME,
  A11.ABRV_NAME,
  A11.PAY_SYSTEM,
  A11.STREET,
  A11.DIVISION,
  A11.RC
  FROM MSTR_F_SL A11 
  JOIN   MART.V_MSTR_SLIPS_FEATURES A12 ON  A11.BATCH_NR = A12.BATCH_NR  
										AND A11.SLIP = A12.SLIP 
										AND A12.POINT_CODE_7='M'
										AND A12.TR_DATE>=TO_DATE(TO_CHAR(TRUNC(SYSDATE-7),'dd.mm.yyyy')||' 00:00:00','dd.mm.yyyy hh24:mi:ss')
										AND A12.TR_DATE<=TO_DATE(TO_CHAR(TRUNC(SYSDATE),'dd.mm.yyyy')||' 23:59:59','dd.mm.yyyy hh24:mi:ss');

  COMMIT;

  T_END := TO_CHAR(sysdate, 'DD-MON-YYYY HH24:MI:SS');
  
END P_CONTACTLESS;"
SELECT * FROM V$VERSION
" select
   r.row_numb as "1_UTRNNO",
   'POS' as "2_TERMINAL_TYPE",
   r.FLD_041 as "3_ORGDEV",
   to_char(r.request_date,'ddmmyyyy') "4_UDATE",
   to_char(r.request_date,'hh24:mi:ss') "5_TIME",
   r.FLD_039 as "6_RESPCODE",
   r.FLD_004/100 as "7_REQAMT",
   
   case
	  when FLD_039 <> '000'  and FLD_039 <> '400' then  r.FLD_004/100 
	  else 0
   end 
   as "8_ACTAMT",
   
   case 
	  when fld_003 like '00%' then 'purchase'
	  when fld_003 like '20%'then 'refund'
	  else 'other_value'
   end 
   as "9_TRANS_TYPE",
   
   case
	  when msg_type_in='1420' then 1
	  else   0
   end
   as "10_REVERSAL",
   
   FLD_026 as "11_MERCHANT",
   
   FLD_042 as "12_MERCHANT_ID",
   
   m.city,m.p_street,fld_043, --15-17 for columns
   
   case
	  when  cast(bg.bank_name as varchar2 (30 byte)) = '??????? ????????' then 47
	  else 0
	  end 
   as "16_NWINDICATOR",

case
when substr(fld_022,7,1) = '9' then '2'
when substr(fld_022,7,1) = '5' then '5'
when substr(fld_022,7,1) = '6' then '6'
when substr(fld_022,7,1) = 'M' then 'I'
when substr(fld_022,7,1) = 'A' then 'B'
else 'Z'
end as "17_POS_DATA_CODE",

case
when substr(fld_022,8,1) = '0' then 0
when substr(fld_022,8,1) = '1' then 1
when substr(fld_022,8,1) = '5' then 5
else 999
end as "18_POS_DATA_CODE2",

case 
when substr(fld_022,8,1) = '1' then 0
else 1
end as "19_PINBLK",

case 
when substr(fld_022,9,1) = '1' then 3
when substr(fld_022,9,1) = '1' then 0
end as "20_PINBLK2"

   from tms.RTPS_MESSAGES_LOG partition (P_20140101) r 
   join tms.merchants m on cast(m.merchant as char(15 byte)) = r.fld_042
   
   left join MART.DQ_VITR_bin_guide bg 
   on cast( bg.bin as VARCHAR2(30 BYTE)) =substr( r.fld_002,1,6)
   
   where FLD_042 
   in (
	  select  cast(m.merchant as CHAR(15 BYTE) ) from tms.merchants m where abrv_name like '%MCDONALD%'
   )
	   
"
"set serveroutput on
"
http://www.f-notes.info/oracle:what_where
"/*PARTITION BY DATE + SUBPARTIOTION BY PAY_SYS + ROWMOVEMENT*/
create table test5_p (
C1 NUMBER,
C2 VARCHAR2(50 BYTE),
C3 date)

partition by range (c3)
subpartition by list (c2)
(
   partition P_1 values less than (to_date('01.01.2014 00:00:00','dd.mm.yyyy hh24:mi:ss'))
	  (
	  subpartition A_1 values ('A'),
	  subpartition V_1 values ('V'),
	  subpartition MC_1 values ('M'),
	  subpartition OTHER_1 values('OTHER'),
	  subpartition DEFAULT_1 values (DEFAULT)
	  ),
	 partition P_2 values less than (to_date('01.02.2014 00:00:00','dd.mm.yyyy hh24:mi:ss'))
	  (
	  subpartition A_2 values ('A'),
	  subpartition V_2 values ('V'),
	  subpartition MC_2 values ('M'),
	  subpartition OTHER_2 values('OTHER'),
	  subpartition DEFAULT_2 values (DEFAULT)
	  )

)ENABLE ROW MOVEMENT;"
"/*testing for unique values*/

insert into test3 values (1,'a',1);
insert into test3 values (1,'b',2);
insert into test3 values (2,'a',2);
insert into test3 values (3,'a',2);
insert into test3 values (3,'b',1);
insert into test3 values (4,'b',1);



insert into test3 values (1,'c',1);
insert into test3 values (2,'a',3);
insert into test3 values (3,'c',3);
insert into test3 values (4,'b',3);



with t1 as (

select  distinct c1,case when c2 ='b'  then  'b' else 'nb' end "C2"  from test3 where c2='b'

union all

select distinct  c1,case when c2 = 'b' then 'b' else 'nb' end "C2"  from test3 where c2<>'b'
and c1 not in (select c1 from test3 where c2='b')

), 
t2 as (
/*select if just one 2 then 2 if none 2 then a unique c3*/
select  distinct c1,case when c3 =2 then 'two' else 'ntwo' end "C3"  from test3 where c3=2

union all

select  distinct c1,case when c3 =2 then 'two' else 'ntwo' end "C3"  from test3 where c3<>2
and c1 not in (
select  c1 from test3 where c3=2)

)
select 
t1.c1,t1.c2,t2.c3
from t1 
join t2 on t2.c1=t1.c1



"/*GRANT OVERAL*/
begin 
for temp_name in (
  select table_name from user_tables 
  --where table_name in ('TEMP','TEMP2','TEMP3','TEMP4') 
  ) loop
  execute immediate 'grant select,insert,delete  on neprintsev_ia.' || temp_name.table_name || ' to neprintsev_ia';
  end loop;
  end ;
  "
"/*REPORT TABLE*/
select  
finished,name_,to_char(started,'dd.mm.yyyy hh24:mi:ss'),to_char(finished,'dd.mm.yyyy hh24:mi:ss'),execution_time,date_from,date_to,rows_count
from report_table 
"
"/*DISTINCT LEFT JOIN SELECT FOR SEVERAL LISTS*/
create table test1(c1 varchar(10),c2 date,c3 number);
create table test2(c1 varchar(10),c2 date,c3 number);
create table test3(c1 varchar(10),c2 date,c3 number);

insert into test1 values  ('A',sysdate-3,1);
insert into test1 values ('A',sysdate-3,2);
insert into test1 values ('A',sysdate-3,3);
insert into test1 values ('B',sysdate-3,1);
insert into test1 values ('B',sysdate-3,2);
insert into test1 values ('B',sysdate-3,3);

insert into test1 values  ('A',sysdate-4,1);
insert into test1 values ('A',sysdate-4,2);
insert into test1 values ('A',sysdate-4,3);
insert into test1 values ('B',sysdate-4,1);
insert into test1 values ('B',sysdate-4,2);
insert into test1 values ('B',sysdate-4,3);

insert into test2 values ('A',sysdate-4,1);
insert into test2 values ('A',sysdate-4,2);
insert into test2 values ('A',sysdate-4,3);
insert into test2 values ('B',sysdate-3,1);
insert into test2 values ('B',sysdate-3,2);
insert into test2 values ('B',sysdate-3,3);

insert into test3 (c1) values ('A');
insert into test3 (c1) values ('B');
insert into test3 (c1) values ('C');
insert into test3 (c1) values ('D');



with t3 as (select t3.c1 "C1" from test3 t3 ),
t2 as(
select t1.c1 "C1",sum(t2.c3*t1.c3) "C3" from test1 t1
left join test2 t2 on t1.c1=t2.c1
where trunc(t1.c2,'dd') = trunc(sysdate-3,'dd')
group by  t1.c1
)
select 
t3.c1,t2.c3 from t3 
left join t2 on t2.c1=t3.c1;"
"/*IB*/
select * from ORAWH.IB_CLIENT_MV where client_name like '%?????????%'
select * from ORAWH.IB_REQ_MV where client_id ='3595559'
select * from ORAWH.IB_QNA_MV where user_id = '3576169'
select * from ORAWH.IB_USERS_MV where user_id = '3576169'

--client person user
'3595559' '3595802' '3576169'
3595802


select * from ORAWH.IB_ACCOUNT_MV
select * from ORAWH.IB_USER_LOCK_MV
select * from ORAWH.MB_ABONENT_LIST
select * from ORAWH.V_IB_CLIENT_ID
select * from ORAWH.IB_INTERNAL_PMT_REQ_MV
select * from ORAWH.IB_DEP_REQ_MV
select * from ORAWH.IB_DOMESTIC_PMT_MV
select * from ORAWH.IB_PUBLIC_SERVICE_REPMT_REQ_MV
select * from ORAWH.IB_PUBLIC_SRV_REPMT_REQ_PAR_MV
select * from ORAWH.IB_BEN_PHONE_PMT_MV
select * from ORAWH.IB_BANK_CARD_ISSUE_REQ_MV
select * from ORAWH.IB_REQ_TMPL_MV
select * from ORAWH.IB_REQ_SIGN_MV
select * from ORAWH.IB_SERVICE_ENABLE_REQ_MV
select * from ORAWH.IB_BANK_CARD_OD_LIMIT_REQ_MV
select * from ORAWH.IB_AGR_LIM_REQ_LIM_MV
select * from ORAWH.IB_CARD_PMT_REQ_MV
select * from ORAWH.IB_REGUL_ORDER_MV
"
"create or replace
PROCEDURE P_REGEX
AUTHID CURRENT_USER
IS
pattern  varchar(250);
Cursor CR is select t.REGEX_PATTERN from neprintsev_ia.ref_regex_pattern t where t.REGEX_PATTERN is not null;

BEGIN
delete from neprintsev_ia.ref_regex_ent;
 DBMS_OUTPUT.PUT_LINE('Deleted from ref_regex_ent');  
 
  for C1 in CR loop
	insert into neprintsev_ia.ref_regex_ent(ENTITY,REGEX_PATTERN) select m.merchant,C1.REGEX_PATTERN  from neprintsev_ia.ref_merchants m where regexp_like(upper(m.street),trim(upper(C1.REGEX_PATTERN))) and m.city ='MOSKVA';
	--insert into neprintsev_ia.ref_regex_ent(ENTITY,REGEX_PATTERN) select m.merchant,C1.REGEX_PATTERN from neprintsev_ia.ref_merchants m;--regexp_like(upper(m.street),upper(C1.C3));
	DBMS_OUTPUT.PUT_LINE(C1.REGEX_PATTERN);    
  end loop;  
END P_REGEX;"
"set serveroutput on
DECLARE
   TYPE EmpCurTyp IS REF CURSOR;
   emp_cv   EmpCurTyp;
   emp_rec  ref_regex_pattern%ROWTYPE;
   sql_stmt VARCHAR2(250);
   sql_stmt2 varchar(250);
   v_job   number := 10;
BEGIN
   sql_stmt := 'SELECT * FROM ref_regex_pattern WHERE rownum <= :j';
   sql_stmt2 := 'INSERT INTO temp7(c1) select m.merchant from ref_merchants m where regexp_like(upper(m.street),upper(:a)) ';
   OPEN emp_cv FOR sql_stmt USING v_job;
   LOOP
	 FETCH emp_cv INTO emp_rec;
	 EXIT WHEN emp_cv%NOTFOUND;
	 DBMS_OUTPUT.PUT_LINE('Name: ' || emp_rec."NAME");
	 execute immediate sql_stmt2 using emp_rec."NAME";
   END LOOP;
   CLOSE emp_cv;
END;

"
"define fnRegDate = trunc(sysdate,'dd')-1/24/60/60
define stRegDate = trunc(&fnRegDate,'mm')

define stSLDate = add_months(trunc(&stRegDate,'mm'),-5)
define fnSLDate = trunc(add_months(trunc(&fnRegDate,'mm'),+2),'mm')-(1/24/60/60)


select
to_char(&fnRegDate,'dd.mm.yyyy hh24:mi:ss') "FNREG",
to_char(&stRegDate,'dd.mm.yyyy hh24:mi:ss') "STREG",
to_char(&fnSLDate,'dd.mm.yyyy hh24:mi:ss') "FNSL",
to_char(&stSLDate,'dd.mm.yyyy hh24:mi:ss') "STSL"
from dual;
"
"create type emp_obj is object (empno number, ename varchar2(10));
create type emp_tab is table of emp_obj;

create or replace function all_emps return emp_tab
	is
	  l_emp_tab emp_tab := emp_tab();
	   n integer := 0;
   begin
   
	  for r in (select c1 empno, c2 ename from temp)
	  
	  loop
		  l_emp_tab.extend;
		  n := n + 1;
		l_emp_tab(n) := emp_obj(r.empno, r.ename);
	  end loop;
	  
	  return l_emp_tab;
   end;
   
select * from table (all_emps);"
"CREATE OR REPLACE function get_daily
  RETURN SYS_REFCURSOR
AS
  my_cursor SYS_REFCURSOR;
BEGIN
  OPEN my_cursor FOR SELECT * FROM temp_acq_d;
  RETURN my_cursor;
END get_daily;


begin 
select get_daily from dual;
end ;
"
"create or replace
procedure get_daily(out_dt out SYS_REFCURSOR)
 AS
BEGIN
  OPEN out_dt FOR SELECT * FROM neprintsev_ia.temp_acq_d where rownum <=10;
END get_daily;"
CREATE USER 'test_user3'@'localhost' IDENTIFIED BY 'QwErT234';
GRANT create,select ON temp_db.* TO 'test_user2'@'10.14.16.48' IDENTIFIED BY 'QwErT234';
"insert into temp2 (c1,c2,c3) values ('1',to_date('01.01.2015','dd.mm.yyyy'),'3');
insert into temp2 (c1,c2,c3) values ('1',to_date('02.01.2015','dd.mm.yyyy'),'0');
insert into temp2 (c1,c2,c3) values ('2',to_date('01.01.2015','dd.mm.yyyy'),'0');
insert into temp2 (c1,c2,c3) values ('3',to_date('01.01.2015','dd.mm.yyyy'),'0');
insert into temp2 (c1,c2,c3) values ('4',to_date('03.01.2015','dd.mm.yyyy'),'0');
insert into temp2 (c1,c2,c3) values ('4',to_date('04.01.2015','dd.mm.yyyy'),'3');


with t as (
select c1,max(c2) c2 from temp2 group by c1
) ,
t2 as (
select t.c1,t.c2,t.c3 from temp2 t
)

select t2.* from t2 
join t on t2.c1=t.c1 and t2.c2=t.c2
"
"//------------------------------------

create table t_daily_d
(
"ID" number not null,
"PAY_SYS" varchar(10) not null,
constraint pk_daily_id primary key ("ID")
)

------------------------------------
drop sequence seq_d ;
Create sequence seq_d start with 1
increment by 1
minvalue 1
maxvalue 1000000000;

------------------------------------

insert into t_daily_d 
values
(seq_d.nextval,'A')

------------------------------------"
"create table test1 (c1 date,c2 varchar(10),c3 varchar(10),c4 number) ;


insert into test1 select sysdate-68,'2','10',0.564032697547684  from dual ;
insert into test1 select sysdate-97,'4','15',0.329087048832272  from dual ;
insert into test1 select sysdate-140,'1','15',1.66015625  from dual ;
insert into test1 select sysdate-165,'4','12',0.630021141649049  from dual ;
insert into test1 select sysdate-171,'5','14',1.21212121212121  from dual ;
insert into test1 select sysdate-220,'2','13',0.805111821086262  from dual ;
insert into test1 select sysdate-227,'3','10',0.878048780487805  from dual ;
insert into test1 select sysdate-283,'4','10',1.50922509225092  from dual ;
insert into test1 select sysdate-338,'3','10',0.868217054263566  from dual ;
insert into test1 select sysdate-383,'3','14',2.36526946107784  from dual ;
insert into test1 select sysdate-429,'1','13',0.316062176165803  from dual ;
insert into test1 select sysdate-499,'3','13',0.92817679558011  from dual ;
insert into test1 select sysdate-547,'3','15',0.226299694189602  from dual ;
insert into test1 select sysdate-609,'1','13',0.809128630705394  from dual ;
insert into test1 select sysdate-628,'5','13',0.0595238095238095  from dual ;
insert into test1 select sysdate-635,'3','13',1.03562945368171  from dual ;
insert into test1 select sysdate-674,'3','12',0.242811501597444  from dual ;
insert into test1 select sysdate-715,'1','11',0.80672268907563  from dual ;
insert into test1 select sysdate-787,'4','15',2.21739130434783  from dual ;
insert into test1 select sysdate-834,'5','15',0.651764705882353  from dual ;
insert into test1 select sysdate-879,'2','10',0.799086757990868  from dual ;
insert into test1 select sysdate-944,'1','13',0.60958904109589  from dual ;
insert into test1 select sysdate-958,'1','10',0.462222222222222  from dual ;
insert into test1 select sysdate-1021,'5','10',2.50617283950617  from dual ;
insert into test1 select sysdate-1054,'1','11',1.04618937644342  from dual ;
insert into test1 select sysdate-1076,'1','11',0.0290909090909091  from dual ;
insert into test1 select sysdate-1109,'2','11',1.10096153846154  from dual ;
insert into test1 select sysdate-1143,'3','14',0.514285714285714  from dual ;
insert into test1 select sysdate-1191,'2','13',0.123711340206186  from dual ;
insert into test1 select sysdate-1211,'4','15',0.469565217391304  from dual ;
insert into test1 select sysdate-1245,'1','10',0.176339285714286  from dual ;
insert into test1 select sysdate-1322,'5','15',0.324786324786325  from dual ;
insert into test1 select sysdate-1384,'5','11',1.01793721973094  from dual ;
insert into test1 select sysdate-1437,'4','13',0.264018691588785  from dual ;
insert into test1 select sysdate-1466,'3','13',0.794029850746269  from dual ;
insert into test1 select sysdate-1486,'5','11',0.507418397626113  from dual ;
insert into test1 select sysdate-1513,'1','10',0.302884615384615  from dual ;
insert into test1 select sysdate-1555,'5','12',0.864406779661017  from dual ;
insert into test1 select sysdate-1633,'3','15',0.612385321100917  from dual ;
insert into test1 select sysdate-1661,'4','10',0.545454545454545  from dual ;
insert into test1 select sysdate-1731,'4','12',0.51875  from dual ;
insert into test1 select sysdate-1747,'3','12',0.952479338842975  from dual ;
insert into test1 select sysdate-1823,'1','12',0.35978835978836  from dual ;
insert into test1 select sysdate-1894,'3','15',0.380129589632829  from dual ;
insert into test1 select sysdate-1924,'5','10',0.603723404255319  from dual ;
insert into test1 select sysdate-1936,'3','10',0.665271966527197  from dual ;
insert into test1 select sysdate-1944,'2','11',1.48262548262548  from dual ;
insert into test1 select sysdate-2009,'2','11',0.0341463414634146  from dual ;
insert into test1 select sysdate-2082,'2','13',2.70285714285714  from dual ;
insert into test1 select sysdate-2123,'2','14',0.912955465587045  from dual ;
insert into test1 select sysdate-2203,'5','11',4.46728971962617  from dual ;
insert into test1 select sysdate-2279,'4','10',0.127348643006263  from dual ;
insert into test1 select sysdate-2296,'1','12',1.04892966360856  from dual ;
insert into test1 select sysdate-2354,'5','13',1  from dual ;
insert into test1 select sysdate-2412,'4','12',1.02762430939227  from dual ;
insert into test1 select sysdate-2440,'3','10',0.911458333333333  from dual ;


--select maximum by indexed column from date
with t as (
select
--c4 "RT",
c2 || '_' || c3 "IND",
max(c1) "DATE"
from test1
group by c2 || '_' || c3
)
,
t2 as (
select
c4 "RT",
c2 || '_' || c3 "IND",
c1 "DATE"
from test1
)

select t2.* from t2
join t on t.IND = t2.IND and t."DATE"=t2."DATE"
"
"drop table test_number;
drop table test_number_min_max;

CREATE TABLE test_number("ID_T" NUMBER,SEQ NUMBER,text VARCHAR2(5));
INSERT INTO test_number VALUES(1,1,'AA');
INSERT INTO test_number VALUES(1,3,'CC');
INSERT INTO test_number VALUES(1,4,'DD');
INSERT INTO test_number VALUES(1,5,'EE');
INSERT INTO test_number VALUES(1,6,'FF');
INSERT INTO test_number VALUES(1,7,'GG');
INSERT INTO test_number VALUES(1,8,'HH');
INSERT INTO test_number VALUES(1,10,'JJ');
INSERT INTO test_number VALUES(2,1,'KK');
INSERT INTO test_number VALUES(2,2,'LL');
INSERT INTO test_number VALUES(2,3,'MM');
INSERT INTO test_number VALUES(2,4,'NN');
INSERT INTO test_number VALUES(2,6,'PP');
INSERT INTO test_number VALUES(2,7,'QQ');
INSERT INTO test_number VALUES(3,1,'TT');
INSERT INTO test_number VALUES(3,4,'ZZ');
INSERT INTO test_number VALUES(3,5,'XX');

--///////////////////
--//min max
create table test_number_min_max("ID_T2" number,"MIN" number,"MAX" number);
INSERT INTO test_number_min_max VALUES(1,1,12);
INSERT INTO test_number_min_max VALUES(2,1,9);
INSERT INTO test_number_min_max VALUES(3,1,5);

--"oldschool" syntax
SELECT "RWN" "ID_T3","ROWN" seq FROM 

(SELECT ROWNUM "ROWN" FROM all_objects WHERE ROWNUM <13),
(SELECT ROWNUM "RWN" FROM all_objects WHERE ROWNUM <4),
test_number_min_max m

WHERE "RWN"="ID_T2" AND "ROWN" >= "MIN" AND "ROWN" <= "MAX" AND ("RWN","ROWN") NOT IN
(SELECT "ID_T",seq FROM test_number)


--join syntax
select t."RWN",t3."ROWN" from
(SELECT ROWNUM "RWN" FROM all_objects WHERE ROWNUM <4) t
join test_number_min_max t2 on t2."ID_T2" = t."RWN"
join (SELECT ROWNUM "ROWN" FROM all_objects WHERE ROWNUM <13) t3 on t3."ROWN" >= t2."MIN" and  t3."ROWN" <= t2."MAX"

where (t."RWN",t3."ROWN" ) not in (SELECT "ID_T",seq FROM test_number)

--//\\\\\\\\\\\\\\\\\\\\\\\
		}
	}
		
	}

	public protected class ORACLE()
	{
		public internal class Insertion()
		{
			
			public SQL_LOADER()
			{
				//ctl example
				//-----
				load data
				infile 'c:\test\sql_loader\terminals\load.txt'
				replace into table t_terminals3
				--append into table merchant_list
				fields terminated by "|" TRAILING NULLCOLS
				("TERMINAL","MERCHANT" 
				,"OPEN_DATE" DATE 'DD.MM.YYYY HH24:MI:SS'
				,"CLOSE_DATE" DATE 'DD.MM.YYYY HH24:MI:SS'
				,"STATUS"				
				--( "NAME" ,"DEPARTMENT" ,"TERM_ID","TR_DATE" DATE 'DD.MM.YYYY HH24:MI:SS',"P_SYS","A_CARD","A_ACQ_B","A_CARD_ISS"
				--,"A_AMT" "TO_NUMBER(replace(:A_AMT,'.',','))"
				--,"A_FEE" "TO_NUMBER(replace(:A_FEE,'.',','))"
				--,"A_FEE_AMT" "TO_NUMBER(replace(:A_FEE_AMT,'.',','))"
				--,"A_P_AMT" "TO_NUMBER(replace(:A_P_AMT,'.',','))"
				--,"A_CCY","A_SLIP","A_APR_CODE","A_TR_TYPE" ,"A_P_MERCH","A_F_NAME","A_ARN"
				)
				
				//load par example
				DATA=C:\test\sql_loader\terminals\load.txt
				USERID=neprintsev_ia/awsedrDRSEAW@dwh
				CONTROL=C:\test\sql_loader\ctl.ctl
				LOG=C:\test\sql_loader\terminals\log.txt
				
			}
		
		}
	}
	
}

//SQL SERVER
//T SQL
public void T_SQL()
{
	
	public protected class ScriptExamples()
	{
			
		public interface class Insertion()
		{
				public Shitty_Callendar()
				{
					
					drop table  master.dbo.calendar ;
					create table master.dbo.calendar (id int ,"DATE" date
					, primary key (ID)
					);

					delete from master.dbo.calendar;

					declare @cnt int ;
					declare @max int;
					select @cnt = 0;
					set @max = 12*10;

					while @cnt < @max
					begin
					set @cnt = @cnt+1;
					print(dateadd(month,-(@max-@cnt),dateadd(MONTH,DATEDIFF(MONTH,0,getdate()),0)));

					insert into master.dbo.calendar (ID,DATE)
					values (
					@cnt,
					dateadd(month,-(@max-@cnt),dateadd(MONTH,DATEDIFF(MONTH,0,getdate()),0))
					);
					--print(- @cnt);
					end ;


					select * from master.dbo.calendar



				}
		}
		
		public internal class Selection()
		{
			
			public datetime()
			{
				
				--trunc by month
				select dateadd (yy,DATEDIFF(yy, 0,GETDATE()),0)
				select CONVERT(date,GETDATE(),103) where CONVERT(date,GETDATE(),103) = '01/09/2016'
				CONVERT(datetime,"DATE",104)
				select @@ROWCOUNT from DWH_replica.dbo.FD_ACQ_D
				
				select  
				format(
				getdate()
				,'dd.MM.yyyy hh:mm:ss');
				
				select convert(varchar,getdate(),120);
				select convert(date,getdate(),113);
				
			}

		}
		
		public internal class MAINTANANCE()
		{
			
			public tableCreate()
			{
								
				//table with prim,sec keys
				create table teble(
				ID int not null identity(0,1), --not nullable id increasing from 0 by 1 every insert
				SEC_ID int null, --foreign key
				primary key(ID), -- indicates primary key
				foreign key(SEC_ID) references SEC_NAMES(ID), -- indicates secondary key and according key in other table
				)

				//create table add key add foreign key
				create table DWH_replica.dbo.table2 (
				ID int not null identity(0,1),
				TXT varchar(50),
				DT Datetime);

				alter table DWH_replica.dbo.table2
				add primary key (ID);

				create table DWH_replica.dbo.table1 (
				ID int not null identity(0,1),
				SEC_ID int null,
				primary key (ID),
				foreign key (SEC_ID) references DWH_replica.dbo.table2(ID));

			}
			
			public DropDatabase()
			{
				USE master;
				ALTER DATABASE NORTHWIND SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
				DROP DATABASE NORTHWIND ;
			}
			
			public LockSessions()
			{
				
			}
		}
	
	}
	
}

#endregion

}

namespace OS
{
	
	public Windows
	{
		public CMD
		{
			public void AsAdmin(){
			//add current user as admin
			runas /user:????????????? "net localgroup "??????????????" "neprintsevia" /ADD"
		
			}
			
		}
		
		public void Execute()
		{
			mstsc -> ??????????? ? ?????????? ???????? ?????
			cmd -> ???????
		}
	}
	
	public UNIX
	{
		public Ubuntu
		{
			public HotKeys
			{
				
				public OS
				{
					super (hold) - help
					ctrl + alt + T - terminal
					ctrl + L -> nautilus path browser
				}
				
				public Terminal 
				{
					TAB - auto complete
					shift + ins (ctrl + shift + V ) - ctrl + V
					ctrl + ins (ctrl + shift + C )- ctrl + C
					ctrl + LeftArr/RightArr -> moove between params
					ctrl + U -> delete line
						 + K -> delete line after kursor
						 + W -> delete line before kursor
						 + R -< search command history for words
				}
				
			}
			
			public TerminalCommands
			{				
				sudo apt-get update && sudo apt-get upgrade
				sudo apt-get -f install
				sudo dpkg --purge --force-depends libpowerdevilcore0 libtaskmanager4b
				sudo apt-get -f install
				sudo apt-get install build-essential
				sudo apt-get autoclean && sudo apt-get clear cache
				gksu nautilus /etc --open in browser
				sudo nano  /etc/apt/sources.list				
				
				http://help.ubuntu.ru/wiki/%D0%B3%D0%BE%D1%80%D1%8F%D1%87%D0%B8%D0%B5_%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D1%88%D0%B8_%D0%B2_unity
				http://help.ubuntu.ru/manual/%D1%82%D0%B5%D1%80%D0%BC%D0%B8%D0%BD%D0%B0%D0%BB
				http://forum.ubuntu.ru/index.php?topic=14535.15
				
				lsb_release -a - current build version
				(alt + F2) gksu software-properties-gtk -> show ubuntu update center
				sudo rm -r -f /path -> force remove recursive
				sudo cd /path -> goto folder
					cd .. -> up 1 lvl
				sudo mkdir /path -> create directory
					-p /path -> create directory recursive
				sudo ls -> display content-map
					-a -> with hidden
				sudo systemctl restart network-manager -> restarn netweork				
				sudo ufw enable/disablemail- 
				sudo poweroff/reboot -> poweroff/reboot
				dpkg --get-selections -> installed pkgs
				dpkg --get-selections | grep -v deinstall > ~/Desktop/packages -> save to file				
					-L packageNmae -> find installed pakceg pathes
				mv /folder /folder -> rename folder
				command !& -> run command with previous typed parameter
				^command1^command2 -> run command2 with previous command1 params
				
			}
		
			public Troubleshooting
			{
				//No _apt sandbox user
				https://askubuntu.com/questions/810202/what-is-the-sandbox-user-apt-on-my-system
				adduser --force-badname --system --home /nonexistent  \
				--no-create-home --quiet _apt || true
				
				//Windows 7 don't have a permission to brows Ubuntu Fileshare
				uncomment browseable = yes in etc/samba/smb.conf
				https://askubuntu.com/questions/569333/windows-7-8-1-ubuntu-14-folder-sharing
			}
		
			public Pakets
			{
				public Mercurial
				{
					sudo add-apt-repository universse
					sudo apt-get install mercurial
					sudo apt-get install mercurial meld
					
					hg -> main call
					hg version -> check installation
						init -> initialize in current directory
						clone path -> make copy of path in current directory
						clone path path ->
						
				}
				
				public Glances (resource monitor)
				{
					sudo apt-get install python-pip build-essential python-dev lm-sensors
					sudo pip install psutil logutils bottle batinfo https://bitbucket.org/gleb_zhulik/py3sensors/get/tip.tar.gz zeroconf netifaces pymdstat influxdb elasticsearch potsdb statsd pystache docker-py pysnmp pika py-cpuinfo bernhard
					sudo pip install glances
				}
			}
		}
	}

}

