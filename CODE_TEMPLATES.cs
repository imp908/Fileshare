///Hierarhy
namespace Parts{
	
	#region Names
	
{
"TODO":[
	{"Infrastructure":[
		{
		"Name":""
		,"What":""
		,"How":""
		,"TODO":[]
		,"DONE":[]
		,"Test":[]
		,"Comments":""
		}
	]}
	,{"Utility":[]}
	,{"Mastery":[]}
	,{"Actual":[]}
]
}
	#endregion
	
}

	//Usefull links
	public void mostUsefullLinks()
	{
		https://sharpc.livejournal.com/67583.html
		http://www.securitynewspaper.com/2015/10/15/how-to-scan-whole-internet-3-7-billion-ip-addresses-in-few-minutes/
																							 
		//electronics manufacturing association
		http://www.semi.org
		RAND Corporation 
		Atlantic Council
		http://veloline.ru/ispravlenie-vosmerok								 
		
		temp[
		
Белиз 
Гватемала 	
Сальвадор 	
Гондурас 	
Никарагуа 	
Коста-Рика 	
Лос-Альтос 
Панама

эль-пасо
Сьюдад-Хуарес
лос-сента
синалоа

Радуга: Семеро из шестой камеры второго блока
1. Добро пожаловать в Эн.Эйч.Кэй / NHK ni Youkoso! (24 серии) 1:20 - 3:56 
2. Радуга: Семеро из шестой камеры / Rainbow: Nisha Rokubou no Shichinin (26 серий) 3:57 - 6:32 
3. Код Гиас: Восставший Лелуш / Code Geass (первый сезон: 25 + 11 special, второй сезон: 25 + 9 special) 7:02 - 9:00﻿

[
ang io [ http, VS template ]
,.net core [ web api 2 template, ang io template ]
,linq to orient [ extend ]
]

cubiio

atack rocket
[usa,gb,fr]->[syria]
rus sector avoid

weak
oil,usd/
rub,gold\

oil(72.57;67.33),gold(1347),
usd\rub(62.01)/

подсолнечник 39/0,250
тыква 199/0,5

"Яма" Александра Куприна, "Санин" Михаила Арцыбашева, "В тумане" Леонида Андреева, "Крейцерова соната" Льва Толстого
		]
		RPN[
			http://77.rospotrebnadzor.ru/index.php/upravlenie/priemnaya
			http://rospotrebnadzor.ru/region/structure/str_uprav.php
			https://www.meleon.ru/
			https://www.kartoteka.ru/card/235a7ca4f006b2d3f2b6c855374cadd0/
			https://www.kartoteka.ru/card/886e2d61f96dc6ae24bd60eb3084fc78/	
		]
		
		https://proglib.io/p/hacker-course/		
		http://www.gilead.com/
		http://www.ftse.com/products/downloads/Russell-US-indexes.pdf
		
		Barings Vostok 
		 
		offhore[
			Британские Виргинские острова, США, Великобритания, Кипр, Панама, Новая Зеландия
		]
		
		azb[nesterov igor
			13.01.1985
		]			 
	
	//investing
	[
		stats[
			http://www.pbc.gov.cn
			
			JPY[
				MinistryOfFinanace
				https://www.mof.go.jp/english/index.htm
					[
						Сальдо торгового баланса с учетом сезонных колебаний
						импорт,экспорт
						
					]
			]
			
			GB[
				Office for National Statistics
				https://www.gov.uk/government/statistics/announcements
				https://www.ons.gov.uk/
				[
					Consumer Price Index (CPI)
					Индекс потребительских цен (ИПЦ) (г/г,м/м) (month)
					Producer Price Index (PPI)
					Индекс закупочных цен производителей (г/г,м/м) (month)
					The Retail Price Index
				]
				
			]
			
			EUR[
				eurostat
				http://ec.europa.eu/eurostat
			]
			
			USA[
				fedreserve
				https://www.federalreserve.gov/monetarypolicy/beige-book-default.htm
				[
					Beige Book
				]
				energy agency
				https://www.eia.gov/
				[
				 	Crude Oil Inventories
					Crude Oil Imports
					Cushing Crude Oil Inventories
					EIA Weekly Distillates Stocks
					Distillate Fuel Production
					EIA Weekly Distillates Stocks
				]
			]			
		]
		
		funds[
			https://www.bakerhughes.com/
			
			https://www.fidelity.com/
			https://www.fundcalibre.com/
			https://www.youinvest.co.uk/
			https://www.brewin.co.uk/
			https://www.unicornam.com/
			http://www.moneyobserver.com/
		]
		
		analytics[
			
			https://ru.investing.com
			
			US index
			https://www.marketwatch.com/investing/index/DXY
			
			https://oilprice.com/
			
			http://www.barrons.com
		]
		
		ideas[
			https://oilprice.com/
			
			OIL[
				ROSN,SNGS,LKOH
				
				OPEC[
				2018 IRI-57.5;KSA-70
					07.2018 
				]
				2019 Saudi Arabian Oil Co IPO 
				$2 trl priced
				$100 mlrd IPO shares cap.
			
			]
		]
		
		platforms[
			https://www.xtrade.ru
			https://www.etoro.com
			https://www.investopedia.com
		]
			
		crypto[
			https://ru.m.bitcoinwiki.org/wiki/%D0%91%D0%B8%D1%80%D0%B6%D0%B8
			https://www.bloomberg.com/features/bitcoin-bulls-bears/
			https://xapo.com/
			
			https://www.bloomberg.com/news/articles/2018-05-09/ex-goldman-trader-hires-former-rivals-to-build-a-crypto-empire
			https://www.panteracapital.com/
		]
	
	]
	
	 //startups
	[
	
	http://www.selpo.me/
	http://go.philtech.ru/?utm_source=meduza&utm_medium=article&utm_campaign=accelerator.
	
	]
	
	//OWIN
	[
https://docs.microsoft.com/en-us/aspnet/web-api/overview/security/external-authentication-services
https://docs.microsoft.com/en-us/aspnet/identity/overview/extensibility/overview-of-custom-storage-providers-for-aspnet-identity
https://docs.microsoft.com/en-us/dotnet/framework/wcf/extending/how-to-create-a-custom-authorization-policy
https://docs.microsoft.com/en-us/dotnet/framework/wcf/extending/how-to-create-a-custom-authorization-manager-for-a-service
https://docs.microsoft.com/en-us/dotnet/framework/wcf/extending/how-to-create-a-custom-client-identity-verifier
https://docs.microsoft.com/en-us/aspnet/core/security/authorization/roles
https://docs.microsoft.com/en-us/aspnet/core/fundamentals/owin
http://bitoftech.net/2015/01/21/asp-net-identity-2-with-asp-net-web-api-2-accounts-management/
http://bitoftech.net/2015/03/11/asp-net-identity-2-1-roles-based-authorization-authentication-asp-net-web-api/
	]
	
	//EXPRESSIONS
	[
//MSDN linq, expressions
https://weblogs.asp.net/dixin					  
//Expression trees
https://weblogs.asp.net/dixin/functional-csharp-function-as-data-and-expression-tree
//Dynamic LINQ Queries with Expression Trees
https://www.simple-talk.com/dotnet/net-framework/dynamic-linq-queries-with-expression-trees/
//expressionTypes
https://msdn.microsoft.com/en-us/library/bb361179(v=vs.110).aspx
//Expression rules
http://coding-time.blogspot.ru/2011/07/how-to-implement-rule-engine-in-c.html
//custom LINQ provider
https://stackoverflow.com/questions/12181276/implementing-a-custom-linq-to-x-provider
https://msdn.microsoft.com/en-us/library/bb546158.aspx
https://blogs.msdn.microsoft.com/mattwar/2007/07/30/linq-building-an-iqueryable-provider-part-i/
	]
	
	//CORE
	[
	
//.NET CORE
https://docs.microsoft.com/en-us/dotnet/core/
//core utilities
https://www.microsoft.com/net/download/linux
//Linux prerequisites
https://docs.microsoft.com/en-us/dotnet/core/linux-prerequisites?tabs=netcore2x
//core Hello world
https://docs.microsoft.com/en-us/aspnet/core/tutorials/first-web-api
//core deploy 
https://docs.microsoft.com/en-us/dotnet/core/deploying/deploy-with-vs#simpleSelf
//core target platforms 
https://docs.microsoft.com/en-us/dotnet/core/rid-catalog#linux-rids
//publish iis
https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/iis/?tabs=aspnetcore2x
https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/visual-studio-publish-profiles?tabs=aspnetcore2x#publish-profiles
//kestrel
https://docs.microsoft.com/en-us/aspnet/core/fundamentals/servers/?tabs=aspnetcore2x
https://docs.microsoft.com/ru-ru/aspnet/core/fundamentals/servers/kestrel?tabs=aspnetcore2x
//nginx
https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/linux-nginx?tabs=aspnetcore2x
https://www.tonyranieri.com/blog/2017/10/27/Hosting-.Net-Core-On-Linux/
//docker
https://stormpath.com/blog/tutorial-deploy-asp-net-core-on-linux-with-docker
//self contained 
https://docs.microsoft.com/en-us/dotnet/core/deploying/index
https://docs.microsoft.com/en-us/dotnet/core/deploying/deploy-with-vs
//platforms ID catalog
https://docs.microsoft.com/en-us/dotnet/core/rid-catalog#linux-rids
//kestrel
https://github.com/aspnet/KestrelHttpServer
//iis host
https://metanit.com/sharp/aspnet5/20.1.php

	]
	
	//angular routing and injection
	[
		https://angular-2-training-book.rangle.io/handout/modules/lazy-load-di.html
		https://plnkr.co/edit/C1QKHk9Uijtxtb13UU9t?p=preview
		https://medium.com/@cyrilletuzi/understanding-angular-modules-ngmodule-and-their-scopes-81e4ed6f7407
	]
	
	//blogs
	[
		https://medium.com/reverdev/why-we-moved-from-angular-2-to-vue-js-and-why-we-didnt-choose-react-ef807d9f4163
		https://medium.com/javascript-scene/the-shocking-secret-about-static-types-514d39bf30a3
		https://blog.angularindepth.com/the-new-angular-httpclient-api-9e5c85fe3361
		https://toddmotto.com/classes-vs-interfaces-in-typescript
		https://codecraft.tv/courses/angular/http/http-with-observables/
		https://medium.com/meduza-how-it-works/%D1%85%D0%BE%D1%87%D1%83-%D1%81%D0%B2%D0%BE%D0%B9-vpn-%D0%B7%D0%B0-5-%D0%BC%D0%B8%D0%BD%D1%83%D1%82-%D1%87%D1%82%D0%BE-%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C-5581e536650a
		https://medium.com/meduza-how-it-works/ddos-ab63424e595e
		https://hackernoon.com/		
	]						   
		
	//DAG directed acyclic graph
	https://en.wikipedia.org/wiki/Directed_acyclic_graph
								 
	//Generate mvc and razor from json
	https://stackoverflow.com/questions/12876865/is-there-anyway-to-generate-razor-views-cshtml-based-on-a-template-beside-t4
	http://www.umbraworks.net/bl0g/rebuildall/2009/11/17/ASP_NET_MVC_and_virtual_views
	
	//C
	//TCC compiler
	https://bellard.org/tcc/
	
	//Books
	//The Art of Unit Testing: with Examples in .NET
	https://www.amazon.com/dp/1933988274/?tag=stackoverfl08-20
	//JS
	//Angular 2 to WebComponents
	https://angular.io/guide/elements
	//dynamic external lib load
	https://stackoverflow.com/questions/950087/how-do-i-include-a-javascript-file-in-another-javascript-file
	//Cloud I9 editor
	//Ace editor
	//Json to html
	http://www.json2html.com/
	//clarity 
	https://vmware.github.io/clarity/documentation/v0.11/get-started
	//font awasome
	https://fontawesome.com/get-started/svg-with-js
	//UX UI
	https://blog.bitsrc.io/11-angular-component-libraries-you-should-know-in-2018-e9f9c9d544ff
	//bootstrap
	https://medium.com/codingthesmartway-com-blog/building-an-angular-5-project-with-bootstrap-4-and-firebase-4504ff7717c1
	//primeng
	https://www.primefaces.org/primeng/#/ 
	
	TOREAD_SORT
	//JS maddness external files load
	http://unixpapa.com/js/dyna.html
	//Load files
	https://frontender.info/exploring-the-abyss-of-null-and-undefined-in-javascript/
	//JS to Typescript
	https://blog.appdynamics.com/engineering/8-steps-migrating-javascript-typescript/
	//JS modules
	https://medium.freecodecamp.org/javascript-modules-a-beginner-s-guide-783f7d7a5fcc
	//Common JS 
	http://requirejs.org/docs/start.html
	//webpack
	https://webpack.js.org/guides/installation/
	//TS modules
	https://www.typescriptlang.org/docs/handbook/tsconfig-json.html
	//avoid multiple subscription
	https://medium.com/@2muchcoffee/how-to-avoid-multiple-subscription-in-angular-2-component-ce50bc21991b
	//datasharing 
	https://www.lucidchart.com/techblog/2016/11/08/angular-2-and-observables-data-sharing-in-a-multi-view-application/
	//concurent dataloading 
	https://www.metaltoad.com/blog/angular-2-http-observables-and-concurrent-data-loading
	//custom custom scrollbars library
	http://jscrollpane.kelvinluck.com/#examples

	//CSS		
	https://css-tricks.com/snippets/html/glyphs/
	//CSS tricks
	https://css-tricks.com/
	//CSS tricks flexbox
	https://css-tricks.com/snippets/css/a-guide-to-flexbox/
	//CSS tricks grid
	https://css-tricks.com/snippets/css/complete-guide-grid/
	//Float parent lement collaps
	https://css-tricks.com/almanac/properties/f/float/
	//Code alchemy
	https://htmlacademy.ru/courses/45
	//Code alchemy grids
	https://htmlacademy.ru/courses/65
	//animate css
	https://daneden.github.io/animate.css/
	//character code
	http://www.fileformat.info
	http://www.mauvecloud.net
	//custom checkboxes 
	https://codepen.io/arpitnj/pen/oCAqa
	 //gradients 
	https://mycolor.space/gradient?ori=to+right+top&hex=%23153669&hex2=%231ECFE0&sub=1
	https://webgradients.com/
	//svg
	https://bennettfeely.com/clippy/
	//spans svg png
	https://icons8.com/icon/set/calendar/all
	https://icons8.com/
	
	//c#
	//Effective C# (Covers C# 4.0): 50 Specific Ways to Improve Your C#, 2nd Edition
	http://www.informit.com/store/effective-c-sharp-covers-c-sharp-4.0-50-specific-ways-9780321658708
	//editing
	https://readymag.com/
	//ExtCore
	http://extcore.net/
	
	//Angular + React
	https://www.packtpub.com/books/content/integrating-angular-2-react
	https://eloquentjavascript.net/index.html
					   
	https://blog.rapid7.com/2016/02/03/combining-angularjs-and-reactjs-for-better-applications/
	https://stackoverflow.com/questions/44117390/angular-4-mixed-with-react
	https://www.quora.com/Can-I-use-React-for-UI-along-with-Angular-2
	//LinqInAction
	https://elacademico.files.wordpress.com/2009/11/manning-linq-in-action-jan-2008-19339881691.pdf
															   
	https://eloquentjavascript.net/index.html	
	//bulletproof wrappers
	https://blog.sentry.io/2016/02/03/wrap-javascript-functions
	//tests
	https://www.sitepoint.com/proper-error-handling-javascript/
	//error handling
	https://javascript.info/try-catch
	
	//chart vis	
	http://js.cytoscape.org/#getting-started/including-cytoscape.js
	http://graphalchemist.github.io/Alchemy/#/
	https://neo4j.com/developer/guide-data-visualization/
	http://sigmajs.org/
	//with images
	http://bl.ocks.org/eesur/be2abfb3155a38be4de4
	//chart libs
	//with json shema change
	https://gojs.net/latest/index.html
	//tree draw
	http://fperucic.github.io/treant-js/
	//comparison names
	https://modeling-languages.com/javascript-drawing-libraries-diagrams/
	
	//with images
	http://bl.ocks.org/eesur/be2abfb3155a38be4de4
	
	http://leaverou.github.io/awesomplete/
	https://primitive.lol/
	//ECMAScript 6
	http://exploringjs.com/es6/index.html#toc_ch_modules
												 
	//web components
	https://hackernoon.com/the-wonderful-world-of-web-components-e4c1675c6901
	//HAML jade sass less
	https://softwareengineering.stackexchange.com/questions/225400/pros-and-cons-of-facebooks-react-vs-web-components-polymer
	
	//FLUX
	https://facebook.github.io/flux/docs/dispatcher.html#content			
	
	
	//BLOGS
	//Jon Skeet's
	https://codeblog.jonskeet.uk/
	//CoddingHorror
	https://blog.codinghorror.com/
	//CodeNames
	http://blog.codenamed.nl/
	https://prateekvjoshi.com/	
	//CONTINUOUS INTEGRATION
	http://www.eugeneduvenage.com/2011/11/continuous-integration-basics-part-1/
	//web components
	https://dmitriid.com/blog/2017/03/the-broken-promise-of-web-components/
	//equality + hashoe
	http://www.aaronstannard.com/overriding-equality-in-dotnet/
	//hashs
	https://stackoverflow.com/questions/263400/what-is-the-best-algorithm-for-an-overridden-system-object-gethashcode/263416#263416
	//Chart visualization/
	https://stackoverflow.com/questions/21893401/big-data-visualization-using-search-show-context-and-expand-on-demand-concep
	//MSDN linq, expressions
	https://weblogs.asp.net/dixin					  
	
	//D3.js
	//essentials v4
	http://rajapradhan.com/blogs/d3-js-v4-essentials/axes/
	//indepth v4
	http://d3indepth.com/
	//layouts
	http://bl.ocks.org/robschmuecker/7880033
	http://mbostock.github.io/d3/talk/20111116/force-collapsible.html
	http://mbostock.github.io/d3/talk/20111018/tree.html
	http://www.coppelia.io/2014/07/an-a-to-z-of-extra-features-for-the-d3-force-layout/                                                                
	//generated v4
	https://bl.ocks.org/shimizu/e6209de87cdddde38dadbb746feaf3a3
	//labeld
	https://bl.ocks.org/mbostock/950642
	
	//d3 + react
	http://www.adeveloperdiary.com/react-js/integrate-react-and-d3/
	
	//SERIAL PROGRAMMING 	
	//RS-232
	http://cisco.opennet.ru/docs/RUS/serial_guide/index.html#2_2
	
	//Framework Design Guidelines
	https://www.amazon.co.uk/Framework-Design-Guidelines-Conventions-Development/dp/0321545613/		
	
	//Custom errors
	https://weblog.west-wind.com/posts/2017/Jun/01/Bypassing-IIS-Error-Messages-in-ASPNET
	http://benfoster.io/blog/aspnet-mvc-custom-error-pages
	https://msdn.microsoft.com/ru-ru/library/h0hfz6fc(v=vs.85).aspx
	
	//quality check
	https://msdn.microsoft.com/en-us/library/4dtdybt8.aspx
	//CI/CD HW
	https://docs.microsoft.com/en-us/vsts/build-release/actions/ci-cd-part-1
	//PowerShell TFS
	https://blogs.technet.microsoft.com/heyscriptingguy/2014/04/21/powershell-and-tfs-the-basics-and-beyond/
	
	
	//Async
	http://blog.stephencleary.com/2013/11/there-is-no-thread.html
	https://msdn.microsoft.com/en-us/magazine/jj991977.aspx
	//async request
	https://stackoverflow.com/questions/12281777/implementing-httpwebrequest-async-calls
	https://msdn.microsoft.com/ru-ru/library/system.net.httpwebrequest.begingetresponse(v=vs.110).aspx
	//tasks
	https://www.codeproject.com/Articles/152765/Task-Parallel-Library-of-n
	
	//Jupiter notebook
	http://jupyter.org
	//CDN
	https://en.wikipedia.org/wiki/Content_delivery_network
	//CMS\CMF
	https://ru.wikipedia.org/wiki/Content_Management_Framework
	//WebFramework behcnmarks
	https://www.techempower.com/benchmarks/
	//WebAnalytics
	//compare	
	https://en.wikipedia.org/wiki/List_of_web_analytics_software
	//PIWIK
	https://piwik.org/docs/site-search/
	https://developer.piwik.org/guides/tracking-javascript-guide
	https://www.innocraft.cloud/
	
	
	
	//PATTERNS
	//practiacally apply
	http://www.amazedsaint.com/2008/01/design-patterns-part-i-and-ii.html
	//Extensible design
	http://www.codemag.com/article/0801041
	
	
	
	//TOPTAL
	https://www.toptal.com/developers/blog
	//Boilerplate code gen
	http://doc.postsharp.net/
	
	
	
	 //C#
	//Expression trees
	https://weblogs.asp.net/dixin/functional-csharp-function-as-data-and-expression-tree
		
	//dev guide
	https://msdn.microsoft.com/en-us/library/hh156542(v=vs.110).aspx

	//Applications essential
	https://msdn.microsoft.com/en-us/library/ms172157(v=vs.110).aspx

	//simple List<t> class
	https://msdn.microsoft.com/en-us/library/6sh2ey19(v=vs.110).aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-2


	//LINQ to DataSet
	http://blogs.msdn.com/b/adonet/archive/2007/01/26/querying-datasets-introduction-to-linq-to-dataset.aspx

	//correct d3 charts addition
	//<script type="application/javascript" charset="utf-8" src="http://d3js.org/d3.v3.js"></script>

	//charts from excel to poweerpoint copy
	https://social.msdn.microsoft.com/Forums/ru-RU/b00e1da3-908d-4ae1-8c68-2ea5108d1cd0/-excel-powerpoint-vba?forum=programminglanguageru

	//codplex library addres for excel files read
	http://exceldatareader.codeplex.com/

	//never use TWO DOTS
	http://www.thecodingforums.com/threads/asp-net-cant-kill-excel-exe-with-office-pia.123703/#post-528575

	//newtonsoft JSON serializer
	http://www.newtonsoft.com/json/help/html/serializingjson.htm

	//ASP.NET Web Deployment - Recommended Resources
	http://www.asp.net/whitepapers/aspnet-web-deployment-content-map

	//Advanced Entity Framework 6 Scenarios for an MVC 5 + usefull links
	http://www.asp.net/mvc/overview/getting-started/getting-started-with-ef-using-mvc/advanced-entity-framework-scenarios-for-an-mvc-web-application#rawsql

	//ASP.NET Data Access - Recommended Resources
	http://www.asp.net/whitepapers/aspnet-data-access-content-map

	//ASP.NET Data Access Options
	https://msdn.microsoft.com/en-us/library/ms178359.aspx#webservice

	//scafolding
	https://blogs.msdn.microsoft.com/webdev/2014/04/03/creating-a-custom-scaffolder-for-visual-studio/

	//Data Source Web Server Controls
	https://msdn.microsoft.com/en-us/library/ms247258.aspx

	//James chamber 30 days ov MVC
	http://jameschambers.com/2014/07/day-27-rendering-data-in-a-bootstrap-table/

	//Post javascrip to mvc action
	http://vault.lozanotek.com/archive/2010/04/16/posting_json_data_to_mvc_controllers.aspx

	///{LINQ}
	//Create dynamic "Select", "SelectMany" and "GroupBy" clauses
	http://drc.ideablade.com/xwiki/bin/view/Documentation/dynamic-projection

	//Programming Entity Framework, 2nd Edition
	https://www.safaribooksonline.com/library/view/programming-entity-framework/9780596807276/ch04.html

	//Dynamic LINQ Queries with Expression Trees
	https://www.simple-talk.com/dotnet/net-framework/dynamic-linq-queries-with-expression-trees/

	//Calling functions in LINQ queries
	http://tomasp.net/blog/linq-expand.aspx/

	//sql commands types
	https://msdn.microsoft.com/en-us/library/yy6y35y8(v=vs.110).aspx

	//HTML5 plupload
	http://www.plupload.com/

	//How to add Dynamic Behavior to Data-Bound Controls
	https://msdn.microsoft.com/en-us/library/cc488562.aspx

	//WebForms
	https://msdn.microsoft.com/en-us/library/jj822927(v=vs.110).aspx

	//ASP.NET Dynamic Data
	https://msdn.microsoft.com/en-us/library/ee845452.aspx

	//LINQ chaining
	https://blogs.msdn.microsoft.com/meek/2008/05/02/linq-to-entities-combining-predicates/
	
	//Sample plugin
	https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b6174b62	
	
	//active directory integration
	https://www.codeproject.com/Articles/18102/Howto-Almost-Everything-In-Active-Directory-via-C
																					 	
	//Type comparison
	https://stackoverflow.com/questions/983030/type-checking-typeof-gettype-or-is
	
	//KATAs
	http://osherove.com/tdd-kata-1/
	https://github.com/garora/TDD-Katas/blob/develop/Src/cs/FizzBuzzKata/TestFizzBuzz.cs
	https://www.codeproject.com/Articles/886492/Learning-Test-Driven-Development-with-TDD-Katas
	
	
	
	//BUILD STRATEGIES
	//The Cathedral and the Bazaar
	https://en.wikipedia.org/wiki/The_Cathedral_and_the_Bazaar



	//NuGets
	//Lucene
	https://www.nuget.org/packages/Lucene.Net/4.8.0-beta00004
	//pagelist
	https://www.nuget.org/packages/PagedList
	//Reactive Extensions for JavaScript
	https://www.nuget.org/packages/RxJS-Main/1.0.10621

	
	//DATA BINDING FRAMEWORKS/
	//FLUX
	https://facebook.github.io/flux/docs/dispatcher.html#content
	

	//Security
	http://www.adambarth.com/papers/2008/barth-jackson-mitchell-b.pdf
	//MVC forms authentication providerName
	https://habrahabr.ru/post/176043/
	//Cookies
	https://www.nczonline.net/blog/2009/05/05/http-cookies-explained/
	//Custom antiforgery token
	http://prideparrot.com/blog/archive/2012/7/securing_all_forms_using_antiforgerytoken
	//App Security threats
	https://msdn.microsoft.com/en-us/library/f13d73y6.aspx
	//Your Password is Too Damn Short
	https://blog.codinghorror.com/your-password-is-too-damn-short/
	
	
	
	//MVC
	//Minimal folders and configs
	https://stackoverflow.com/questions/19949709/use-of-authconfig-bundleconfig-filterconfig-routeconfig-and-webapiconfig-in
	
	
	
	//WCF distributed
	https://chsakell.com/2013/04/17/distributed-transactions-in-wcf-services-part-1/
	//WCF sample
	https://www.codeproject.com/Articles/571813/A-Beginners-Tutorial-on-Creating-WCF-REST-Services
	//WCF with entity
	https://www.codeproject.com/Articles/127395/Implementing-a-WCF-Service-with-Entity-Framework
	//WCF generate contracts from POCO
	https://www.codeproject.com/Articles/1081015/Autogenerate-DataContracts-for-WCF-from-POCO-Class
	//WCF transactions
	https://www.codeproject.com/Articles/1160537/WCF-Windows-Communication-Foundation-Transaction-S
	//WCF vs aspx service
	http://www.csharptutorial.in/33/csharp-net-difference-between-webservice-and-wcf-service
	//WCF tutorials
	http://www.csharptutorial.in/wcf-tutorials
	//WCF host as a service
	https://docs.microsoft.com/en-us/dotnet/framework/wcf/how-to-host-and-run-a-basic-wcf-service
	https://docs.microsoft.com/en-us/dotnet/framework/wcf/getting-started-tutorial
	//WCF + Entity
	https://www.codeproject.com/Articles/127395/Implementing-a-WCF-Service-with-Entity-Framework
	//WCF IoC
	https://chsakell.com/2015/07/04/dependency-injection-in-wcf/
	
	
	
	//SOAP REST diff
	http://www.csharptutorial.in/296/wcf-tutorials-soap-vs-rest-web-services-or-difference-between-soap-and-rest-web-services
	
	

	//WebApi
	//Using Postman to POST API JSON request in raw
	https://support.brightcove.com/use-postman-api-requests
	//WebApi controller
	https://docs.microsoft.com/en-us/aspnet/web-api/overview/getting-started-with-aspnet-web-api/tutorial-your-first-web-api
	https://docs.microsoft.com/en-us/aspnet/web-api/overview/testing-and-debugging/mocking-entity-framework-when-unit-testing-aspnet-web-api-2
	//WCF WebApi
	http://blogs.microsoft.co.il/idof/2012/03/05/wcf-or-aspnet-web-apis-my-two-cents-on-the-subject/
	//WEB api with packets
	https://habrahabr.ru/post/143024/
	


	//vNext
	https://blogs.msdn.microsoft.com/dotnet/2014/05/12/the-next-generation-of-net-asp-net-vnext/



	//EF
	//Data acces content map
	https://docs.microsoft.com/en-us/aspnet/whitepapers/aspnet-data-access-content-map
	//Code first to database
	https://msdn.microsoft.com/en-us/data/jj200620
	//EF bulk insert
	https://weblog.west-wind.com/posts/2013/Dec/22/Entity-Framework-and-slow-bulk-INSERTs#ContextBloatandLargeLists
	//Entity Framework initializer methods
	https://blog.oneunicorn.com/2013/05/28/database-initializer-and-migrations-seed-methods/
	// Code First Migrations with an existing database
	https://msdn.microsoft.com/en-us/data/dn579398



	//REPOSITORY
	//Generic Repository is BAD
	http://rob.conery.io/2014/03/04/repositories-and-unitofwork-are-not-a-good-idea/
	//generic Repository
	http://techbrij.com/generic-repository-unit-of-work-entity-framework-unit-testing-asp-net-mvc
	//Generic repository
	https://docs.microsoft.com/en-us/aspnet/mvc/overview/older-versions/getting-started-with-ef-5-using-mvc-4/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application
	//A trully generic repository
	http://cpratt.co/truly-generic-repository/
	//Repo done right
	http://blog.gauffin.org/2013/01/repository-pattern-done-right/
	//Repo proof of concept
	http://web.archive.org/web/20150404154203/https://www.remondo.net/repository-pattern-example-csharp/
	//Generic repo in simple 2014
	http://www.codeguru.com/csharp/.net/net_asp/mvc/using-the-repository-pattern-with-asp.net-mvc-and-entity-framework.htm
	//Repository overall
	http://techbrij.com/generic-repository-unit-of-work-entity-framework-unit-testing-asp-net-mvc	
	//Not Generic REPOSITORY
	https://softwareengineering.stackexchange.com/questions/180851/why-shouldnt-i-use-the-repository-pattern-with-entity-framework/220126#220126
	//NOSQL
	//RaveDb
	http://www.primaryobjects.com/2010/12/22/generating-flying-creatures-in-nosql-ravendb-with-c-asp-net-mvc-razor/
	
																							
		
	//TESTING
	//Test Automation most complete answer
	https://stackoverflow.com/questions/1316101/automated-unit-testing-why-what-which#1316209
	//Unit test
	https://msdn.microsoft.com/en-us/library/hh694602.aspx
	https://lostechies.com/derekgreer/2011/03/28/effective-tests-a-test-first-example-part-1/
	https://www.rhyous.com/2012/03/17/unit-test-best-practices-and-guidelines/
	//nUnit
	http://severe-programmer.com/manual/unit-testing-v-visual-studio-s-ispolzovaniem-nunit-i-nsubstitute-chast-1/
	https://github.com/nunit/docs/wiki/TestCaseData
	//Moq Setup
	https://professorweb.ru/my/ASP_NET/mvc/level2/2_5.php
	//MOQ
	https://metanit.com/sharp/mvc5/18.5.php
	https://github.com/Moq/moq4/wiki/Quickstart
	https://msdn.microsoft.com/en-us/library/dn314429(v=vs.113).aspx
	https://msdn.microsoft.com/en-us/library/dn314431(v=vs.113).aspx
	https://msdn.microsoft.com/en-us/library/ff650441.aspx
	http://www.developerhandbook.com/unit-testing/writing-unit-tests-with-nunit-and-moq/
	//EF integration testing
	https://stackoverflow.com/questions/22690877/how-are-people-unit-testing-with-entity-framework-6-should-you-bother/22691703#22691703
	//Integration
	http://enterprisecraftsmanship.com/2015/07/13/integration-testing-or-how-to-sleep-well-at-nights/
	//Mocking idea descr
	https://stackoverflow.com/questions/19674363/when-to-use-a-mocking-framework
	


	//MOQ
	//Mock return item from list by ID 
	https://stackoverflow.com/questions/22010063/moq-a-retrieve-of-particular-list-item



	//Single Page Application
	https://docs.microsoft.com/en-us/aspnet/single-page-application/overview/introduction/knockoutjs-template

	//JS good practices
	http://james.padolsey.com/javascript/javascript-bad-practices/
	//JS no more frameworks
	https://bitworking.org/news/2014/05/zero_framework_manifesto

	//ORM vs plain sql strategies
	http://softwareengineering.stackexchange.com/questions/117357/is-entity-framework-suitable-for-high-traffic-websites

	//msdn C# posts
	https://blogs.msdn.microsoft.com/ruericlippert/tag/type-inference/

	//TOP 10 C# errors
	https://www.upwork.com/hiring/development/common-mistakes-in-c-sharp-programming/
	https://www.toptal.com/c-sharp/top-10-mistakes-that-c-sharp-programmers-make

	//SOLID
	http://sergeyteplyakov.blogspot.ru/2014/10/solid.html
	http://www.c-sharpcorner.com/uploadfile/damubetha/solid-principles-in-c-sharp/
	https://www.codeproject.com/Articles/703634/SOLID-architecture-principles-using-simple-Csharp

	//Learn C# building-a-simple-rpg-index
	http://scottlilly.com/learn-c-by-building-a-simple-rpg-index/

	//Loading type MSDN + (Loading types, lazy loading turning off)
	https://msdn.microsoft.com/en-us/library/jj574232(v=vs.113).aspx

	//C# Delegates, Actions, Funcs, Lambdas?Keeping it super simple
	https://blogs.msdn.microsoft.com/brunoterkaly/2012/03/02/c-delegates-actions-funcs-lambdaskeeping-it-super-simple/
	//Generic parameters vs type 
	https://stackoverflow.com/questions/10955579/passing-just-a-type-as-a-parameter-in-c-sharp

	/*
	filtering inherited types classes in base class list of classes
	google
	c# base class list contains inherited classes
	stack
	*/
	http://stackoverflow.com/questions/2074779/identifying-derived-types-from-a-list-of-base-class-objects


	/*ECM possible FuckUps*/
	
	https://www.directum.ru/
	docsvision
	intraservise
	elma
	https://www.naumen.ru
	
	
	//code gen
	https://swagger.io/
	//tizen
	https://www.tizen.org/
	
	//ORACLE
	http://www.f-notes.info/oracle:what_where
		
	//Shodan
	https://www.shodan.io/
	
	}
	
	#region SourceControl

		public Bug Trackers
		{
			ignore list[		
	.vs
	.git
	bin
	*.dll
	*.csproj*
	*.asax*
	Web.config
	Extensions
	obj
	Properties
	*.config

			]
			GitLab{

			NSQL_napi_commit[
					repository withot ".git"
					http://files.nspk.ru:8888/Intranet_Development/AddressBook_News2
					
					http://gitlab.nspk.ru/Neprintsevia/NSQLManager.git
					
					git remote rm nsm
					git remote rm napi
					
					git remote add nsm http://gitlab.nspk.ru/Neprintsevia/NSQLManager.git
					git remote add napi http://gitlab.nspk.ru/Neprintsevia/NewsApi.git
					
					cd C:\workflow\projects\Dev\gitLab\PersonNews
					git init 
					git add .
					git commit -m "slash escape repair. post with spaces."
					
					cd C:\workflow\projects\Dev\gitLab\manager_split\NSQLManager
					git init 
					git add .
					git commit -m "slash escape repair. post with spaces."
				]												
				
				cd C:\workflow\projects\Dev\gitLab\manager_split\NSQLManager
				git init 
				git add .
				git commit -m "slash escape repair. post with spaces."
				
			},
			
			public GIT hub
			{https://git-scm.com/book/en/v2
				
				public ProxyAdd
				{
					
	git config http.sslVerify false
	git config --global http.proxy http://proxypath:proxyport
					
				}
				
				public InitializeNewRepo()
				{
					
	echo "# NSQLmanager" >> README.md
	git init
	git add README.md
	git commit -m "first commit"
	git remote add origin https://github.com/imp908/NSQLmanager.git
	git push -u origin master
	IF NOT WORKS {git push -f origin master}
					
				}
				
				
				public BranchMerge()
				{// Master->br1. stage 1 master+ stage 2 master+ br1--

	Short:
	https://help.github.com/articles/merging-an-upstream-repository-into-your-fork/

	Long:

	stage1
	inital deploy
	short: {
	create
	commit
	push
	}
	\\\\\\
	detailed
	//Initial deploy

	>>Create repo

	cd PATH
	git init
	git commit –m "initial commit"
	git remote add origin GITPATH
	git push origin master

	stage2
	//////
	get cahnges from master to br1
	short: {
	pull br want to update,
	checkout branch want to update,
	pull branch(master) from what to get
	}
	\\\\\\
	//Pull changes from master to branch (changes in master were made,commited and pushed)
	>>branch git project

	cd PATH_branch1
	git init
	//(if not set) 
	git remote add origin GITPATH
	//+ if no branch1 files are in direcory
	git pull origin br1
	git checkout gm br1
	//get changes from master to br branch
	git pull origin master
	git push origin br1

	stage3
	added method in master file
	deleted file in br
	deleted method in br
	changed method in br
	//////

	 repeat Stage2: 
	{
	pull br1
	checkout br1,
	pull master
	}

	CONFLICT: automatic merge failed

	Resolve conflicts in web or descktop or cmd



	stage4:
	///////
	added files to master

	repeat stage2:
	{
		//if no files in 
		pull br1
		checkout br1
		pull master
		//added files added
		push br1
	}



				}
				
				
				public DeleteMaster()
				{ //not working
					https://git-scm.com/book/en/v2/Git-Branching-Remote-Branches					
					git symbolic-ref HEAD refs/heads/another-branch
					http://matthew-brett.github.io/pydagogue/gh_delete_master.html
		  }
		  
				PullProgects
				{
					
		git remote rm nsm
		git remote rm napi
		git remote add nsm http://gitlab.nspk.ru/Neprintsevia/NSQLManager.git 
		git remote add napi http://gitlab.nspk.ru/Neprintsevia/NewsApi.git
		cd C:\workflow\projects\Dev\gitLab\manager_split
		git init
		git pull nsm manager_split
		git checkout manager_split
		cd C:\workflow\projects\Dev\gitLab\PersonNews
		git init
		git pull napi nsql_mng
		git checkout nsql_mng
					
				}
				
				rmFilesByMask[
					//	git rm -r --cached **/*.jar
				]
				removeVsFoldersFromDirectory[
	git rm -r .vs
	git rm -r NewsAPI/bin
	git rm -r NewsAPI/obj
	git rm -r NewsAPI/Properties
	git rm -r NewsAPI.JsonValidator.Tests/bin
	git rm -r NewsAPI.JsonValidator.Tests/obj
	git rm -r NewsAPI.JsonValidator.Tests/Properties
	git rm -r NewsAPI.Tests/bin
	git rm -r NewsAPI.Tests/obj
	git rm -r NewsAPI.Tests/Properties
				]
				
				overall 
				[
					//add CAinfo
					git config http.sslCAinfo G:/disk/Progs/Git/mingw64/ssl/certs/ca-bundle.crt
					
					MERGE PROJECTS ON FIRST COMMIT AFTER REMOTE BRANCH CREATEION
					git pull origin branchname --allow-unrelated-histories			
					//recommended
					git clone
								
					
					git remote -v -> check remotes
					git branch -> check what branch you are in
					
					EXISTING LOCAL PROJECT TO NEW GIT REPO FIRST PUSH
					create new in git web
					cd -> moove to directory		
					git remote add origin \\url_to_project
					git pull origin master
					git init -> initialize git
					git add . -a //no files changed
					git add -u //only indexed files
					
					git commit -m "Commit text"
					git push -u origin master
					
					NEW BRANCH
					create new branch in web
					git checkout -b \\url to branch		
					add commit push section 
					
					git push -u origin branchname {!!!<pushing to branch>!!!}
					
					REMOVE REPO
					git remote rm origin
			  //filemanager
					gitk
					
					//log commits
					https://stackoverflow.com/questions/1838873/visualizing-branch-topology-in-git
					git log --graph			
					git log --graph --pretty=oneline --abbrev-commit
					git log --graph --oneline --all
					git log --graph --oneline
					
					git-ls-tree 
					git-ls-remote
				]
			}

		}

		public Issuer Trackers
		{
			public TFS()
			{
				
				public void MergeBranchAndFolder()
				{
					Branching of two differnet projects in TFS 
	(if link chain was broken with zip download example)

	Project changes disposition:
	\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
		(Folder) Parent project 		 			  -> 1 -> 4 -> 5

		(Folder converted to branch) Child project  0 -> 2 -> 3 -> 6
					zip downloaded   changes

		Want to make projects merge of child branch to parent folder 

		Parent  -> 5	
					\
		Child	-> 6 -> 7 -> TA DAAM! merged branch goes on

	///////////////////////////////////////////////////////////////////

	1) zip download parent progect
	2) open in VS
	3) unbind from TFS in VS
	обозрватель решений-выделить заголовок проекта
	файл-система управления версиями-сменить систему-удалить привязку
	4) deploy project to new folder parent3
		файл-добавить проект в систему управления версиями
		create new folder for solution branch 9better one level folder down, whole sln becomes a branch)
		check in
	5) convert parent3 to branch
	6) select child branch and select 
		создание ветви и объединение-объединить
		select final branch 
		parent3
	7) merge
	Result:
	Parent and child progects merged in child branch

		
				}
				
			}
		}

	#endregion

	#region C#

	//Forums
	public stackoverflow
	{


	/*
	filtering inherited types classes in base class list of classes
	google
	c# base class list contains inherited classes
	stack
	*/
	http://stackoverflow.com/questions/2074779/identifying-derived-types-from-a-list-of-base-class-objects

	//wrong CompiledQuery
	http://stackoverflow.com/questions/8125581/pre-compiling-linq-queries-when-using-entity-framework

	//null false grouping in linq to entities
	http://stackoverflow.com/questions/33286297/linq-groupby-with-a-dynamic-group-of-columns

	//HttpPostedFileBase always return null in ASP.NET MVC
	http://stackoverflow.com/questions/8551528/httppostedfilebase-always-return-null-in-asp-net-mvc

	//MVC Upload,DOwnload
	http://www.mikesdotnetting.com/article/125/asp-net-mvc-uploading-and-downloading-files
	http://rachelappel.com/upload-and-download-files-using-asp-net-mvc/

	//MVC values in postback
	https://www.syncfusion.com/kb/5427/how-to-get-the-form-control-values-in-postback

	//IIS max size change
	https://www.iis.net/configreference/system.webserver/security/requestfiltering/requestlimits

	//C++ stdio include
	http://stackoverflow.com/questions/31736361/visual-studio-2015-gives-me-errors-upon-creating-a-simple-test-console-program

	//c# linq datetime filter type to oracle database entity context
	http://stackoverflow.com/questions/4146300/linq-to-entityframework-datetime

	//Bookmarks Toolbar include
	http://stackoverflow.com/questions/29742174/how-to-add-bookmark-toolbar-in-visual-studio-2012

	//validation errors publish
	http://stackoverflow.com/questions/5400530/validation-failed-for-one-or-more-entities-while-saving-changes-to-sql-server-da

	//get current method name
	http://stackoverflow.com/questions/2652460/how-to-get-the-name-of-the-current-method-from-code
	http://stackoverflow.com/questions/2652460/how-to-get-the-name-of-the-current-method-from-code

	//Json null date fromate
	https://stackoverflow.com/questions/18635599/specifying-a-custom-datetime-format-when-serializing-with-json-net
	
	}

	//structure
	public OverallC#
	{
		
		public Description()
		{
			annonymous Type - varibale type from code context
			weak reference - allow GC collect large class even if referenced
			generics default - default(T) bind default value to generic varibale
			generic with generic parameter - interface IGarrage<TCar,TOther> where TCar : IGenericCar<TOther> { ... }
			c++\CLI - wrap c++ code in .net
			CAS - Computer Algebra Systems
		}
		
		public Platform()
		{
			.net 2.0 - delegates begininvoke endinvoke
			--anonimous 
			.net 3.0 - lambda
			.net 4.0 - System.Threading.tasks - task parallel lib
			.net 4.5 - task based asynchronous (async,await)
		}	
		
		public Ideas()
		{
			DRY:
			Common library - leads to a lot links to one unrelated code
			Common source code - file in proj folder leds to diverse versions/getting-started-with-ef-5-using-mvc-4/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application
			Service - one service in use. Large progects with latency and failures understood and managed
			NuGET - managing layers
			
			PluginArchitecture:
			
			Interfaces use not only to loose coupling
			Highly Generic code could be used from many places
			
		}
	
		public Examples()
		{
			
			public void Theory()
			{			
				
				public class Equality(){
					
					GetType():
					a = new b
					gettype == typeof() -> b

					IS:
					a = new b
					a is b -> true => a : b
					a is b -> false => a !: b || a : Ib

					EQUALS:
					a.Equals(b) -> true => a=b
									
				}
				
				public class OperatorOverload()	{
					...
					protected static ret operator[+,...,*] (){...};
					...
				}
				
				public class StringMutability(){
					
					STRING MUTABILITY:
					string a; //a==null
					string[] arr


					method2(string a ){cahnge a;}// unchanged global; cahnged local}
					method2(string[] arr ){cahnge arrr;}// cahnged global refernce type}
					method1(){cahnge a;}// cahnged global}
				}
				
				public class SealedMethodChange(){
						public sealed class Circle
						{
							private double radius;
							public double Calculate(Func<double, double> op)
							{
								return op(radius);
							}
						}
				   
				   ...
				   
				   circle.clculate(r=>Math.PI*dbl);
				}

				public class Disposing(){
					public void NullOrNotNull()
					{
						https://blogs.msdn.microsoft.com/clyon/2004/12/01/to-null-or-not-to-null/
					}
					public void GC_SuppressFinilize()
					{
						https://msdn.microsoft.com/en-us/library/system.gc.suppressfinalize(v=vs.110).aspx
					}				
				}
			
				public class UnitTesting(){
					
					public void Overall_Recommendations(){
						
						https://msdn.microsoft.com/en-us/library/aa730844(v=vs.80).aspx
						/*
							Runs fast. fast.
							Main purpose -> developer concerns about program + selfdocummented code
							All dependencies : DB,IO & s.o. -> mocked or stubbed.
							LIC -> Limited,Isolated,Clear;
							FLIMR - > Fast,Limited,Isolated,Mocked,Revealing;
						*/
						
					}
					
				}			
				
				public class AssmebiesDescription(){
					System.Web : HttpResponse,HttpRequest.HttpFileResult -> server browser comunication
					
					https://stackoverflow.com/questions/31291008/system-net-http-httpclient-vs-windows-web-http-httpclient-what-are-the-main-di
					System.Web.Http : IhttpActionResult -> System.Web.Http vs System.Net.Http more common, multilanguage, Http otimized
									
					System.Net : WebRequest,WebResponse, HttpWebRequest,HttpWebResponse -> web iteration puggable protocols
				}
								
				public class StringConcatenation()
				{
					
https://stackoverflow.com/questions/21078/most-efficient-way-to-concatenate-strings
					
Using the plus (+) symbol.
string.Concat().
string.Join().
string.Format().
string.Append().
StringBuilder.
					
				}
			}
			
			public void Patterns()
			{
				
				public void Singletones()
				{http://csharpindepth.com/Articles/General/Singleton.aspx
					
	/// <summary>
    /// Singletones
    /// </summary>
    //BAD single tone, concept only THREADINSAFE
    public sealed class SingleTone
    {
        private static SingleTone instance = null;

        public SingleTone()
        {

        }

        public static SingleTone Instance
        {
            get
            {
                if (instance == null)
                {
                    instance = new SingleTone();
                }

                return Instance;
            }
        }
    }


    //threadsafe like singletone
    public sealed class SingleTone_ThSf
    {
        private static SingleTone_ThSf instance;
        private static readonly object padlock = new object();

        private SingleTone_ThSf()
        {

        }

        public static SingleTone_ThSf Instance
        {
            get
            {
                if (instance == null)
                {
                    lock (padlock)
                    {
                        instance = new SingleTone_ThSf();
                    }
                }
                return instance;
            }
        }

    }

    //Threadsafe singletone not lazy
    //drawbacks
    //any private members reference at first would instantiate a class
    //circular stastic constructors 
    //Laziness if not marked beforefieldinit for lacking static constructors
    public sealed class SingleTone_ThSf_notLazy
    {
        private static SingleTone_ThSf_notLazy instance;

        //Executes once per thread and per Application pool, and always checked at object creation
        //faster then lock
        static SingleTone_ThSf_notLazy()
        {

        }
        private SingleTone_ThSf_notLazy()
        {

        }
        public static SingleTone_ThSf_notLazy Instance
        {
            get
            {
                return instance;
            }
        }
    }

    //Thread safe Lazy Singletone without lock
    public sealed class SingleTone_ThSf_Lz
    {
        //not to mark class as beforeheadinit
        private SingleTone_ThSf_Lz() { }

        public static SingleTone_ThSf_Lz Instance
        {
            get { return Nested.Instance; }
        }

        private class Nested
        {
            //not to mark class as beforeheadinit
            private Nested() { }

            internal static readonly SingleTone_ThSf_Lz Instance = new SingleTone_ThSf_Lz();

        }

    }

    //Thread safe lazy by framework .net 4
    public sealed class SingleTone_ThSf_LzFl
    {
        private static readonly Lazy<SingleTone_ThSf_LzFl> Lazy =
            new Lazy<SingleTone_ThSf_LzFl>(() => new SingleTone_ThSf_LzFl());

        private SingleTone_ThSf_LzFl() { }

        public static SingleTone_ThSf_LzFl Instance { get { return Lazy.Value; } }


    }
					
				}
				
			
			}
			
			public class Collections()
			{
				
				public void ListsConcatenate(){
					this.Tokens = texts_.SelectMany(s => s.Tokens).ToList(); 
				}
				
				public void JSONformat()
				{
					//Datetime format
					JsonConvert.SerializeObject(Object, new IsoDateTimeConverter() { DateTimeFormat = @"yyyy-MM-dd HH:mm:ss" })
					
					//add jsonserializersettings
					JsonConvert.SerializeObject(input_, new JsonSerializerSettings() { NullValueHandling = NullValueHandling.Ignore, Formatting = Formatting.None});
				}
				
			}
			
			//Override reminder
			public void OverrideReminder()
			{

				//override reminder exmpl
				//------------------------------------
				public class test1
				{
				public int a = 1;
				public test1()
				{

				}
				public virtual void countt()
				{
				a = a * 2;
				}
				public virtual int getA()
				{
				return a;
				}
				}
				public class test2 : test1
				{
				public int a = 1;
				public test2()
				{

				}
				public override void countt()
				{
				a = a * 3;
				}
				public override int getA()
				{
				return a;
				}
				}
				public class testt
				{
				public test1 t1;

				public testt(test1 t_)
				{
				t1 = t_;
				}
				}
				public int overridetest()
				{
				testt tt = new testt(new test1());
				tt.t1.countt();
				return tt.t1.getA();
				}
				//------------------------------------

			}
			
			public void MVC()
			{
					
				public void MVC_Template()
				{
					
					+ references
					System.Web.Mvc;
					System.Web.Razor;
					System.Web.Entity;
					System.Web.Helpers;
					System.Web.ApplicationServices;
					
					App_Data

					App_Start						
						RouteConfig.cs
							using System.Web.Mvc;
							using System.Web.Routing;
							public class RouteConfig
							{
								public void RegisterRoutes(RouteCollection routes)
								{
									
									routes.IgnoreRoute("{resuource}.axd{*pathInfo}");
									
									routes.MapRoute(
										name: "Default",
										url: "/{controller/{action}/{id}}",
										defaults: new {controller = "Default", action = "DefaultView", id = UrlParameter.Optional }
									);
								}
							}
						BundleConfig.cs						
							using System.Web.MVC;
							using System.Web.Optimization;
							public class BundleConfig()
							{
								public static void RegisterBundles(BundleCollection bundles)
								{
									bundles.Add(new ScriptBundle("~/bundles/jquery").Include("~/Scripts/jquery-{version}.js"));
									bundles.Add(new StyleBundle("~/Content/css").Include("~/Content/site.css"));
								}
							}
							
						FilterConfig.cs
							using System.Web.MVC;
							public class FilterConfig()
							{
								public static void RegisterGlobalFilters(GlobalFilterCollection filters)
								{
									filters.Add(new HandleErrorAttribute());
								}
							}
							
						Startup.cs
						
					Models

					Controllers
						using System.Web;
						using System.Web.MVC;
						DefaultController.cs
							public ActionResult Default : Controllers{
									return View();
							}
							
					Views
						Default
							DefaultView
							<h2>Header native</h2>
						Shared
							_Layout.cshtml
								<DOCTYPE html>
								<head><h1>@ViewBag.Title</h1></head>
								<body>@RenderBody()</body>
						_ViewStart.cshtml
							@{Layout=@"~/Views/Shared/_Layout.cshtml"}
								
								Global.asax
									
									using System.Web.Mvc;
									
									using System.Web.Routing;
									
									using System.Web.Optimization;
										
									using System.Web.Helpers;												
									using System.Security.Claims;
									
									public class App : System.Web.HttpApplication
									{
										
										public void Application_Start()
										{
										
					`						AreaRegistration.RegisterAllAreas();
											FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
																	
											RouteConfig.RegisterRoutes(RouteTable.Routes);						
										
											BundleConfig.RegisterBundles(BundleTable.Bundles);
																
											AntiForgeryConfig.UniqueClaimTypeIdentifier = ClaimTypes.Authentication;
											
										}
										
									}
																		
				}
		
				public void DAL()
				{
								
					/// <summary>
					/// Context with recreate if model changes
					/// </summary>
					public class SQLDB_CHANGE : DbContext
					{
						
						public SQLDB_CHANGE()
							: base("name=SQLDB_J")
						{
							Database.SetInitializer<SQLDB_CHANGE>(new DropCreateDatabaseIfModelChanges<SQLDB_CHANGE>());
							//CreateDatabaseIfNotExists
							//DropCreateDatabaseAlways
						}

						public SQLDB_CHANGE(string ConnectionName)
							: base(ConnectionName)
						{							
							//Database.SetInitializer<SQLDB_CHANGE>(new DropCreateDatabaseIfModelChanges<SQLDB_CHANGE>());
							
							//set initializer method
							Database.SetInitializer(new InitializerAtCreation());
							
							//force initialization
							Database.Initialize(true);
						}
							
						protected override void OnModelCreating(DbModelBuilder modelBuilder)
						{
							base.OnModelCreating(modelBuilder);
						}
						
						//initializer class with seed method
						//runs at DB creation
						public class InitializerAtCreation : DropCreateDatabaseIfModelChanges<SQLDB_CHANGE>
						{
							protected override void Seed(SQLDB_CHANGE context)
							{
								IList<KEY_CLIENTS_SQL> kk = new List<KEY_CLIENTS_SQL>()
								{
									new KEY_CLIENTS_SQL {SECTOR_ID = 1, MERCHANT = 9290000000 },
									new KEY_CLIENTS_SQL {SECTOR_ID = 2, MERCHANT = 9290000001 },
									new KEY_CLIENTS_SQL {SECTOR_ID = 2, MERCHANT = 9290000003 }
								};

								context.KEY_CLIENTS.AddRange(kk);
								context.SaveChanges();

								IList<REFMERCHANTS_SQL> rm = new List<REFMERCHANTS_SQL>()
								{
									new REFMERCHANTS_SQL { MERCHANT = 9290000000 },
									new REFMERCHANTS_SQL { MERCHANT = 9290000001 },
									new REFMERCHANTS_SQL { MERCHANT = 9290000002 },
									new REFMERCHANTS_SQL { MERCHANT = 9290000003 },
									new REFMERCHANTS_SQL { MERCHANT = 9290000004 },
								};

								context.REFMERCHANTS_SQL.AddRange(rm);
								context.SaveChanges();

								List<MERCHANT_LIST_SQL> ml = new List<MERCHANT_LIST_SQL>() {
									new MERCHANT_LIST_SQL() { MERCHANT = 9290000000, USER_ID =0, UPDATE_DATE = DateTime.Now },
									new MERCHANT_LIST_SQL() { MERCHANT = 9290000001, USER_ID =0, UPDATE_DATE = DateTime.Now },
									new MERCHANT_LIST_SQL() { MERCHANT = 9290000002, USER_ID =0, UPDATE_DATE = DateTime.Now }
								};

								context.MERCHANT_LIST.AddRange(ml);
								context.SaveChanges();

								base.Seed(context);
							}
						}
					}
					
					///<summary>
					/// Northwind context with OWIN security attached
					/// </summary>
					public partial class NorthwindModel : IdentityDbContext<ApplicationUser>
					{
						public NorthwindModel()
							: base("name=NorthwindConn_J")
						{
						}

						public static NorthwindModel Create()
						{
							return new NorthwindModel();
						}
					  
						public virtual DbSet<Category> Categories { get; set; }
						public virtual DbSet<CustomerDemographic> CustomerDemographics { get; set; }
						public virtual DbSet<Customer> Customers { get; set; }
						public virtual DbSet<Employees> Employees { get; set; }
						public virtual DbSet<Order_Detail> Order_Details { get; set; }
						public virtual DbSet<Order> Orders { get; set; }
						public virtual DbSet<Product> Products { get; set; }
						public virtual DbSet<Region> Regions { get; set; }
						public virtual DbSet<Shipper> Shippers { get; set; }
						public virtual DbSet<Supplier> Suppliers { get; set; }
						public virtual DbSet<Territory> Territories { get; set; }

						
						protected override void OnModelCreating(DbModelBuilder modelBuilder)
						{

							//modelBuilder.Entity<Login>().HasRequired(t => t.employee).WithOptional(t=>t.Account);

							modelBuilder.Entity<Employees>().HasOptional(t => t.Account).WithOptionalPrincipal(t=>t.employee);

							modelBuilder.Entity<CustomerDemographic>()
								.Property(e => e.CustomerTypeID)
								.IsFixedLength();

							modelBuilder.Entity<CustomerDemographic>()
								.HasMany(e => e.Customers)
								.WithMany(e => e.CustomerDemographics)
								.Map(m => m.ToTable("CustomerCustomerDemo").MapLeftKey("CustomerTypeID").MapRightKey("CustomerID"));

							modelBuilder.Entity<Customer>()
								.Property(e => e.CustomerID)
								.IsFixedLength();

							modelBuilder.Entity<Employees>()
								.HasMany(e => e.Employees1)
								.WithOptional(e => e.Employee1)
								.HasForeignKey(e => e.ReportsTo);

							modelBuilder.Entity<Employees>()
								.HasMany(e => e.Territories)
								.WithMany(e => e.Employees)
								.Map(m => m.ToTable("EmployeeTerritories").MapLeftKey("EmployeeID").MapRightKey("TerritoryID"));

							modelBuilder.Entity<Order_Detail>()
								.Property(e => e.UnitPrice)
								.HasPrecision(19, 4);

							modelBuilder.Entity<Order>()
								.Property(e => e.CustomerID)
								.IsFixedLength();

							modelBuilder.Entity<Order>()
								.Property(e => e.Freight)
								.HasPrecision(19, 4);

							modelBuilder.Entity<Order>()
								.HasMany(e => e.Order_Details)
								.WithRequired(e => e.Order)
								.WillCascadeOnDelete(false);

							modelBuilder.Entity<Product>()
								.Property(e => e.UnitPrice)
								.HasPrecision(19, 4);

							modelBuilder.Entity<Product>()
								.HasMany(e => e.Order_Details)
								.WithRequired(e => e.Product)
								.WillCascadeOnDelete(false);

							modelBuilder.Entity<Region>()
								.Property(e => e.RegionDescription)
								.IsFixedLength();

							modelBuilder.Entity<Region>()
								.HasMany(e => e.Territories)
								.WithRequired(e => e.Region)
								.WillCascadeOnDelete(false);

							modelBuilder.Entity<Shipper>()
								.HasMany(e => e.Orders)
								.WithOptional(e => e.Shipper)
								.HasForeignKey(e => e.ShipVia);

							modelBuilder.Entity<Territory>()
								.Property(e => e.TerritoryDescription)
								.IsFixedLength();

							base.OnModelCreating(modelBuilder);
						}					
					}					
					
				}
				
				public void Model()
				{
					///Model attributes
					//class table name
					[Table(@"REFMERCHANTS_SQL")]
					//column as PK , not null
					[Key],[Required]
					//Column ID by database genereated
					[DatabaseGenerated(DatabaseGeneratedOption.Computed)]
					[DatabaseGenerated(DatabaseGeneratedOption.Identity)]												
					
				}
				
				public void NorthwindDBModel()
				{
					
					#region HR
					public partial class REGIONS : Repo_.IEntityInt
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public REGIONS()
						{
							this.COUNTRIES = new HashSet<COUNTRIES>();
						}

						[Key]
						//Change column name anfd type in DB
						[Column("REGION_ID", TypeName = "decimal")]
						public int ID { get; set; }
						public string REGION_NAME { get; set; }

						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<COUNTRIES> COUNTRIES { get; set; }
					}

					public partial class LOCATIONS : Repo_.IEntity
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public LOCATIONS()
						{
							this.DEPARTMENTS = new HashSet<DEPARTMENTS>();
						}

						[Key]
						[Column("LOCATION_ID", TypeName = "varchar")]
						public string ID { get; set; }
						public string STREET_ADDRESS { get; set; }
						public string POSTAL_CODE { get; set; }
						public string CITY { get; set; }
						public string STATE_PROVINCE { get; set; }
						public string COUNTRY_ID { get; set; }

						public virtual COUNTRIES COUNTRIES { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<DEPARTMENTS> DEPARTMENTS { get; set; }
					}

					public partial class JOBS
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public JOBS()
						{
							this.EMPLOYEES = new HashSet<EMPLOYEES>();
							this.JOB_HISTORY = new HashSet<JOB_HISTORY>();
						}

						[Key]
						public string JOB_ID { get; set; }
						public string JOB_TITLE { get; set; }
						public Nullable<int> MIN_SALARY { get; set; }
						public Nullable<int> MAX_SALARY { get; set; }

						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<EMPLOYEES> EMPLOYEES { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<JOB_HISTORY> JOB_HISTORY { get; set; }
					}

					public partial class JOB_HISTORY
					{
						[Key]
						public int EMPLOYEE_ID { get; set; }
						public System.DateTime START_DATE { get; set; }
						public System.DateTime END_DATE { get; set; }
						public string JOB_ID { get; set; }
						public Nullable<short> DEPARTMENT_ID { get; set; }
						public Nullable<int> EMPLOYEES_EMPLOYEE_ID { get; set; }

						public virtual DEPARTMENTS DEPARTMENTS { get; set; }
						public virtual EMPLOYEES EMPLOYEES { get; set; }
						public virtual JOBS JOBS { get; set; }
					}

					public partial class COUNTRIES
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public COUNTRIES()
						{
							this.LOCATIONS = new HashSet<LOCATIONS>();
						}

						[Key]
						public string COUNTRY_ID { get; set; }
						public string COUNTRY_NAME { get; set; }
						public Nullable<decimal> REGION_ID { get; set; }

						public virtual REGIONS REGIONS { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<LOCATIONS> LOCATIONS { get; set; }
					}

					public partial class DEPARTMENTS
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public DEPARTMENTS()
						{
							this.EMPLOYEES2 = new HashSet<EMPLOYEES>();
							this.EMPLOYEES3 = new HashSet<EMPLOYEES>();
							this.JOB_HISTORY = new HashSet<JOB_HISTORY>();
						}

						[Key]
						public short DEPARTMENT_ID { get; set; }
						public string DEPARTMENT_NAME { get; set; }
						public Nullable<int> MANAGER_ID { get; set; }
						public Nullable<short> LOCATION_ID { get; set; }
						public Nullable<int> EMPLOYEES_EMPLOYEE_ID { get; set; }
						public Nullable<int> EMPLOYEES_EMPLOYEE_ID1 { get; set; }

						public virtual EMPLOYEES EMPLOYEES { get; set; }
						public virtual EMPLOYEES EMPLOYEES1 { get; set; }
						public virtual LOCATIONS LOCATIONS { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<EMPLOYEES> EMPLOYEES2 { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<EMPLOYEES> EMPLOYEES3 { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<JOB_HISTORY> JOB_HISTORY { get; set; }
					}

					public partial class EMPLOYEES
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public EMPLOYEES()
						{
							this.DEPARTMENTS = new HashSet<DEPARTMENTS>();
							this.DEPARTMENTS1 = new HashSet<DEPARTMENTS>();
							this.EMPLOYEES1 = new HashSet<EMPLOYEES>();
							this.JOB_HISTORY = new HashSet<JOB_HISTORY>();
						}

						[Key]
						public int EMPLOYEE_ID { get; set; }
						public string FIRST_NAME { get; set; }
						public string LAST_NAME { get; set; }
						public string EMAIL { get; set; }
						public string PHONE_NUMBER { get; set; }
						public System.DateTime HIRE_DATE { get; set; }
						public string JOB_ID { get; set; }
						public Nullable<decimal> SALARY { get; set; }
						public Nullable<decimal> COMMISSION_PCT { get; set; }
						public Nullable<int> MANAGER_ID { get; set; }
						public Nullable<short> DEPARTMENT_ID { get; set; }
						public Nullable<short> DEPARTMENTS1_DEPARTMENT_ID { get; set; }
						public Nullable<int> EMPLOYEES2_EMPLOYEE_ID { get; set; }
						public Nullable<short> DEPARTMENTS_DEPARTMENT_ID { get; set; }

						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<DEPARTMENTS> DEPARTMENTS { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<DEPARTMENTS> DEPARTMENTS1 { get; set; }
						public virtual DEPARTMENTS DEPARTMENTS2 { get; set; }
						public virtual DEPARTMENTS DEPARTMENTS3 { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<EMPLOYEES> EMPLOYEES1 { get; set; }
						public virtual EMPLOYEES EMPLOYEES2 { get; set; }
						public virtual JOBS JOBS { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<JOB_HISTORY> JOB_HISTORY { get; set; }
					}
					#endregion
		
				}
								
				public class CustomAttribute()
				{
					
					public class Quth : AuthorizeAttribute
					{

						const();
						
						public override void OnAuthorization(Syste.Wb.http.HttpActionContext at)
						{
						
							base.()OnAuthorization(at);
							
						}
						
					}
					
				}
			}
			
			public void WebApi()
			{
				
				public WebAPIconfigMultipleMethods(){
					
					config.Routes.MapHttpRoute(
					name: "TrackedBirthdaysPOST",
					routeTemplate: "api/{controller}/{action}/{fromGUID}/{toGUID}",
					defaults: new { controller = "Person", action = "TrackedBirthdaysAccPOST" }
					);
					config.Routes.MapHttpRoute(
					name: "TrackedBirthdaysGET",
					routeTemplate: "api/{controller}/{action}/{GUID}",
					defaults: new { controller = "Person", action = "TrackedBirthdaysAccGET" }
					);
					config.Routes.MapHttpRoute(
					name: "TrackedBirthdaysDELETE",
					routeTemplate: "api/{controller}/{action}/{GUID}",
					defaults: new { controller = "Person", action = "TrackedBirthdaysAccDELETE" }
					);
					
					  config.Routes.MapHttpRoute(
					"ApiByTypeOfs",
					"api/{controller}/{type}/{start}/{count}",
					 new { action = "Get" },
					 new { httpMethod = new HttpMethodConstraint(HttpMethod.Get), type = @"^[a-zA-Z]*$", start = @"\d+", count = @"\d+" }

					);
		  
				}
				
				public WebApiConfigMinified()
				{
					
					// Web API configuration and services

					// Web API routes
					config.MapHttpAttributeRoutes();

					//enables all parametreless methods
					config.Routes.MapHttpRoute(
					name: "DefaultApiParam",
					routeTemplate: "api/{controller}/{action}"
					);



					//default Birthdays
					config.Routes.MapHttpRoute(
					name: "Persons_GET_paramed",
					routeTemplate: "api/Person/TrackedBirthdaysAccGET/{GUID}",
					defaults: new { controller = "Person", Action = "TrackedBirthdaysAccGET" }
					);
					config.Routes.MapHttpRoute(
					name: "Birthdays_GET_paramed",
					routeTemplate: "api/Birthdays/GetBirthdays/{GUID}",
					defaults: new { controller = "Birthdays", Action = "GetBirthdays" }
					);



					//birthdays Acc
					config.Routes.MapHttpRoute(
					name: "Birthdays_Acc_get",
					routeTemplate: "api/Birthdays/GetBirthdaysAcc/{GUID}",
					defaults: new { controller = "Birthdays", Action = "GetBirthdaysAcc" }
					);
					config.Routes.MapHttpRoute(
					name: "Birthdays_Acc_POST",
					routeTemplate: "api/Birthdays/GetBirthdaysAcc/{fromGUID}/{toGUID}",
					defaults: new { controller = "Birthdays", Action = "PostBirthdaysAcc" }
					);
					config.Routes.MapHttpRoute(
					name: "Birthdays_Acc_Delete",
					routeTemplate: "api/Birthdays/GetBirthdaysAcc/{fromGUID}/{toGUID}",
					defaults: new { controller = "Birthdays", Action = "DeleteBirthdaysAcc" }
					);



					//placed first, enables all but disables
					//all controllers GET methods with single parameter
					config.Routes.MapHttpRoute(
					name: "Persons_GET",
					routeTemplate: "api/{controller}/{action}/{accountName}",
					defaults: new { accountName = RouteParameter.Optional, controller = "Person" }
					);
					//enables Birthdays Get and Persons Gettracked with GUID parameter
					config.Routes.MapHttpRoute(
					name: "Birthdays_GET",
					routeTemplate: "api/{controller}/{action}/{GUID}",
					defaults: new { GUID = RouteParameter.Optional, controller = "Birthdays" }
					);


					//enables whole bunch of Birthday, Person methods with fromGUID,toGUID signature
					config.Routes.MapHttpRoute(
					name: "Birthdays_Perosn_POST_DELETE",
					routeTemplate: "api/{controller}/{action}/{fromGUID}/{toGUID}"
					);

				}
			
			}
			
			public void OrientDB()
			{
				public void DriversInstall()
				{
					Update-Package Microsoft.AspNet.Mvc -Reinstall
					Install-Package Microsoft.AspNet.Mvc -Version 3.2
					Install-Package Microsoft.ApplicationInsights.Web
					Update-Package Microsoft.ApplicationInsights.Web -Reinstall
				}
			}
							
			public void Testing()
			{
				
				//Expected Actual
				public void Moq()
				{
					//Setup phase
					//sample type callback
					kkRepo.Setup(m => m.Add(It.IsAny<KEY_CLIENTS_SQL>())).Callback<KEY_CLIENTS_SQL>(
					(KEY_CLIENTS_SQL s) => { client = s; });
					
					//Cllaback hosting object 
					kkRepo.Setup(m => m.Add(It.IsAny<KEY_CLIENTS_SQL>())).Callback(
					(KEY_CLIENTS_SQL s) => { clientsL.Add(s);});
				
					//return item by ID
					kkRepo.Setup(m => m.GetByID(It.IsAny<int>())).Returns<int>(id => clientsQ.SingleOrDefault(r => r.ID == id));
					
					
					//DELETEBYLIST example
					kkRepo.Object.DeleteByList(clientsDel.AsQueryable());
					kkRepo.Verify(s => s.DeleteByList(It.IsAny<IQueryable<KEY_CLIENTS_SQL>>()));
					Assert.AreEqual(clientsL.Count(), clientsAfterListDeleteCount);
				}				
							
				public void xUnit(){
					public xUnitInitializeCode{

						public class DatabaseFixture : IDisposable
						{
						  public DatabaseFixture()
						  {
							GenDb();

							// ... initialize data in the test database ...
						  }

						  public void Dispose()
						  {
							mng.DeleteDB();
						  }

						  public void GenDb()
						  {

						  } 

						}
					}
				}
			}					
					
			public class Deploy()
			{
				
				public void IIS()
				{
					
					public void Mnual()
					{
						https://msdn.microsoft.com/en-us/library/1y1404zt.aspx
						1) Build Web API
						2) Create folder in IIS visible area
						3) CopyPast project
						4) Add site in iis -> set folder -> configure bindings (no name possible)
					}
					
				}
			
			}
			
			public class VisualStudio()
			{
				//Nugets
				public void ConsoleManager()
				{https://docs.microsoft.com/en-us/nuget/tools/package-manager-console
				
          //install all projects
					Get-Project -All | Install-Package packageName
				
					//install in project subset
					Get-Project -All | where { $_.Name.EndsWith(".Test") } | Install-Package NSubstitute
				
					Update-Package Microsoft.AspNet.Mvc -Reinstall
					Install-Package Microsoft.AspNet.Mvc -Version 3.2
					Install-Package Microsoft.ApplicationInsights.Web
					Update-Package Microsoft.ApplicationInsights.Web -Reinstall
					
					
					-ProjectName
					Find-Package microsoft.net.http
					Install-Package microsoft.net.http
					Install-Package microsoft.net.http -ProjectName ConsoleApp1
					install-package Newtonsoft.Json -ProjectName NewsAPI, NewsAPI.Tsts
					
					Install-Package xunit
					Install-Package xunit.analyzers 
					Install-Package xunit.runner.console
					Install-Package xunit.runner.visualstudio
					
					Update-Package -Reinstall
					
					//system.web.hhtp
					Install-Package Microsoft.AspNet.WebApi
					//using System.Web.Http.Cors;
					Install-Package Microsoft.AspNet.WebApi.Cors

//nsql ref
Install-Package xunit -ProjectName NSQLManagerIntegrationTests
Install-Package moq -ProjectName NSQLManagerIntegrationTests
Install-Package Newtonsoft.Json -ProjectName NSQLManagerIntegrationTests
Install-Package Microsoft.AspNet.WebApi -ProjectName NSQLManagerIntegrationTests

Install-Package NUnit -ProjectName NSQLManagerIntegrationTests
Install-Package NUnit.ConsoleRunner -ProjectName NSQLManagerIntegrationTests
Install-Package NUnit.Console -ProjectName NSQLManagerIntegrationTests
Install-Package NUnit3TestAdapter  -ProjectName NSQLManagerIntegrationTests
				
				}
				public void ConfigurationManager()
				{
					reference 
					FRAMEWORKS -> System.Configuration
					
				}
			
        public void WebDeploy()
				{
					Web Deploy
					//host name without urls or ports
					//http://server-name-1:8182 ->
					server-name-1
					//Iis sitename 
					sitename1
					//Credentials with domen
					DOMN\user
					password
					//site url with protocol and port
					http://newstest2:8184
				}
			
			
			public void MSbuild()
			{

			/*				
			"10.0" указывает на поднабор инструментов .NET Framework 4;
			"11.0" указывает на поднабор инструментов .NET Framework 4.5;
			"12.0" указывает на поднабор инструментов .NET Framework 4.5.1.
			*/

				//build v14.0
				C:\Windows\Microsoft.NET\Framework64\v4.0.30319\MSBuild.exe "C:\workflow\projects\Dev\Intranet Development\AddressBook_News2\AddressBook_News2-branch1\AddressBook_News.sln" /p:Configuration=Debug  /p:VisualStudioVersion=14.0;BaseOutputPath=bin\res
			
			}
				
			public class Unsorted
			{
				
			//delete from oracle table and link parametrized insert command to connection
			public class oracle_queries(){
			oracleConnection.Open();
			oracleDeleteCommand.Connection = oracleConnection;
			oracleDeleteCommand.CommandText = oracleQueriesBank.unparametrizedDelete;
			oracleDeleteCommand.ExecuteNonQuery();

			OracleCommand oracleInsertCommand = new OracleCommand();
			oracleInsertCommand.Connection = oracleConnection;
			oracleInsertCommand.CommandText = oracleQueriesBank.parametrizedInsert;

			oracleConnection.Open();
			oracleTablePresence.Connection = oracleConnection;
			oracleTablePresence.CommandText = oracleQueriesBank.tablePresenceTest;
			oracleTablePresence.Parameters.Add(new OracleParameter("tablename", "MERCHANT_LIST"));
			tablecount = oracleTablePresence.ExecuteScalar().ToString();

			oracleTablePresence.CommandText = oracleQueriesBank.tableColumnTest;
			oracleTablePresence.Parameters.Add(new OracleParameter("tablename", "MERCHANT_LIST"));
			oracleTablePresence.Parameters.Add(new OracleParameter("columnname", "ID_MERCHANT"));
			columncount = oracleTablePresence.ExecuteScalar().ToString();

			connectionInitialize(oracleConnection);
			OracleCommand oracleTableCount = new OracleCommand();
			oracleConnection.Open();
			oracleTableCount.Connection = oracleConnection;
			oracleTableCount.CommandText = oracleQueriesBank.unparametrizedRowCount;

			oracleTableCount.CommandText = oracleQueriesBank.tableColumnTest;
			rowcount = oracleTableCount.ExecuteScalar().ToString();
			}

			//oracle service query texts
			public class servise_queries(){
			//used for parametrized insert from import datagridview to oracle table
			//occurs in dataGridView_Import_DoubleClick throught OracleQueryExecutor class
			sampleInsert = "insert into merchant_list (ID_MERCHANT) values ('test_val')";

			unparametrizedDelete = "delete from merchant_list";
			parametrizedInsert = "insert into merchant_list values (:value)";
			unparametrizedRowCount = "select max(rownum) from merchant_list";

			//used for detecting marchant_list table presence and it's creation
			tablePresenceTest = "select max(rownum) from user_tables where table_name = (:tablename)";
			//detecting rownumbers in table
			tableColumnTest = "select max(rownum) from user_tab_columns where table_name = (:tablename) and column_name = (:columnname)";
			createTable = "create table MERCHANT_LIST (ID_MERCHANT varchar(50))";
			}

			//SERIALIZE DESERIALIZE
			public class serealization_deserialization(){
			public void Serialize(String path, List<OracleQueriesListClass> myArray)
			{
			BinaryFormatter formatter = new BinaryFormatter();
			using (FileStream stream = new FileStream(path, FileMode.Create, FileAccess.Write))
			{
			formatter.Serialize(stream, myArray);
			}
			}

			public List<OracleQueriesListClass> DeserializeList(String path)
			{
			BinaryFormatter formatter = new BinaryFormatter();
			using (FileStream stream = new FileStream(path, FileMode.Open, FileAccess.Read))
			{
			List<OracleQueriesListClass> myList = (List<OracleQueriesListClass>)formatter.Deserialize(stream);
			return myList;
			}
			}
			}

			//app setting connstrings example
			public class connstrings(){

			//requesting connString from appsettings
			System.Configuration.ConfigurationSettings.AppSettings["ConnectionString"];
			System.Configuration.ConfigurationManager.ConnectionStrings["connectionStringName"].ConnectionString;
			</startup>
			<appSettings>
			<add key="ConnectionString" value="Data Source=dwh.rs.ru;User ID=LoginReplacePatch;Password=PasswordReplacePatch" />
			<add key="ClientSettingsProvider.ServiceUri" value="" />
			<add key="excelConnectionString" value="OLEDB;Provider=MSDAORA.1;Password=PasswordReplacePatch;User ID=LoginReplacePatch;Data Source=dwh.rs.ru;" />
			</appSettings>
			}

			public class ExcelIntegration(){
				

			//create excel xlsx with OPEN xml
			private void OPENxmlCreate(){
			string fileName = @"C:\111\test.xlsx";
			using (SpreadsheetDocument document = SpreadsheetDocument.Create(fileName, SpreadsheetDocumentType.Workbook))
			{
			WorkbookPart workbookPart = document.AddWorkbookPart();
			workbookPart.Workbook = new Workbook();

			WorksheetPart worksheetPart = workbookPart.AddNewPart<WorksheetPart>();
			worksheetPart.Worksheet = new Worksheet(new SheetData());

			Sheets sheets = workbookPart.Workbook.AppendChild(new Sheets());

			Sheet sheet = new Sheet() { Id = workbookPart.GetIdOfPart(worksheetPart), SheetId = 1, Name = "Test Sheet" };

			sheets.Append(sheet);

			workbookPart.Workbook.Save();
			}
			}

			}

			/////

			//connection strings
			public void connectionStrings()
			{

			//connection to local SQL express from MVC
			//<add name="BookContext" connectionString="Data Source=.\SQLEXPRESS2;Initial Catalog=text_db;Integrated Security=SSPI;" providerName="System.Data.SqlClient"/>

			//<add name="SoocerContext" connectionString="Data Source=.\SQLEXPRESS2;Initial Catalog=tempdb;Integrated Security=SSPI;" providerName="System.Data.SqlClient"/>

			//connection from console app
			//string connectionString = @"Initial Catalog=tempdb;Data Source=.\SQLEXPRESS2;Integrated Security=SSPI;";

			//string connectionStringORCL = @"User Id=neprintsev_ia; password = awsedrDRSEAW; Data Source = dwh.rs.ru; Pooling=false;";
			//string connectionStringSQL = @"Data Source=.\SQLEXPRESS;Initial Catalog=DWH_replica;Integrated Security=SSPI;";

			}

			//----------------------------------------------


			//mvc tempaltes
			public void MVC_templates()
			{

			//view add button with rediraect
			<input type="button" value="ClickMe" onclick="location.href='@Url.Action("Migrate","Home")'"

			//view submit button
			<input type="submit" value="Save" class="btn btn-default" />

			//view actionlink
			@Html.ActionLink("Back to List", "Index")

			// Refresh model in controller if passing values after changes in layer
			if(ModelState.IsValid)
			{
			ModelState.Clear();
			}

			//start wcf service async
			Task.Run(() => migrateService.migrate_((DateTime)DateFrom, (DateTime)DateTo));

			//one of multiple buttons
			//controller part
			[HttpPost]
			[MultipleButton(Name = "action", Argument = "Stop")]
			public ActionResult Stop(int ID, DateTime? DateFrom, DateTime? DateTo)
			{}

			//view part
			<td>
			<input type="submit" value="Stop" name="action:Stop" />
			</td>

			//pass multiple parameters to controller from view
			<td>
			<input type="text" id="DateTo" name="DateTo" value="@tab.DateTo" />
			</td>

			//parametrized groupping linq to entity
			var a = from s in db.FD_ACQ_D
			where DbFunctions.CreateDateTime(s.DT_REG.Year, s.DT_REG.Month,01,0,0,0) ==
			DbFunctions.CreateDateTime(fromDate.Year, fromDate.Month, 01, 0, 0, 0)
			group s by new { DT_REG= DbFunctions.CreateDateTime(s.DT_REG.Year, s.DT_REG.Month, 01, 0, 0, 0), TYPE_TRANSACTION=s.TYPE_TRANSACTION, PAY_SYSTEM=s.PAY_SYS} into g
			select new
			{
			DT_REG = g.Key.DT_REG,
			TYPE_TRANSACTION = g.Key.TYPE_TRANSACTION,
			PAY_SYSTEM=g.Key.PAY_SYSTEM,
			AMT = g.Sum(s => s.AMT)
			};
			foreach(var b in a)
			{
			this.FD_ACQ_D.Add(new FD_RES { DT_REG = b.DT_REG, TYPE_TRANSACTION = b.TYPE_TRANSACTION, AMT = b.AMT, PAY_SYS=b.PAY_SYSTEM });
			}


			//return json from controller public string GetJson()
			{
			ml.GetACQ(db);
			string jsn = JsonConvert.SerializeObject(ml.FD_ACQ_D);
			return jsn;
			}

			}

			//json serialization with newtonsoft dll
			public void jsonserialization()
			{

			string json2 = JsonConvert.SerializeObject(jst1, Formatting.Indented);
			File.WriteAllText(@"C:\test\insert\json.json", json2);

			string json3 = "";
			json3 = File.ReadAllText(@"C:\test\insert\json.json");
			json_tst_par jDes = JsonConvert.DeserializeObject<json_tst_par>(json3);

			}

			public void StoreValuesToSettings()
			{

			//storing values to settings
			WindowsFormsApplication2.Properties.Settings.Default.Upgrade();
			//changes
			WindowsFormsApplication2.Properties.Settings.Default.Save();

			//Initializing Form Elements in form methods
			TextBox tb = (TextBox)sender;

			//datetime defenition
			DateTime dt = new DateTime(1, 1, 1, 0, 0, 0)
			}

			//default connection strings for oracle and excel
			public void connectionStrings()
			{
			<appSettings>
			<add key="ConnectionString" value="Data Source=dwh.rs.ru;User ID=LoginReplacePatch;Password=PasswordReplacePatch;" />
			<add key="ClientSettingsProvider.ServiceUri" value="" />
			<add key="excelConnectionString" value="OLEDB;Provider=MSDAORA.1;Password=PasswordReplacePatch;User ID=LoginReplacePatch;Data Source=dwh.rs.ru;Pooling=false;" />
			</appSettings>
			}

			//List object on excel list REFRESH
			if (lob.Name == liobName)
			{
			lob.QueryTable.CommandText = queryText__;
			lob.QueryTable.Connection = connectionString;
			lob.QueryTable.BackgroundQuery = true;
			lob.QueryTable.SaveData = true;
			lob.QueryTable.EnableRefresh = true;
			//lob.QueryTable.Refresh(false);
			try
			{
			lob.QueryTable.Refresh(false);
			}
			catch (Exception e)
			{

			}
			}

			//List object on excel list PLACE
			if (ws.Name==wsName)
			{

			ExcelInterop.Range worksheetRange = ws.get_Range("A1");
			string tableName=Path.GetRandomFileName().Replace(".","");
			tableName = Regex.Replace(tableName, @"\d", "");


			ExcelInterop.ListObject ListObject = ws.ListObjects.Add(ExcelInterop.XlListObjectSourceType.xlSrcQuery,
			((object)connectionString), false, ExcelInterop.XlYesNoGuess.xlYes, worksheetRange);

			//ListObject.QueryTable.CommandText = ((object)excelCommand);
			ListObject.QueryTable.CommandText = ((object)queryText__);
			ListObject.QueryTable.RowNumbers = false;
			ListObject.QueryTable.FillAdjacentFormulas = false;
			ListObject.QueryTable.PreserveFormatting = true;
			ListObject.QueryTable.RefreshOnFileOpen = false;
			ListObject.QueryTable.BackgroundQuery = true;
			ListObject.QueryTable.SavePassword = false;
			ListObject.QueryTable.SaveData = true;
			ListObject.QueryTable.AdjustColumnWidth = true;
			ListObject.QueryTable.RefreshPeriod = 10;
			ListObject.QueryTable.PreserveColumnInfo = true;
			ListObject.QueryTable.ListObject.DisplayName = tableName; //tabName;
			ListObject.QueryTable.EnableRefresh = true;
			ListObject.QueryTable.Refresh(false);

			}

			//searchs all processes and finds id for passed main window title
			//apl.Caption for excell aplications
			public int GetProcessIdByWindowTitle(string windowTitle)
			{

			int processID;
			processID = 0;
			foreach (System.Diagnostics.Process proc in System.Diagnostics.Process.GetProcessesByName("Excel"))
			{
			if (proc.MainWindowTitle == windowTitle)
			processID = proc.Id;
			}
			return processID;
			}

			//kills process with current ID
			public void processKill(int ID)
			{
			foreach (System.Diagnostics.Process proc in System.Diagnostics.Process.GetProcessesByName("Excel"))
			{
			if (proc.Id == ID)
			proc.Kill();
			}
			}

			//creates file for current excel workbook with path
			public void fileSave(ExcelInterop.Workbook wb, string OutputFileName)
			{
			if (!Directory.Exists(Path.GetDirectoryName(OutputFileName)))
			{
			Directory.CreateDirectory(Path.GetDirectoryName(OutputFileName));
			}

			wb.SaveAs(OutputFileName, ExcelInterop.XlFileFormat.xlWorkbookDefault,
			Missing.Value, Missing.Value, Missing.Value, Missing.Value,
			ExcelInterop.XlSaveAsAccessMode.xlExclusive,
			Missing.Value, Missing.Value, Missing.Value,
			Missing.Value, Missing.Value);
			wb.Close();
			}

			//correct excel application killing
			public void ExcelApplicationTest()
			{
			xlNS.Application apl2;
			apl2 = new xlNS.Application();

			xlNS.Workbooks wbs2;
			wbs2 = apl2.Workbooks;

			xlNS.Workbook wb2;
			xlNS.Worksheet ws2;

			 

			if(!File.Exists(ExcelPath))
			{
			wb2 = wbs2.Add(xlNS.XlWBATemplate.xlWBATWorksheet);
			//ws2 = (xlNS.Worksheet)wb2.Worksheets[1];
			wb2.SaveAs(ExcelPath);
			}
			else
			{
			wb2 = wbs2.Open(ExcelPath);
			}

			wb2.Close();
			apl2.Quit();
			wbs2.Close();

			Marshal.ReleaseComObject(wb2);
			Marshal.ReleaseComObject(wbs2);
			Marshal.ReleaseComObject(apl2);

			wb2 = null;
			apl2 = null;
			wbs2 = null;

			}

			//Opens filedialog and inserts results from excel to datagrid view
			public void dataGridSelectedFill(DataGridView dg, FilePath FilePath_)
			{
			OpenFileDialog ofd = new OpenFileDialog();
			Stream stream = null;

			ofd.Filter = "excel files (*.xls)|*.xls|excel files (*.xlsx)|*.xlsx";
			ofd.FilterIndex = 2;
			ofd.RestoreDirectory = true;

			if (ofd.ShowDialog() == DialogResult.OK)
			{
			if (File.Exists(ofd.FileName))
			{
			FilePath_.inputFilePath = ofd.FileName;

			try
			{
			ofd.InitialDirectory = FilePath_.inputFileFolder;

			try
			{
			if ((stream = ofd.OpenFile()) != null)
			{
			WindowsFormsApplication2.Properties.Settings.Default.InputFilePath = ofd.FileName;
			WindowsFormsApplication2.Properties.Settings.Default.Save();

			using (stream)
			{
			//calls main method for excel file from filedialog open and dataset to datagrid bnding
			dg.DataSource = StreamToGrid(stream, ofd.FileName);
			//new BindingSource(result.Tables[0], null);
			}

			}
			}
			catch (Exception ex)
			{
			MessageBox.Show("Error: Could not read file from disk. Original error: " + ex.Message);
			}

			}
			catch (Exception ex)
			{
			MessageBox.Show("Error: no file folder exists!" + ex.Message);
			}
			}
			}
			}

			//converts stream of file to datagrid for xls,xlsx
			//with CodePlex data reader http://exceldatareader.codeplex.com/
			public DataTable StreamToGrid(Stream stream, string ofd)
			{
			IExcelDataReader excelReader = null;
			DataSet result = new DataSet();

			string ExcelExtension= Path.GetExtension(ofd);


			if (ExcelExtension == ".xls")
			{
			excelReader = ExcelReaderFactory.CreateBinaryReader(stream);
			result = excelReader.AsDataSet();
			}

			if (ExcelExtension == ".xlsx")
			{
			excelReader = ExcelReaderFactory.CreateOpenXmlReader(stream);
			excelReader.IsFirstRowAsColumnNames = true;
			result = excelReader.AsDataSet();
			}


			//6. Free resources (IExcelDataReader is IDisposable)
			excelReader.Close();

			return result.Tables[0];

			}

			 

			//Initializes and starts new form from another one (for excel worksheet selection)
			private void wsSelectShow(ExcelInterop.Workbook wb, ExcelExport ee, string connectionString)
			{
			ListObjects_ liob = new ListObjects_();
			wsSelect wsSelect_ = new wsSelect(wb, ee, connectionString);
			wsSelect_.Show();
			}

			//publishing of excel list object
			public void listObjectPublish(){

			ExcelInterop.ListObject ListObject = ws.ListObjects.Add(ExcelInterop.XlListObjectSourceType.xlSrcQuery,
			((object)connectionString), false, ExcelInterop.XlYesNoGuess.xlYes, worksheetRange);

			//ListObject.QueryTable.CommandText = ((object)excelCommand);
			ListObject.QueryTable.CommandText = ((object)queryText__);
			ListObject.QueryTable.RowNumbers = false;
			ListObject.QueryTable.FillAdjacentFormulas = false;
			ListObject.QueryTable.PreserveFormatting = true;
			ListObject.QueryTable.RefreshOnFileOpen = false;
			ListObject.QueryTable.BackgroundQuery = true;
			ListObject.QueryTable.SavePassword = false;
			ListObject.QueryTable.SaveData = true;
			ListObject.QueryTable.AdjustColumnWidth = true;
			ListObject.QueryTable.RefreshPeriod = 10;
			ListObject.QueryTable.PreserveColumnInfo = true;
			ListObject.QueryTable.ListObject.DisplayName = tableName; //tabName;
			ListObject.QueryTable.EnableRefresh = true;
			ListObject.QueryTable.Refresh(false);
			}

			//refreshing of list objects on excel
			public void ListObject refresh()
			{
			lob.QueryTable.CommandText = queryText__;
			lob.QueryTable.Connection = connectionString;
			lob.QueryTable.BackgroundQuery = true;
			lob.QueryTable.SaveData = true;
			lob.QueryTable.EnableRefresh = true;
			lob.QueryTable.Refresh(false);
			}

			//Connection string and query for reading excel files with OLEDB and storing to datatable to excel
			public void readExcelOledbStoreDTtoExcel()
			{
			//string for oledb to excel query
			string conString = @"Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + fileToParse + ";" + "Extended Properties=" + "\"" + @"Excel 12.0;HDR=NO;TypeGuessRows=0;ImportMixedTypes=Text""";

			OleDbConnection oleCon = new OleDbConnection(conString);
			OleDbCommand oleCmd = new OleDbCommand(req, oleCon);
			DataTable dt = new DataTable("Output");

			oleCon.Open();
			dt.Load(oleCmd.ExecuteReader());

			//save dt as xml
			dt.WriteXml(folder + @"\" + @"output.xml",XmlWriteMode.WriteSchema, false);

			Excel.Application excel_ = new Excel.Application();
			Excel.Workbook wb_ = excel_.Workbooks.Add(true);
			Excel.Worksheet ws_ = wb_.Worksheets[1];

			ws_ = wb_.Worksheets[1];


			//worksheet.Cells["A1"].LoadFromDataTable(dataToExcel, true,


			//passing datatable to array of objects dim to dim
			var data = new object[dt.Rows.Count+1, dt.Columns.Count+1];
			int drC = 0;
			int drR = 0;

			foreach(DataRow dr in dt.Rows)
			{
			drR = drR + 1;
			foreach(DataColumn dc in dt.Columns)
			{
			drC = drC + 1;
			data[drR, drC] = dt.Rows[drR-1][drC-1];
			}
			drC = 0;
			}

			var startCell = (Excel.Range)ws_.Cells[1, 1];
			var endCell = (Excel.Range)ws_.Cells[dt.Rows.Count + 1, dt.Columns.Count + 1];
			var writeRange = ws_.Range[startCell, endCell];

			//passing array of objects to excel list
			writeRange.Value2 = data;
			wb_.SaveAs(folder + @"\" + @"output.xlsx");

			wb_.Close();

			//read stored xml to datatable increases values if datatable not empty
			dt.ReadXml(folder + @"\" + @"output.xml");
			dt.WriteXml(folder + @"\" + @"output2.xml", XmlWriteMode.WriteSchema, false);

			oleCon.Close();

			}

			//Get current application folder console
			public void ApplicationFolder()
			{
			Application.StartupPath
			System.IO.Path.GetDirectoryName(
			System.Reflection.Assembly.GetExecutingAssembly().Location)
			AppDomain.CurrentDomain.BaseDirectory //Priority
			System.IO.Directory.GetCurrentDirectory()
			Environment.CurrentDirectory
			System.IO.Path.GetDirectoryName(
			System.Reflection.Assembly.GetExecutingAssembly().GetName().CodeBase)
			System.IO.Path.GetDirectory(Application.ExecutablePath)
			}

			//Get current application folder models
			public void Application folder()
			{
			AppDomain.CurrentDomain.GetData("DataDirectory").ToString();
			}

			//Get current application folder view
			public void Application_view()
			{
			HttpContext.Server.MapPath("~/App_Date/");
			}

			//using Interface IENUMERABLE for looping throught dates in list
			public void loopThroughDates()
			{

			public IEnumerable<DateTime> EachDay(DateTime from, DateTime thru)
			{
			for (var day = from.Date; day.Date <= thru.Date; day = day.AddDays(1))
			yield return day;
			}

			foreach(DateTime date in EachDay(startDate,finishDate))
			{
			DatesRequested.Add(date);
			}
			}

			//reads excel contents into datatable and stores it as xml
			public void readExceloledb()
			{

			public string oledbRequest = "SELECT F2,sum(F3) FROM [????1$] where F4 like '929%' or F4 like '959%' and F2 <> '' and F2 is not null group by F2 ";

			string conString = @"Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + fileToParse + ";" + "Extended Properties=" + "\"" + @"Excel 12.0;HDR=NO;TypeGuessRows=0;ImportMixedTypes=Text""";

			OleDbConnection oleCon = new OleDbConnection(conString);
			OleDbCommand oleCmd = new OleDbCommand(req, oleCon);
			DataTable dt = new DataTable("Output");

			oleCon.Open();

			//dt is datatable
			dt.Load(oleCmd.ExecuteReader());

			//save dt as xml
			dt.WriteXml(folder + @"\" + @"output.xml",XmlWriteMode.WriteSchema, false);

			}

			//reads datatable , convets it to excel array on worksheet and saves xlsx
			public void storeDatatableAsXLSX()
			{

			Excel.Application excel_ = new Excel.Application();
			Excel.Workbook wb_ = excel_.Workbooks.Add(true);
			Excel.Worksheet ws_ = wb_.Worksheets[1];

			ws_ = wb_.Worksheets[1];


			//worksheet.Cells["A1"].LoadFromDataTable(dataToExcel, true,


			//passing datatable to array of objects dim to dim
			var data = new object[dt.Rows.Count+1, dt.Columns.Count+1];
			int drC = 0;
			int drR = 0;

			foreach(DataRow dr in dt.Rows)
			{
			drR = drR + 1;
			foreach(DataColumn dc in dt.Columns)
			{
			drC = drC + 1;
			data[drR, drC] = dt.Rows[drR-1][drC-1];
			}
			drC = 0;
			}


			var startCell = (Excel.Range)ws_.Cells[1, 1];
			var endCell = (Excel.Range)ws_.Cells[dt.Rows.Count + 1, dt.Columns.Count + 1];
			var writeRange = ws_.Range[startCell, endCell];

			//passing array of objects to excel list
			writeRange.Value2 = data;
			wb_.SaveAs(folder + @"\" + @"output.xlsx");

			}



			//openXMLread
			public void openXML()
			{
			// open the document read-only
			SpreadsheetDocument document = SpreadsheetDocument.Open(fileName, false);
			SharedStringTable sharedStringTable = document.WorkbookPart.SharedStringTablePart.SharedStringTable;
			string cellValue = null;

			foreach (WorksheetPart worksheetPart in document.WorkbookPart.WorksheetParts)
			{
			foreach (SheetData sheetData in worksheetPart.Worksheet.Elements<SheetData>())
			{
			if (sheetData.HasChildren)
			{
			foreach (Row row in sheetData.Elements<Row>())
			{
			foreach (Cell cell in row.Elements<Cell>())
			{
			cellValue = cell.InnerText;

			/*
			try
			{
			if (cell.DataType == CellValues.SharedString)
			{
			Console.WriteLine("cell val: " + sharedStringTable.ElementAt(Int32.Parse(cellValue)).InnerText);
			}
			else
			{
			Console.WriteLine("cell val: " + cellValue);
			}
			}
			catch(Exception e)
			{
			if(e.Message=="Error in implicit conversion. Cannot convert null object.")
			{
			MessageBox.Show(e.Message);
			}
			}
			* */
			}
			}
			}
			}
			}
			document.Close();

			}


			//select max ID from list of classes
			public void LINQlogic()
			{
			//add list of objects to ienumerable
			IEnumerable<QueryTextNew> Queries =
			from QueryTextNew in querytextList
			select QueryTextNew;

			//select max ID catching empty element exception
			int itemsMax;

			try
			{
			itemsMax = Queries.Max(x => x.ID);
			}
			catch(Exception e )
			{
			itemsMax = 0;
			}

			}

			//creating procedure for dataset return
			public void oracleprocedurefordataset()
			{
			create or replace
			procedure get_daily(out_dt out SYS_REFCURSOR)
			AS
			BEGIN
			OPEN out_dt FOR SELECT * FROM neprintsev_ia.temp_acq_d where rownum <=10;
			END get_daily;
			}

			//get dataset from oracle procedure and store result datatable in xml
			public void datasetget()
			{

			string fileToParse = @"C:\test\daily\output\01022015report + fee2.xlsx";
			string oledbRequest = @"SELECT F5,F4,sum(F9) FROM [????1$] where F2 like '929%' or F2 like '959%' and F3 <> '' and F3 is not null group by F5,F4 ";
			string conString = @"Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + fileToParse + ";" + "Extended Properties=" + "\"" + @"Excel 12.0;HDR=NO;TypeGuessRows=0;ImportMixedTypes=Text""";

			string connString = @"Data Source=dwh.rs.ru;User ID=neprintsev_ia;Password=awsedrRDESWA;";
			string oracleQuery = "get_daily";

			OracleConnection oracleConn = new OracleConnection(connString);

			OracleCommand oracleComm = new OracleCommand(oracleQuery, oracleConn);
			oracleComm.CommandType = CommandType.StoredProcedure;
			DataSet orads = new DataSet();
			oracleComm.Parameters.Add("out_dt", OracleType.Cursor).Direction=ParameterDirection.Output;

			oracleConn.Open();
			oracleComm.ExecuteNonQuery();

			OracleDataReader reader =
			oracleComm.Parameters["out_dt"].Value as OracleDataReader;

			OracleDataAdapter oracleAdapt = new OracleDataAdapter(oracleComm);

			oracleAdapt.Fill(orads);

			foreach (DataTable dtt in orads.Tables)
			{
			dtt.WriteXml(Path.GetDirectoryName(fileToParse) + @"\" + @"f_output.xml", XmlWriteMode.WriteSchema, false);
			}


			}

			//populate datatable to excel for current rowcolumn number
			public void populatedatatble to excel()
			{

			public void populateDataTable(DataTable dt,Excel.Worksheet ws_,int x,int y )
			{
			var data = new object[dt.Rows.Count , dt.Columns.Count ];
			int drC = -1;
			int drR = -1;

			foreach (DataRow drr in dt.Rows)
			{
			drR = drR + 1;
			foreach (DataColumn dcc in dt.Columns)
			{
			drC = drC + 1;
			data[drR, drC] = dt.Rows[drR ][drC];
			}
			drC = -1;
			}


			var startCell = (Excel.Range)ws_.Cells[x, y];
			var endCell = (Excel.Range)ws_.Cells[x+dt.Rows.Count-1, y+dt.Columns.Count-1];
			var writeRange = ws_.Range[startCell, endCell];

			writeRange.Value2 = data;

			}

			}

			//copy as embedded cahrt to powerpoint (editable) with smoexecute
			public void copytopowerpoiny(){
			pptSlide.Application.CommandBars.ExecuteMso("PasteExcelChartSourceFormatting");
			}


			//copy as ambeded and select object in powerpoint
			public void powerPoint(){
			//chartobject
			ch.Copy();

			pptSlide.Application.CommandBars.ExecuteMso("PasteExcelChartSourceFormatting");
			Thread.Sleep(1000);
			var a = pptSlide.Application.ActiveWindow.Selection;

			a.ShapeRange.Left = 10;
			a.ShapeRange.Top = 10;
			a.ShapeRange.Height = 200;
			a.ShapeRange.Width = 200;
			}


			//JSON serialization
			//Read write to filestream using memorystream
			public void JSONserialize(){

			MemoryStream ms = new MemoryStream();
			DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(rQueries_ih));
			ser.WriteObject(ms, q);

			ms.Position = 0;

			using (FileStream fs = new FileStream(@"C:\test\insert\json.txt",
			FileMode.Create, System.IO.FileAccess.Write))
			{
			ms.WriteTo(fs);
			ms.Close();
			}

			using (FileStream fs = new FileStream(@"C:\test\insert\json.txt",
			FileMode.Open, System.IO.FileAccess.Read))
			{
			MemoryStream ms2 = new MemoryStream();
			byte[] bytes = new byte[fs.Length];
			fs.Read(bytes, 0, (int)fs.Length);
			ms2.Write(bytes, 0, (int)fs.Length);

			ms2.Position = 0;
			q2 = (rQueries_ih)ser.ReadObject(ms2);
			ms2.Close();
			}

			}


			//inheritance
			public Inheritance()
			{
			A:B:C:D
			void -> new (virtual)-> virtual -> override
			void -> virtual-> override -> override
			A : D(C) => A

			virtual -> new virtual -> override
			A:C(D) =>A

			A:B:C:D
			virtual -> override-> virtual -> override
			A(B):D => B, C(D):D => D

			A,B:A,C:A
			virtual -> new
			B:B => A
			virtual -> override
			C:C => C


			}

			//copy past excel range to powwerpoint
			public void CopyRangeEmbeded(xlNS.Range rn_, pptNS.Slide ptSld, pptNS.Shape sh)
			{

			rn_.Application.Visible = true;
			rn_.Worksheet.Activate();
			rn_.Select();
			rn_.Copy();
			ptSld.Select();
			sh.Select();

			//needs thread sleep activation - unstable
			/*
			Thread.Sleep(500);
			sh.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
			Application.DoEvents();
			*/

			//copy but with standart format
			//ptSld.Application.ActiveWindow.View.PasteSpecial();
			//ptSld.Application.ActiveWindow.View.Paste();


			//ptSld.Shapes.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault, Microsoft.Office.Core.MsoTriState.msoFalse, "", 0, "", Microsoft.Office.Core.MsoTriState.msoTrue);
			//ptSld.Shapes.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault,,,,,);

			//ptSld.Application.ActiveWindow.View.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault);


			//PasteDestinationTheme
			//PasteAsEmbedded
			//PasteSourceFormatting
			//PasteExcelTableSourceFormatting


			//powerpointApplication.ActiveWindow.View.PasteSpecial();

			//only working example with correct shape and format
			//worked after first type commenting
			try
			{
			sh.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
			}
			catch (Exception e)
			{
			Logger.LogAddDebug(e.Message);
			}

			//sh.Application.ActiveWindow.Selection.Unselect();
			//sl.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
			}

			//copy pasy excel sheet to powwerpoint
			public void CopyChartEmbeded(xlNS.Shape ch, pptNS.Slide sl, pptNS.Shape sh)
			{
			ch.Copy();
			sl.Select();
			sh.Select();

			//paste as link
			//pptSlide.Shapes.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault, Microsoft.Office.Core.MsoTriState.msoFalse, "", 0, "", Microsoft.Office.Core.MsoTriState.msoTrue);
			//sh.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
			//sh.Application.ActiveWindow.Selection.Unselect();
			//sl.Application.CommandBars.ExecuteMso("PasteSourceFormatting");

			try
			{
			sl.Application.CommandBars.ExecuteMso("PasteExcelChartSourceFormatting");
			}
			catch (Exception e)
			{
			Logger.LogAddDebug(e.Message);
			}
			//Thread.Sleep(1000);
			var a = sl.Application.ActiveWindow.Selection;
			}

		}
			
			}
			public SystemReflectionEmit()
			{
using System.Reflection.Emit;
namespace NS
{
DynamicMethod dm = new DynamicMethod("A", typeof(int),new Type[]{typeof(int)});
}
			}
		
		}
			
			public void SB()
			{
				
				/// <summary>
				/// Char arrays rearrange (arrays gaps error)
				/// </summary>
				public static class FormatRearrange
				{       

					public static void StringsCheck()
					{

						//string r1 = Rearrange("{0}{1} {3}"); //OK "{0}{1} {2}"
						//string r1 = Rearrange("{0}{2} {3}"); // OK "{0}{1} {2}"
						//string r1 = Rearrange("{0}{0} "); // OK "{0}{1}"
						//string r1 = Rearrange("{0} {0} {0}"); //OK "{0} {1} {2}"
						//string r1 = Rearrange("{0} {3} {2}{5}"); //OK "{0} {1} {2}{3}"            
						//string r1 = Rearrange("{1}"); //OK "{0}"
						//string r1 = Rearrange("{2} {7}:{0} / {3}"); //OK "{0} {1}:{2} / {3}"
						//string r1 = Rearrange("{10}{10}{10}"); //OK "{0}{1}{2}"
						//string r1 = Rearrange("{10}{0}{2}");
						//string r1 = Rearrange("{0}:{1}/{2}/{3}/{4}/{0} {1} {2} {3} {4}");
						//string r1 = Rearrange("{0}:{1}/{2}/{3}/{4}/{0} {1} {2} {3} {0} {1}");

						string rVar = Rearrange("{0}{1} {2} {3}{4}/{5}:{6}{7} {8}"); //OK "{0}{1} {2} {3}{4}/{5}:{6}{7} {8}"
						string rZeroToTen = Rearrange("{0}:{1}/{2}/{3}/{4}/{0} {1} {2} {3} {0} {1}");
						string r40 = Rearrange("{0} {1} {2} {3} {4} {5} {6} {7} {8} {9} {10} {11} {12} {13} {14} {15} {16} {17} {18} {19} {20} {21} {22} {23} {24} {25} {26} {27} {28} {29} {30} {31} {32} {33} {34} {35} {36} {37} {38} {39} {40}");

					}

					public static string Rearrange(string input_)
					{

						string result = input_;
						char[] chr = input_.ToCharArray();
						int lng = chr.Length;
						
						char[] prevDigit = null;
						char[] currDigit = null;
						char[] insDigit = null;

						int i2 = 0;

						for (int i = 0; i < lng; i++)
						{
							i2 = i;
							if (char.IsDigit(chr[i2]))
							{
								if (i2 + 1 < lng)
								{
									while (char.IsDigit(chr[i2 + 1]))
									{
										i2++;
									}
								}

								if (prevDigit==null)
								{
									currDigit = ChArrFill(i, i2, chr);
									if (charArrToInteger(currDigit) != 0)
									{
										insDigit = intToCharArr(0);
										prevDigit = insDigit;
										char[] chrN = InsertDigitInPosition(insDigit, chr, i, currDigit.Length);
										result = new string(chrN);
										chr = chrN;
										lng = chr.Length;
									}
									else { prevDigit = currDigit; }

								}
								else
								{
									currDigit = ChArrFill(i, i2, chr);
									if (!check(currDigit, prevDigit))
									{
										insDigit = intToCharArr(charArrToInteger(prevDigit) + 1);
										char[] chrN = InsertDigitInPosition(insDigit, chr, i, currDigit.Length);
										prevDigit = insDigit;

										/*
										char[] chrN = new char[chr.Length + currDigit.Length - prevDigit.Length];

										for (int i4 = 0; i4 < i; i4++)
										{
											chrN[i4] = chr[i4];
										}
										for (int i4 = i; i4 <= i2; i4++)
										{
											chrN[i4] = currDigit[i4-i];
										}
										for (int i4 = i2+1; i4 < lng; i4++)
										{
											chrN[i4] = chr[i4];
										}
										*/

										result = new string(chrN);
										chr = chrN;
										lng = chr.Length;
									}
									else { prevDigit = currDigit; }
								}
								if (prevDigit != null)
								{
									i += prevDigit.Length - 1;
								}
							}
						  
						}
					
						return result;
					}     

					static char[] InsertDigitInPosition(char[] insDigit_,char[] fromArr_,int pos_, int curDigitLen_)
					{
						char[] toArr=new char[fromArr_.Length+insDigit_.Length-curDigitLen_];
						int arrGap= toArr.Length-fromArr_.Length;
						//before position copy
						for (int i4 = 0; i4 < pos_; i4++){
							toArr[i4] = fromArr_[i4];}
						//position copy num length
						for (int i4 = pos_; i4 <= (pos_+insDigit_.Length-1); i4++){
							toArr[i4] = insDigit_[i4 - pos_];}
						//after position copy from num length + arrrays gap
						for (int i4 = (pos_+insDigit_.Length-arrGap); i4< fromArr_.Length; i4++){
							toArr[i4+arrGap] = fromArr_[i4];}
						return toArr;
					}
					static int charArrToInteger(char[] arr_)
					{
						int res = 0;
						int i = 1;
						for (int i2 = arr_.Length - 1; i2 >= 0; i2--)
						{
							res += (int)(char.GetNumericValue(arr_[i2]) * i);
							i *= 10;
						}
						return res;
					}
					static char[] intToCharArr(int i_)
					{
						return i_.ToString().ToCharArray();
					}
					static char[] intRecount(char[] currDig_, char[] prevDigit_)
					{
						if (charArrToInteger(currDig_) == charArrToInteger(prevDigit_) + 1)
						{
							return currDig_;
						}
						else
						{
							return intToCharArr(charArrToInteger(prevDigit_) + 1);
						}
					}
					static bool check(char[] currDig_, char[] prevDigit_)
					{
						if (charArrToInteger(currDig_) == charArrToInteger(prevDigit_) + 1)
						{
							return true;
						}
						else
						{
							return false;
						}
					}
					static char[] ChArrFill(int i_, int i2_, char[] chFrom_)
					{
						char[] chTo_ = new char[(i2_ - i_) + 1];

						for (int i3_ = 0; i3_ <= (i2_ - i_); i3_++)
						{
							chTo_[i3_] = chFrom_[i_ + i3_];
						}
						return chTo_;
					}
					
				}    
				
			}
	
	}

    public class External_Libraries()
    {
          
    //reading excel
    http://epplus.codeplex.com/
    //Entity Framework extensions
    http://entityframework-extensions.net/
    //nUnit
    https://github.com/nunit/nunit
    
    
    
    }

    public class IssuesErrors()
    {

      //Issues\Errors
      public void .NET()
      {
      
        public CannotFindObject()
        {
        WHEN:
        incorrect connection string in : DbContext initialization parameters

        WHAT:
        Cannot find the object because it does not exist or you do not have permissions

        HOW:
        correct DbContext initialization
        }

        public ReferencePermissionWasDenied()
        {
        WHEN:
        migrating with code first model, with navigation properties and collection.
        Creating foreign key, constraint.

        WHAT:
        error:
        the reference permission was denied on the object '' database '', schema ''
        Cannot find the object '' because it does not exist or you do not have permissions
        could not create constraint.

        HOW:
        simle:
        (trying to migrate one after another commenting out not works - migrates both simultaneosly )
        create table with primary key. In sql manager give to users pemission rights
        Create table with collection.

        correct:
        change model to correct collection - navigation property. Collection in parent,
        foreign key with patent item property in child
        grant privilages
        use DWH_REPLICA;
        grant references To guest;
        go
        }

        public MethodFunctionNotFound()
        {
        WHEN:
        no EF in project referencing repository project

        WHAT: update EF
        }

        public System.Security.SecurityException()
        {
          WHEN:
          while windows service with InstallUtil.exe installation
          
          WHAT:
          Syste.Security.SecurityException
          
          WHOW:
          start console with administrative
        }
        
        public WCFhttpREGerror()
        {
          
          WHAT:
  Протоколу HTTP не удалось зарегистрировать URL-адрес http://+:8000/Service1/. Текущий процесс не имеет прав доступа к этому 
  пространству имен (подробнее см. на веб-странице http://go.microsoft.com/fwlink/?LinkId=70353)
          
          WHEN:
  WCF service under console host
            
          HOW:
  recommended to register port:
  netsh http add urlacl url=http://+:8000/ServiceModelSamples/Service user=mylocaluser
          OR 
          start VS under admin 
        }
        
        public WCFCannot_btain_etadata_rom()
        {
          WHAT:
          Error: Cannot obtain Metadata from http://localhost:57495/WCF2.svc If this is a Windows (R) Communication Foundation service to which you have 
  access, please check that you have enabled metadata publishing at the specified address.
          WHEN:
            testing wcf.svc from VS
          HOW:
            NOT enough memory free 
          OR: 
            
          
        }
      
       
			public MethodFunctionNotFound()
			{
			WHEN:
			no EF in project referencing repository project

			WHAT: update EF
			}

			public System.Security.SecurityException()
			{
			  WHEN:
			  while windows service with InstallUtil.exe installation
			  
			  WHAT:
			  Syste.Security.SecurityException
			  
			  WHOW:
			  start console with administrative
			}
			
			public WCFhttpREGerror()
			{
			  
			  WHAT:
		Протоколу HTTP не удалось зарегистрировать URL-адрес http://+:8000/Service1/. Текущий процесс не имеет прав доступа к этому 
		пространству имен (подробнее см. на веб-странице http://go.microsoft.com/fwlink/?LinkId=70353)
			  
			  WHEN:
		WCF service under console host
				
			  HOW:
		recommended to register port:
		netsh http add urlacl url=http://+:8000/ServiceModelSamples/Service user=mylocaluser
			  OR 
			  start VS under admin 
			}
			
			public WCFCannot_btain_etadata_rom()
			{
			  WHAT:
			  Error: Cannot obtain Metadata from http://localhost:57495/WCF2.svc If this is a Windows (R) Communication Foundation service to which you have 
		access, please check that you have enabled metadata publishing at the specified address.
			  WHEN:
				testing wcf.svc from VS
			  HOW:
				NOT enough memory free 
			  OR: 
				
			  
			}
		  
			public sgen_exe()
			{
			  sgen.exe exited with code 1
			  //xml serialization turn off project options->build->xml 

			  }

        public void SSAS()
        {
          
          ///Installation
          ///Donload instal SSDT from MS VS
          ///Create Analysis services projects from VS templates
        
          public void Impersonation()
          {
            
            WHEN:
            While trying to proccess any item of olap cube from VS to create new database
            
            WHAT:
            Severity	Code	Description	Project	File	Line	Suppression State
            Error		?????????????? ??????????: ???????? ????????? ??? ??????? ImpersonationInfo. ???? ???????? ImpersonateAccount ???????????? ?????? ImpersonationInfo, ???????? Account ?? ????? ???? ??????.			0	
            
            HOW:
            in datasourses name rightclick ViewDesigner, in Impersonation Information input credentials
                  
          }
        
          public void Database NameChange()
          {
            
            WHEN:
            
            WHAT:
            change olap database name
            
            WHOW:
            rtclck project properties - > deployment
            
          }
          
          public void DimensionProcessError()
          {
            
            WHEN:
            connecting via wrong login (Datasource base login instead of OLAP base)
            
            WHAT:
            cannot connect to database while login 
            
            WHOW:
            change credentials
            
          }
                
        }
        
		public XunitTestDebugNotThrowsException()
		{
			WHAT;
				files .cs not found thrown bu Xunit
			WHEN:
				while code under test throws error for Xunit, when
				exception must be thrown , some files .cs not found thrown instead
			HOW:
				Tolos->Import And export settings-> reset all settings
		}
		
      }	
    
      
    }
    
  
		
	#endregion 	
	
	#region C++ 

	public Code theory
	{
		
		Escape characters{
			\n //new line
			\r //carriage return
			\t //tab
			\\ //backslash \
			\" quotation "
		}
		
		Operators
		{
			a %= b //a = a % b; 1 = 5/2;
			
			((cond) ? "true" : "false"); // ((i>2) ? "yes" :: "no");
			
			//pointers declaration
			int* a;
			int *a;
								
		}
		
		Structures
		{
			
			class enum Name 
			{
				T field
				,T2 field2
			};
			
			struct Name{
				T field;
				T2 field2;
			};		
			
			Pointers {
				//pointers with int address initialize
				int b=0;
				//&b - > address of b
				a=&b;
				//*a - > get pointed variable value with Dereference Operator
				
				char* pstr ;
				
				//Pointer addresses substraction
				char buffer[50];
				char* pbuffer = &buffer[0];
				while(*pbuffer){pbuffer++};
				int sbstr = pbuffer - buffer;
				
				double bean[3][4];
				double* pbean = &bean[0][0];
				double pb = *(*(bean+0)+0);
				double pb2 = *(bean[1]+2);
				double pb3 = *(bean+1)[2];
				double pb4 = (*(bean+1))[2];

				*(*(arr+i)+j)
			}
												

		}
		
		arhitecture{
			
			namespaces{
				//Use ms namespace foo function
				ms::foo();
				//using custom namespace function
				return ms::return_zero();
			}
		
		}
	}

	public Code Examples
	{
		
		HowTo's
		{		
			sample_empty{
				
				//standart minimum include for cout
				#include <iostream>

				//namespace initialization
				using namespace std;

				int main()
				{
					cout << "HW";
					return 0;
				}
			}							
			
			
		}
		
		[class boilerplates



	//<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

	
	
		]
		
	}

	#endregion	
	
	#region JS5

	//js templates
	public void JS_templates()
	{
		public void JSLibs(){
			
			//awasomplete
			http://leaverou.github.io/awesomplete/
			//promitive.js
			https://ondras.github.io/primitive.js/
			//metro js
			http://www.drewgreenwell.com/projects/metrojs
			//treant js
			http://fperucic.github.io/treant-js/

		}
		public void Unsorted(){
	$(document).ready(function(){

	$(function () {
	var data = [50, 90, 30, 10, 70, 20];
	var w = 500;
	var h = 100;
	var svg = d3.select("#barChart")
	.attr("width", w)
	.attr("height", h);

	svg.selectAll("rect")
	.data(data)
	.enter()
	.append("rect")
	.attr("x", function (d, i) {
	return i * 21; //Bar width of 20 plus 1 for padding
	})
	.attr("y", function (d) {
	return h - d; //Height minus data value
	})
	.attr("width", 20)
	.attr("height", function (d) {
	return d; //Just the data value
	})
	.attr("fill", function (d) {
	return "rgb(0, 0, " + (d * 3) + ")";
	});
	});

	$("#GO").click(
	function () {

	//load data from Json action
	//$.getJSON("/Home/GetJson", databind);

	$.getJSON("GetJson", databind);

	//add d3 container
	var tableDiv = d3.select('body').append('div').attr('id', 'tableDiv').attr('class', 'table table-hover');
	console.log("Added container : ", tableDiv);

	//bind data from callback
	function databind(data) {
	console.log(data);

	var data3 = JSON.parse(JSON.stringify(data));
	console.log(data3);

	tabulate(data3, ['DT_REG', 'PAY_SYS', 'AMT']);

	};

	 

	}
	);


	});

	function tabulate(data, columns){
	console.log('Started tabulate for ', data);
	var table = d3.select('body').append('table').attr('id', 'tabulated').attr('class', 'table table-hover');
	var thead = table.append('thead');
	var tbody = table.append('tbody');

	// append the header row
	thead.append('tr')
	.selectAll('th')
	.data(columns).enter()
	.append('th')
	.text(function (column) { return column; });

	// create a row for each object in the data
	var rows = tbody.selectAll('tr')
	.data(data)
	.enter()
	.append('tr');

	// create a cell in each row for each column
	var cells = rows.selectAll('td')
	.data(function (row) {
	return columns.map(function (column) {
	return { column: column, value: row[column] };
	});
	})
	.enter()
	.append('td')
	.text(function (d) { return d.value; });

	return table;
	}
		}
		
 public void Templates(){
			
			public void select2Template(){
				
var data_arr={};

function query_cleverence(processF,bindF){

	var restServerURL = "http://10.31.14.76/cleverence_ui/hs/IntraService/location/full"; 
	
	$.ajax({
	  type:"GET",
	  url: restServerURL ,
	  accepts: "application/json",
	  dataType:"json",	 	 	  
	  success: function(data, xhr, textStatus){
					 
		console.log("query_cleverenceSt")
		data_arr = processF(data);
		//console.log(data_arr);
		bindF('#input1');
		return data_arr;
		
	  },
	  error:function(jqXHR, textStatus, errorThrown){
					   alert(errorThrown);
	  }
	});
}

function processData(data){
	console.log('processData');
	var res = Object.keys(data).map(function(k) { return { id: data[k].GUID, text: data[k]["Адрес"] } });
	//console.log(res);
	return res;
}
function bindSelect2ToItem(item){
	var dt =[];	
	console.log("bindSelect2ToItem");
	$(item).select2({data: data_arr});	
}	

function registerSelect2(item,placeholder){
	$(item).select2({
		placeholder: placeholder,
		minimumInputLength: 3
	});
}
function registerSelect2Data(item)
{
	console.log("dt2 change");
	$(item).select2({data:data_arr});
}
function registerSelect2_FIO(item,placeholder){
	$(item).select2({
		tags: false,
		minimumInputLength: 3,
		placeholder: placeholder,
		language: "ru",
		ajax: {
			url: 'http://msk1-vm-inapp01.nspk.ru:81/api/structure/searchperson/',
			headers: {
					"authorization": "Basic cm9vdDptUiVtekpVR3ExRQ=="
				},
			dataType: "json",
			type: "GET",
			data: function (params) {

				var queryParameters = {
					p2: params.term
				}
				return queryParameters;
			},
			processResults: function (data) {
					console.log(data);
				return {
				
					results: $.map(data, function (item) {
						return {
							text: item.label ,
							id: item.login
						}
					})
				};
			}
			
		}
	});
}



function FireAndRegister(){
	query_cleverence(processData,bindSelect2ToItem);	
	registerSelect2("#input1",'Поиск GUID по адресу');
	registerSelect2Data("#input1");
	registerSelect2_FIO("#input2",'Поиск ФИО из 1С');
}

$(document).ready(function(){
	
	//console.log("Doc ready started")
	FireAndRegister()	
	
	// $("#input1").on("select2:focus", function(e) { console.log ("focus");})
	// .on("select2:selecting", function(e) { console.log ("selecting");})
	// .on("select2:highlight", function(e) { console.log ("highlight");})
	// .on("select2:change", function(e) { console.log ("change");})
	// .on("change", function(e) { console.log ("change2");})
	// .on("select2-blur", function(e) { console.log ("blur");})
	// .on("select2:blur", function(e) { console.log ("blur2");})
	
	//$("#input3").mouseenter(function(e){  registerSelect2Data("#input1"); console.log("mouseenter");})
	//$('.select2-search__field').on('keyup',function(e){  console.log("hover"); })
	//console.log("Doc ready finished")
	
});


			}
			
			public void CallBackSample1(){
											
				function f1(a,b){
					console.log("F1 " + a);
					b(a);
				};
				function f2(c)
				{
					console.log("F2 " + c);
				};

				function f3(a,b){
					console.log("F3 " + a);	
				};
				function f4()
				{
					console.log("F4 cb");
				};

function callbk(a,b){b(a);}
function cl(a){console.log(a);}
function fnameToPrint(){}
//>>>callbk(fnameToPrint,cl);

			}
			
			public void CallBackSample2(){
	function cl(){ return "cl"; }

	function ret(a){ return a; }

	function cla(b){ return ret(b); }

	function call_cl(){
		return cl();
	}
	function call_ret(){
		return ret("ret");
	}
	function call_cla(){
		return cla("cla");	
	}

	function call_cl_a(){
		setTimeout ( function(){return cl();},1000);
	}
	function call_ret_a(){ 
		setTimeout ( function(){return ret("ret");},1000);
	}
	function call_cla_a(){
		setTimeout ( function(){return cla("cla");	},1000);
	}

	function sync_call() {
		clog(call_cl());
		clog(call_ret());
		clog(call_cla());
		
	};
	function async_call() {
		
			
		clog(call_cl_a());
		clog(call_ret_a());
		clog(call_cla_a());
	};

	function clog(a){ console.log(a); }

	$(document).ready(function(){
		console.log("Doc ready started")
		async_call();
		sync_call();
		console.log("Doc ready finished")
		
	});

			}
			
			public void Clousures(){
				
var x = "abovec";

function placeElement(e,v){
	v(e);
}
function log(e){
	console.log(e);
}
function mult(i_){
	for(i=0;i<i_;i++)
	{
		console.log(i);
	}
}

//self containing clousure
var z = (function(){return function(){console.log(z)}})();
//minimal closure
var a = (function(){
	return function () {
		return console.log("a");
	}
})();
//parametrized closure 
//can be used for function text exposure
var b = (function(d){
	return function (d) {
	return console.log(d);
	}
})();
//clousure exmpl
var add = (function(){
    var counter = 0;
    return function(){ console.log(counter); return counter += 1;}
})(); 

$(document).ready(function(){
	console.log("Document ready st");
	add();
	a();
	b(a);
	b(b);
	z();
	console.log("Document ready fn");
})

			}
						
			public void Callbacks(){
				
				
function log(a){console.log(a)}

//callback
function a(n){return function(b){console.log("A->" + n + " B->" + b)}}
//function callback
function L1(l1){return function(L2){ l1(L2); }}

//function reference callback
function cond1(a,b)
{
	if(a){ b() ;}
}
function ex(a,b)
{
	for(var i=0;i<a;i++)
	{
		b(i);
	}
}

var a_ = a("A1");


$(document).ready(function(){
	console.log("Document ready st");	
	a_();
	a_("B1");
	a("C1")("D1");
	
	L1(log)("L2");
	
	//condition callback
	cond1(5>2,function(){log(5)});
	
	//repeat callback
	ex(3,function(n){log(n);});
	
	//repeat from condition callback
	ex(5,function(n){
		cond1(n%2,function(){
			log(n);
		})
	});
	
	console.log("Document ready fn");
	
})


				
			}
			
		public void Examples()
		{
			
			public void Select2OnInter03(){
				
								
				var data_arr={};

				function query_cleverence(processF,bindF,item){

					var restServerURL = "http://"; 
					
					$.ajax({
					  type:"GET",
					  url: restServerURL ,
					  accepts: "application/json",
					  dataType:"json",	 	 	  
					  success: function(data, xhr, textStatus){
									 
						console.log("query_cleverenceSt")
						data_arr = processF(data);
						//console.log(data_arr);
						bindF(item);
						return data_arr;
						
					  },
					  error:function(jqXHR, textStatus, errorThrown){
									   alert(errorThrown);
					  }
					});
				}

				function processData(data){
					console.log('processData');
					var res = Object.keys(data).map(function(k) { return { id: data[k].GUID, text: data[k]["Адрес"] } });
					//console.log(res);
					return res;
				}
				function bindSelect2ToItem(item){
					var dt =[];	
					console.log("bindSelect2ToItem");
					$(item).select2({data: data_arr});	
				}	

				function registerSelect2(item,placeholder){
					$(item).select2({
						placeholder: placeholder,
						minimumInputLength: 3
					});
				}
				function registerSelect2Data(item)
				{
					console.log("dt2 change");
					$(item).select2({data:data_arr});
				}
				function registerSelect2_FIO(item,placeholder){
					$(item).select2({
						tags: false,
						minimumInputLength: 3,
						placeholder: placeholder,
						language: "ru",
						ajax: {
							url: 'http://',
							dataType: "json",
							type: "GET",
							data: function (params) {

								var queryParameters = {
									p2: params.term
								}
								return queryParameters;
							},
							processResults: function (data) {
									console.log(data);
								return {
								
									results: $.map(data, function (item) {
										return {
											text: item.label ,
											id: item.login
										}
									})
								};
							}
							
						}
					});
				}

				function ChangeNodeToSelect(d)
				{
					var f1 = $(d);
					var f2 = f1.clone();
					
					console.log(f1);
					console.log(f2);
					
					var attrs = { };

				$.each($(d)[0].attributes, function(idx, attr) {
					attrs[attr.nodeName] = attr.nodeValue;
				});



				$(d).replaceWith(function () {
					return $("<select />", attrs).append($(this).contents());
				});

					
				}


				function ItemCSS(item)
				{
					$(item).css({'width':'500px'});
					
				}


				function registerSelectByID(item1,item2)
				{
					console.log("registerSelectByID" + "st");
					query_cleverence(processData,bindSelect2ToItem,item1);	
					ChangeNodeToSelect(item1);
					ChangeNodeToSelect(item2);
					registerSelect2(item1,'Поиск GUID по адресу');
					registerSelect2(item2,'Поиск по ФИО');
					registerSelect2Data(item1);
					registerSelect2_FIO(item2,'Поиск ФИО из 1С');
					ItemCSS(item1);
					ItemCSS(item2);
					console.log("registerSelectByID" + "fn");
					
				}

				function registerSelectByIDOne(item1)
				{
					console.log("registerSelectByIDOne" + "st");
					query_cleverence(processData,bindSelect2ToItem,item1);	
					ChangeNodeToSelect(item1);
					registerSelect2(item1,'Поиск GUID по адресу');
					registerSelect2Data(item1);
					ItemCSS(item1);
					console.log("registerSelectByIDOne" + "fn");
					
				}

				function FireAndRegister(){
					
						
					var EqId1="#field4114";
					var FIOId1="#field4112";	
					
					var EqId2="#field4108";
					var FIOId2="#field4110";	
					
					var EqId3="#field4107";
					var FIOId3="#field4104";
					var FIOId32="#field4109";
					
					try{
						registerSelectByID(EqId1,FIOId1);
					}catch(e)
					{
						console.log('1lvlfl')
					}
						
					try{
						registerSelectByID(EqId2,FIOId2);
					}catch(e)
					{
						console.log('2lvlfl')
					}
					
					try{
						registerSelectByID(EqId3,FIOId3);
					}catch(e)
					{
						console.log('3lvlfl')
					}
					
					
					try{
						//registerSelectByIDOne(FIOId32);
					}catch(e)
					{
						console.log('32lvlfl')
					}
					
				}


				$(document).ready(function(){
					
					//console.log("Doc ready started")
					FireAndRegister()	
					
					// $("#input1").on("select2:focus", function(e) { console.log ("focus");})
					// .on("select2:selecting", function(e) { console.log ("selecting");})
					// .on("select2:highlight", function(e) { console.log ("highlight");})
					// .on("select2:change", function(e) { console.log ("change");})
					// .on("change", function(e) { console.log ("change2");})
					// .on("select2-blur", function(e) { console.log ("blur");})
					// .on("select2:blur", function(e) { console.log ("blur2");})
					
					//$("#input3").mouseenter(function(e){  registerSelect2Data("#input1"); console.log("mouseenter");})
					//$('.select2-search__field').on('keyup',function(e){  console.log("hover"); })
					//console.log("Doc ready finished")
					
				});


				
			}
			
		}
	
	}
	//JS vendors
	public void JSvendors()
	{
	<!--Links from vendors JQuery, jQyery UI, Bootstrap, D3 + styles-->
	<!--
	<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
	<link rel="nofollow" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/themes/smoothness/jquery-ui.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js"></script>
	<script type="application/javascript" charset="utf-8" src="http://d3js.org/d3.v3.min.js"></script>
	<link rel="nofollow" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	-->
	}

	}
	//----------------------------------------------	
	
	public void Angular_IO()
	{
		
		links[
		
https://ng-bootstrap.github.io/#/getting-started
https://angular.io/guide/setup-systemjs-anatomy
//jquery include
https://medium.com/@swarnakishore/how-to-include-and-use-jquery-in-angular-cli-project-592e0fe63176

		]
		
		public void CMD_commands(){
			
			
			//create new project 
			ng new my_app
			//Open project
			ng serve --open
			
			//default in app/app7
			ng new module app7			
			ng g component app7 --flat
			
			ng g model --flat
			//flat by default
			ng g service
							  
   
			//bootstrap install
			npm install --save @ng-bootstrap/ng-bootstrap
			
			//material design
			//https://material.angular.io/guide/getting-started
			npm install --save @angular/material @angular/cdk
			npm install --save @angular/animations
			
			npm install -g @angular/cli
			npm install --save @angular/core -g
			npm install --save @angular/common -g
			npm install --save @angular/forms -g
			npm install --save @ng-bootstrap/ng-bootstrap -g
   
			boilerplate[			
				ng new App1
				cd ./app1/
				ng g component app1 --flat
				cd ./app1/src/
				ng g component menu
			]
			
		}
  
		public void Descriptions(){

componentModuleShema[
   
	

	component {}
	//new components added to app.component.html, index.html
	.ts;.html;.css
	metadata ...
	template <>
		
	{}-{{values}}-><>
	{}-[className]=""-><{}>
	<>-(event)="value"->{}	
 			 
	
	binings{
		
	https://angular.io/guide/template-syntax#aliasing-io
	
	datasource to view
	{{expression}}
	[target]="expression"
	bind-target="expression"
	
	view to datasource 
	(target)="statement"
	on-target="statement"
	
	two-way
		Event and property
		[(ngModel)]=""
	
	inject
		class ChildCL{}
		//import { Injectable }       from '@angular/core';
		//@Injectable()	
		class ParentCL {getCh(){return c ChildCL;}}
		
		@Component{
			import {ParentCL}
			,providers[ParentCL]
		}
		
		qt: any;		
		contructor(sr: ParentCL){
			qt=sr.getCh();
		}
	
  
 
		{{}} <- values from component.ts CL
		[]=""/{{}} <- html element value bind to value/property
		
		//bind class
		<button [disabled]="isUnchanged">Cancel is disabled</button>
				
		//pass model to html element, bind model to html element selector
		<component selector [class]="classname from component"><> <-
			
		//bind event 
		<button (click)="onSave()">Save</button>
		<button on-click="onSave()">On Save</button>
				target event
				
		//bind DOM event
		<input [value]="currentHero.name"
		(input)="currentHero.name=$event.target.value">
		
		//pass model and event to template
		<template_name_ [variableInTemplate_]="variablePassedFromComponent" (parentComponentAction)="childcompponentAction($event)></<template_name_>		
		
		event{
			
			template.html[method to event bind]{
				<button (click)="delete()">Delete</button>
			}
			
			component.ts[method calls eventproperty emmit ]{
				deleteRequest = new EventEmitter<Hero>();

				delete(){
					this.deleteRequest.emit(this.hero);
				}
			}
			
  
			component.html[eventemmiter to method bind ]{
				<app-hero-detail (deleteRequest)="deleteHero($event)" [hero]="currentHero"></app-hero-detail>
			}
			
		}
	
		InjectService[
			
			Service[

				import { Injectable } from '@angular/core';				
				//for HttpRequests 
				import { HttpClient, HttpHeaders , HttpResponse} from '@angular/common/http';
				//for http responses
				import {Observable} from 'rxjs/Observable';
				
				@Injectable()
				export class HttpCL {
					//Http constructor
					constructor(private http: HttpClient){}
									
				}
			
			]
			
			Inject[

				@Component({...,providers: [ServiceClass]})				
				Constructor(private _service:ServiceClass){}

			]
			
		]
		
		Http[
			
			service[
				@Injectable()
				export class HS {
				
				get(url_:string){
					return this.http.get<T>(url_);
				}
				
			}
			]
			component[
				@Component({
					,providers: [ HS ]
				})
				constructor(private hs_:HS){}
				get(){
					this.hs_.get(url_)
					.subscirbe(
						r=>{
							console.log(r);
							this.arr=r;
						}
					)
				}
			]
		]
	
	}
	

]

boilerplateReferenceShema[

	{main.ts}-
	[import { AppModule2 } from './app/app.module';... bootstrapModule(AppModule2)]
	->{.module.ts}-
	[
	import { AppComponent2 } from './app2.component';
	import { ClickMeComponent } from '../click/click_me.component';
	...
		declarations: [
			AppComponent2,ClickMeComponent
		]
	]
	->{.component.ts{selector(<app-root>),template,css}}
	<-[selector(<app-root>)]-index.html(.ts,.html,.css)
	{.html}<-[selector(<click-me>)]-{.component(.ts(selector(<click-me>)),.html)}
	
]
	
modulesReference[


	ng_module:{
		question.service.ts{exports:CL}
		,app.component.ts{
			@component(links between html templates and services)({
				service:servise.ts{imports:CL};
				ref:selector to html:template{
					links to other components selectors
					
				};
			)}
			exports:CL2;
		}
		,app.module.ts{
			imports:CL2; 
			exports{AppModule}
		}
		,components{
			
		}
	}


	main.ts{imports:AppModule,}
	index.html{selector:ngModule component html}


]

	child_to_parent_with_event_shema
	{
//Component child parent binding with events
Child
html -> action=method
ts -> @output outEm=EventEmitter<>(), method(){this.outEm.emit();}
Parent
ts -> method($event){} 
html -> <childHtml (outEm)="method($event)">
	}
	
		}
  
		public void Examples(){
			
			dropdownSlect[
				<select  #selectedCategory (change)="typeChange(selectedCategory.value)">
				<option *ngFor="let qt of answerTypes_.types_" [value]="qt.type" >{{qt.name}}</option>
				</select>
			]
			bootstrapDropDown(){
				
<div ngbDropdown>
	<button class="btn btn-outline-primary" id="dropdownMenu3" ngbDropdownToggle>Toggle</button>
	<div class="dropdown-menu" aria-labelledby="dropdownMenu3" ngbDropdownMenu>
		<button class="dropdown-item">Action - 1</button>
		<button class="dropdown-item">Another Action</button>
		<button class="dropdown-item">Something else is here</button>
	</div>
</div>
			}
			
	  TemplateDrawRowColumn{
						
  <div class="row">
    <div class="col-sm-4" *ngFor="let bt_ of _buttons.collection.array">
         <app-click [button_]="bt_" [obj_]="_obj"></app-click>
    </div>
  </div>
			
			}
		}
	
		 	public void TipsAndTricks{
			
			generateTemplateIncolumns[
			
				When template draws in *ngFor block, to correctly placing in bootstrap columns
				fake nested row must be inserted
				
				<row>
					{{modelItem}}
					
					//nested template
					<listTemplate>
					
						*//nested template code
						<row>
							<ng-container *ngFor>
								<div class="col-sm">
								</div>
							</ng-container>
						</row>
					</listTemplate>
				</row>
			
			]
			
			Css[
				component based css is on component scope only
				rogect scope css in main styles.css need to be placed 
				
				@import './assets/common.css';
			]
		
			neutralPlaceholderForDOM[
				<ng-container></ng-container>
			]
			
			multiSubscription[
				several instances of one Template, is subscribed to one action, would multiple it.
				if several templates generated, all of them would be triggered with one action?
				not "clicked" only.
			]
			
			JS_CSS_Libs[
				tricky js include via .angular-cli.json block => scripts['assets/svg.js']
				tricky import => import * as f from "assets/svg.js"
				not all js functions visible from ng DOM components. vanila component nedded => <div> not <div *ngFor|*mgIf>
				jquery inited, but tricky usage with component return $ => return $
				multiple bootstrap libs more reality trick not angular => vanilla,ng,mdb [
					https://getbootstrap.com ,
					https://ng-bootstrap.github.io,
					https://mdbootstrap.com
				]
				datetime pickers only in ng and very fucked up
				glyphicons ignore event with fonts folder include
			]
			
			typeAttributeBinding[
				to get <input type="checkbox" checked>
				<input type="{{item.cssType}}" [checked]="item.checked_">
			]
			
			NgMOdelOverridsHtmlAttr[
			inpyt type="textbox" - > binding [(ngModel)]="val" overrides any placeholders value attr
			]
		}
	}
	
	public void TypeScript
	{
		
		npm[
		
			npm install -g typescript-collections --save
			//compile 
			tsc tsc_.ts
			tsc tsc_.ts --target "ES2015" --module "ES2015"
		]
		
		specificality{
			//overload constructors
		}
		
		index.html[
			//to include compiled js
			add <scripts> to <body> section
			//include exports add to <body>
			<script>var exports = {};</script>
		]
		
		GenericInterfaces[

//Generic interface
//---------------------------------------------------------------
interface IPrimitiveCollection_ { <X>(arg:Array<X>):Array<X> }
//Generic PrimitiveCollection variants
//---------------------------------------------------------------
function PrimitiveCollection_<T>(arg:Array<T>):Array<T>{return arg;}
let myCol1: <U>(arg:Array<U>) => Array<U> = PrimitiveCollection_;
//call signature of and object literal type
let myCol2: { <X>(arg:Array<X>):Array<X> } =PrimitiveCollection_;
//call via interface
let myCol3: IPrimitiveCollection_ = PrimitiveCollection_;
			
		]						
		
		tipsandtricks[
			cannotreturnTypeStringOnly[			
				exists=>
				a typeof b
				a instanceof b 
				not exists=>
				return type, can only string return <= this.constructor.name
			]
		]
	
	}
	
	public void TipsAndTricks{
		
		CSS{
			FlexBoxRowWrap{
				not working if flexbox child of some unflex parent;
				need flexbow with height attr;
			}
		}
		,DOMevents{
			
			ClickVsMouseUp(
			click will trigger MouseEvent and will intercept other KeyDown events.
			if different actions on mouseclick and keybord click (enter for example ) expected=>
				use mouseup
				
				//in this structure 
				    <div class="input-group-append">
						<input class="form-control" (keyup)="keyPressed($event)"
						<button (mouseup/click)="selectToday($event)">Select Today</button>
					</div>
			
			)
		}
	}
	#endregion	
		
	#region Python
		
		public void Python{
			
			public void IO()
			{
				
    'r' : use for reading
    'w' : use for writing
    'x' : use for creating and writing to a new file
    'a' : use for appending to a file
    'r+' : use for reading and writing to the same file

				
			}
			
			public void LocalServerForTesting()
			{
				#stollen from 
#http://pbcraft.ru/simple-python3-web-server/
import http.server
import socketserver

from http.server import BaseHTTPRequestHandler, HTTPServer

PORT = 8000

class testHTTPServer_RequestHandler(BaseHTTPRequestHandler):
	def do_GET(self):
		# Отправляем код 200 (ОК)
		self.send_response(200)
		 # Теперь очередь за заголовками
		self.send_header('Content-type','text/html')
		self.end_headers()
	def do_POST(self):
		# Отправляем код 200 (ОК)
		self.send_response(200)
		 # Теперь очередь за заголовками
		self.send_header('Content-type','text/html')
		self.end_headers()
	def do_DEL(self):
		# Отправляем код 200 (ОК)
		self.send_response(200)
		 # Теперь очередь за заголовками
		self.send_header('Content-type','text/html')
		self.end_headers()
		
Handler = http.server.SimpleHTTPRequestHandler

with socketserver.TCPServer(("", PORT), testHTTPServer_RequestHandler) as httpd:
    print("serving at port", PORT)
    httpd.serve_forever()
				
			}
		
			public void Libs()
			{
				pip install numpy
pip install matplotlib
pip install bokeh
pip install pandas
npm install -g phantomjs-prebuilt
pip install ipython
			}
		
			public void Wheels()
			{
				{"Name":"Python Libs WHL",
"WHL":[
{
"LIBNAME":"LXM"
,"VER":"Python 3.6 pip 9.0"
,"URL":"https://pypi.python.org/packages/cb/b4/21319db4bef36225ea0924a3129332ab9989da7dfaba790fa427ac105ee7/lxml-4.1.1-cp36-cp36m-win_amd64.whl#md5=1cd0365757ebacaf99de8737739f75c7"
,"CMD":"pip install lxml-4.1.1-cp36-cp36m-win_amd64.whl"
,"DESCRIPTION":"parse html"
}
,{}
]
}
			}
		
		}
	
	#endregion		
	
	#region DB
	
	public void SQL()
	{
		
		//ORACLE
		//PL - sql server script templates
		public void PL_SQL()
		{
			
			public protected class ScriptExmaples()
			{
				
				public internal class TestDB()
				{

					public void WithConstraints() {
	/*
	alter table test3
	add primary key (C3)

	alter table test2
	add constraint test_pk 
	foreign key (c3) 
	references test3(c3)
	;

	delete from test2;

	insert into test2 (c1,c2) values ('TEST1','TEST1');
	insert into test2 (c1,c2) values ('TEST2','TEST2');
	insert into test2 (c1,c2) values ('TEST3','TEST3');
	commit;

	select to_char(c3,'dd.mm.yyyy hh24:mi:ss') from test2;
	commit;

	drop table purge;
	*/



					create table test_product(
					ID number constraint prod_id_pk primary key,
					INS_DATE date,
					product_name varchar(50)
					);

					create table test_types(
					ID number  constraint type_id_pk primary key,
					INS_DATE date,
					product_type varchar(50)
					);

					create table test_price(
					ID number ,
					INS_DATE date,
					DATE_FROM date,
					DATE_TO date,
					price number,
					prodcut_id  constraint test_product_price_PK references test_product(ID)
					);

					create table test_product_type (
					ID number ,
					INS_DATE date,
					product_id number,
					type_id number
					);


					/*Product table ID, date trigger on insert*/
					create or replace trigger test_prod_trg_ins
					before insert on test_product
					for each row
					declare 
					var_1 number;
					begin
					select max(ID) into var_1 from test_product;
					if var_1 is null
					then var_1 := 0;
					else
					var_1 := var_1+1;
					end if;
					:new.ID :=var_1;
					select sysdate into :new.INS_DATE from dual;
					end;
					/



					/*Product table date trigger on update*/
					create or replace trigger test_prod_trg_upd
					before update on test_product
					for each row
					begin
					select sysdate into :new.INS_DATE from dual;
					end;
					/




					/*Product table ID, date trigger on insert*/
					create or replace trigger test_prod_type_ins
					before insert on test_types
					for each row
					declare 
					var_1 number;
					begin
					select max(ID) into var_1 from test_types;
					if var_1 is null
					then var_1 := 0;
					else
					var_1 := var_1+1;
					end if;
					:new.ID :=var_1;
					select sysdate into :new.INS_DATE from dual;
					end;
					/

					/*Product table date trigger on update*/
					create or replace trigger test_prod_type_upd
					before update on test_types
					for each row
					begin
					select sysdate into :new.INS_DATE from dual;
					end;
					/



					/*Product table ID, date trigger on insert*/
					create or replace trigger test_price_ins
					before insert on test_price
					for each row
					declare 
					var_1 number;
					begin
					select max(ID) into var_1 from test_price;
					if var_1 is null
					then var_1 := 0;
					else
					var_1 := var_1+1;
					end if;
					:new.ID :=var_1;
					select sysdate into :new.INS_DATE from dual;
					end;
					/

					/*Product table date trigger on update*/
					create or replace trigger test_price_upd
					before update on test_price
					for each row
					begin
					select sysdate into :new.INS_DATE from dual;
					end;
					/


					alter table test_product_type
					add constraint test_product_type_PK
					foreign key (product_id) 
					references test_product(ID)
					;

					alter table test_product_type
					add constraint test_product_types_PK
					foreign key (type_id) 
					references test_types(ID)
					;



					insert into test_product (product_name) values ('Product_3');
					insert into test_product (product_name) values ('Product_5');
					insert into test_product (product_name) values ('Product_6');
					insert into test_product (product_name) values ('Product_7');
					insert into test_product (product_name) values ('Product_8');

					update test_product set product_name ='Product_3' where product_name='Product_2';
					update test_product set product_name ='Product_2' where product_name='Product_3';


					insert into test_types (product_type) values ('Product_type_1');
					insert into test_types (product_type) values ('Product_type_2');
					insert into test_types (product_type) values ('Product_type_3');


					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('01.01.2017','dd.mm.yyyy'),to_date('10.01.2017','dd.mm.yyyy'),1,10);
					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('15.01.2017','dd.mm.yyyy'),to_date('20.01.2017','dd.mm.yyyy'),1,20);
					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('25.01.2017','dd.mm.yyyy'),null,1,15);

					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('01.01.2017','dd.mm.yyyy'),to_date('10.01.2017','dd.mm.yyyy'),2,25);
					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('15.01.2017','dd.mm.yyyy'),to_date('20.01.2017','dd.mm.yyyy'),2,30);
					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('25.01.2017','dd.mm.yyyy'),null,2,45);


					insert into test_product_type(product_id,type_id) values (1,1);
					insert into test_product_type(product_id,type_id) values (2,1);
					insert into test_product_type(product_id,type_id) values (3,2);
					insert into test_product_type(product_id,type_id) values (4,2);
					insert into test_product_type(product_id,type_id) values (0,3);

					select * from test_product;
					select * from test_types; 
					select * from test_product_type;
					select * from test_price;


					/* !!!DANGER!!!
					execute maintain();
					*/

				}
					
					public void GollandDB()
					{
						
	--create 
	-------------------
	drop table employees;
	drop table project;
	drop table emp_pro;

	create table employees (
	emp_no int primary key,Name varchar(15), Address varchar(15), Profession varchar(15), dept_no int,
	manager_no int, Salary number );

	create table project (pro_name varchar(10), pro_no int , pro_mng int );

	create table emp_pro ( p_no int, emp_no int , precent_time number  );
	-------------------


	--insert
	-------------------
	insert into employees values (1001,'NAME 1001','Address_4','Proffession_7',1,1015,20000);
	insert into employees values (1002,'NAME 1002','Address_3','Proffession_4',4,1015,45000);
	insert into employees values (1003,'NAME 1003','Address_4','Proffession_7',1,1010,15000);
	insert into employees values (1004,'NAME 1004','Address_3','Proffession_2',3,1015,50000);
	insert into employees values (1005,'NAME 1005','Address_1','Proffession_3',4,1015,10000);
	insert into employees values (1006,'NAME 1006','Address_2','Proffession_3',2,1009,40000);
	insert into employees values (1007,'NAME 1007','Address_4','Proffession_5',2,1012,20000);
	insert into employees values (1008,'NAME 1008','Address_2','Proffession_7',1,1014,20000);
	insert into employees values (1009,'NAME 1009','Address_1','Proffession_3',4,1015,35000);
	insert into employees values (1010,'NAME 1010','Address_4','Proffession_7',4,1013,15000);
	insert into employees values (1011,'NAME 1011','Address_2','Proffession_5',2,1012,20000);
	insert into employees values (1012,'NAME 1012','Address_1','Proffession_3',2,1013,20000);
	insert into employees values (1013,'NAME 1013','Address_3','Proffession_3',4,1014,45000);
	insert into employees values (1014,'NAME 1014','Address_5','Proffession_2',4,1016,50000);
	insert into employees values (1015,'NAME 1015','Address_1','Proffession_3',4,1016,55000);
	insert into employees values (1016,'NAME 1016','Address_1','Proffession_7',3,1016,45000);



	insert into project values ('Prog 1',1,1001);
	insert into project values ('Prog 2',2,1003);
	insert into project values ('Prog 3',3,1001);
	insert into project values ('Prog 4',4,1001);
	insert into project values ('Prog 5',5,1003);
	insert into project values ('Prog 6',6,1008);
	insert into project values ('Prog 7',7,1001);
	insert into project values ('Prog 8',8,1001);
	insert into project values ('Prog 9',9,1003);
	insert into project values ('Prog 10',10,1008);
	insert into project values ('Prog 11',11,1002);
	insert into project values ('Prog 12',12,1004);
	insert into project values ('Prog 13',13,1004);
	insert into project values ('Prog 14',14,1003);
	insert into project values ('Prog 15',15,1004);
	insert into project values ('Prog 16',16,1005);



	insert into emp_pro values (1,1001,50);
	insert into emp_pro values (2,1003,21);
	insert into emp_pro values (3,1001,41);
	insert into emp_pro values (4,1001,76);
	insert into emp_pro values (5,1003,63);
	insert into emp_pro values (6,1008,3);
	insert into emp_pro values (7,1001,60);
	insert into emp_pro values (8,1001,98);
	insert into emp_pro values (9,1003,97);
	insert into emp_pro values (10,1008,68);
	insert into emp_pro values (11,1002,91);
	insert into emp_pro values (12,1004,55);
	insert into emp_pro values (13,1004,97);
	insert into emp_pro values (14,1003,5);
	insert into emp_pro values (15,1004,62);
	insert into emp_pro values (16,1005,74);
	-------------------




	--Q/A
	-------------------

	--1) All employes with the same Profession,dept_no as employee with id 1006
	with t as (
	select Profession,dept_no from employees
	where emp_no = '1006')
	, t2 as (
	select * from employees
	)
	select * from t2 
	join t on t2.Profession = t.Profession and t2.dept_no=t.dept_no;

	--2) progect number and progect manager name
	/*
	assuming, that manager of project is employee and we need not his name but
	to populate name of employee who is manager of an employee who is, in his turn,
	manager of a progect 
	*/
	select ep.pro_name,em2.Name from project ep
	left join employees em on ep.pro_mng = em.emp_no
	left join employees em2 on em2.emp_no=em.manager_no
	;

	--3) select amployees with salary > then their manager
	select em.emp_no,em.Name from employees em
	join employees em2 on em.manager_no=em2.emp_no
	where (em.salary > em2.salary)
	;

	--4) all amployees working on > 3 projects
	select * from employees em where em.emp_no in (
	select emp_no from emp_pro group by emp_no having (count (emp_no) >3)
	);

	--5) professions and salary of employees from same address as employee with max salary
	with t as(
	select em.profession,em.salary,em.address from employees em
	where em.salary =( select max(salary) from employees)
	)
	select em2.profession,em2.salary 
	from employees em2 join t on em2.address = t.address
	;
	-------------------

					}
				
				}
				
				public internal class Selection()
				{
					
					public datetime()
					{
						
						define ReqFnDate=to_date('30.06.2017 23:59:59','dd.mm.yyyy hh24:mi:ss');
						define ReqStDate=add_months(trunc(&ReqFnDate,'mm'),0);
						define TrStDate=add_months(&ReqStDate,-5);
						define TrFnDate=add_months(&ReqFnDate,+1);
						
					}

					public tableCreate()
					{
						
						//table with prim,sec keys
						create table teble(
						ID int not null identity(0,1), --not nullable id increasing from 0 by 1 every insert
						SEC_ID int null, --foreign key
						primary key(ID), -- indicates primary key
						foreign key(SEC_ID) references SEC_NAMES(ID), -- indicates secondary key and according key in other table
						)

						//create table add key add foreign key
						create table DWH_replica.dbo.table2 (
						ID int not null identity(0,1),
						TXT varchar(50),
						DT Datetime);

						alter table DWH_replica.dbo.table2
						add primary key (ID);

						create table DWH_replica.dbo.table1 (
						ID int not null identity(0,1),
						SEC_ID int null,
						primary key (ID),
						foreign key (SEC_ID) references DWH_replica.dbo.table2(ID));

					}
								
					public join_update()
					{
						
						/*update from join*/
						--\\\\\\\\\\\\\\\\\\
						update acquiring_month tt
						set (center,division) = (
						select f.rc,f.rp from tms.v_merchants t 
						join mtr_rc_rp_fins f on f.GEOGRAPHIC=t.GEOGRAPHIC_GID 
						where t.merchant=tt.merchant
						)
						where exists(
						select t.merchant,f.rc,f.rp from tms.v_merchants t 
						join mtr_rc_rp_fins f on f.GEOGRAPHIC=t.GEOGRAPHIC_GID 
						where t.merchant=tt.merchant
						)
						and tt.center is null and tt.division is null 
						--//////////////////


						--update from join with merge into 
						--\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

						select * from test1;
						select * from test2;

						delete from test1; delete from test2;

						insert into test1 (c1,c2) values ('A','1');
						insert into test1 (c1,c2) values ('B','1');
						insert into test1 (c1,c2) values ('C','1');
						insert into test1 (c1,c2) values ('D','1');
						insert into test1 (c1,c2) values ('E','1');
						insert into test1 (c1,c2) values ('F','1');

						insert into test2 (c1,c2) values ('A','2');
						insert into test2 (c1,c2) values ('B','3');
						insert into test2 (c1,c2) values ('C','4');

						merge into test1 t1
						using (select * from test2 t2) p
						on (t1.c1=p.c1)
						when matched then
						update set t1.c2=p.c2
						;

						--//////////////////////////////

					}

					public LEVEL()
					{
						
					--//level1
					SELECT * FROM

					(SELECT LEVEL R0 FROM dual CONNECT BY LEVEL <3),
					(SELECT LEVEL R1 FROM dual CONNECT BY LEVEL <5),
					(SELECT LEVEL R2 FROM dual CONNECT BY LEVEL <4)
					--///

					--// levle2
					select * from 
					( select level "C1" from dual connect by level <=10 ) t1
					full outer join ( select level "C1" from dual connect by level <=3 ) t2 on t1.c1<>t2.c1

					union all

					select * from 
					( select level "C1" from dual connect by level <=10 ) t1
					join ( select level "C1" from dual connect by level <=3 ) t2 on t1.c1=t2.c1
					--///

					}

					public partition_over()
					{
						
					select 
					min(rownum) 
					from (
					select t.*,count(*) over (partition by t.bin,t.bank) "CNT" from neprintsev_ia.ref_bin t
					) where cnt>1 group by bin,bank

					}

					public delete_duplicates()
					{
						
					delete from neprintsev_ia.ref_bin 
					where rowid in (
					select min(rowid) "RN" from neprintsev_ia.ref_bin  where bin in (
					select bin from neprintsev_ia.ref_bin having count(bin)>1 group by bin
					) group by bin
					)

					}

					public CURSOR()
					{
						/*SAMPLE CURSOR*/
						set serveroutput on;
						begin
						for cr in ( select merchant,reg_nr from ref_merchants )
						loop 
						  dbms_output.put_line('drop table ' || cr.merchant || ';');
						end loop;
						end ;

					}
					
					public CrossReference()
					{
											
											
						drop table Customers;
						drop table Invoices;

						create table customers ("ID" int primary key not null, Name varchar(10), "REF" int,
						constraint fk_ref foreign key("REF") references customers ("ID"));

						create table Invoices (id int primary key not null, Billing date,CustomerID int,
						constraint fk_inv foreign key(CustomerID) references customers (ID) );


						insert into customers values (0,'A',null);
						insert into customers values (1,'B',null);
						insert into customers values (2,'C',0);
						insert into customers values (3,'D',null);
						insert into customers values (4,'F',0);
						insert into customers values (5,'G',2);
						insert into customers values (6,'H',3);
						insert into customers values (7,'I',0);

						insert into invoices values (0,sysdate,0);
						insert into invoices values (1,sysdate,0);
						insert into invoices values (2,sysdate,2);
						insert into invoices values (3,sysdate,4);
						insert into invoices values (4,sysdate,3);
						insert into invoices values (5,sysdate,6);
						insert into invoices values (6,sysdate,7);
						insert into invoices values (7,sysdate,null);

						select * from Customers;
						select * from invoices t;

						select t.id,t.billing,t2.name,t3.name 
						from invoices t
						--left
						join Customers t2 on t2.id=t.customerId
						left join Customers t3 on t3.ID = t2.REF
						order by t.BILLING;



					}
					
					public UpdateCase()
					{
						
						drop table swap;
						create table swap (id int,c1 varchar(10), c2 varchar(10));
						insert into swap values (0,'f','m');
						insert into swap values (1,'m','f');
						insert into swap values (2,'f','m');

						update swap t
						set c1 = case when c1 is null then null when c1 = 'f' then 'm' else 'f' end  ;

						select * from swap;
					}
					
					public IntersectMinus()
					{
											
						drop table test_a;
						drop table test_b;

						create table test_a(id numeric,val varchar(10));
						create table test_b(id numeric,val varchar(10));

						insert into test_a values (10,'a');
						insert into test_a values (20,'b');
						insert into test_a values (30,'c');
						insert into test_a values (40,'d');
						insert into test_a values (50,'f');

						insert into test_b values (10,'a');
						insert into test_b values (30,'d');
						insert into test_b values (50,'f');

						with t as (select * from test_a t) ,
						t2 as (select * from test_b t)
						select * from t
						intersect
						select * from t2
						;

						with t as (select * from test_a t) ,
						t2 as (select * from test_b t)
						select * from t
						minus
						select * from t2
						;
					}
					
					public Rank()
					{
						
						--For Golland DbContext
						--RANK
	select * from (
	select ep.*, row_number() over(order by ep.salary desc) "RN"
	from employees ep
	) where "RN" = 10
	;

	with t as (
	select t.*,row_number() over (order by t.SAL desc ) "RN" from (
	select distinct ep.salary "SAL" from employees ep order by "SAL" desc
	) t ) 
	, t2 as (
	select * from employees ep
	)
	select * from t2
	join t on t2.salary = t.sal
	;

	select ep.dept_no,ep.name,max(ep.salary) "MAX",
	dense_rank() over (partition by ep.dept_no order by max(ep.salary) desc) "RANK"
	from employees ep
	group by ep.dept_no,ep.name
	order by "MAX" desc;


	select ep.*,
	max(ep.salary)  over (partition by ep.dept_no) as "MAX_DEP_SAL",
	avg(ep.salary)  over (partition by ep.dept_no) as "AVG_DEP_SAL",
	avg(ep.salary)  over (partition by ep.profession) as "AVG_PROF_SAL"
	from employees ep
	order by "MAX_DEP_SAL" desc;


	select 
	ep.*, 
	max(ep.salary) over() as "SAL"
	from employees ep
	;


	select ep.name,ep.dept_no
	--, max(ep.salary) over (partition by ep.dept_no order by ep.salary desc) "RANK"
	, max(ep.salary) keep (dense_rank first order by ep.salary desc) "RANK"
	from employees ep
	group by ep.name,ep.dept_no
	order by"RANK" desc

	; 


					}
					
				}
				
				public internal class MAINTANANCE()
				{
					
					public REFERENCES()
					{
						
						--//roles
						select * from role_tab_privs
						--//granted privileges
						select * from table_privileges
						revoke  select on acquiring_month from kokorina_jv
						--//all  user objects
						select * from user_objects
						--// TABLE modifications INSERT,DELETE,UPDATE
						select * from user_tab_modifications;
						//Objects source code
						select * from all_source
						//Procedure texts 
						select * from user_source  
						
						/*Unreferenced table names*/
						select distinct table_name,'select * from ' || table_name || ';' from all_tables where owner like '%NEPRIN%'
						and table_name not in (
						select distinct "REFERENCED_NAME" from user_dependencies 
						)
						;

						/*Unref and ungranted tables*/
						select distinct table_name,'select * from ' || table_name || ';' from all_tables where 1=1 
						and owner like '%NEPRIN%'
						--all tables that referenced from smwh
						and table_name not in (select distinct "REFERENCED_NAME" from user_dependencies )
						--all tables granted to somb
						and table_name not in (select table_name from user_tab_privs where owner like '%NEPRIN%')
						and table_name not like 'REF%'
						order by table_name asc
						;

						/*TABLE SIZE*/
						select segment_name "TABLE_NAME",bytes /1024/1024  "SIZE_MB" from 
						user_segments 
						order by "SIZE_MB" desc 
						;
						
					}			
								
					public Priviledges
					{
						revoke  select on acquiring_month from kokorina_jv
					}
					
					public TABLES_ALTER()
					{
						//change column type
						alter table ref_mc_ird_rates modify mcc varchar (50) 
					}
					
					public EXPLAIN_PLAN()
					{

						--//eplain table
						delete from PLAN_TABLE;
						EXPLAIN PLAN for
						select * from dual;
						select operation,options,object_name,cost , t.* from PLAN_TABLE t;
						SELECT * FROM TABLE (dbms_xplan.display);
						--//


						--//display cursor
						select * from table (DBMS_XPLAN.DISPLAY_CURSOR(null,null,'basic'))
						--// privilege needed: SELECT privilege on V$SQL_PLAN, V$SQL_PLAN_DETAIL,SELECT_CATALOG_ROLE
						--//

						--//Gather statistic
						Execute DBMS_STATS.GATHER_TABLE_STATS('neprintsev_ia','AMS_MC_BINS_',method_opt=>'FOR COLUMNS SIZE 254 columnName')
						--//

					}
					
					public DB_LINK()
					{
						
						
					drop  DATABASE LINK "DB_LINK.US.ORACLE.COM";

					CREATE DATABASE LINK "DB_LINK.US.ORACLE.COM"
					CONNECT TO DACQ_NEPRINTSEV
					IDENTIFIED BY  x2y4uecbbo
					USING '  (DESCRIPTION=
						(ADDRESS=
						  (PROTOCOL=TCP)
						  (HOST=exdt01-scan.rs.ru)
						  (PORT=1521)
						)
						(CONNECT_DATA=
						  (SERVER=dedicated)
						  (SERVICE_NAME=BUS)
						)
					  )
					'
					;
					}
							
					public JOBS()
					{
						
						select job,broken,interval,what,last_date,last_sec,next_date,next_sec from user_jobs order by job desc;
					
						DECLARE
						l_job NUMBER := 0;
						BEGIN
						DBMS_JOB.SUBMIT( l_job,what=>'P_TEMPLATE_DATE(sysdate,null,null);', 
						next_date=>trunc(sysdate,'dd')+1+2.5/24/60/60, -- start next hour 
						interval => 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+3+2.5/24');
						commit;
						END;
						
						DECLARE
						l_job NUMBER := 0;
						BEGIN
						DBMS_JOB.SUBMIT( l_job,what=>'p_gns_date(add_months(trunc(sysdate,''mm''),-1),add_months(trunc(sysdate,''mm''),0)-1/24/60/60,''GNS_JOB'');', 
						next_date=>trunc(sysdate,'dd')+1+2.5/24/60/60, -- start next hour 
						interval => 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+2+2.5/24');
						commit;
						END;

						exec dbms_job.run(163038);commit;

						BEGIN
						DBMS_JOB.REMOVE(131572);
						COMMIT;
						END;
					
					
						begin
						dbms_job.change(210250, null,to_date('19.08.2017 08:00:00','dd.mm.yyyy hh24:mi:ss'), 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+7+8/24');
						end;
						begin
						dbms_job.change(214250, null,to_date('19.08.2017 08:15:00','dd.mm.yyyy hh24:mi:ss'), 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+7+8/24');
						end;
						
						
						
						select * from user_jobs where job in (210250,214250,213974);


						begin
						dbms_job.change(210250, null,to_date('23.08.2017 13:30:00','dd.mm.yyyy hh24:mi:ss'), 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+7+8/24');
						commit;
						end;
						begin
						dbms_job.change(214250, null,to_date('08.09.2017 08:15:00','dd.mm.yyyy hh24:mi:ss'), 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+7+8/24');
						commit;
						end;
						begin
						dbms_job.change(213974, null,to_date('23.08.2017 14:20:00','dd.mm.yyyy hh24:mi:ss'), 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+7+8/24');
						commit;
						end;

						
						
						execute DBMS_JOB.BROKEN(212730,FALSE);
						execute dbms_job.change(212730, null,sysdate+0.15/24, 'next_day(trunc(sysdate,''dd''),''ВТОРНИК'')+0.3/24');

		
						begin
						dbms_job.change(212730, null,to_date('08.08.2017 00:00:00','dd.mm.yyyy hh24:mi:ss'), 'next_day(trunc(sysdate,' || '''' || 'mm' || '''' ||'),' || '''' || 'ВТОРНИК' || '''' ||  ')+0.3/24');
						end;

						--unBroke JOB
						EXEC DBMS_JOB.BROKEN(206923,FALSE);

						--change next date time
						EXECUTE dbms_job.change(206923,null,to_date('03.04.2017 00:00:00','dd.mm.yyyy hh24:mi:ss'),'add_months(trunc(sysdate,''mm''),1)+3');
				
				 begin 
				 DBMS_JOB.CHANGE
				   (213653
				   ,'P_BANK_FN(sysdate,''%*%'');'
				   ,trunc(sysdate,'dd')+1+1.5/24/60
				   ,'add_months(TRUNC(SYSDATE,''mm''),1)+3+1.5/24');
				   end ;
				   
					exec dbms_job.run(131571);commit;

					BEGIN
					   DBMS_JOB.REMOVE(131572);
					   COMMIT;
					END;
					
					/*JOBS UNBROKE*/
					/* Filename on companion disk: job5.sql */*
					CREATE OR REPLACE PROCEDURE job_fixer
					AS
				   /*
				   || calls DBMS_JOB.BROKEN to try and set
				   || any broken jobs to unbroken
				   */
				   
				   /* cursor selects user's broken jobs */
				   CURSOR broken_jobs_cur
				   IS
				   SELECT job
					 FROM user_jobs
					WHERE broken = 'Y';
						
					BEGIN
					   FOR job_rec IN broken_jobs_cur
					   LOOP
						  DBMS_JOB.BROKEN(job_rec.job,FALSE);
					   END LOOP;
					END job_fixer;
																				
					}
					
					public alter_session_lang()
					{
						ALTER SESSION SET NLS_DATE_LANGUAGE = 'ENGLISH'
						select to_char(sysdate,'Month') from dual 
					}
					
					public DROP_TABLES_BY_LIST()
					{
					-------------------------
					drop table temp3;
					drop table temp4;

					create table temp3 (c1 varchar (10));
					create table temp4 (c1 varchar (10),C2 INT);

					insert into temp3 (c1) values ('aa b aa');
					insert into temp3 (c1) values ('aa c aa');
					insert into temp3 (c1) values ('aa d aa');
					insert into temp3 (c1) values ('aa e aa');

					insert into temp4 (c1) values ('c');
					insert into temp4 (c1) values ('e');

					commit;

					set serveroutput on
					begin
					for c_c1 in (select c1 from temp3) loop
						for c_c2 in (select c1 from temp4) loop         
						  if c_c1.c1  like  '%' || c_c2.c1  || '%' then 
						  dbms_output.put_line(c_c1.c1  || ' like ' || '''%' || c_c2.c1  || '%'''); 
						  --insert into T_output (c1) VALUES (c_c1.c1  || ' like ' || '''%' || c_c2.c1  || '%''');
						  UPDATE TEMP4 SET C2 =1 WHERE C1=c_c2.C1;
						  end if;
						end loop;
					  end loop;
					end;
					-------------------------


					--BATTLE--
					-------------------------

					drop table t_table_to_delete;
					create table t_table_to_delete (t_name varchar(250),inprocedures int);

					--search selected tables in procedures and if used mark inprocedures as 1
					set serveroutput on
					begin
					for c_c1 in ( SELECT TEXT  FROM USER_SOURCE) loop
						for c_c2 in ( SELECT T_NAME   FROM T_TABLE_TO_DELETE) loop         
						  if c_c1.TEXT  like  '%' || c_c2.T_NAME  || '%' then 
						  dbms_output.put_line(c_c1.TEXT  || ' like ' || '''%' || c_c2.T_NAME  || '%'''); 
						  update T_TABLE_TO_DELETE set inprocedures =1 where t_name =c_c2.T_NAME and t_name not in 
						  (select distinct table_name from table_privileges );
						  end if;
						end loop;
					  end loop;
					end;


					--very very bad drop;
					set serveroutput on
					begin
					for c_c in (select * from t_table_to_delete where inprocedures !=1 and t_name not in 
						  (select distinct table_name from table_privileges )) loop
					  execute immediate ('drop table ' || c_c.t_name );
					  dbms_output.put_line('dropped :' || c_c.t_name);
					end loop;
					end ;
					-------------------------
					}
											
				}
				
				public internal class Functions()
				{
					
					public P_TEMPLATE()
					{
						
						create or replace
						PROCEDURE P_EWALLET_D (ReqStIn date, ReqFnIn date, comment_ varchar )
						AUTHID CURRENT_USER
						IS
						jobStarted date; --sysdate of currentprocedure started
						jobFinished date; --sysdate of currentprocedure finished

						ReqStDate date;
						ReqFnDate date;

						rows_processed number;
						commentary varchar(200);

						BEGIN
						DBMS_OUTPUT.PUT_LINE('\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\');
						DBMS_OUTPUT.PUT_LINE('P_EWALLET_D STARTED');
						jobStarted := sysdate;
						rows_processed := 0;



						if(comment_ is null or comment_ = '' ) then 
						commentary := 'UNKNOWN' ;
						else
						commentary := comment_;
						end if;

						if(ReqStIn is not null and ReqFnIn is not null ) then
						ReqStDate := trunc(ReqStIn,'mm') ;
						ReqFnDate := trunc(ReqFnIn,'mm') ;
						else
						if(ReqStIn is null and ReqFnIn is null ) then
						ReqStDate := add_months(trunc(sysdate,'mm'),-1);
						ReqFnDate := add_months(ReqStDate,1)-1/24/60/60;
						else

						if(ReqStIn is null) then
						ReqStDate := trunc(ReqFnIn,'mm');
						ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
						end if;

						if(ReqFnIn is null) then 
						ReqStDate := trunc(ReqStIn,'mm');
						ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
						end if;
						end if;

						end if;









						--printing all date values to log

						DBMS_OUTPUT.PUT_LINE('Actual sysdate - ' || to_char(sysdate,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Received sysdate - ' || to_char(jobStarted,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Data period start date  - ' || to_char(ReqStDate,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Data period finish date  - ' || to_char(ReqFnDate,'dd.mm.yyyy hh24:mi:ss') || ';');


						--all procedure specific code goes here
						-->>>HERE<<<

						/*
						delete from T_EWALLETS_D where DATE_D between ReqStDate  and ReqFnDate;

						insert into T_EWALLETS_D


						select 
						trunc(m.request_date,'dd') "DATE_D",
						cast(fld_042 as varchar(10)) "MERCHANT",
						CASE
						WHEN fld_119 LIKE '%061150139059239%'
						THEN 'APP'
						WHEN fld_119 LIKE '%061150110030273%'
						THEN 'SMP'
						WHEN fld_119 LIKE '%061150120834693%'
						THEN 'ARP'
						ELSE '0'
						END "EWALLET",

						sum(m.FLD_004/100) "AMT",
						count(m.FLD_004) "CNT"

						FROM tms.RTPS_MESSAGES_LOG m
						where 1=1
						and m.request_date between ReqStDate  and ReqFnDate
						and cast(fld_042 as varchar(10)) in (
						select merchant from ref_merchants --where reg_nr = '7743543761'
						)
						and FLD_039 = '000'

						group by trunc(m.request_date,'dd') , cast(m.fld_042 as varchar(10)) ,
						CASE
						WHEN fld_119 LIKE '%061150139059239%'
						THEN 'APP'
						WHEN fld_119 LIKE '%061150110030273%'
						THEN 'SMP'
						WHEN fld_119 LIKE '%061150120834693%'
						THEN 'ARP'
						ELSE '0'
						END
						;

						commit;
						*/

						--ref_report_table
						--select max(rownum) into rows_processed from neprintsev_ia.T_ACQ_D where "DATE" between startRefresh and endRefresh;
						jobFinished:=sysdate;
						insert into neprintsev_ia.ref_report_table ("NAME",job_started,job_finished,data_start,data_finish,rows_processed, commentary) 
						values ('P_EWALLET_D', jobStarted,jobFinished,ReqStDate,ReqFnDate,rows_processed,commentary);
						DBMS_OUTPUT.PUT_LINE('P_EWALLET_D EXECUTED');
						DBMS_OUTPUT.PUT_LINE('//////////////////////////////////////////////////////////');

						--current procedure execution example
						/*
						set serveroutput on;
						execute P_TEMPLATE(sysdate);
						*/
						END P_EWALLET_D;
					}
					
					public P_TEMPLATE_DATE()
					{
						
						create or replace
						PROCEDURE P_TEMPLATE_DATE (ReqStIn date, ReqFnIn date, comment_ varchar )
						AUTHID CURRENT_USER
						IS
						jobStarted date; --sysdate of currentprocedure started
						jobFinished date; --sysdate of currentprocedure finished

						dataDate date;  --date wich is default for data quering (sysdate-2 for acquiring queries)
						dataStart date; --data period start date
						dataFinish date; --data period finish date

						rows_processed number;
						commentary varchar(200);

						ReqStDate date;
						ReqFnDate date;


						BEGIN
						DBMS_OUTPUT.PUT_LINE('\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\');
						DBMS_OUTPUT.PUT_LINE('P_TEMPLATE_DATE STARTED');
						jobStarted := sysdate;
						rows_processed := 0;


						if(comment_ is null or comment_ = '' ) then 
						commentary := 'UNKNOWN' ;
						else
						commentary := comment_;
						end if;

						if(ReqStIn is not null and ReqFnIn is not null ) then
						ReqStDate := trunc(ReqStIn,'mm') ;
						ReqFnDate := trunc(ReqFnIn,'mm') ;
						else
						if(ReqStIn is null and ReqFnIn is null ) then
						ReqStDate := add_months(trunc(sysdate,'mm'),-1);
						ReqFnDate := add_months(ReqStDate,1)-1/24/60/60;
						else

						if(ReqStIn is null) then
						ReqStDate := trunc(ReqFnIn,'mm');
						ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
						end if;

						if(ReqFnIn is null) then 
						ReqStDate := trunc(ReqStIn,'mm');
						ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
						end if;
						end if;

						end if;

						dataDate:=sysdate-2; --data default for most reports sysdate - 2
						dataStart:=trunc(dataDate,'mm'); --defining data date range start of month 
						dataFinish:=trunc(dataStart,'dd')-1/24/60/60; --defining data date range finish of month

						--printing all date values to log

						DBMS_OUTPUT.PUT_LINE('Actual sysdate - ' || to_char(sysdate,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Received sysdate - ' || to_char(jobStarted,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Data sysdate defined - ' || to_char(dataDate,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Data period start date  - ' || to_char(dataStart,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Data period finish date  - ' || to_char(dataFinish,'dd.mm.yyyy hh24:mi:ss') || ';');


						--all procedure specific code goes here
						-->>>HERE<<<


						--ref_report_table
						--select max(rownum) into rows_processed from neprintsev_ia.T_ACQ_D where "DATE" between startRefresh and endRefresh;
						jobFinished:=sysdate;
						insert into neprintsev_ia.ref_report_table ("NAME",job_started,job_finished,data_start,data_finish,rows_processed, commentary) 
						values ('P_TEMPLATE_DATE', jobStarted,jobFinished,dataStart,dataFinish,rows_processed,comment_);
						DBMS_OUTPUT.PUT_LINE('P_TEMPLATE_DATE EXECUTED');
						DBMS_OUTPUT.PUT_LINE('//////////////////////////////////////////////////////////');

						--current procedure execution example
						/*
						set serveroutput on;
						execute P_TEMPLATE(sysdate);
						*/
						END P_TEMPLATE_DATE;
						
					}
					
					public LoopByNumWithLevel()
					{
						
						set serveroutput on
						begin 
						for c1 in ( SELECT LEVEL R0 FROM dual CONNECT BY LEVEL <3 ) loop

						/*
						define dt = add_months(trunc(sysdate,'dd'),0) ;
						set serveroutput on
						execute P_ECOM_M_REFRESH(&dt);
						commit;
						*/
						DBMS_OUTPUT.put_line('Print ' || c1.R0 );

						end loop;
						end ;

					}
				
				}
				
				public internal class UNSORTED()
				{
				
		  
		"
		"set serveroutput on
		"
		http://www.f-notes.info/oracle:what_where
		"/*PARTITION BY DATE + SUBPARTIOTION BY PAY_SYS + ROWMOVEMENT*/
		create table test5_p (
		C1 NUMBER,
		C2 VARCHAR2(50 BYTE),
		C3 date)

		partition by range (c3)
		subpartition by list (c2)
		(
		   partition P_1 values less than (to_date('01.01.2014 00:00:00','dd.mm.yyyy hh24:mi:ss'))
			  (
			  subpartition A_1 values ('A'),
			  subpartition V_1 values ('V'),
			  subpartition MC_1 values ('M'),
			  subpartition OTHER_1 values('OTHER'),
			  subpartition DEFAULT_1 values (DEFAULT)
			  ),
			 partition P_2 values less than (to_date('01.02.2014 00:00:00','dd.mm.yyyy hh24:mi:ss'))
			  (
			  subpartition A_2 values ('A'),
			  subpartition V_2 values ('V'),
			  subpartition MC_2 values ('M'),
			  subpartition OTHER_2 values('OTHER'),
			  subpartition DEFAULT_2 values (DEFAULT)
			  )

		)ENABLE ROW MOVEMENT;"
		"/*testing for unique values*/

		insert into test3 values (1,'a',1);
		insert into test3 values (1,'b',2);
		insert into test3 values (2,'a',2);
		insert into test3 values (3,'a',2);
		insert into test3 values (3,'b',1);
		insert into test3 values (4,'b',1);



		insert into test3 values (1,'c',1);
		insert into test3 values (2,'a',3);
		insert into test3 values (3,'c',3);
		insert into test3 values (4,'b',3);



		with t1 as (

		select  distinct c1,case when c2 ='b'  then  'b' else 'nb' end "C2"  from test3 where c2='b'

		union all

		select distinct  c1,case when c2 = 'b' then 'b' else 'nb' end "C2"  from test3 where c2<>'b'
		and c1 not in (select c1 from test3 where c2='b')

		), 
		t2 as (
		/*select if just one 2 then 2 if none 2 then a unique c3*/
		select  distinct c1,case when c3 =2 then 'two' else 'ntwo' end "C3"  from test3 where c3=2

		union all

		select  distinct c1,case when c3 =2 then 'two' else 'ntwo' end "C3"  from test3 where c3<>2
		and c1 not in (
		select  c1 from test3 where c3=2)

		)
		select 
		t1.c1,t1.c2,t2.c3
		from t1 
		join t2 on t2.c1=t1.c1


		/*GRANT OVERAL*/
		begin 
		for temp_name in (
		  select table_name from user_tables 
		  --where table_name in ('TEMP','TEMP2','TEMP3','TEMP4') 
		  ) loop
		  execute immediate 'grant select,insert,delete  on neprintsev_ia.' || temp_name.table_name || ' to neprintsev_ia';
		  end loop;
		  end ;
	
		/*DISTINCT LEFT JOIN SELECT FOR SEVERAL LISTS*/
		create table test1(c1 varchar(10),c2 date,c3 number);
		create table test2(c1 varchar(10),c2 date,c3 number);
		create table test3(c1 varchar(10),c2 date,c3 number);

		insert into test1 values  ('A',sysdate-3,1);
		insert into test1 values ('A',sysdate-3,2);
		insert into test1 values ('A',sysdate-3,3);
		insert into test1 values ('B',sysdate-3,1);
		insert into test1 values ('B',sysdate-3,2);
		insert into test1 values ('B',sysdate-3,3);

		insert into test1 values  ('A',sysdate-4,1);
		insert into test1 values ('A',sysdate-4,2);
		insert into test1 values ('A',sysdate-4,3);
		insert into test1 values ('B',sysdate-4,1);
		insert into test1 values ('B',sysdate-4,2);
		insert into test1 values ('B',sysdate-4,3);

		insert into test2 values ('A',sysdate-4,1);
		insert into test2 values ('A',sysdate-4,2);
		insert into test2 values ('A',sysdate-4,3);
		insert into test2 values ('B',sysdate-3,1);
		insert into test2 values ('B',sysdate-3,2);
		insert into test2 values ('B',sysdate-3,3);

		insert into test3 (c1) values ('A');
		insert into test3 (c1) values ('B');
		insert into test3 (c1) values ('C');
		insert into test3 (c1) values ('D');


		with t3 as (select t3.c1 "C1" from test3 t3 ),
		t2 as(
		select t1.c1 "C1",sum(t2.c3*t1.c3) "C3" from test1 t1
		left join test2 t2 on t1.c1=t2.c1
		where trunc(t1.c2,'dd') = trunc(sysdate-3,'dd')
		group by  t1.c1
		)
		select 
		t3.c1,t2.c3 from t3 
		left join t2 on t2.c1=t3.c1;"
		"/*IB*/
		select * from ORAWH.IB_CLIENT_MV where client_name like '%?????????%'
		select * from ORAWH.IB_REQ_MV where client_id ='3595559'
		select * from ORAWH.IB_QNA_MV where user_id = '3576169'
		select * from ORAWH.IB_USERS_MV where user_id = '3576169'

		
		/*REGEX proc*/
		create or replace
		PROCEDURE P_REGEX
		AUTHID CURRENT_USER
		IS
		pattern  varchar(250);
		Cursor CR is select t.REGEX_PATTERN from neprintsev_ia.ref_regex_pattern t where t.REGEX_PATTERN is not null;

		BEGIN
		delete from neprintsev_ia.ref_regex_ent;
		 DBMS_OUTPUT.PUT_LINE('Deleted from ref_regex_ent');  
		 
		  for C1 in CR loop
			insert into neprintsev_ia.ref_regex_ent(ENTITY,REGEX_PATTERN) select m.merchant,C1.REGEX_PATTERN  from neprintsev_ia.ref_merchants m where regexp_like(upper(m.street),trim(upper(C1.REGEX_PATTERN))) and m.city ='MOSKVA';
			--insert into neprintsev_ia.ref_regex_ent(ENTITY,REGEX_PATTERN) select m.merchant,C1.REGEX_PATTERN from neprintsev_ia.ref_merchants m;--regexp_like(upper(m.street),upper(C1.C3));
			DBMS_OUTPUT.PUT_LINE(C1.REGEX_PATTERN);    
		  end loop;  
		END P_REGEX;
		
		set serveroutput on
		DECLARE
		   TYPE EmpCurTyp IS REF CURSOR;
		   emp_cv   EmpCurTyp;
		   emp_rec  ref_regex_pattern%ROWTYPE;
		   sql_stmt VARCHAR2(250);
		   sql_stmt2 varchar(250);
		   v_job   number := 10;
		BEGIN
		   sql_stmt := 'SELECT * FROM ref_regex_pattern WHERE rownum <= :j';
		   sql_stmt2 := 'INSERT INTO temp7(c1) select m.merchant from ref_merchants m where regexp_like(upper(m.street),upper(:a)) ';
		   OPEN emp_cv FOR sql_stmt USING v_job;
		   LOOP
			 FETCH emp_cv INTO emp_rec;
			 EXIT WHEN emp_cv%NOTFOUND;
			 DBMS_OUTPUT.PUT_LINE('Name: ' || emp_rec."NAME");
			 execute immediate sql_stmt2 using emp_rec."NAME";
		   END LOOP;
		   CLOSE emp_cv;
		END;

		
		"define fnRegDate = trunc(sysdate,'dd')-1/24/60/60
		define stRegDate = trunc(&fnRegDate,'mm')

		define stSLDate = add_months(trunc(&stRegDate,'mm'),-5)
		define fnSLDate = trunc(add_months(trunc(&fnRegDate,'mm'),+2),'mm')-(1/24/60/60)


		select
		to_char(&fnRegDate,'dd.mm.yyyy hh24:mi:ss') "FNREG",
		to_char(&stRegDate,'dd.mm.yyyy hh24:mi:ss') "STREG",
		to_char(&fnSLDate,'dd.mm.yyyy hh24:mi:ss') "FNSL",
		to_char(&stSLDate,'dd.mm.yyyy hh24:mi:ss') "STSL"
		from dual;
		
		create type emp_obj is object (empno number, ename varchar2(10));
		create type emp_tab is table of emp_obj;

		create or replace function all_emps return emp_tab
			is
			  l_emp_tab emp_tab := emp_tab();
			   n integer := 0;
		   begin
		   
			  for r in (select c1 empno, c2 ename from temp)
			  
			  loop
				  l_emp_tab.extend;
				  n := n + 1;
				l_emp_tab(n) := emp_obj(r.empno, r.ename);
			  end loop;
			  
			  return l_emp_tab;
		   end;
		   
		select * from table (all_emps);
		CREATE OR REPLACE function get_daily
		  RETURN SYS_REFCURSOR
		AS
		  my_cursor SYS_REFCURSOR;
		BEGIN
		  OPEN my_cursor FOR SELECT * FROM temp_acq_d;
		  RETURN my_cursor;
		END get_daily;



		create table t_daily_d
		(
		"ID" number not null,
		"PAY_SYS" varchar(10) not null,
		constraint pk_daily_id primary key ("ID")
		)

		------------------------------------
		drop sequence seq_d ;
		Create sequence seq_d start with 1
		increment by 1
		minvalue 1
		maxvalue 1000000000;

		------------------------------------

		insert into t_daily_d 
		values
		(seq_d.nextval,'A')

		------------------------------------"
		"create table test1 (c1 date,c2 varchar(10),c3 varchar(10),c4 number) ;


		insert into test1 select sysdate-68,'2','10',0.564032697547684  from dual ;
		insert into test1 select sysdate-97,'4','15',0.329087048832272  from dual ;
		insert into test1 select sysdate-140,'1','15',1.66015625  from dual ;
		insert into test1 select sysdate-165,'4','12',0.630021141649049  from dual ;
		insert into test1 select sysdate-171,'5','14',1.21212121212121  from dual ;
		insert into test1 select sysdate-220,'2','13',0.805111821086262  from dual ;
		insert into test1 select sysdate-227,'3','10',0.878048780487805  from dual ;
		insert into test1 select sysdate-283,'4','10',1.50922509225092  from dual ;
		insert into test1 select sysdate-338,'3','10',0.868217054263566  from dual ;
		insert into test1 select sysdate-383,'3','14',2.36526946107784  from dual ;
		insert into test1 select sysdate-429,'1','13',0.316062176165803  from dual ;
		insert into test1 select sysdate-499,'3','13',0.92817679558011  from dual ;
		insert into test1 select sysdate-547,'3','15',0.226299694189602  from dual ;
		insert into test1 select sysdate-609,'1','13',0.809128630705394  from dual ;
		insert into test1 select sysdate-628,'5','13',0.0595238095238095  from dual ;
		insert into test1 select sysdate-635,'3','13',1.03562945368171  from dual ;
		insert into test1 select sysdate-674,'3','12',0.242811501597444  from dual ;
		insert into test1 select sysdate-715,'1','11',0.80672268907563  from dual ;
		insert into test1 select sysdate-787,'4','15',2.21739130434783  from dual ;
		insert into test1 select sysdate-834,'5','15',0.651764705882353  from dual ;
		insert into test1 select sysdate-879,'2','10',0.799086757990868  from dual ;
		insert into test1 select sysdate-944,'1','13',0.60958904109589  from dual ;
		insert into test1 select sysdate-958,'1','10',0.462222222222222  from dual ;
		insert into test1 select sysdate-1021,'5','10',2.50617283950617  from dual ;
		insert into test1 select sysdate-1054,'1','11',1.04618937644342  from dual ;
		insert into test1 select sysdate-1076,'1','11',0.0290909090909091  from dual ;
		insert into test1 select sysdate-1109,'2','11',1.10096153846154  from dual ;
		insert into test1 select sysdate-1143,'3','14',0.514285714285714  from dual ;
		insert into test1 select sysdate-1191,'2','13',0.123711340206186  from dual ;
		insert into test1 select sysdate-1211,'4','15',0.469565217391304  from dual ;
		insert into test1 select sysdate-1245,'1','10',0.176339285714286  from dual ;
		insert into test1 select sysdate-1322,'5','15',0.324786324786325  from dual ;
		insert into test1 select sysdate-1384,'5','11',1.01793721973094  from dual ;
		insert into test1 select sysdate-1437,'4','13',0.264018691588785  from dual ;
		insert into test1 select sysdate-1466,'3','13',0.794029850746269  from dual ;
		insert into test1 select sysdate-1486,'5','11',0.507418397626113  from dual ;
		insert into test1 select sysdate-1513,'1','10',0.302884615384615  from dual ;
		insert into test1 select sysdate-1555,'5','12',0.864406779661017  from dual ;
		insert into test1 select sysdate-1633,'3','15',0.612385321100917  from dual ;
		insert into test1 select sysdate-1661,'4','10',0.545454545454545  from dual ;
		insert into test1 select sysdate-1731,'4','12',0.51875  from dual ;
		insert into test1 select sysdate-1747,'3','12',0.952479338842975  from dual ;
		insert into test1 select sysdate-1823,'1','12',0.35978835978836  from dual ;
		insert into test1 select sysdate-1894,'3','15',0.380129589632829  from dual ;
		insert into test1 select sysdate-1924,'5','10',0.603723404255319  from dual ;
		insert into test1 select sysdate-1936,'3','10',0.665271966527197  from dual ;
		insert into test1 select sysdate-1944,'2','11',1.48262548262548  from dual ;
		insert into test1 select sysdate-2009,'2','11',0.0341463414634146  from dual ;
		insert into test1 select sysdate-2082,'2','13',2.70285714285714  from dual ;
		insert into test1 select sysdate-2123,'2','14',0.912955465587045  from dual ;
		insert into test1 select sysdate-2203,'5','11',4.46728971962617  from dual ;
		insert into test1 select sysdate-2279,'4','10',0.127348643006263  from dual ;
		insert into test1 select sysdate-2296,'1','12',1.04892966360856  from dual ;
		insert into test1 select sysdate-2354,'5','13',1  from dual ;
		insert into test1 select sysdate-2412,'4','12',1.02762430939227  from dual ;
		insert into test1 select sysdate-2440,'3','10',0.911458333333333  from dual ;


		--select maximum by indexed column from date
		with t as (
		select
		--c4 "RT",
		c2 || '_' || c3 "IND",
		max(c1) "DATE"
		from test1
		group by c2 || '_' || c3
		)
		,
		t2 as (
		select
		c4 "RT",
		c2 || '_' || c3 "IND",
		c1 "DATE"
		from test1
		)

		select t2.* from t2
		join t on t.IND = t2.IND and t."DATE"=t2."DATE"
		"
		"drop table test_number;
		drop table test_number_min_max;

		CREATE TABLE test_number("ID_T" NUMBER,SEQ NUMBER,text VARCHAR2(5));
		INSERT INTO test_number VALUES(1,1,'AA');
		INSERT INTO test_number VALUES(1,3,'CC');
		INSERT INTO test_number VALUES(1,4,'DD');
		INSERT INTO test_number VALUES(1,5,'EE');
		INSERT INTO test_number VALUES(1,6,'FF');
		INSERT INTO test_number VALUES(1,7,'GG');
		INSERT INTO test_number VALUES(1,8,'HH');
		INSERT INTO test_number VALUES(1,10,'JJ');
		INSERT INTO test_number VALUES(2,1,'KK');
		INSERT INTO test_number VALUES(2,2,'LL');
		INSERT INTO test_number VALUES(2,3,'MM');
		INSERT INTO test_number VALUES(2,4,'NN');
		INSERT INTO test_number VALUES(2,6,'PP');
		INSERT INTO test_number VALUES(2,7,'QQ');
		INSERT INTO test_number VALUES(3,1,'TT');
		INSERT INTO test_number VALUES(3,4,'ZZ');
		INSERT INTO test_number VALUES(3,5,'XX');

		--///////////////////
		--//min max
		create table test_number_min_max("ID_T2" number,"MIN" number,"MAX" number);
		INSERT INTO test_number_min_max VALUES(1,1,12);
		INSERT INTO test_number_min_max VALUES(2,1,9);
		INSERT INTO test_number_min_max VALUES(3,1,5);

		--"oldschool" syntax
		SELECT "RWN" "ID_T3","ROWN" seq FROM 

		(SELECT ROWNUM "ROWN" FROM all_objects WHERE ROWNUM <13),
		(SELECT ROWNUM "RWN" FROM all_objects WHERE ROWNUM <4),
		test_number_min_max m

		WHERE "RWN"="ID_T2" AND "ROWN" >= "MIN" AND "ROWN" <= "MAX" AND ("RWN","ROWN") NOT IN
		(SELECT "ID_T",seq FROM test_number)


		--join syntax
		select t."RWN",t3."ROWN" from
		(SELECT ROWNUM "RWN" FROM all_objects WHERE ROWNUM <4) t
		join test_number_min_max t2 on t2."ID_T2" = t."RWN"
		join (SELECT ROWNUM "ROWN" FROM all_objects WHERE ROWNUM <13) t3 on t3."ROWN" >= t2."MIN" and  t3."ROWN" <= t2."MAX"

		where (t."RWN",t3."ROWN" ) not in (SELECT "ID_T",seq FROM test_number)

		--//\\\\\\\\\\\\\\\\\\\\\\\
				}
			}
				
				public class procedures()
				{
					
					public void MAINTAIN()
					{
						
						create or replace
	procedure maintain as
	begin


	begin
	  for rec in (
	select * from all_objects where owner like '%NEPRIN%' and (object_name like 'TEMP_%' or object_name like '%TEST%') 
	)
	  loop  
		begin 
		  if rec.object_type= 'TABLE' then 
		   EXECUTE IMMEDIATE 'DROP '
								  || rec.object_type
								  || ' "'
								  || rec.object_name
								  || '" CASCADE CONSTRAINTS';
			 ELSE
				EXECUTE IMMEDIATE 'DROP '
								  || rec.object_type
								  || ' "'
								  || rec.object_name
								  || '"';
		end if;
	  end;
	  end loop;
	end;

	end;
	/

	create or replace
	procedure P_CHECK as
	  begin
	  
	  
	  begin
		for rec in (
	  select * from all_objects where owner like '%NEPRIN%' and (object_name = 'MAINTAIN') 
	  )
		loop  
		  begin 
			if rec.object_type= 'TABLE' then 
			 EXECUTE IMMEDIATE 'DROP '
									|| rec.object_type
									|| ' "'
									|| rec.object_name
									|| '" CASCADE CONSTRAINTS';
			   ELSE
				  EXECUTE IMMEDIATE 'DROP '
									|| rec.object_type
									|| ' "'
									|| rec.object_name
									|| '"';
		  end if;
		end;
		end loop;
	  end;
	  
	  end;
	  /
	  
	 begin
	dbms_job.change(210250, null,add_months(trunc(sysdate,'mm'),1)+6+8/24, 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+6+8/24');
	end;
	/

	begin
	dbms_job.change(214250, null,add_months(trunc(sysdate,'mm'),1)+6+8.15/24, 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+6+8.15/24');
	end;
	/
					}
				
				}
			
			}

			public protected class ORACLE()
			{
				public internal class Insertion()
				{
					
					public SQL_LOADER()
					{
						//ctl example
						//-----
						load data
						infile 'c:\test\sql_loader\terminals\load.txt'
						replace into table t_terminals3
						--append into table merchant_list
						fields terminated by "|" TRAILING NULLCOLS
						("TERMINAL","MERCHANT" 
						,"OPEN_DATE" DATE 'DD.MM.YYYY HH24:MI:SS'
						,"CLOSE_DATE" DATE 'DD.MM.YYYY HH24:MI:SS'
						,"STATUS"				
						--( "NAME" ,"DEPARTMENT" ,"TERM_ID","TR_DATE" DATE 'DD.MM.YYYY HH24:MI:SS',"P_SYS","A_CARD","A_ACQ_B","A_CARD_ISS"
						--,"A_AMT" "TO_NUMBER(replace(:A_AMT,'.',','))"
						--,"A_FEE" "TO_NUMBER(replace(:A_FEE,'.',','))"
						--,"A_FEE_AMT" "TO_NUMBER(replace(:A_FEE_AMT,'.',','))"
						--,"A_P_AMT" "TO_NUMBER(replace(:A_P_AMT,'.',','))"
						--,"A_CCY","A_SLIP","A_APR_CODE","A_TR_TYPE" ,"A_P_MERCH","A_F_NAME","A_ARN"
						)
						
						//load par example
						DATA=C:\test\sql_loader\terminals\load.txt
						USERID=neprintsev_ia/awsedrDRSEAW@dwh
						CONTROL=C:\test\sql_loader\ctl.ctl
						LOG=C:\test\sql_loader\terminals\log.txt
						
					}
				
				}
			}
			
		}

		//SQL SERVER
		//T SQL
		public void T_SQL()
		{
					
			public internal classs Theory()
			{
				public class Procedures_Functions_difference()
				{
					+---------------------------------+----------------------------------------+
					| Stored Procedure (SP)           | Function (UDF - User Defined           |
					|                                 | Function)                              |
					+---------------------------------+----------------------------------------+
					| SP can return zero , single or  | Function must return a single value    |
					| multiple values.                | (which may be a scalar or a table).    |
					+---------------------------------+----------------------------------------+
					| We can use transaction in SP.   | We can't use transaction in UDF.       |
					+---------------------------------+----------------------------------------+
					| SP can have input/output        | Only input parameter.                  |
					| parameter.                      |                                        |
					+---------------------------------+----------------------------------------+
					| We can call function from SP.   | We can't call SP from function.        |
					+---------------------------------+----------------------------------------+
					| We can't use SP in SELECT/      | We can use UDF in SELECT/ WHERE/       |
					| WHERE/ HAVING statement.        | HAVING statement.                      |
					+---------------------------------+----------------------------------------+
					| We can use exception handling   | We can't use Try-Catch block in UDF.   |
					| using Try-Catch block in SP.    |                                        |
					+---------------------------------+----------------------------------------+
				}
				
			}
			
			public internal class Insertion()
			{
					public Shitty_Callendar()
					{
						
						drop table  master.dbo.calendar ;
						create table master.dbo.calendar (id int ,"DATE" date
						, primary key (ID)
						);

						delete from master.dbo.calendar;

						declare @cnt int ;
						declare @max int;
						select @cnt = 0;
						set @max = 12*10;

						while @cnt < @max
						begin
						set @cnt = @cnt+1;
						print(dateadd(month,-(@max-@cnt),dateadd(MONTH,DATEDIFF(MONTH,0,getdate()),0)));

						insert into master.dbo.calendar (ID,DATE)
						values (
						@cnt,
						dateadd(month,-(@max-@cnt),dateadd(MONTH,DATEDIFF(MONTH,0,getdate()),0))
						);
						--print(- @cnt);
						end ;


						select * from master.dbo.calendar



					}
			}
			
			public internal class Selection()
			{
				
				public datetime()
				{
					
					--trunc by month
					select dateadd (yy,DATEDIFF(yy, 0,GETDATE()),0)
					select CONVERT(date,GETDATE(),103) where CONVERT(date,GETDATE(),103) = '01/09/2016'
					CONVERT(datetime,"DATE",104)
					select @@ROWCOUNT from DWH_replica.dbo.FD_ACQ_D
					
					select  
					format(
					getdate()
					,'dd.MM.yyyy hh:mm:ss');
					
					select convert(varchar,getdate(),120);
					select convert(date,getdate(),113);
					
				}

			}
			
			public internal class MAINTANANCE()
			{
				
				public tableCreate()
				{
									
					//table with prim,sec keys
					create table teble(
					ID int not null identity(0,1), --not nullable id increasing from 0 by 1 every insert
					SEC_ID int null, --foreign key
					primary key(ID), -- indicates primary key
					foreign key(SEC_ID) references SEC_NAMES(ID), -- indicates secondary key and according key in other table
					)

					//create table add key add foreign key
					create table DWH_replica.dbo.table2 (
					ID int not null identity(0,1),
					TXT varchar(50),
					DT Datetime);

					alter table DWH_replica.dbo.table2
					add primary key (ID);

					create table DWH_replica.dbo.table1 (
					ID int not null identity(0,1),
					SEC_ID int null,
					primary key (ID),
					foreign key (SEC_ID) references DWH_replica.dbo.table2(ID));

				}

			}
		
			public void Queries()
			{
				
				public void Cases()
				{
					
--Sample get max value for col1 by col2
create table #Temp(
	 EmplID int,DepID int ,Sal dec, primary key (EmplID)
)

declare @counter1 smallint;
declare @counter2 smallint;
declare @counter3 smallint;
declare @sal dec;

set @counter1 = 0;
set @counter2 = 0;
set @counter3 = 0;

while @counter1 < 50
	begin	
		while @counter2 < 5
		begin
			set @sal = rand()*1000;
			insert into #Temp (EmplID,DepID,Sal) values(@counter1,@counter3,@sal);
			set @counter1=@counter1+1;
			set @counter2=@counter2+1;
		end;
		set @counter2=0;
		set @counter3=@counter3+1;
	end;
go

select * from #Temp;

select t2.EmplID, t.DepID,t."SAL" from (select DepID, max(Sal) "SAL" from #Temp group by DepID) t
left join (select EmplID,Sal from #Temp) t2 on t."SAL" = t2.Sal

drop table #Temp;



--Exists instead of not null
create table #Colors(Color varchar(10) primary key);
create table #Clothes(Color varchar(10),Clothes varchar(10));

insert into #Colors (Color) values ('Red');
insert into #Colors (Color) values ('Blue');
insert into #Colors (Color) values ('Green');
insert into #Colors (Color) values ('Cyan');
insert into #Colors (Color) values ('Yellow');

insert into #Clothes values('Red','Trouses');
insert into #Clothes values('Blue','Skit');
insert into #Clothes values(null,'Coat');

select * from #Colors;
select * from #Clothes;


select * from #Colors t
where not exists (select * from #Clothes c where c.Color=t.Color);


drop table #Colors;
drop table #Clothes;





--check cast varchar to int
create table #Account(Name varchar(20) ,Val varchar(20));

insert into #Account values ('name1','abc');
insert into #Account values ('name2',1);
insert into #Account values ('name3',2);
insert into #Account values ('name4','4');
insert into #Account values ('name5','as');

select 
*
from #Account where 1=1 
--and  Val not like '%[^0-9]%'
and 
case when Val not like '%[^0-9]%' then cast(Val as int) 
 end > 0;

drop table #Account;


				}
			
	 	public void Pivot()
				{
					
					
select 'Avg' as avg, [110221],[115201],[140091] from (
select ZipCode, Id--avg(Id) as "AVG"
from Adresses
where ZipCode in (110221,115201,140091)
--group by ZipCode
) as source
pivot(
AVG(Id) for ZipCode in([110221],[115201],[140091])
) as pivot_

					
select 'Avg' as avg, [1],[1112] from (
select [Target],[UserID] from TaskBasePermission 
) as source
pivot (
AVG( [Target]) for [UserID] in ([1],[1112])
) as pivot_

				}
				
			}			
		
		}
	
	}
		
	public void NoSQL()
	{

		public void OrientDB()
		{
			
			public void REST_API()
			{				

Orient_REST_API(){

	https://orientdb.com/docs/2.1/OrientDB-REST.html?q=
	http://localhost:2480/database/test_db1/plocal
	http://localhost:2480/class/test_db1/Address2
	http://localhost:2480/class/test_db1/dateField/DATE
	http://localhost:2480/class/test_db1/
	{
	  "name": {
		  "propertyType": "STRING"
	  },
	  "father": {
		  "propertyType": "LINK",
		  "linkedClass": "Person"
	  }
	}

	http://localhost:2480/command/test_db1/sql
	{
	  "command": "select from V where name = :name and city = :city",
	  "parameters": {
		"name": "Luca",
		"city": "Rome"
	  }
	}
	//sql batch
	http://localhost:2480/batch/test_db1/
	{ "transaction" : true,
	  "operations" : [
		{
		  "type" : "script",
		  "language" : "sql",
		  "script" : [ "LET account = CREATE VERTEX Account SET name = 'Luke'",
					   "LET city = SELECT FROM City WHERE name = 'London'",
					   "CREATE EDGE Lives FROM $account TO $city RETRY 100" ]
		}
	  ]
	}
	
	//batch
	http://localhost:2480/batch/test_db1/
	{ "transaction" : true,
	  "operations" : [
		{ "type" : "u",
		  "record" : {
			"@rid" : "#14:122",
			"name" : "Luca",
			"vehicle" : "Car"
		  }
		}, {
		  "type" : "d",
		  "record" : {
			"@rid" : "#14:100"
		  }
		}, {
		  "type" : "c",
		  "record" : {
			"@class" : "City",
			"name" : "Venice"
		  }
		}, {
		  "type" : "cmd",
		  "language" : "sql",
		  "command" : "create edge Friend from #10:33 to #11:33"
		}, {
		  "type" : "script",
		  "language" : "javascript",
		  "script" : "orient.getGraph().createVertex('class:Account')"
		}
	  ]
	}

	http://localhost:2480/cluster/test_db1/Address

	ALTER CLASS Customer ADDCLUSTER USA_Customers
	clusters
	browse cluster OUser

	
	
}

Orient_REST_FIDDLER(){
		
	POST/DELETE
	http://localhost:2480/database/demo/plocal
	//delete response
	{"result":[{"@type":"d","@version":0,"value":0}]}


	http://localhost:2480/connect/test_db1
	User-Agent: Fiddler
	Host: localhost:2480
	Authorization: Basic cm9vdDpyb290


	http://localhost:2480/database/test_db1
	Host: localhost:2480
	Cookie: OSESSIONID=OS15104197214972108562285800211602;
	Connection: keep-alive

	http://localhost:2480/command/test_db/sql
	Host: localhost:2480
	Connection: keep-alive
	Authorization: Basic cm9vdDpyb290
	Content-Length: 85
	{"command": "CREATE PROPERTY VSC.Name STRING (MANDATORY TRUE, NOTNULL TRUE);"}
	{"command": "CREATE class  Person extends V;"}
	{"command": "CREATE class  Unit extends V;"}
	{"command": "CREATE class MainAssignment extends E;"}
	{"command":"create vertex Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"1\", \"Name\": \"0\"}"}
	{   "transaction":true,"operations":[   {"type":"script","language":"sql","script":[   "Create Vertex Person content {"Name":"0","GUID":"1","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}"   ]}]}   
  
  
	
	http://localhost:2480/batch/test_db/sql
	Host: localhost:2480
	Connection: keep-alive
	Authorization: Basic cm9vdDpyb290
	Content-Length: 756
	{ "transaction" : true,
	"operations" : [
	{
	  "type" : "script",
	  "language" : "sql",
	  "script" : [
	"delete vertex Person",
		 "create vertex Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"1\", \"Name\": \"0\"}"
		 ,"create vertex Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"2\", \"Name\": \"0\"}"
		 ,"create vertex Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"3\", \"Name\": \"0\"}"
		 ,"create vertex Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"4\", \"Name\": \"0\"}"
	  ]
	}
	]
	}

	{ "transaction" : true,
	"operations" : [
	{
	  "type" : "script",
	  "language" : "sql",
	  "script" : [
	"delete vertex Person",
	"delete vertex Unit",
	"delete edge MainAssignment",
	"create vertex Unit content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"5\", \"Name\": \"0\"}",
	"create vertex Unit content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"6\", \"Name\": \"0\"}",
	"create vertex Unit content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"7\", \"Name\": \"0\"}",

	"create vertex Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"1\", \"Name\": \"0\"}"
	,"create vertex Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"2\", \"Name\": \"0\"}"
	,"create vertex Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"3\", \"Name\": \"0\"}"
	,"create vertex Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"4\", \"Name\": \"0\"}"


	]
	}
	]
	}
	
	//will work edges only throught let or command
	{ "transaction" : true,
	"operations" : [
	{
	  "type" : "script",
	  "language" : "sql",
	  "script" : [
	"let a = select from Unit where GUID =5",
	"let b = select from Person where GUID =1",
	" create edge MainAssignment from $a to $b  content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"8\", \"Name\": \"0\"}"

	]
	}
	]
	}
	
	//will work too
	{ "transaction" : true,
	"operations" : [
	{
		  "type" : "cmd",
		  "language" : "sql",
		  "command" : "create edge MainAssignment from 47:0 to 50:1 content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"4\", \"Name\": \"0\"}"
		}
	]
	}
	//Multibatch create
	{ "transaction" : true,
	"operations" : [
	{
		"type" : "script",
		"language" : "sql",
		"script" : [

		"let a=create vertex Unit content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"5\", \"Name\": \"0\"}"
		,"let b=create vertex Unit content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"6\", \"Name\": \"0\"}"
		,"create edge MainAssignment from $a to $b  content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"8\", \"Name\": \"0\"}"

		,"let a=create vertex Unit content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"7\", \"Name\": \"0\"}"
		,"let b=create vertex Unit content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"8\", \"Name\": \"0\"}"
		,"create edge MainAssignment from $a to $b  content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"8\", \"Name\": \"0\"}"
	
		]
	}
	]
	}
	
	//Multibatch select
	{ "transaction" : true,
	"operations" : [
	{
	  "type" : "script",
	  "language" : "sql",
	  "script" : [
	  
	"let a = select from Unit where GUID =5"
	,"let b = select from Unit where GUID =6"
	," create edge MainAssignment from $a to $b  content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"8\", \"Name\": \"0\"}"

	,"let a = select from Unit where GUID =7"
	,"let b = select from Unit where GUID =8"
	," create edge MainAssignment from $a to $b  content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"8\", \"Name\": \"0\"}"

	]
	}
	]
	}
	
	
	//will not work -> only command
	{ "transaction" : true,
	  "operations" : [
		{
		  "type" : "script",
		  "language" : "sql",
		  "script" : [

	"create edge MainAssignment from (select from Unit where Name = 5) to (select from Person where Name = 1) content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"8\", \"Name\": \"0\"}"
	,"create edge MainAssignment from (select from Unit where Name = 5) to (select from Person where Name = 2) content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"8\", \"Name\": \"0\"}"
	,"create edge MainAssignment from (select from Unit where Name = 6) to (select from Person where Name = 3) content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"8\", \"Name\": \"0\"}"

	]
		}
	  ]
	}
	
	
//quotes correct excape in body to batch

//with gap insert
{ "transaction" : true,
	"operations" : [
	{
		  "type" : "cmd",
		  "language" : "sql",
"command" : "create vertex News content {\"GUID\": \"119\", \"Created\":\"2015-02-02 12:43:56\",\"content_\":\"c \\\"a a\\\" t\"}"
		}
	]
	}
	
	
//no gap insert	
	{ "transaction" : true,
	"operations" : [
	{
		  "type" : "cmd",
		  "language" : "sql",
"command" : "create vertex News content {\"GUID\": \"119\", \"Created\":\"2015-02-02 12:43:56\",\"content_\":\"c \\"a \\"a t\"}"
		}
	]
	}	

POST,DELETE function
{query bodies for function create delete}
{POST}
http://msk1-vm-ovisp02:2480/command/news_prod/sql/
delete from Ofunction where name = "test";
CREATE FUNCTION test "var gp= orient.getGraph();var res=gp.command(\"sql\",\"select from \"+var1);return res;"  PARAMETERS [var1] IDEMPOTENT true LANGUAGE JAVASCRIPT
		batchInsertPOCCbodyURI{
					
		http://msk1-vm-ovisp02:2480/command/news_test3/sql/create vertex Person content {"Changed": "2017-10-19 18:00:09", "Created": "2015-02-02 12:43:56", "GUID": "0", "Name": "0"}

		{ "transaction" : true,
		  "operations" : [
			{
			  "type" : "script",
			  "language" : "sql",
			  "script" : [ "INSERT INTO Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"0\", \"Name\": \"0\"}",
						   "INSERT INTO Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"0\", \"Name\": \"0\"}"
						   ]
			}
		  ]
		}


		{ "transaction" : true,
		  "operations" : [
			{
			  "type" : "script",
			  "language" : "sql",
			  "script" : [
				 "create vertex Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"0\", \"Name\": \"0\"}"
				 ,"create vertex Person content {\"Changed\": \"2017-10-19 18:00:09\", \"Created\": \"2015-02-02 12:43:56\", \"GUID\": \"0\", \"Name\": \"0\"}"
			  ]
			}
		  ]
		}


		"http://msk1-vm-ovisp02:2480/connect/news_test3"
		"http://msk1-vm-ovisp02:2480/command/news_test3/sql"
		"Select from Person"
		"where 1=1"
		http://msk1-vm-ovisp02:2480/command/news_test3/sql/Select from Person where 1=1

	}
	
	createVertexURI{
		Create Vertex Person content {"Created":"2017-10-27T14:45:11.3738136+03:00","GUID":"0","Changed":"2017-10-27T14:45:11.3733119+03:00","Name":"0"}
		//ALTER DATABASE DATETIMEFORMAT "yyyy-MM-dd HH:mm:ss"
		Create Vertex Person content {"Created":"2017-10-27 14:55:02","GUID":"0","Changed":"2017-10-27 14:55:02","Name":"0"}

		Delete Vertex Person where "Name" = "0"
		
		http://msk1-vm-ovisp02:2480/command/news_test3/sql/Delete Vertex Person where Name = 0
													
	}
}
			
			}
			
			public void Maintenance()
			{
				
//Query metadata
//get calsess
select expand(classes) from metadata:schema
//get properties for classes
select expand(properties) from (select expand(classes) from metadata:schema)

	public CreateFunctQuery()
	{
		
CREATE FUNCTION test "var g=orient.getGraph(); var b=g.command(\"sql\",\"select if(eval(\'1=2\'),2,3) \" ); return b;" 
PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT
	
CREATE FUNCTION test "var g=orient.getGraph(); var b=g.command(\"sql\",\"select from Person where sAMAccountName = 'kpa' \" ); return b;" 
PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT

CREATE FUNCTION test "var g=orient.getGraph(); var b=g.command(\"sql\",\"select if(eval(\'1=2\'),2,3) \" ); return b;" 
PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT
CREATE FUNCTION test "var gp= orient.getGraph();var res=gp.command(\"sql\",\"select in('\"+var1+\"') from \"+var2);return res;"  
PARAMETERS [var1,var2] IDEMPOTENT true LANGUAGE JAVASCRIPT														 
		
	}
	
	public TestFunctionQuery()
	{

select from Ofunction where name = "test";
delete from Ofunction where name = "test";
CREATE FUNCTION test "var gp= orient.getGraph();var res=gp.command(\"sql\",\"select in('\"+var1+\"') from \"+var2);return res;"  PARAMETERS [var1,var2] IDEMPOTENT true LANGUAGE JAVASCRIPT
select test("Authorship","News")

{query bodies for function create delete}
{POST}
http://msk1-vm-ovisp02:2480/command/news_prod/sql/
delete from Ofunction where name = "test";
CREATE FUNCTION test "var gp= orient.getGraph();var res=gp.command(\"sql\",\"select from \"+var1);return res;"  PARAMETERS [var1] IDEMPOTENT true LANGUAGE JAVASCRIPT

select test("News")

	}
	
	public void Initial_NewsApi_Queries()
	{


CREATE CLASS VSC extends V;

CREATE PROPERTY VSC.Name STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.GUID STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.Created DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.Changed DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.PGUID STRING;
CREATE PROPERTY VSC.Disabled DATETIME;

ALTER PROPERTY VSC.GUID DEFAULT uuid();
ALTER PROPERTY VSC.Created DEFAULT "sysdate()";
ALTER PROPERTY VSC.Changed DEFAULT "sysdate()";


CREATE CLASS ESC extends E;

CREATE PROPERTY ESC.Name STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.GUID STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.Created DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.Changed DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.PGUID STRING;
CREATE PROPERTY ESC.Disabled DATETIME;

ALTER PROPERTY ESC.GUID DEFAULT uuid();
ALTER PROPERTY ESC.Created DEFAULT "sysdate()";
ALTER PROPERTY ESC.Changed DEFAULT "sysdate()";

create class Unit extends VSC;
create class Person extends VSC;

create class SubUnit extends E;
create class MainAssignment extends ESC;
create class InExtAssignment extends ESC;
create class OutExtAssignment extends ESC;
create class OldMainAssignment extends ESC;

delete vertex Unit;
delete vertex Person;
delete edge SubUnit;
delete edge MainAssignment;
delete edge InExtAssignment;
delete edge OutExtAssignment;
delete edge OldMainAssignment;

ALTER PROPERTY ESC.GUID DEFAULT uuid();
ALTER PROPERTY ESC.Created DEFAULT sysdate();
ALTER PROPERTY ESC.Changed DEFAULT sysdate();
ALTER PROPERTY VSC.GUID DEFAULT uuid();
ALTER PROPERTY VSC.Created DEFAULT sysdate();
ALTER PROPERTY VSC.Changed DEFAULT sysdate();


alter database custom standardElementConstraints=false

CREATE CLASS Object_SC extends V;

create class UserSettings extends V;

CREATE PROPERTY UserSettings.showBirthday BOOLEAN ;

CREATE PROPERTY Object_SC.Id INTEGER (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY Object_SC.Content STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY Object_SC.Created DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY Object_SC.Changed DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY Object_SC.Disabled DATETIME;

ALTER PROPERTY Object_SC.Created DEFAULT "sysdate()";
ALTER PROPERTY Object_SC.Changed DEFAULT "sysdate()";


CREATE CLASS Object EXTENDS Object_SC;
CREATE CLASS Authorship EXTENDS E;
CREATE CLASS Comment EXTENDS E;

CREATE CLASS CommonSettings EXTENDS E;

update MainAssignment remove HierarhyWeight;
CREATE PROPERTY MainAssignment.HierarhyWeight INTEGER;

CREATE PROPERTY Person.sAMAccountName string;
CREATE PROPERTY Person.mail string;

create index Person.Name_sAMAccountName_mail on Person (Name,sAMAccountName,mail)  FULLTEXT ENGINE LUCENE;
create index OFunction.name on OFunction (Name) UNIQUE_HASH_INDEX;
ALTER PROPERTY VSC.Seed DEFAULT "sequence('intranet_seed').next()";

/*

//property logic
(Person)-[CommonSettings]->(UserSettings {"bool":"true"})

//egge logic
(Person)-[publishBirthdate]->(BirthdayV)

create class BirthdayV extends V;
create Property BirthdayV.BirthDay DATETIME;
create class publishBirthdate extends E;

create vertex BirthdayV set BirthDay = '1984-11-11 00:00:00';
create vertex BirthdayV set BirthDay = '1976-05-22 00:00:00';
create edge publishBirthdate from (select from 21:0 ) to (select from 45:0);
create edge publishBirthdate from (select from 21:2 ) to (select from 46:0);
select outE("publishBirthdate").inV().BirthDay[0] as BD ,Name from Person where @rid  in [21:0,21:2,21:3];

*/

/*Lowerest level Weight*/
update MainAssignment set HierarhyWeight = 1000;

/*Managment hierarhy*/
update MainAssignment set HierarhyWeight = 0 where Name = 'Генеральный директор'
update MainAssignment set HierarhyWeight = 1 where Name = 'Заместитель Генерального директора'
update MainAssignment set HierarhyWeight = 50 where Name = 'Директор Административного департамента - Финансовый директор'
update MainAssignment set HierarhyWeight = 50 where Name = 'Директор департамента'
update MainAssignment set HierarhyWeight = 50 where Name = 'Директор департамента / Главный архитектор'
update MainAssignment set HierarhyWeight = 50 where Name = 'Директор Департамента ИТ'
update MainAssignment set HierarhyWeight = 50 where Name = 'Директор Департамента маркетинга и развития бренда'
update MainAssignment set HierarhyWeight = 50 where Name = 'Директор Департамента стратегического планирования и проектного управления'
update MainAssignment set HierarhyWeight = 50 where Name = 'Директор Организационно-правового департамента'
update MainAssignment set HierarhyWeight = 50 where Name = 'Директор по персоналу, руководитель Службы персонала'
update MainAssignment set HierarhyWeight = 50 where Name = 'Коммерческий директор - директор департамента'
update MainAssignment set HierarhyWeight = 51 where Name = 'Заместитель директора департамента'
update MainAssignment set HierarhyWeight = 51 where Name = 'Заместитель директора Департамента архитектуры и разработки ПО'
update MainAssignment set HierarhyWeight = 51 where Name = 'Заместитель директора департамента ИТ'
update MainAssignment set HierarhyWeight = 51 where Name = 'Заместитель директора департамента-HR директор'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник управления'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления cпециальных проектов и PR'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления администрации и делопроизводства'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления безопасности'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления бухгалтерского учета и отчетности - Главный бухгалтер'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления бюджетирования и управленческого учета'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления внутреннего аудита (контроля)'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления инноваций'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник управления инфраструктуры'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления по работе с платежными системами'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления развития продуктов и партнерских программ'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления разработки ПО'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления разработки правил НСПК'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления разработки программного обеспечения'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления регламентации и процедур'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления тарифов и отчетности'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Управления технологий'
update MainAssignment set HierarhyWeight = 100 where Name = 'Начальник Юридического управления'
																											  
																																										 
update MainAssignment set HierarhyWeight = 101 where Name = 'Заместитель начальника управления'
update MainAssignment set HierarhyWeight = 101 where Name = 'Заместитель начальника Управления безопасности'
update MainAssignment set HierarhyWeight = 101 where Name = 'Заместитель начальника Управления бухгалтерского учета и отчетности'
update MainAssignment set HierarhyWeight = 101 where Name = 'Заместитель начальника Управления развития продуктов и партнерских программ'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник отдела'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник отдела - заместитель начальника управления'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела администрирования инфраструктурных сервисов'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела взаимоотношений с поставщиками'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела внутренней безопасности'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник отдела инфраструктурного мониторинга'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела криптографической защиты информации'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела международных проектов'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела мониторинга бизнес-процессов'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела мониторинга и контроля информационной безопасности'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела по договорной работе'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела по корпоративно-правовой работе'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела правового сопровождения НСПК'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник отдела протокола'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник отдела разработки программных комплексов'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела сопровождения информационной безопасности и развития систем защиты'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела статистики и отчетности'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник Отдела тестирования'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник отдела тестирования онлайн систем'
update MainAssignment set HierarhyWeight = 150 where Name = 'Начальник отдела технического администрирования'
update MainAssignment set HierarhyWeight = 151 where Name = 'Заместитель начальника отдела'
update MainAssignment set HierarhyWeight = 151 where Name = 'Заместитель начальника Отдела взаимоотношений с поставщиками'
	}

	public void Initial_PersonApi_Functions()
	{
		//create function 
		//CREATE FUNCTION test "var g=orient.getGraph();var b=g.command(\"sql\",\"select from Person where sAMAccountName =  '\"+accountName+\"' \");return b;" PARAMETERS [accountName]  IDEMPOTENT true LANGUAGE JAVASCRIPT
		
		/*
delete from OFUNCTION where name = 'test'

CREATE FUNCTION test " value \"  \\\" ' \' \\' \\\' "  IDEMPOTENT true LANGUAGE JAVASCRIPT
value "  \" ' ' \' \' 


CREATE FUNCTION test " value \"  \\\" ' \' \\' \\\' \\ "  IDEMPOTENT true LANGUAGE JAVASCRIPT
value "  \" ' ' \' \' \ 

		*/
		
		/*GetUnitByAccount*/
		delete from Ofunction  where name in ["GetGUID","GetCollegesLowerByAccount","GetLowerCase","GetUnitByAccount","GetDepartmentByAccount","GetManagerByAccount","GetManagerHierarhyByAccount","GetCollegesByAccount"]
	
		CREATE FUNCTION GetLowerCase "var g=orient.getGraph(); var b=g.command(\"sql\",\" select r.ToLowerCase() as r from (select '\"+input+\"' as r) \"); return b;" PARAMETERS [input] IDEMPOTENT true LANGUAGE JAVASCRIPT ;
		CREATE FUNCTION GetUnitByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\" select in('MainAssignment').Name[0] as Name from Person WHERE sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0] and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )\"); return b;" PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetDepartmentByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\" select Name from ( traverse in('MainAssignment','SubUnit') from (select from Person where sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0] ) ) where PGUID='00000000-0000-0000-0000-000000000000'  \" ); return b;" PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetManagerByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\"select r as Name from ( select   /*   If person HierarhyWeight is smallest -> header of Unit => get PUnit header   else Unit Header   */ if(eval('$z.w[0]=$a.w[0]'),if(eval('$x.inE(\\\"MainAssignment\\\").outV(\\\"Unit\\\").PGUID =\\\"00000000-0000-0000-0000-000000000000\\\"'),'kvv',$f.Name[0]),$e.Name[0]) as r /* if(eval('1=2'),1,if(eval('1=2'),2,3)) */    let   $x = ( select  from Person where sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0]) 	/*person HierarhyWeight*/   ,$z = (       select HierarhyWeight as w from (select expand(inE('MainAssignment')) from Person where sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase())   where (inE('MainAssignment').Disabled is null or inE('MainAssignment').Disabled >= sysdate() and (inE('MainAssignment').State != 'Отпуск по уходу за ребенком' and inE('MainAssignment').State != 'Отпуск по беременности и родам' ))   )   /*Min weigth in Person Unit*/   ,$a = (     select min(HierarhyWeight) as w from ( select expand(inE('MainAssignment').OutV('SubUnit').outE('MainAssignment')) from Person where  sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase() ) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null  ) /*Min weigth in Person PUnit*/   , $b = (       select min(HierarhyWeight) as w from ( select expand(inE('MainAssignment').OutV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')) from Person where  sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase() ) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null    )   /*Person Unit person appointment*/   	, $c = (       select Name as d ,HierarhyWeight as w,inV('Person').sAMAccountName as Name from ( select expand(inE('MainAssignment').OutV('SubUnit').outE('MainAssignment')) from Person where  sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase() ) where    (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null      )   /*Person PUnit person appointment*/   ,$d =(         select Name as d ,HierarhyWeight as w,inV('Person').sAMAccountName as Name from ( select expand(inE('MainAssignment').OutV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')) from Person where sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase() ) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null       )   /*Person Unit Header $a->$c */   , $e = (      select from ( select expand($c)) where 1=1 and w =  $a.w[0]   )     /*Person PUnit Header $a->$c */   , $f = (      select from ( select expand($d)) where 1=1 and w = $b.w[0]   ) ) order by Name\"); return b;" PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;		
																																																																																																																	   
		CREATE FUNCTION GetManagerHierarhyByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\"  select  Acc as Name from (    select expand($b3)    let   $x = (      select from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0]    )  ,$a = (      /*From Person by Unit Hierarhy*/     select  Name as n, sAMAccountName as Acc, inE('MainAssignment').outV('Unit').Name[0] as d, inE('MainAssignment').HierarhyWeight[0] as w , 	 inE('MainAssignment').Name[0] as a from (       select expand(inV()) from (            traverse inE('MainAssignment','SubUnit'),outE('MainAssignment'),outV('Unit','Person') from (           select from person where 1=1 and sAMAccountName=$x.sAMAccountName[0] )           ) ) where 1=1      and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() ) and (Disabled is null) and     (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )         /*If account name not assigned then deputy*/ 	and sAMAccountName is not null       ), $c = (      /*Select Header by HierarhyWeight 0 */     select  Name as n, sAMAccountName as Acc, inE('MainAssignment').outV('Unit').Name[0] as d, inE('MainAssignment').HierarhyWeight[0] as w, 	inE('MainAssignment').Name[0] as a from ( select from Person where inE('MainAssignment').HierarhyWeight[0] = 0     )    ) , $e = unionall (      /*Union all Unit Headers and Directory (as ddirectory not in linear structure -> not binded to parent node*/     $a,$c    ), $b = (      /*From United Person by Unit Hierarhy minimal Wights in Unit by account*/     select from  (     select Acc,d,a, min(w) as w from (       select expand($e)     ) group by  Acc       ) where 1=1 and w < $x.inE('MainAssignment').HierarhyWeight[0] order by w    ), $b2 = (      /*Minuimal wight by department*/     select from  (     select d , min(w) as w from (       select expand($e)     ) group by d       ) where 1=1 and w < $x.inE('MainAssignment').HierarhyWeight[0] order by w    ), $b3 = (   	select from (select expand($b )) where w in $b2.w   )  ) order by Name  \"); return b; " PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetCollegesByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\" select sAMAccountName as Name from (   select expand($a)    let   $x = (     select from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0]   ),   $a =  (      select from (       select expand(a) from (         select inE('MainAssignment').outV('SubUnit').outE('MainAssignment').inV('Person') as a from (           select from person where 1=1 and sAMAccountName=$x.sAMAccountName[0])       )     ) where 1=1     /*Exclude person's account from results*/     and sAMAccountName != $x.sAMAccountName[0]      /*Standart overall Person filter*/     and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() )     and (Disabled is null)     and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )    )  ) order by Name \"); return b; " PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetCollegesLowerByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\"  select from (     select expand($c)     let $a = (select from Person where sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0] ),     $c = (       select sAMAccountName.ToLowerCase() as Name from (         traverse out('MainAssignment','SubUnit') from (           select  from ( traverse in('MainAssignment','SubUnit') from (select from  $a  ) ) where           PGUID='00000000-0000-0000-0000-000000000000'         )       ) where 1=1       and @class = 'Person'       and  inE('MainAssignment').HierarhyWeight[0] > $a.inE('MainAssignment').HierarhyWeight[0]      ),     $b =(       select ine('MainAssignment').HierarhyWeight from (         select expand($a)       )     )    ) order by Name \"); return b; " PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetGUID "var g=orient.getGraph(); var b=g.command(\"sql\",\" select GUID as Name from Person where sAMAccountName.tolowercase() = GetLowerCase('\"+accountName+\"').r[0] \"); return b;" PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT ;
		CREATE FUNCTION SearchByFNameLName "var g=orient.getGraph(); substr = substr.replace('ё','е').toUpperCase(); var b=g.command(\"sql\",\"select expand($c) let $a = (select distinct(LastName).replace('ё','е') as suggestion from Person WHERE (LastName.replace('ё','е').toUpperCase() like '%\"+substr+\"%' ) and (inE()[0].Disabled is null or inE()[0].Disabled >= sysdate() ) and (Disabled is null)  and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' ) ), $b = (select distinct(FirstName).replace('ё','е') as suggestion from Person WHERE (FirstName.replace('ё','е').toUpperCase() like '%\"+substr+\"%' ) and  (inE()[0].Disabled is null or inE()[0].Disabled >= sysdate() ) and  (Disabled is null) and (inE(\\\"MainAssignment\\\").State != 'Отпуск по уходу за ребенком' and inE(\\\"MainAssignment\\\").State != 'Отпуск по беременности и родам' )),  $c = unionall($a,$b)\"); return b;" PARAMETERS [substr] IDEMPOTENT true LANGUAGE JAVASCRIPT ; 
		
		CREATE FUNCTION GetStructureByUnitGUID "var g=orient.getGraph(); var b=g.command(\"sql\",\"select  GUID as id, ifnull( if( eval(\\\"@class = \\'Person\\'\\\"), in(\\\"MainAssignment\\\").GUID[0],PGUID[0]) , \\'0\\' ) as parent, ifnull(telephoneNumber, \\' \\') as phone, ifnull( mail,\\'&nbsp\\')as mail, Name as title, Name as label, ifnull((inE(\\\"MainAssignment\\\").Name[0]), Name) as description, GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\\\"@class = \'Person\'\\\"),\\'PersonTemplate\\',\\'UnitTemplate\\' ) as templateName , if(eval(\\'inE().ExpDate[0] is not null\\'), inE().State[0],null)  as state, if( eval(\\'inE().ExpDate[0] is not null\'),inE().ExpDate[0].format(\\'dd.MM.YYYY\\'),null) as expDate,  GetPositionBar(InE(\\\"MainAssignment\\\").Name[0].replace('\\\\\\\"',''))[\\'groupTitle\\'][0] as groupTitle  , Birthday.format(\\'dd.MM\\') as birthday   ,  GetDepartmentColorClass(GUID)[colorClass][0] as colorClass  , GetWeight(InE(\\\"MainAssignment\\\").Name[0].replace('\\\\\\\"',''))['value'][0] as weight    from ( traverse out(\\\"MainAssignment\\\",\\'SubUnit\\') from  (select from Unit where GUID = '\"+UnitGUID+\"' ) ) where ((inE()[0].Disabled is null or inE()[0].Disabled >= sysdate() ) and (Disabled is null)  and ( ((@class = \'Person\') or (out(\\\"MainAssignment\\\").size() >0)  or (out(\\\"SubUnit\\\").size() >0)) or (Name = \\'НСПК\\')) and (inE().State != \\'Отпуск по уходу за ребенком\\' and inE().State != \\'Отпуск по беременности и родам\\')   )  \"); return b;" PARAMETERS [UnitGUID] IDEMPOTENT true LANGUAGE JAVASCRIPT;   																																																																																																																																																																																																																																																																																																																																																																																																																									 
		
		v1 CREATE FUNCTION GetManagerHierarhyByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\"  select Acc as Name from ( select expand($e) let $x = ( select from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0]    )   ,$a = (      /*From Person by Unit Hierarhy*/     select  Name as n, sAMAccountName as Acc, inE('MainAssignment').outV('Unit').Name[0] as d,   inE('MainAssignment').HierarhyWeight[0] as w from (       select expand(inV()) from ( traverse inE('MainAssignment','SubUnit')   ,outE('MainAssignment'),outV('Unit','Person') from (           select from person where 1=1 and sAMAccountName=$x.sAMAccountName[0] )           ) ) where 1=1        and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() )   and (Disabled is null) and     (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )      /*If account name not assigned then deputy*/ 	and sAMAccountName is not null       ),   $c = (      /*Select Header by HierarhyWeight 0 */     select  Name as n, sAMAccountName as Acc,   inE('MainAssignment').outV('Unit').Name[0] as d, inE('MainAssignment').HierarhyWeight[0] as w   from (       select from Person where inE('MainAssignment').HierarhyWeight[0] = 0     )    ) ,   $e = unionall (      /*Union all Unit Headers and Directory (as ddirectory not in linear structure -> not binded to parent node*/     $a,$c    )   , $b = (      /*From United Person by Unit Hierarhy minimal Wights in Unit*/     select d , min(w) as w from (       select expand($e)     ) group by d    )  )  where 1=1      and w in $b.w     and w != $x.inE('MainAssignment').HierarhyWeight[0] order by Name \"); return b; " PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetCollegesLowerByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\"   select  sAMAccountName as Name from (     select expand($a )     let     $x = (         select from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0]   ),     $a =  (      select from (           select from person     ) where 1=1     /*Exclude person's account from results*/     and sAMAccountName != $x.sAMAccountName[0]       and inE('MainAssignment').HierarhyWeight[0] < $x.inE('MainAssignment').HierarhyWeight[0]          /*Standart overall Person filter*/         and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() )         and (Disabled is null)         and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам'          )    )  ) order by Name    \"); return b; " PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;		
	}
			
	public void Initial_NewsApi_Functions()
	{
		//create function 
		//CREATE FUNCTION test "var g=orient.getGraph();var b=g.command(\"sql\",\"select from Person where sAMAccountName =  '\"+accountName+\"' \");return b;" PARAMETERS [accountName]  IDEMPOTENT true LANGUAGE JAVASCRIPT
		CREATE FUNCTION GetStructure "var g=orient.getGraph(); var b=g.command(\"sql\",\"select @RID,@class,FirstName,GUID,Name,Disabled,Created,sAMAccountName,Changed,LastName,MiddleName,mail,telephoneNumber,userAccountControl ,objectGUID , if( eval('@class = \\\"Person\\\"'),in('MainAssignment').GUID[0],PGUID ) as PGUID ,inE().Name[0] as AssignmentName ,inE().State[0] as AssignmentState ,inE().ExpDate[0] as AssignmentStateExpireDate from ( traverse out('MainAssignment') from (traverse out('SubUnit') from (select from Unit where GUID = '\"+Depth+\"') while $depth <= '\"+Depth+\"' ) ) where Disabled is null\") ; return b;" PARAMETERS [Depth] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetPersonPhoto "var link_s = \'http://msk1-vm-inapp01/AddressBookAPI/api/Photo/?email=\'"+mail+";return link_s;" PARAMETERS [mail] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetPerson "var g=orient.getGraph(); var b=g.command(\"sql\",'select GetPersonPhoto(mail) as Photo, FirstName, GUID, PGUID ,Name,Disabled,Created,sAMAccountName,Changed,LastName,MiddleName,mail,telephoneNumber,userAccountControl,objectGUID from Person where GUID = \"'+GUID+'\"'); return b;" PARAMETERS [GUID] IDEMPOTENT true LANGUAGE JAVASCRIPT;		
		CREATE FUNCTION GetDepartmentName "var g=orient.getGraph(); var b=g.command(\"sql\",\"select $b.Name[0] as departmentName let $a = (select if(eval('@class = \\\"Unit\\\"'), GUID, in(\'MainAssignment\').GUID[0] ) as GUID from (select from vsc where GUID = \'\"+GUID+\"\') ), $b = ( select Name from ( select expand( shortestPath( (select from Unit where GUID = \'00000000-0000-0000-0000-000000000000\') , (select from VSC where GUID = $a.GUID[0] ) )[1] ) ) )\"); return b;" PARAMETERS [GUID] IDEMPOTENT true LANGUAGE JAVASCRIPT 
		CREATE FUNCTION GetDepartmentColorClass "var g=orient.getGraph(); var b=g.command(\"sql\",\"select $b.DepartmentColorClass[0] as colorClass let $a = (select if(eval(\'@class = \\\"Unit\\\"\'), GUID, in(\'MainAssignment\').GUID[0] ) as GUID from (select from vsc where GUID = \'\"+GUID+\"\') ), $b = ( select DepartmentColorClass from ( select expand( shortestPath( (select from Unit where GUID = \'00000000-0000-0000-0000-000000000000\') , (select from VSC where GUID = $a.GUID[0] ) )[1] ) ) )\"); return b;" PARAMETERS [GUID] IDEMPOTENT true LANGUAGE JAVASCRIPT
		CREATE FUNCTION GetDepartmentColor "var g=orient.getGraph(); var b=g.command(\"sql\",\"select $b.DepartmentColorRGB[0] as color let $a = (select if(eval(\'@class = \\\"Unit\\\"\'), GUID, in(\'MainAssignment\').GUID[0] ) as GUID from (select from vsc where GUID = \'\"+GUID+\"\') ), $b = ( select DepartmentColorRGB from ( select expand( shortestPath( (select from Unit where GUID = \'00000000-0000-0000-0000-000000000000\') , (select from VSC where GUID = $a.GUID[0] ) )[1] ) ) )\"); return b;" PARAMETERS [GUID] IDEMPOTENT true LANGUAGE JAVASCRIPT		
		CREATE FUNCTION GetPositionBar "var gr=orient.getGraph(); var br=gr.command(\"sql\",\"select $isDeputy['position'][0] as groupTitle let $managers = (select distinct(Name) as Name	from MainAssignment where ( (Name like '%уководите%' or Name like '%ачальни%' or Name like '%иректор%' or Name like '%аместите%')  and (not (Name like '%омощник%') and not (Name like '%екретар%') and not (Name like '%направлени%')))) , $isManager = (select if( eval(\\\"$managers.Name.indexOf('\"+position+\"') != -1\\\"), 'true', 'false' ) as IsManager) , $IsZam = (select count(*) as IsZam from MainAssignment where Name = '\\\"+position+\\\"' and Name like '%Заместитель%') , $isDeputy = (select if( eval(\\\"$isManager['IsManager'][0] = true\\\"), if( eval(\\\"$IsZam[IsZam][0] > 0\\\") ,'Заместитель','Руководитель'), null) as position)\"); return br;"  PARAMETERS [position] IDEMPOTENT true LANGUAGE JAVASCRIPT
		CREATE FUNCTION GetWeight "var gr=orient.getGraph(); if(position){ var br=gr.command(\"sql\",\"select $isDeputy['position'][0] as value let $managers = (select distinct(Name) as Name from MainAssignment where ( (Name like '%уководите%' or Name like '%ачальни%' or Name like '%иректор%' or Name like '%аместите%')  and (not (Name like '%омощник%') and not (Name like '%екретар%') and not (Name like '%направлени%')) ) ) ,   $isManager = (select if( eval(\\\"$managers.Name.indexOf('\"+position+\"') != -1\\\"), 'true', 'false' ) as IsManager) , $IsZam = (select count(*) as IsZam from MainAssignment where Name = '\"+position+\"' and Name like '%Заместитель%') , $isDeputy = (select if( eval(\\\"$isManager['IsManager'][0] = true\\\"), if( eval(\\\"$IsZam[IsZam][0] > 0\\\") ,1000000,0), 2000000) as position)\");   return br; } else {   return 3000000; }"  PARAMETERS [position] IDEMPOTENT true LANGUAGE JAVASCRIPT
		CREATE FUNCTION SearchPerson "var g=orient.getGraph(); var b=g.command(\"sql\",\"select GUID as id, ifnull( if( eval(\\\"@class = 'Person'\\\"),in(\\\"MainAssignment\\\").Name[0],Name[0]) ,'0' ) as division , ifnull( if( eval(\\\"@class = 'Person'\\\"),in(\\\"MainAssignment\\\").GUID[0],PGUID[0]) ,'0' ) as parent, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label,  LastName.append(' ').append(FirstName.substring( 0, 1 )).append('. ').append(MiddleName.substring( 0, 1 )).append('.') as shortFName , ifnull((inE('MainAssignment').Name[0]), Name) as description , GetDepartmentColor(GUID)[color][0] as itemTitleColor , if( eval(\\\"@class = 'Person'\\\"),'PersonTemplate','UnitTemplate' ) as templateName , if(eval('inE().ExpDate[0] is not null'), inE().State[0],null) as state, if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate, GetPositionBar(InE().Name[0].replace('\\\\\\\"',''))['groupTitle'][0] as groupTitle , if(eval('outE(\\\"CommonSettings\\\").inv(\\\"UserSettings\\\").showBirthday[0]=true'),Birthday.format('dd.MM'),'') as birthday  , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass, GetDepartmentName(GUID)[departmentName][0] as departmentName, sAMAccountName as login from Person WHERE [Name, sAMAccountName] LUCENE \\\"/.*\"+substr+\".*/\\\" and (inE(\\\"MainAssignment\\\")[0].Disabled is null or inE(\\\"MainAssignment\\\")[0].Disabled >= sysdate() ) and (inE(\\\"MainAssignment\\\").size() > 0) and (Disabled is null) and (inE().State != \'Отпуск по уходу за ребенком\' and inE().State != \'Отпуск по беременности и родам\' )\"); return b;"  PARAMETERS [substr] IDEMPOTENT true LANGUAGE JAVASCRIPT		
		CREATE FUNCTION GetStructureByUnitGUIDAtCurrentLevel "var g=orient.getGraph(); var b=g.command(\"sql\",\"select GUID as id, ifnull( if( eval(\\\"@class = 'Person'\\\"),in(\\\"MainAssignment\\\").GUID[0],PGUID[0]) ,'0' ) as parent,ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, ifnull((inE('MainAssignment').Name[0]), Name) as description, GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\\\"@class = 'Person'\\\"),\'PersonTemplate\',\'UnitTemplate\' ) as templateName , if(eval(\'inE().ExpDate[0] is not null\'), inE().State[0],null) as state, if( eval(\'inE().ExpDate[0] is not null\'),inE().ExpDate[0].format(\'dd.MM.YYYY\'),null) as expDate, GetPositionBar(InE('MainAssignment').Name[0].replace('\\\\\\\"',''))[\'groupTitle\'][0] as groupTitle ,  if(eval('outE(\\\"CommonSettings\\\").inv(\\\"UserSettings\\\").showBirthday[0]=true'),Birthday.format('dd.MM'),'') as birthday, GetDepartmentColorClass(GUID)[colorClass][0] as colorClass , GetWeight(InE(\\\"MainAssignment\\\").Name[0].replace('\\\\\\\"',''))[\'value\'][0] as weight , Seed as seed from ( traverse out(\\\"MainAssignment\\\",\\\"SubUnit\\\") from (select from Unit where GUID = '\"+GUID+\"' ) while $depth <=1 ) where ((inE()[0].Disabled is null or inE()[0].Disabled >= sysdate() ) and (Disabled is null) and ( ((@class = 'Person') or (out(\\\"MainAssignment\\\").size() >0) or (out(\\\"SubUnit\\\").size() >0)) or (Name = 'НСПК')) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам') ) \"); return b;"  PARAMETERS [GUID] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetStructureByPersonGUID "var g=orient.getGraph(); var b=g.command(\"sql\",\"select expand($c) let $v = (select expand( in('MainAssignment') ) from Person where GUID = '\"+personGUID+\"'),  $a = (select GUID as id, ifnull(PGUID,0) as parent, Name as title, Name as label,'&nbsp' as phone, Name as description, '&nbsp' as mail, GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\\\"@class = 'Person'\\\"),\\\"PersonTemplate\\\",\\\"UnitTemplate\\\" ) as templateName , if(eval('outE(\\\"CommonSettings\\\").inv(\\\"UserSettings\\\").showBirthday[0]=true'),Birthday.format('dd.MM'),'') as birthday , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass , GetWeight(InE('MainAssignment').Name[0].replace('\\\\\\\"',''))['value'][0] as weight , Seed as seed from ( traverse in() from ( SELECT shortestPath( $v[0], (select from Unit where GUID = '00000000-0000-0000-0000-000000000000') ) ) while $depth =0 ) ), $b = (select GUID as id, ifnull( if( eval(\\\"@class = 'Person'\\\"),in(\\\"MainAssignment\\\").GUID[0],PGUID[0]) ,'0' ) as parent, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, ifnull((inE(\\\"MainAssignment\\\").Name[0]), Name) as description, GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\\\"@class = 'Person'\\\"),\\\"PersonTemplate\\\",\\\"UnitTemplate\\\" ) as templateName ,if(eval('inE().ExpDate[0] is not null'), inE().State[0],null) as state, if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate, GetPositionBar(InE(\\\"MainAssignment\\\").Name[0].replace('\\\\\\\"',''))['groupTitle'][0] as groupTitle , if(eval('outE(\\\"CommonSettings\\\").inv(\\\"UserSettings\\\").showBirthday[0]=true'),Birthday.format('dd.MM'),'') as birthday , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass , GetWeight(InE('MainAssignment').Name[0].replace('\\\\\\\"',''))['value'][0] as weight , Seed as seed from ( traverse out('MainAssignment','SubUnit') from $v[0] ) where ((inE(\\\"MainAssignment\\\")[0].Disabled is null or inE(\\\"MainAssignment\\\")[0].Disabled >= sysdate() ) and (Disabled is null) and ((@class = 'Person') or (out(\\\"MainAssignment\\\").size() >0) or (out(\\\"SubUnit\\\").size() >0)) or (Name = 'НСПК') ) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != \'Отпуск по беременности и родам\' ) ), $c = unionall( $a, $b)\"); return b;" PARAMETERS [personGUID] IDEMPOTENT true LANGUAGE JAVASCRIPT ;
		CREATE FUNCTION GetStructureByUnitGUID "var g=orient.getGraph(); var b=g.command(\"sql\",\"select GUID as id, ifnull( if( eval(\\\"@class = 'Person'\\\"),in(\\\"MainAssignment\\\").GUID[0],PGUID[0]) ,\'0\' ) as parent, ifnull(telephoneNumber, \' \') as phone, ifnull( mail,\'&nbsp\')as mail, Name as title, Name as label, ifnull((inE(\'MainAssignment\').Name[0]), Name) as description, GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\\\"@class = 'Person'\\\"),\'PersonTemplate\',\'UnitTemplate\' ) as templateName , if(eval(\'inE().ExpDate[0] is not null\'), inE().State[0],null) as state, if( eval(\'inE().ExpDate[0] is not null\'),inE().ExpDate[0].format(\'dd.MM.YYYY\'),null) as expDate, GetPositionBar(InE('MainAssignment').Name[0].replace('\\\\\\\"',''))['groupTitle'][0] as groupTitle , if(eval('outE(\\\"CommonSettings\\\").inv(\\\"UserSettings\\\").showBirthday[0]=true'),Birthday.format('dd.MM'),'') as birthday, GetDepartmentColorClass(GUID)[colorClass][0] as colorClass , GetWeight(InE('MainAssignment').Name[0].replace('\\\\\\\"',''))['value'][0] as weight from ( traverse out(\'MainAssignment\',\'SubUnit\') from (select from Unit where GUID = '\"+unitGUID+\"' ) ) where ((inE()[0].Disabled is null or inE()[0].Disabled >= sysdate() ) and (Disabled is null) and ( ((@class = \'Person\') or (out(\\\"MainAssignment\\\").size() >0) or (out(\\\"SubUnit\\\").size() >0)) or (Name = \'НСПК\')) and (inE().State != \'Отпуск по уходу за ребенком\' and inE().State != \'Отпуск по беременности и родам\') ) \"); return b; "   PARAMETERS [unitGUID] IDEMPOTENT true LANGUAGE JAVASCRIPT					;
		CREATE FUNCTION GetAllStructureFAMILY "var g=orient.getGraph(); var b=g.command(\"sql\",\"select expand($c) let $v = (select from Unit where Name = 'НСПК'), $a = (select GUID as id, ifnull(PGUID,'0'.asSet()) as parents, Name as title, Name as label,' ' as phone, Name as description, '&nbsp' as mail, if( eval(\\\"@class = 'Person'\\\"),'PersonTemplate','UnitTemplate' ) as templateName , if(eval('outE(\\\"CommonSettings\\\").inv(\\\"UserSettings\\\").showBirthday[0]=true'),Birthday.format('dd.MM'),'') as birthday from ( traverse in() from (SELECT dijkstra($current, $v, 'SubUnit', 'both') FROM $v) while $depth =0 ) ), $b = ( select GUID as id, ifnull( if( eval(\\\"@class = 'Person'\\\"),in().GUID,PGUID.asSet()) ,'0'.asSet() ) as parents, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, ifnull((inE('MainAssignment').Name[0]), Name) as description , if( eval(\\\"@class = 'Person'\\\"),'PersonTemplate','UnitTemplate' ) as templateName,inE().State[0] as state, if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate , Birthday.format('dd.MM') as birthday from ( traverse out('MainAssignment','SubUnit') from (select from Unit where Name = 'НСПК') ) where ( inE()[0].Disabled is null and Disabled is null) ), $c = unionall( $a, $b);\"); return b;"  IDEMPOTENT true LANGUAGE JAVASCRIPT
		CREATE FUNCTION GetAllStructureLARGEHTY "var g=orient.getGraph(); var b=g.command(\"sql\",\"select GUID as id, ifnull( if( eval(\\\"@class = 'Person'\\\"),in(\\\"MainAssignment\\\").GUID[0],PGUID[0]) ,'0' ) as parent, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, ifnull((inE('MainAssignment').Name[0]), Name) as description , GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\\\"@class = 'Person'\\\"),'PersonTemplate','UnitTemplate' ) as templateName,inE().State[0] as state, if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate , if(eval('outE(\\\"CommonSettings\\\").inv(\\\"UserSettings\\\").showBirthday[0]=true'),Birthday.format('dd.MM'),'') as birthday from ( traverse out('MainAssignment','SubUnit') from (select from Unit where Name = 'НСПК') ) where (( inE()[0].Disabled is null and Disabled is null) and ( ((@class = 'Person') or (out(\\\"MainAssignment\\\").size() >0) or (out(\\\"SubUnit\\\").size() >0)) or (Name = 'НСПК')) and inE().State != \'ОтпускПоУходуЗаРебенком\' ) \"); return b;"  IDEMPOTENT true LANGUAGE JAVASCRIPT
		CREATE FUNCTION GetLarge "var g=orient.getGraph(); var b=g.command(\"sql\",\"select GUID as id , ifnull( if( eval(\\\"@class = 'Person'\\\"),in(\\\"MainAssignment\\\").GUID[0],PGUID[0]) ,'0' ) as parent , ifnull(telephoneNumber, ' ') as phone , ifnull( mail,'&nbsp')as mail , Name as title, Name as label , ifnull((inE('MainAssignment').Name[0]), Name) as description , GetDepartmentColor(GUID)[color][0] as itemTitleColor , if( eval(\\\"@class = 'Person'\\\"),'PersonTemplate','UnitTemplate' ) as templateName ,if(eval('inE().ExpDate[0] is not null'), inE().State[0],null) as state , if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate , GetPositionBar(InE().Name[0].replace('\\\\\\\"',''))['groupTitle'][0] as groupTitle , if(eval('outE(\\\"CommonSettings\\\").inv(\\\"UserSettings\\\").showBirthday[0]=true'),Birthday.format('dd.MM'),'') as birthday from ( traverse out('MainAssignment','SubUnit') from (select from Unit where Name = 'НСПК') ) where (( inE()[0].Disabled is null and Disabled is null) and( ((@class = 'Person') or (out(\\\"MainAssignment\\\").size() >0) or (out(\\\"SubUnit\\\").size() >0)) or (Name = 'НСПК')) and inE().State != \'ОтпускПоУходуЗаРебенком\' ) \"); return b;" IDEMPOTENT true LANGUAGE JAVASCRIPT
		
		
	}
	
	public void Brewers_Boilerplate()
	{ /*Drops all created objects at final*/
		

		/*
		BOOLEAN	SHORT	DATE	DATETIME	BYTE
INTEGER	LONG	STRING	LINK	DECIMAL
DOUBLE	FLOAT	BINARY	EMBEDDED	LINKBAG
		*/
		
		/*
EMBEDDEDLIST	EMBEDDEDSET	EMBEDDEDMAP
LINKLIST	LINKSET	LINKMAP
		*/
	
create class VSCN extends V;
CREATE PROPERTY VSCN.Name STRING (MANDATORY TRUE, notnull true);
CREATE PROPERTY VSCN.Created DATETIME (MANDATORY TRUE, notnull true);
CREATE PROPERTY VSCN.Changed DATETIME (MANDATORY TRUE, notnull true);
create class ESCN extends E;
CREATE PROPERTY ESCN.Name STRING (MANDATORY TRUE, notnull true);
CREATE PROPERTY ESCN.Created DATETIME (MANDATORY TRUE, notnull true);
CREATE PROPERTY ESCN.Changed DATETIME (MANDATORY TRUE, notnull true);
create class Brewery extends VSCN;
create class Beer extends VSCN;
create class Produces extends ESCN;

create class Human extends VSCN;
create class Pub extends VSCN;

create class FriendOf extends ESCN;
create class Drinks extends ESCN;
create class PassesTimeAt extends ESCN;


/*type1 batch type*/
/*
let $a = CREATE VERTEX Brewery CONTENT {"Name":"Brewer1","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
let $b = CREATE VERTEX Beer CONTENT {"Name":"Beer1","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
let $c = CREATE EDGE Produces from $a to $b CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
*/


/*Brewery*/
CREATE VERTEX Brewery CONTENT {"Name":"Brewer1","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Brewery CONTENT {"Name":"Brewer2","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Brewery CONTENT {"Name":"Brewer3","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};

/*beer*/
CREATE VERTEX Beer CONTENT {"Name":"Beer1","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Beer CONTENT {"Name":"Beer2","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Beer CONTENT {"Name":"Beer3","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Beer CONTENT {"Name":"Beer4","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Beer CONTENT {"Name":"Beer5","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Beer CONTENT {"Name":"Beer6","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};

/*type2*/
/*Produces beer*/
CREATE EDGE Produces from (select from Brewery where Name ="Brewer1" ) to (select from Beer where Name ="Beer1" ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE Produces from (select from Brewery where Name ="Brewer1" ) to (select from Beer where Name ="Beer2" ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE Produces from (select from Brewery where Name ="Brewer1" ) to (select from Beer where Name ="Beer3" ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE Produces from (select from Brewery where Name ="Brewer2" ) to (select from Beer where Name ="Beer4" ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE Produces from (select from Brewery where Name ="Brewer2" ) to (select from Beer where Name ="Beer5" ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE Produces from (select from Brewery where Name ="Brewer3" ) to (select from Beer where Name ="Beer6" ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}


/*Pubs*/
CREATE VERTEX Pub CONTENT {"Name":"Pub1","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Pub CONTENT {"Name":"Pub2","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};

/*Humans*/
CREATE VERTEX Human CONTENT {"Name":"Human1","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Human CONTENT {"Name":"Human2","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Human CONTENT {"Name":"Human3","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Human CONTENT {"Name":"Human4","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Human CONTENT {"Name":"Human5","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Human CONTENT {"Name":"Human6","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Human CONTENT {"Name":"Human7","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};
CREATE VERTEX Human CONTENT {"Name":"Human8","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"};

/*Friends bidirectional*/
/*1<>3 1<>4*/
CREATE EDGE FriendOf from (select from Human where Name ="Human1" ) to (select from Human where Name ="Human3"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE FriendOf from (select from Human where Name ="Human3" ) to (select from Human where Name ="Human1"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE FriendOf from (select from Human where Name ="Human1" ) to (select from Human where Name ="Human4"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE FriendOf from (select from Human where Name ="Human4" ) to (select from Human where Name ="Human1"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}


/*2<>3 2<>5 2<>6*/
CREATE EDGE FriendOf from (select from Human where Name ="Human2" ) to (select from Human where Name ="Human3"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE FriendOf from (select from Human where Name ="Human3" ) to (select from Human where Name ="Human2"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE FriendOf from (select from Human where Name ="Human2" ) to (select from Human where Name ="Human5"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE FriendOf from (select from Human where Name ="Human5" ) to (select from Human where Name ="Human2"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE FriendOf from (select from Human where Name ="Human2" ) to (select from Human where Name ="Human6"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE FriendOf from (select from Human where Name ="Human6" ) to (select from Human where Name ="Human2"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

/*3<>7*/
CREATE EDGE FriendOf from (select from Human where Name ="Human3" ) to (select from Human where Name ="Human7"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE FriendOf from (select from Human where Name ="Human7" ) to (select from Human where Name ="Human3"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

/*4<>8*/
CREATE EDGE FriendOf from (select from Human where Name ="Human4" ) to (select from Human where Name ="Human8"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE FriendOf from (select from Human where Name ="Human8" ) to (select from Human where Name ="Human4"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

/*5<>7 5<>8*/
CREATE EDGE FriendOf from (select from Human where Name ="Human5" ) to (select from Human where Name ="Human8"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE FriendOf from (select from Human where Name ="Human8" ) to (select from Human where Name ="Human5"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE FriendOf from (select from Human where Name ="Human5" ) to (select from Human where Name ="Human7"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE FriendOf from (select from Human where Name ="Human7" ) to (select from Human where Name ="Human5"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}


/*Drinks*/
CREATE EDGE Drinks from (select from Human where Name ="Human1" ) to (select from Beer where Name ="Beer1"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE Drinks from (select from Human where Name ="Human1" ) to (select from Beer where Name ="Beer2"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE Drinks from (select from Human where Name ="Human1" ) to (select from Beer where Name ="Beer3"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE Drinks from (select from Human where Name ="Human2" ) to (select from Beer where Name ="Beer1"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE Drinks from (select from Human where Name ="Human2" ) to (select from Beer where Name ="Beer3"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE Drinks from (select from Human where Name ="Human3" ) to (select from Beer where Name ="Beer3"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE Drinks from (select from Human where Name ="Human4" ) to (select from Beer where Name ="Beer1"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE Drinks from (select from Human where Name ="Human4" ) to (select from Beer where Name ="Beer6"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE Drinks from (select from Human where Name ="Human5" ) to (select from Beer where Name ="Beer6"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE Drinks from (select from Human where Name ="Human5" ) to (select from Beer where Name ="Beer5"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE Drinks from (select from Human where Name ="Human6" ) to (select from Beer where Name ="Beer1"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE Drinks from (select from Human where Name ="Human7" ) to (select from Beer where Name ="Beer2"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}

CREATE EDGE Drinks from (select from Human where Name ="Human8" ) to (select from Beer where Name ="Beer3"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}



/*PassesTimeAt*/
CREATE EDGE PassesTimeAt from (select from Human where Name ="Human1" ) to (select from Pub where Name ="Pub1"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE PassesTimeAt from (select from Human where Name ="Human2" ) to (select from Pub where Name ="Pub1"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE PassesTimeAt from (select from Human where Name ="Human3" ) to (select from Pub where Name ="Pub1"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE PassesTimeAt from (select from Human where Name ="Human4" ) to (select from Pub where Name ="Pub1"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE PassesTimeAt from (select from Human where Name ="Human5" ) to (select from Pub where Name ="Pub2"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE PassesTimeAt from (select from Human where Name ="Human6" ) to (select from Pub where Name ="Pub2"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE PassesTimeAt from (select from Human where Name ="Human7" ) to (select from Pub where Name ="Pub2"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}
CREATE EDGE PassesTimeAt from (select from Human where Name ="Human8" ) to (select from Pub where Name ="Pub2"  ) CONTENT {"Name":"Produces","Created":"2017-01-01 00:00:00","Changed":"2017-01-01 00:00:00"}



delete vertex Brewery;
delete vertex Beer;
delete vertex Human;
delete vertex Pub;

delete Edge Produces;
delete Edge Drinks;
delete Edge PassesTimeAt;
delete Edge FriendOf;

drop class FriendOf;
drop class Drinks;
drop class PassesTimeAt;
drop class Produces;
drop class Beer;
drop class Human;
drop class Brewery;
drop class Pub;
drop class ESCN;
drop class VSCN;



/*
create class VSCN extends V;
create class VSCN2 extends VSCN;
create class VSCN3 extends VSCN2;

drop class vscn3;
drop class vscn2;
drop class vscn;
*/


	}
	
	
	AdbBoilerplate(){

	create class VSCN extends V;
	CREATE VERTEX Brewery CONTENT {};
	CREATE EDGE Produces from ( ) to () CONTENT {};
	CREATE PROPERTY VSCN.Name STRING (MANDATORY TRUE, notnull true);

	delete vertex/edge Brewery;
	drop class FriendOf;
	
	select from Person;
	select from Unit;
	select from Person where 1=1;
	select from (select from Person where 1=1) where 1=1;
	select inE().outV() from person;
	select expand(inE().outV()) from person;

	
	1) create (class,vertex) 
	ItypeToken command_, IorientObject class, ItypeToken conten_=null

	class extends
	vartex content

	2) create (edge)
	ItypeToken command_, IorientObject class, ItypeToken from, ItypeToken to,ItypeToken conten_=null

	3) create (property)
	ItypeToken command_, IorientObject class,IorientObject propertyName,ItypeToken type_, MANDATORY bool, notnull bool

	4) delete vertex/edge 
	ItypeToken command_, IorientObject class
	delete 

	5)
	ItypeToken command_, IorientObject class
	drop 


	OrientType -> POCO -> type -> Token
	POCOtype -> orienttype

}
	
	public void ExportImport(){//Moove db with export
	
		public void InitSequence(){
			
CREATE SEQUENCE intranet_seed TYPE ORDERED
ALTER SEQUENCE intranet_seed START 1000100
select sequence('intranet_seed').reset()


		}
		
		public void InitClasses(){			
			
CREATE CLASS VSC extends V;

CREATE PROPERTY VSC.Name STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.GUID STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.Created DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.Changed DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.PGUID STRING;
CREATE PROPERTY VSC.Disabled DATETIME;

ALTER PROPERTY VSC.GUID DEFAULT uuid();
ALTER PROPERTY VSC.Created DEFAULT "sysdate()";
ALTER PROPERTY VSC.Changed DEFAULT "sysdate()";


CREATE CLASS ESC extends E;

CREATE PROPERTY ESC.Name STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.GUID STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.Created DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.Changed DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.PGUID STRING;
CREATE PROPERTY ESC.Disabled DATETIME;

ALTER PROPERTY ESC.GUID DEFAULT uuid();
ALTER PROPERTY ESC.Created DEFAULT "sysdate()";
ALTER PROPERTY ESC.Changed DEFAULT "sysdate()";

create class Unit extends VSC;
create class Person extends VSC;

create class SubUnit extends E;
create class MainAssignment extends ESC;
create class InExtAssignment extends ESC;
create class OutExtAssignment extends ESC;
create class OldMainAssignment extends ESC;

delete vertex Unit;
delete vertex Person;
delete edge SubUnit;
delete edge MainAssignment;
delete edge InExtAssignment;
delete edge OutExtAssignment;
delete edge OldMainAssignment;

ALTER PROPERTY ESC.GUID DEFAULT uuid();
ALTER PROPERTY ESC.Created DEFAULT sysdate();
ALTER PROPERTY ESC.Changed DEFAULT sysdate();
ALTER PROPERTY VSC.GUID DEFAULT uuid();
ALTER PROPERTY VSC.Created DEFAULT sysdate();
ALTER PROPERTY VSC.Changed DEFAULT sysdate();

alter database custom standardElementConstraints=false


CREATE SEQUENCE intranet_seed TYPE ORDERED
	ALTER SEQUENCE intranet_seed START 1000100
		select sequence('intranet_seed').reset()

CREATE PROPERTY VSC.Seed Integer (MANDATORY TRUE, NOTNULL TRUE);
ALTER PROPERTY VSC.Seed DEFAULT "sequence('intranet_seed').next()";

CREATE SEQUENCE idseq TYPE ORDERED;

/*
CREATE PROPERTY VSC.ID  Integer (MANDATORY TRUE, NOTNULL TRUE);
ALTER PROPERTY VSC.ID DEFAULT 'sequence("idseq").next()';
ALTER PROPERTY Object.ID DEFAULT 'sequence("idseq").next()';
ALTER PROPERTY Person.ID DEFAULT 'sequence("idseq").next()';
ALTER PROPERTY Unit.ID DEFAULT 'sequence("idseq").next()';
Create PROPERTY Authorship.ID  Integer (MANDATORY TRUE, NOTNULL TRUE);
ALTER PROPERTY Authorship.ID DEFAULT 'sequence("idseq").next()';
*/

/*
create index Person.Name_sAMAccountName_mail on Person(Name,sAMAccountName,mail) fulltext engine lucene

create index Person.Name_sAMAccountName_mail on Person(Name,sAMAccountName,mail) fulltext engine lucene 
metadata {
"analyzer": "org.apache.lucene.morphology.russian.RussianAnalyzer",
  "allowLeadingWildcard": true,
  "MorphologyAnalyzer" :"org.apache.lucene.morphology.russian.RussianMorphology"
}
*/
			
		}
				
		
		connect remote:127.0.0.1/news_test3 root 
		import database C:/import/news_test3.gz
		
	}
	
	public Functions_NewsTest2(){
		
		
	{
	GetStructure : var g=orient.getGraph(); var b=g.command(""sql"",""select @RID,@class,FirstName,GUID,Name,Disabled,Created,sAMAccountName,Changed,LastName,MiddleName,mail,telephoneNumber,userAccountControl,objectGUID , if( eval('@class = \""Person\""'),in('MainAssignment').GUID[0],PGUID ) as PGUID ,inE().Name[0] as AssignmentName ,inE().State[0] as AssignmentState ,inE().ExpDate[0] as AssignmentStateExpireDate from ( traverse out('MainAssignment') from (traverse out('SubUnit') from (select from Unit where GUID = '""+GUID+""') while $depth <= '""+Depth+""' ) ) where Disabled is null"") ; return b; 
	},{ 
	GetPerson : var g=orient.getGraph(); var b=g.command(""sql"",'select GetPersonPhoto(mail) as Photo, FirstName, GUID, PGUID ,Name,Disabled,Created,sAMAccountName,Changed,LastName,MiddleName,mail,telephoneNumber,userAccountControl,objectGUID from Person where GUID = ""'+GUID+'""'); return b; 
	} ,{
	GetPersonPhoto : //var samaaa = mail.split('@')[0]; var link_s = 'http://msk1-vm-inapp01/AddressBookAPI/api/Photo/?email='+mail; return link_s; //var link_s = 'https:\/\/webmail.nspk.ru/ews/exchange.asmx/s/GetUserPhoto?email=' //var link_f = '&size=HR120x120' //return link_s + mail + link_f; 
	},{ 
	GetAllStructureFAMILY : var g=orient.getGraph(); var b=g.command(""sql"",""select expand($c) let $v = (select from Unit where Name = 'НСПК'), $a = (select GUID as id, ifnull(PGUID,'0'.asSet()) as parents, Name as title, Name as label,' ' as phone, Name as description, '&nbsp' as mail, if( eval(\""@class = 'Person'\""),'PersonTemplate','UnitTemplate' ) as templateName , Birthday.format('dd.MM') as birthday from ( traverse in() from (SELECT dijkstra($current, $v, 'SubUnit', 'both') FROM $v) while $depth =0 ) ), $b = ( select GUID as id, ifnull( if( eval(\""@class = 'Person'\""),in().GUID,PGUID.asSet()) ,'0'.asSet() ) as parents, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, ifnull((inE('MainAssignment').Name[0]), Name) as description , if( eval(\""@class = 'Person'\""),'PersonTemplate','UnitTemplate' ) as templateName,inE().State[0] as state, if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate , Birthday.format('dd.MM') as birthday from ( traverse out('MainAssignment','SubUnit') from (select from Unit where Name = 'НСПК') ) where ( inE()[0].Disabled is null and Disabled is null) ), $c = unionall( $a, $b);""); return b; 
	},{ 
	GetAllStructureLARGEHTY : var g=orient.getGraph(); var b=g.command(""sql"",""select GUID as id, ifnull( if( eval(\""@class = 'Person'\""),in(\""MainAssignment\"").GUID[0],PGUID[0]) ,'0' ) as parent, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, ifnull((inE('MainAssignment').Name[0]), Name) as description , GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\""@class = 'Person'\""),'PersonTemplate','UnitTemplate' ) as templateName,inE().State[0] as state, if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate , Birthday.format('dd.MM') as birthday from ( traverse out('MainAssignment','SubUnit') from (select from Unit where Name = 'НСПК') ) where (( inE()[0].Disabled is null and Disabled is null) and ( ((@class = 'Person') or (out(\""MainAssignment\"").size() >0) or (out(\""SubUnit\"").size() >0)) or (Name = 'НСПК')) and inE().State != \'ОтпускПоУходуЗаРебенком\' ) ""); return b; 
	},{ 
	GetStructureBysAMAccountName : var g=orient.getGraph(); var b=g.command(""sql"",""select expand($c) let $v = (select expand( in('MainAssignment') ) from Person where sAMAccountName = '""+sAMAccountName+""' ), $a = (select GUID as id, ifnull(PGUID,0) as parent, Name as title, Name as label,'&nbsp' as phone, Name as description, '&nbsp' as mail, GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\""@class = 'Person'\""),'PersonTemplate','UnitTemplate' ) as templateName , Birthday.format('dd.MM') as birthday , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass from ( traverse in() from ( SELECT shortestPath( $v, (select from Unit where GUID = '00000000-0000-0000-0000-000000000000') ) ) while $depth =0 ) ), $b = (select GUID as id, ifnull( if( eval(\""@class = 'Person'\""),in(\""MainAssignment\"").GUID[0],PGUID[0]) ,'0' ) as parent, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, ifnull((inE('MainAssignment').Name[0]), Name) as description, GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\""@class = 'Person'\""),'PersonTemplate','UnitTemplate' ) as templateName ,if(eval('inE().ExpDate[0] is not null'), inE().State[0],null) as state, if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate, GetPositionBar(InE('MainAssignment').Name[0].replace('\\\""',''))['groupTitle'][0] as groupTitle , Birthday.format('dd.MM') as birthday , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass from ( traverse out('MainAssignment','SubUnit') from $v ) where (( inE()[0].Disabled is null and Disabled is null) and ((@class = 'Person') or (out(\""MainAssignment\"").size() >0) or (out(\""SubUnit\"").size() >0)) or (Name = 'НСПК') ) and inE().State != 'ОтпускПоУходуЗаРебенком' ), $c = unionall( $a, $b)""); return b; 
	},{ 
	GetStructureByPersonGUID : var g=orient.getGraph(); var b=g.command(""sql"",""select expand($c) let $v = (select expand( in('MainAssignment') ) from Person where GUID = '""+personGUID+""'), $a = (select GUID as id, ifnull(PGUID,0) as parent, Name as title, Name as label,'&nbsp' as phone, Name as description, '&nbsp' as mail, GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\""@class = 'Person'\""),'PersonTemplate','UnitTemplate' ) as templateName , Birthday.format('dd.MM') as birthday , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass , GetWeight(InE('MainAssignment').Name[0].replace('\\\""',''))['value'][0] as weight , Seed as seed from ( traverse in() from ( SELECT shortestPath( $v[0], (select from Unit where GUID = '00000000-0000-0000-0000-000000000000') ) ) while $depth =0 ) ), $b = (select GUID as id, ifnull( if( eval(\""@class = 'Person'\""),in(\""MainAssignment\"").GUID[0],PGUID[0]) ,'0' ) as parent, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, ifnull((inE('MainAssignment').Name[0]), Name) as description, GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\""@class = 'Person'\""),'PersonTemplate','UnitTemplate' ) as templateName ,if(eval('inE().ExpDate[0] is not null'), inE().State[0],null) as state, if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate, GetPositionBar(InE('MainAssignment').Name[0].replace('\\\""',''))['groupTitle'][0] as groupTitle , Birthday.format('dd.MM') as birthday , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass , GetWeight(InE('MainAssignment').Name[0].replace('\\\""',''))['value'][0] as weight , Seed as seed from ( traverse out('MainAssignment','SubUnit') from $v[0] ) where ((inE(\""MainAssignment\"")[0].Disabled is null or inE(\""MainAssignment\"")[0].Disabled >= sysdate() ) and (Disabled is null) and ((@class = 'Person') or (out(\""MainAssignment\"").size() >0) or (out(\""SubUnit\"").size() >0)) or (Name = 'НСПК') ) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != \'Отпуск по беременности и родам\' ) ), $c = unionall( $a, $b)""); return b; 
	},{ 
	GetDepartmentName : var g=orient.getGraph(); var b=g.command(""sql"",""select $b.Name[0] as departmentName let $a = (select if(eval('@class = \""Unit\""'), GUID, in('MainAssignment').GUID[0] ) as GUID from (select from vsc where GUID = '""+GUID+""') ), $b = ( select Name from ( select expand( shortestPath( (select from Unit where GUID = '00000000-0000-0000-0000-000000000000') , (select from VSC where GUID = $a.GUID[0] ) )[1] ) ) )""); return b; 
	},{ 
	"SearchPerson : var g=orient.getGraph(); var b=g.command(""sql"",""select GUID as id, ifnull( if( eval(\""@class = 'Person'\""),in(\""MainAssignment\"").Name[0],Name[0]) ,'0' ) as division , ifnull( if( eval(\""@class = 'Person'\""),in(\""MainAssignment\"").GUID[0],PGUID[0]) ,'0' ) as parent, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, LastName.append(' ').append(FirstName.substring( 0, 1 )).append('. ').append(MiddleName.substring( 0, 1 )).append('.') as shortFName, ifnull((inE('MainAssignment').Name[0]), Name) as description , GetDepartmentColor(GUID)[color][0] as itemTitleColor , if( eval(\""@class = 'Person'\""),'PersonTemplate','UnitTemplate' ) as templateName , if(eval('inE().ExpDate[0] is not null'), inE().State[0],null) as state, if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate, GetPositionBar(InE().Name[0].replace('\\\""',''))['groupTitle'][0] as groupTitle , Birthday.format('dd.MM') as birthday , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass, GetDepartmentName(GUID)[departmentName][0] as departmentName, sAMAccountName as login from Person WHERE sAMAccountName = '""+userLogin+""' and (inE(\""MainAssignment\"")[0].Disabled is null or inE(\""MainAssignment\"")[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != \'Отпуск по уходу за ребенком\' and inE().State != \'Отпуск по беременности и родам\' )""); return b; 
	},{ 
	"SearchByLastName : var g=orient.getGraph(); substr = substr.toUpperCase(); var b=g.command(""sql"",""select distinct(LastName) as lastName from Person WHERE LastName.toUpperCase() like '%""+substr+""%' and inE()[0].Disabled is null and Disabled is null "") return b; 
	},{ 
	GetPositionBar : var gr=orient.getGraph(); var br=gr.command(""sql"",""select $isDeputy['position'][0] as groupTitle let $managers = (select distinct(Name) as Name from MainAssignment where ( (Name like '%уководите%' or Name like '%ачальни%' or Name like '%иректор%' or Name like '%аместите%') and (not (Name like '%омощник%') and not (Name like '%екретар%') and not (Name like '%направлени%')) ) ) , $isManager = (select if( eval(\""$managers.Name.indexOf('""+position+""') != -1\""), 'true', 'false' ) as IsManager) , $IsZam = (select count(*) as IsZam from MainAssignment where Name = '""+position+""' and Name like '%Заместитель%') , $isDeputy = (select if( eval(\""$isManager['IsManager'][0] = true\""), if( eval(\""$IsZam[IsZam][0] > 0\"") ,'Заместитель','Руководитель'), null) as position)""); return br; 
	},{ 
	GetLarge : var g=orient.getGraph(); var b=g.command(""sql"",""select GUID as id , ifnull( if( eval(\""@class = 'Person'\""),in(\""MainAssignment\"").GUID[0],PGUID[0]) ,'0' ) as parent , ifnull(telephoneNumber, ' ') as phone , ifnull( mail,'&nbsp')as mail , Name as title, Name as label , ifnull((inE('MainAssignment').Name[0]), Name) as description , GetDepartmentColor(GUID)[color][0] as itemTitleColor , if( eval(\""@class = 'Person'\""),'PersonTemplate','UnitTemplate' ) as templateName ,if(eval('inE().ExpDate[0] is not null'), inE().State[0],null) as state , if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate , GetPositionBar(InE().Name[0].replace('\\\""',''))['groupTitle'][0] as groupTitle , Birthday.format('dd.MM') as birthday from ( traverse out('MainAssignment','SubUnit') from (select from Unit where Name = 'НСПК') ) where (( inE()[0].Disabled is null and Disabled is null) and( ((@class = 'Person') or (out(\""MainAssignment\"").size() >0) or (out(\""SubUnit\"").size() >0)) or (Name = 'НСПК')) and inE().State != \'ОтпускПоУходуЗаРебенком\' ) ""); return b; 
	},{ 
	"SearchByFNameLName_old : var g=orient.getGraph(); substr = substr.toUpperCase(); var b=g.command(""sql"",""select expand($c) let $a = (select distinct(LastName) as lastName from Person WHERE LastName.toUpperCase() like '%""+substr+""%' and inE()[0].Disabled is null and Disabled is null ), $b = (select distinct(FirstName) as lastName from Person WHERE FirstName.toUpperCase() like '%""+substr+""%' and inE()[0].Disabled is null and Disabled is null ), $c = unionall($a,$b)""); return b; 
	},{ 
	GetStructureByUnitGUID : var g=orient.getGraph(); var b=g.command(""sql"",""select GUID as id, ifnull( if( eval(\""@class = \'Person\'\""),in(\""MainAssignment\"").GUID[0],PGUID[0]) ,\'0\' ) as parent, ifnull(telephoneNumber, \' \') as phone, ifnull( mail,\'&nbsp\')as mail, Name as title, Name as label, ifnull((inE(\'MainAssignment\').Name[0]), Name) as description, GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\""@class = \'Person\'\""),\'PersonTemplate\',\'UnitTemplate\' ) as templateName , if(eval(\'inE().ExpDate[0] is not null\'), inE().State[0],null) as state, if( eval(\'inE().ExpDate[0] is not null\'),inE().ExpDate[0].format(\'dd.MM.YYYY\'),null) as expDate, GetPositionBar(InE('MainAssignment').Name[0].replace('\\\""',''))['groupTitle'][0] as groupTitle , Birthday.format(\'dd.MM\') as birthday , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass , GetWeight(InE('MainAssignment').Name[0].replace('\\\""',''))['value'][0] as weight from ( traverse out(\'MainAssignment\',\'SubUnit\') from (select from Unit where GUID = '""+UnitGUID+""' ) ) where ((inE()[0].Disabled is null or inE()[0].Disabled >= sysdate() ) and (Disabled is null) and ( ((@class = \'Person\') or (out(\""MainAssignment\"").size() >0) or (out(\""SubUnit\"").size() >0)) or (Name = \'НСПК\')) and (inE().State != \'Отпуск по уходу за ребенком\' and inE().State != \'Отпуск по беременности и родам\') ) ""); return b; 
	},{ 
	GetDepartmentColorClass : var g=orient.getGraph(); var b=g.command(""sql"",""select $b.DepartmentColorClass[0] as colorClass let $a = (select if(eval('@class = \""Unit\""'), GUID, in('MainAssignment').GUID[0] ) as GUID from (select from vsc where GUID = '""+GUID+""') ), $b = ( select DepartmentColorClass from ( select expand( shortestPath( (select from Unit where GUID = '00000000-0000-0000-0000-000000000000') , (select from VSC where GUID = $a.GUID[0] ) )[1] ) ) )""); return b; 
	},{ 
	colortest : var g=orient.getGraph(); var b=g.command(""sql"",""select DepartmentColorClass from (select expand( shortestPath((select from Unit where GUID = '00000000-0000-0000-0000-000000000000'), (select from VSC where GUID = '""+GUID+""'))[1]))""); return b; 
	},{ 
	GetWeight : var gr=orient.getGraph(); if(position){ var br=gr.command(""sql"",""select $isDeputy['position'][0] as value let $managers = (select distinct(Name) as Name from MainAssignment where ( (Name like '%уководите%' or Name like '%ачальни%' or Name like '%иректор%' or Name like '%аместите%') and (not (Name like '%омощник%') and not (Name like '%екретар%') and not (Name like '%направлени%')) ) ) , $isManager = (select if( eval(\""$managers.Name.indexOf('""+position+""') != -1\""), 'true', 'false' ) as IsManager) , $IsZam = (select count(*) as IsZam from MainAssignment where Name = '""+position+""' and Name like '%Заместитель%') , $isDeputy = (select if( eval(\""$isManager['IsManager'][0] = true\""), if( eval(\""$IsZam[IsZam][0] > 0\"") ,1000000,0), 2000000) as position)""); return br; } else { return 3000000; } 
	},{ 
	GetFirstLevelUnits : var g=orient.getGraph(); var b=g.command(""sql"","" select from (traverse out(\""SubUnit\"") from ( select from Unit where GUID = '00000000-0000-0000-0000-000000000000') while $depth <= 1) where Disabled is null "") return b; 
	},{ 
	GetStructureByUnitGUIDAtCurrentLevel : var g=orient.getGraph(); var b=g.command(""sql"",""select GUID as id, ifnull( if( eval(\""@class = \'Person\'\""),in(\""MainAssignment\"").GUID[0],PGUID[0]) ,\'0\' ) as parent,ifnull(telephoneNumber, \' \') as phone, ifnull( mail,\'&nbsp\')as mail, Name as title, Name as label, ifnull((inE(\'MainAssignment\').Name[0]), Name) as description, GetDepartmentColor(GUID)[color][0] as itemTitleColor, if( eval(\""@class = \'Person\'\""),\'PersonTemplate\',\'UnitTemplate\' ) as templateName , if(eval(\'inE().ExpDate[0] is not null\'), inE().State[0],null) as state, if( eval(\'inE().ExpDate[0] is not null\'),inE().ExpDate[0].format(\'dd.MM.YYYY\'),null) as expDate, GetPositionBar(InE('MainAssignment').Name[0].replace('\\\""',''))['groupTitle'][0] as groupTitle , Birthday.format(\'dd.MM\') as birthday , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass , GetWeight(InE('MainAssignment').Name[0].replace('\\\""',''))['value'][0] as weight , Seed as seed from ( traverse out(\'MainAssignment\',\'SubUnit\') from (select from Unit where GUID = '""+UnitGUID+""' ) while $depth <=1 ) where ((inE()[0].Disabled is null or inE()[0].Disabled >= sysdate() ) and (Disabled is null) and ( ((@class = \'Person\') or (out(\""MainAssignment\"").size() >0) or (out(\""SubUnit\"").size() >0)) or (Name = \'НСПК\')) and (inE().State != \'Отпуск по уходу за ребенком\' and inE().State != \'Отпуск по беременности и родам\') ) ""); return b; 
	},{ 
	GetStructureByPersonGUID_ : var g=orient.getGraph(); var b=g.command(""sql"",""select GUID as id , ifnull( if( eval(\""@class = 'Person'\""),in(\""MainAssignment\"").GUID[0],PGUID[0]) ,'0' ) as parent , ifnull(telephoneNumber, ' ') as phone , ifnull( mail,' ')as mail , Name as title , Name as label , ifnull((inE('MainAssignment').Name[0]), Name) as description , GetDepartmentColor(GUID)[color][0] as itemTitleColor , if( eval(\""@class = 'Person'\""),'PersonTemplate','UnitTemplate' ) as templateName , if(eval('inE().ExpDate[0] is not null'), inE().State[0],null) as state , if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate , GetPositionBar(InE('MainAssignment').Name[0].replace('\\\""',''))['groupTitle'][0] as groupTitle , Birthday.format('dd.MM') as birthday , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass , GetWeight(InE('MainAssignment').Name[0].replace('\\\""',''))['value'][0] as weight , Seed as seed from ( select expand( distinct(@this) ) from ( select expand($c) let $v = (select expand( in('MainAssignment') ) from Person where GUID = '53f45ea6-bcc2-11e4-ae8a-f80f41d3dd35'), $a = (select from ( traverse in() from ( SELECT shortestPath( $v, (select from Unit where GUID = '00000000-0000-0000-0000-000000000000') ) ) while $depth =0 ) ), $b = ( select from ( traverse out('MainAssignment','SubUnit') from $v ) where (( inE()[0].Disabled is null and Disabled is null) and ((@class = 'Person') or (out(\""MainAssignment\"").size() >0) or (out(\""SubUnit\"").size() >0)) or (Name = 'НСПК') ) and inE().State != 'ОтпускПоУходуЗаРебенком' ), $c = unionall( $a, $b) ) )""); return b; 
	},{ 
	SearchByFNameLName : var g=orient.getGraph(); substr = substr.replace('ё','е').toUpperCase(); var b=g.command(""sql"",""select expand($c) let $a = (select distinct(LastName).replace('ё','е') as suggestion from Person WHERE (LastName.replace('ё','е').toUpperCase() like '%""+substr+""%' ) and (inE()[0].Disabled is null or inE()[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != \'Отпуск по уходу за ребенком\' and inE().State != \'Отпуск по беременности и родам\' ) ), $b = (select distinct(FirstName).replace('ё','е') as suggestion from Person WHERE (FirstName.replace('ё','е').toUpperCase() like '%""+substr+""%' ) and (inE()[0].Disabled is null or inE()[0].Disabled >= sysdate() ) and (Disabled is null) and (inE(\""MainAssignment\"").State != \'Отпуск по уходу за ребенком\' and inE(\""MainAssignment\"").State != \'Отпуск по беременности и родам\' )), $c = unionall($a,$b)""); return b; 
	},{ 
	GetDepartmentColor : var g=orient.getGraph(); var b=g.command(""sql"",""select $b.DepartmentColorRGB[0] as color let $a = (select if(eval('@class = \""Unit\""'), GUID, in('MainAssignment').GUID[0] ) as GUID from (select from vsc where GUID = '""+GUID+""') ), $b = ( select DepartmentColorRGB from ( select expand( shortestPath( (select from Unit where GUID = '00000000-0000-0000-0000-000000000000') , (select from VSC where GUID = $a.GUID[0] ) )[1] ) ) )""); return b; 
	},{ 
	GetAccountName : var g=orient.getGraph(); var b=g.command(""sql"",""select from Person where sAMAccountName like '%""+login+""%'""); return b; 
	},{ 
	GetObjectById : var g=orient.getGraph(); var b=g.command(""sql"",""select from Object where Id = ""+id+""""); return b; 
	},{ 
	SearchPersonExactly : var g=orient.getGraph(); var b=g.command(""sql"",""select GUID as id, ifnull( if( eval(\""@class = 'Person'\""),in(\""MainAssignment\"").Name[0],Name[0]) ,'0' ) as division , ifnull( if( eval(\""@class = 'Person'\""),in(\""MainAssignment\"").GUID[0],PGUID[0]) ,'0' ) as parent, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, LastName.append(' ').append(FirstName.substring( 0, 1 )).append('. ').append(MiddleName.substring( 0, 1 )).append('.') as shortFName, ifnull((inE('MainAssignment').Name[0]), Name) as description , GetDepartmentColor(GUID)[color][0] as itemTitleColor , if( eval(\""@class = 'Person'\""),'PersonTemplate','UnitTemplate' ) as templateName , if(eval('inE().ExpDate[0] is not null'), inE().State[0],null) as state, if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate, GetPositionBar(InE().Name[0].replace('\\\""',''))['groupTitle'][0] as groupTitle , Birthday.format('dd.MM') as birthday , GetDepartmentColorClass(GUID)[colorClass][0] as colorClass, GetDepartmentName(GUID)[departmentName][0] as departmentName, sAMAccountName as login from Person WHERE sAMAccountName = '""+userLogin+""' and (inE(\""MainAssignment\"")[0].Disabled is null or inE(\""MainAssignment\"")[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != \'Отпуск по уходу за ребенком\' and inE().State != \'Отпуск по беременности и родам\' )""); return b; 
	}
		
  public FunctionsTest(){
		
http://msk1-vm-ovisp02:2480/function/news_test5/GetStructureByPersonGUID/c1b0ff45-5cb1-11e7-8117-005056813668
http://msk1-vm-ovisp02:2480/function/news_test5/GetStructureByPersonGUID/c1a4c984-a00e-11e6-80db-005056813668
http://msk1-vm-ovisp02:2480/function/news_test5/GetStructureByPersonGUID/c1b0ff45-5cb1-11e7-8117-00505681366
http://msk1-vm-ovisp02:2480/function/news_test5/GetStructureByUnitGUIDAtCurrentLevel/c1b0ff45-5cb1-11e7-8117-005056813668
	
						}																	
	
	
			}
			
			}
			
			public void Queries()
			{


https://stackoverflow.com/questions/35323242/orientdb-sql-check-if-multiple-pairs-of-vertices-are-connected
https://stackoverflow.com/questions/33345305/orientdb-traverse-until-condition-on-node

public ByDateSelect(){
	
select from Quiz where 1=1
and StartDate.asDate() between '2017-03-05' and '2017-03-10'
and EndDate.asDate() between '2017-03-05' and '2017-03-10'

select from Quiz where 1=1
and State ='Published'
and StartDate.asDate() > '2017-03-30'
and EndDate.asDate() <  '2017-04-30'

}
public GroupByCountEdges()
{
	select out('Authorship').size(),Name,GUID from Person group by Name,GUID
}
select CommentsCountAndLikes()
{
select in('Authorship').GUID[0] as AuthGUID, * from Note
select in('Authorship').GUID[0] as AuthGUID,out('Comment').size() as CommentsCount, * from News
}
public SelectConditionsHC()
{
	
select from Note
where 1=1
and in('Authorship')[0].@rid!='25:27'
and published.isTrue=true
and pinned.isTrue=true
order by Changed desc
limit 2

}

public SelectNews(){
	//select news
	select expand(
	outE('Authorship').inV('Note').inE('Comment').outV('Note')
	)from Person where @rid=#73:1 and outE('Authorship').inV('Note').inE('Comment').@size!=''
}

public SelectComments(){
	//select comments
	select  from (
	select expand(
	outE('Authorship').inV('Note')
	)from Person where @rid=#73:1 )
	where 1=1 and inE('Comment')[0].@rid!=''
}
	
public DateTimeRearrangeGet(){
	
ALTER DATABASE DATETIMEFORMAT "yyyy.MM.dd HH:mm:ss GG"

select SYSDATE()

}

public Contains(){
	
	SELECT FROM (SELECT BOTH('Friend') FROM Person WHERE name
	'John') WHERE out('LivesIn').name CONTAINS 'Rome'

}

public CreateObjects(){
	
	//examples
	//CREATE PROPERTY User.name STRING (MANDATORY TRUE, MIN 5, MAX 25) 
	//DELETE EDGE [#22:38482,#23:232,#33:2332]
	//DELETE EDGE FROM #11:101 TO #11:117 WHERE date >= "2012-01-15"
	//DELETE VERTEX #10:231
	//TRUNCATE CLASS Email UNSAFE
	//INSERT INTO Profile (name, friends) VALUES ('Luca', [#10:3, #10:4])
	//INSERT INTO Profiles SET name = 'Luca', friends = [#10:3, #10:4]
	//INSERT INTO Diver SET name = 'Luca', buddy = (SELECT FROM Diver  WHERE name = 'Marko')
	
	http://orientdb.com/docs/last/SQL-Create-Property.html
	//insert 
	http://orientdb.com/docs/last/SQL-Insert.html
	//get all classes
	select name from (select expand(classes) from metadata:schema )

	//CREATE PROPERTY User.name STRING (MANDATORY TRUE, MIN 5, MAX 25) 
	//DELETE EDGE [#22:38482,#23:232,#33:2332]
	//DELETE EDGE FROM #11:101 TO #11:117 WHERE date >= "2012-01-15"
	
	BOOLEAN	SHORT	DATE	DATETIME	BYTE
	INTEGER	LONG	STRING	LINK	DECIMAL
	DOUBLE	FLOAT	BINARY	EMBEDDED	LINKBAG

	EMBEDDEDLIST EMBEDDEDSET EMBEDDEDMAP
	LINKLIST LINKSET	LINKMAP

	create class VSCN
	CREATE PROPERTY VSCN.Name STRING (MANDATORY TRUE, notnull true)
	drop class VSCN
	create class Brewer EXTENDS VSCN
	create class Beer
	
	ALTER CLASS Beer SUPERCLASS +Brewer
	ALTER CLASS Beer SUPERCLASS -Brewer
	
	CREATE PROPERTY Brewer.name STRING
	CREATE PROPERTY Beer.name STRING
	CREATE PROPERTY Beer.tags EMBEDDEDLIST STRING
	
	ALTER CLASS Account NAME Seller
		
	DROP CLASS VSCN
	DROP CLASS Brewer
	
	CREATE SEQUENCE idseq TYPE ORDERED
	INSERT INTO Brewer SET id = sequence('idseq').next()
	INSERT INTO Brewer content {"Name":"Brewer1"}
	INSERT INTO Brewer (name) values ('br1'),('br2')
	
	{ "transaction" : true,
  "operations" : [
    {
      "type" : "script",
      "language" : "sql",
      "script" : [ "LET account = CREATE VERTEX Account SET name = 'Luke'",
                   "LET city = SELECT FROM City WHERE name = 'London'",
                   "CREATE EDGE Lives FROM $account TO $city RETRY 100" ]
    }
  ]
}
	
	MATCH {class: Person, where: (name = 'a')}.out("FriendOf")
          {as: friend} RETURN friend
		  
		  MATCH 
  {class: Person, as: person}
  .bothE('Friend'){as: friendship}
  .bothV(){as: friend, where: ($matched.person != $currentMatch)} 
RETURN person, friendship, friend


	
}

public Match(){
	
	//several columns from different objects
	match {class:Person, as: p }.in("MainAssignment").out("SubUnit"){as: u, while: ($depth =0),where: ($depth = 0)} return u.Name,p.Name
	
}

public GetClassNamesFromSchema(){
	
//get all classes
select name from (select expand(classes) from metadata:schema )


//get properties from classes
select name, notNull as nullable from (
  select expand(properties) from (
   select expand(classes) from metadata:schema 
) where name = 'VSC'
  )
	
}

public BatchCreateFromSQL(){
	
	let $a = insert into UserSettings content {"showBirthday":true}
create edge E from (select from Person where sAMAccountName = 'ignatenkofi') to $a;

}
public NestedAggr() {
	
select  from (
select expand($a) 

let
$b = (
  
select  
 max($depth ) as d  
  from (
  traverse inE('MainAssignment','SubUnit'),outV(),outE('MainAssignment'),outE('SubUnit')
  ,outE(),inE(),outV()
  from (

	select
	from person where 1=1
	and sAMAccountName='kpa'
	/* and in().Out('MainAssignment').inE() is null */
	and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and (Disabled is null) and
	(inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

  )) where @Class = 'Unit'
  
),
$a = (

select  
  GUID,Name, $depth as d
  
  from (
  traverse inE('MainAssignment','SubUnit'),outV(),outE('MainAssignment'),outE('SubUnit')
  ,outE(),inE(),outV()
  from (

	select
	from person where 1=1
	and sAMAccountName='kpa'
	/* and in().Out('MainAssignment').inE() is null */
	and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and (Disabled is null) and
	(inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

  )) where @Class = 'Unit'
  
)

) where 1=1
and d=$b.d[0]

}

public traversePath(){
//path 
traverse inE('MainAssignment','SubUnit'),outV() 


traverse inE('MainAssignment','SubUnit'),outV()  from (
select from person where 1=1 and sAMAccountName='lobanovamg'
/* and in().Out('MainAssignment').inE() is null */
and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate() ) and (Disabled is null) and
(inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )
)
}

public PersonFilter(){

//default person select no Fired or in maternity leave
select expand(in().Out('MainAssignment').inE()) as p
from person where 1=1 and sAMAccountName='lobanovamg'
/* and in().Out('MainAssignment').inE() is null */
and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate() ) and (Disabled is null) and
(inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

}

public CheckCollegesTraverse(){

		traverse inE('MainAssignment'),outV('Person') from (
	select from (
	select expand($a)

	let
	$x = (
	select from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('SyulzyakovaVV').r[0]
	),
	$a =  (

	select from (
	  select expand(a) from (
		select inE('MainAssignment').outV('SubUnit').outE('MainAssignment').inV('Person') as a from (
		  select from person where 1=1 and sAMAccountName=$x.sAMAccountName[0])
	  )
	) where 1=1
	/*Exclude person's account from results*/
	and sAMAccountName != $x.sAMAccountName[0]

	/*Standart overall Person filter*/
	and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() )
	and (Disabled is null)
	and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

	)

	) order by Name
	) 
	
}

public ManagerCheck(){
	
select Name,Weight,inV('Person').sAMAccountName from (
select
expand( inE('MainAssignment').outV('Unit').outE('MainAssignment'))
from person where 1=1 and sAMAccountName='lobanovamg'
/* and in().Out('MainAssignment').inE() is null */
and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate() ) and (Disabled is null) and
(inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )
  )
	
}

public PersonLower(){
	
	 select Name,sAMAccountName as Acc,  inE('MainAssignment').Name as nm,inE('MainAssignment').Weight as w, inE('MainAssignment').Disabled as d,
    inE('MainAssignment').State as s from person where 1=1 and sAMAccountName in ['filimonovats','eliseevavv','kpa']
    
	
}

public LevelParody(){
	
//something like MOTHERFUCKING LEVEL
//unpredictable inE(), outV() and "while $depth" working
select from (
traverse both() from (
select from (
traverse inE() from (

select
from person where 1=1
and sAMAccountName='kpa'
/* and in().Out('MainAssignment').inE() is null */
and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and (Disabled is null) and
(inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

) while $depth <=2
) where 1=1
/* and @class = 'Object' */
) while $depth <=5
) where 1=1
/* and  @class = 'Object' */
and $depth >=1
and $depth <=4

}

public ConditionalSelect(){


select

if(eval('$a.r[0]=0'),$b.Name,'a') as r

from (
select $b,$c
let 
$b = (select from Person),
$c = (select from Unit),
$a =(
  select min(r) as r from (

	select if( eval('GUID=\'4e28f31a-89b8-11e4-bab2-00c2c66d13b0\''),0,1) as r from Person where GUID in (
	  select GUID from Person where GUID in
	  ['4e28f31a-89b8-11e4-bab2-00c2c66d13b0','0963f5ee-cbae-11e4-b849-f80f41d3dd35','f58c67e4-ab78-11e4-b308-f80f41d3dd35'])

  )
)

)



}

public Unsorted(){


//returns nothing
select from Person where MainAssignment[GUID] = '4e28f319-89b8-11e4-bab2-00c2c66d13b0'
select from Person where '4e28f319-89b8-11e4-bab2-00c2c66d13b0' in MainAssignment[GUID]
select from Person where '4e28f319-89b8-11e4-bab2-00c2c66d13b0' in MainAssignment[GUID].asString()

//returns something
select * from Person where In()[GUID]=["62c0871f-ed9a-11e4-b696-f80f41d3dd35"]
select * from Person where ["62c0871f-ed9a-11e4-b696-f80f41d3dd35"] in In()[GUID]

//Person name or Parent unit name
select Name, if(eval('@class=\"Unit\"'),In("SubUnit").Name,In("MainAssignment").Name) as Parent from VSC where @class='Unit'

//Traverse
traverse out('MainAssignment','SubUnit')
from (select from Unit where Name = 'НСПК') strategy BREADTH_FIRST
//strategy DEPTH_FIRST


//traverse path
traverse in('MainAssignment','SubUnit')
from (select from Person where sAMAccountName ='somovnv')


//Shortest path shortestpath/dijkstra
SELECT expand(Path) FROM ( select shortestpath($a,$b,'both',null,{"masdepth":2}) as Path
let $a = (select from Unit where Name = "Управление развития и поддержки программы лояльности"),
$b = (select from Person where Name = "Новошинская Наталья Валерьевна")
unwind Path)

//Shortest path dijkstra
SELECT expand(Path) FROM ( select dijkstra($a,$b,null,'both') as Path
let $a = (select from Unit where GUID='00000000-0000-0000-0000-000000000000'),
$b = (select from Person where Name = "Арсеньева Виктория Викторовна")
unwind Path)

//whole structure
traverse in() from (
SELECT expand(Path) FROM ( select dijkstra($a,$b,null,'both') as Path
let $a = (select from Unit where GUID='00000000-0000-0000-0000-000000000000'),
$b = (select from Person where [Name,sAMAccountName] LUCENE "%nesterovayv%" )
unwind Path) )


//Structure
select 
from (
traverse both('MainAssignment','SubUnit') from
(select from Unit where Name = 'НСПК')
)
where (inE()[0].Disabled is null and Disabled is null)


//Path from start to GUID
traverse in() from (
select expand(Path) from  ( select shortestpath($a,$b,'both',null,{"maxdepth":1}) as Path
let $a = (select from Unit where Name = "Управление развития и поддержки программы лояльности"),
$b = (select from Unit where GUID = '00000000-0000-0000-0000-000000000000')
unwind Path) )

//Traverse 
select from (
traverse in() from (
select expand(Path) from  ( select shortestpath($a,$b,'both',null,{"maxdepth":1}) as Path
let $a = (select from Unit where Name = "Управление развития и поддержки программы лояльности"),
$b = (select from Unit where GUID = '00000000-0000-0000-0000-000000000000')
unwind Path) ) while $depth <=1 ) where $depth >=1

//Select level by case
	select Name from (
	select Name , 
	if(eval('Name like "%епартамент%"'),1,if(eval('Name like "%правление%"'),2,0)) as Cnt
	from (traverse in() from (select from Person where [Name,sAMAccountName] LUCENE '%rsm%' )) 
	)

	let $mx = (
	select Max(Cnt) as Cnt from (
	select Name , 
	if(eval('Name like "%епартамент%"'),1,if(eval('Name like "%правление%"'),2,0)) as Cnt
	from (traverse in() from (select from Person where [Name,sAMAccountName] LUCENE '%rsm%' )) 
	)
	)
	
	where Cnt = $mx[Cnt][0]


//select relative level
	select Name from (
	select
	Name , 
	if(eval('Name like "%Правление%"'),1,if(eval('Name like "%епартамент%"'),2,if(eval('Name like "%правление%"'),3,0))) as Cnt
	/*   ,
	$a.Cnt.asString() as cnt,
	$a[Cnt][0] as cnt2,
	if(eval(' \"2\" in $a[Cnt][0] '),1,0) as cond */
	from (
	select expand(Path) from (select dijkstra((select from Person where [Name,sAMAccountName] LUCENE '%shashkovamj%' ), (select from Unit where Name = 'НСПК'),null,'in') as Path ) 
	)
	)
	let $a = (
	  
	select
	Max(if(eval('Name like "%Правление%"'),1,if(eval('Name like "%епартамент%"'),2,if(eval('Name like "%правление%"'),3,0)))  ) as Cnt
	from (
	select expand(Path) from (select dijkstra((select from Person where [Name,sAMAccountName] LUCENE '%shashkovamj%' ), (select from Unit where Name = 'НСПК'),null,'in') as Path ) 
	)
	  
	)
	
	
//DEPTH
	select from (
	traverse in("MainAssignment","SubUnit") from (
	select
	from person
	where [Name,sAMAccountName] LUCENE '%popovaav%'
	) while $depth <=4
	)
	where $depth >=3

	
//DEPTH BY COND
	select
	/* @this.Name,in(),out() , in().Name[0],out().Name[0] */
	from (
	traverse both() from (
	select from Unit where Name = 'НСПК'
	limit 1

	) while $depth <=6
	/* strategy DEPTH_FIRST */
	) where $depth >=4
	and (
	in().Name[0] != ''
	)



//FETCHPLAN
	select from (
		traverse in() from (
			select from  person
			where [Name,sAMAccountName] LUCENE '%prohorovaos%'
			fetchPlan in_*:-2 out_*:-2
		)
	)
	

}


			}

			public void Functions()
			{
				
				public void PersonsAPI()
				{
										
					//к какому подразделению принадлежит Сотрудник А.								
					public void GetUnitByAccount()
					{
						
						/*

db3 kpa 21:265 	db2 22:187

						*/
						
						
var g=orient.getGraph();
var b=g.command("sql","select in(\"MainAssignment\").Name[0] as Name from Person WHERE sAMAccountName = \""+accountName+"\" and (inE(\"MainAssignment\")[0].Disabled is null or inE(\"MainAssignment\")[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )");
return b;


					}
					
					//Определить Управление\Департамент Сотрудника А.
					public void GetDepartmentByAccount()
					{

					
var g=orient.getGraph();
var b=g.command("sql","select Name from (select expand($d) let $b = (select from Unit where GUID = '00000000-0000-0000-0000-000000000000'),$dep = (select expand(in()[0]) from Person WHERE sAMAccountName like '%"+accountName+"%' and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate()) and (Disabled is null) and (inE().State !='Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам')),$c = (select shortestpath($dep,$b,'both',null,null) as Path),$d=( select if(eval(\'Name like \"%правление%\"\'),2,if(eval(\'Name like \"%партамент%\"\'),1,-1)) as Depth,Name,GUID from (traverse in() from ( select expand($c) as Path) limit 3) ), $e=( select max(Depth) as Depth from (select expand($d)))) where 1=1 and $e.Depth[0] = Depth and GUID != '00000000-0000-0000-0000-000000000000' ");
return b;

//2 департмент после НСПК
select Name from (
traverse in('MainAssignment','SubUnit')
from (select from Person where sAMAccountName ='somovnv')
) where PGUID='00000000-0000-0000-0000-000000000000' 

var g=orient.getGraph();
var b=g.command("sql","select Name from (  traverse in('MainAssignment','SubUnit') from (select from Person where sAMAccountName ='"+accountName+"')  ) where PGUID='00000000-0000-0000-0000-000000000000' ");
return b;




//weighted for General 0, Departmens 50, Managements 100, Units 150, others 1000

select Weight,Name, inV('Person').sAMAccountName, $a.inE()[0].Weight,$a.inE()[0].Name from (
select
/* Path.Name,Path.inE().Name, Path.in().Name, Path.in().outE() */
expand(Path.in().outE())
from (
select	shortestpath($a,$c,'both',null,{"maxdepth":2}) as Path
let $a = ( select from person where sAMAccountName = 'DegterevaSV' )
, $b = (select from Unit where GUID = '00000000-0000-0000-0000-000000000000')
, $c = (select from Person where inE().Weight[0]  = 0)
unwind Path
)   
) where 1=1 
and @class = 'MainAssignment' 
and ( Disabled is null or Disabled > sysdate()) 
and (inV().Disabled is null or inV().Disabled > sysdate())
and (State !='Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам') 
and Weight <  $a.inE()[0].Weight


var g=orient.getGraph();
var b=g.command("sql","select Name from (  traverse in('MainAssignment','SubUnit') from (select from Person where sAMAccountName ='"+accountName+"')  ) where PGUID='00000000-0000-0000-0000-000000000000' ");
return b;



						/*testcase
							
							#22:321
							gorevaps -> Управление сертификации
							#21:0
							meshkovav -> Управление сопровождения технологических процессов
							
							#21:66
							malkhasyanar -> Управление регламентации и процедур
							#21:177
							avdeyie -> Управление тарифов и отчетности
							#21:275
							zhiltsovaa -> Управление тарифов и отчетности
							
							#21:313
							luchinata -> Управление по контролю рисков
							#22:152
							telukhla -> Управление стратегических проектов
							#22:208
							fesenkoev -> Управление стратегического планирования
							#21:153
							gejmanma -> Управление стратегических проектов
							
							#21:198 #19:54
							>	tishakovoi -> Организационно-правовой департамент
							#22:180 #19:74
							pelenitsinam -> Управление безопасности
							#21:268 #19:14
							>	a.pronin -> Административный департамент
							#22:59 #19:89
							makedonskajaks -> Департамент развития продуктов и бизнеса
							#21:227 #19:20
							>	mitichkinaea -> 500
							#22:307 #20:82
							sedovavv -> Руководство
							#21:242 #20:61
							sergeevro -> Управление сопровождения технологических процессов
							#22:84 #20:61
							reznichenkoks -> Управление сопровождения технологических процессов
							
							#22:306 #20:41
							SyulzyakovaVV -> Департамент маркетинга и коммуникаций
							#21:174 #20:63
							budaevaas -> Управление бренда и маркетинговых коммуникаций
							#21:60
							kuzmichjovdv -> Управление бренда и маркетинговых коммуникаций
							
							#21:203 ->(#19:45,#19:73)
							PodolskayaNI -> Департамент стратегического планирования и проектного управления
							Perepechiniv -> Управление стратегического планирования
							Karpushevamv -> Управление стратегических проектов
							
							gashigullinrr -> Управление по контролю рисков
							
							#21:59
							>	lopushanskijsv -> Административный департамент
							#22:95
							levitskayaaa -> Управление бюджетирования и управленческого учета
							
						*/
					
					}
					
					//Определить непосредственного Руководителя Сотрудника А.
					public void GetManagerByAccount()
					{

/*
var g=orient.getGraph();
var b=g.command("sql","select $h.Acc[0] as Name let $c = (select min(Wg) as Wg from ( select value as Wg from ( select expand(inV().inE().Weight) as Wg from ( select expand(in().OutE(\"MainAssignment\")) as Wg from Person where [Name,sAMAccountName] LUCENE \"%"+accountName+"%\")))) , $d = ( select inV().Name as Name,inV().sAMAccountName as Acc,inV().@rid as pId ,inV().inE().Weight[0] as Wg,inV().inE().Name[0] as Name2,inV().inE().outV().@rid[0] as uId from ( select expand(in().OutE(\"MainAssignment\")) as Wg from Person where [Name,sAMAccountName] LUCENE \"%"+accountName+"%\") where $c.Wg[0]=Weight ), $e = (select min(Wg) as Wg from (select value as Wg from (  select expand(inV().inE().Weight) as Wg from (  select expand(in().in().OutE(\"MainAssignment\")) as Wg from Person where [Name,sAMAccountName] LUCENE \"%"+accountName+"%\" )))) , $f = ( select inV().Name as Name,inV().sAMAccountName as Acc,inV().@rid as pId ,inV().inE().Weight[0] as Wg,inV().inE().Name[0] as Name2,inV().inE().outV().@rid[0] as uId from ( select expand(in().in().OutE(\"MainAssignment\")) as Wg from Person where [Name,sAMAccountName] LUCENE \"%"+accountName+"%\") where $e.Wg[0]=Weight), $g = ( select inE().Weight[0] as Wg from Person where [Name,sAMAccountName] LUCENE \"%"+accountName+"%\"),$h = (select expand(if(eval(' $g.Wg[0]=$d.Wg[0]'),$f,$d)) )");
return b;
*/

var g=orient.getGraph(); var b=g.command("sql","   select sAMAccountName as Name from ( select expand($a)  let $x = (select from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('"+accountName+"').r[0]) , $a = ( select expand(in().Out('MainAssignment')) from person where 1=1 and sAMAccountName =$x.sAMAccountName[0]  and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' ) order by Name  ) ) where 1=1 and sAMAccountName != $x.sAMAccountName[0]  "); return b;


//NEW manager query
//<<<<<<<<<<<<<<<<<

select r.Name[0] as Name from (
select 
  /*
  If person Weight is smallest -> header of Unit => get PUnit header
  else Unit Header
  */
if(eval('$z.w[0]=$a.w[0]'),if(eval('$x.inE(\'MainAssignment\').outV(\'Unit\').PGUID =\'00000000-0000-0000-0000-000000000000\''),'kvv',$f),$e) as r
/* if(eval('1=2'),1,if(eval('1=2'),2,3)) */



let
  $x = ( select  from Person where sAMAccountName.ToLowerCase()=GetLowerCase('kpa').r[0])
	/*person Weight*/
  ,$z = (
      select Weight as w from (select expand(inE('MainAssignment')) from Person where sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase())
  where (inE('MainAssignment').Disabled is null or inE('MainAssignment').Disabled >= sysdate() and (inE('MainAssignment').State != 'Отпуск по уходу за ребенком' and inE('MainAssignment').State != 'Отпуск по беременности и родам' ))
  )
  /*Min weigth in Person Unit*/
  ,$a = (
    
select min(Weight) as w from (
select expand(inE('MainAssignment').OutV('SubUnit').outE('MainAssignment')) from Person where  sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase()
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

)
/*Min weigth in Person PUnit*/
  , $b = ( 
    
  select min(Weight) as w from (
select expand(inE('MainAssignment').OutV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')) from Person where  sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase()
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

  )
  /*Person Unit person appointment*/
  	, $c = (
   
   select Name as d ,Weight as w,inV('Person').sAMAccountName as Name from (
select expand(inE('MainAssignment').OutV('SubUnit').outE('MainAssignment')) from Person where  sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase()
) where    (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

    )
  /*Person PUnit person appointment*/
  ,$d =(
    
    select Name as d ,Weight as w,inV('Person').sAMAccountName as Name from (
select expand(inE('MainAssignment').OutV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')) from Person where sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase()
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null
    
  )
  /*Person Unit Header $a->$c */
  , $e = (
     select from ( select expand($c)) where 1=1 and w =  $a.w[0]
  )
    /*Person PUnit Header $a->$c */
  , $f = (
     select from ( select expand($d)) where 1=1 and w = $b.w[0]
  )
)
  
  
  
  
  
//<<<<<<<<<<<<<<<

select r.Name[0] as Name from (

select 
  /*If person Weight is smallest -> header of Unit => get PUnit header 
  else Unit Header
  */
if(eval('$z.w[0]=$a.w[0]'),$f,$e) as r
/* expand($e) */
  
let
  x = ( select  from Person where sAMAccountName='YablokovAE' )
	/*person Weight*/
  ,$z = (
      select Weight as w from (select expand(inE('MainAssignment')) from Person where sAMAccountName=$x.sAMAccountName[0])
  where (inE('MainAssignment').Disabled is null or inE('MainAssignment').Disabled >= sysdate() and (inE('MainAssignment').State != 'Отпуск по уходу за ребенком' and inE('MainAssignment').State != 'Отпуск по беременности и родам' ))
  )
  /*Min weigth in Person Unit*/
  ,$a = (
    
select min(Weight) as w from (
select expand(inE('MainAssignment').OutV('SubUnit').outE('MainAssignment')) from Person where sAMAccountName=$x.sAMAccountName[0]
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

)
/*Min weigth in Person PUnit*/
  , $b = ( 
    
  select min(Weight) as w from (
select expand(inE('MainAssignment').OutV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')) from Person where sAMAccountName=$x.sAMAccountName[0]
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

  )
  /*Person Unit person appointment*/
  	, $c = (
   
   select Name as d ,Weight as w,inV('Person').sAMAccountName as Name from (
select expand(inE('MainAssignment').OutV('SubUnit').outE('MainAssignment')) from Person where sAMAccountName=$x.sAMAccountName[0]
) where    (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

    )
  /*Person PUnit person appointment*/
  ,$d =(
    
    select Name as d ,Weight as w,inV('Person').sAMAccountName as Name from (
select expand(inE('MainAssignment').OutV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')) from Person where sAMAccountName=$x.sAMAccountName[0]
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null
    
  )
  /*Person Unit Header $a->$c */
  , $e = (
     select from ( select expand($c)) where 1=1 and w =  $a.w[0]
  )
    /*Person PUnit Header $a->$c */
  , $f = (
     select from ( select expand($d)) where 1=1 and w = $b.w[0]
  )

  )
   




						//tests
						/*
							#22:321 #22:66
							gorevaps -> rsm
							#21:0 #21:91
							meshkovav -> pak
							
							#21:66 
							malkhasyanar -> Управление регламентации и процедур
							#21:177 #21:198
							#22:265 samovichevasa >	avdeyie -> tishakovoi
							#21:275 #21:177
							zhiltsovaa -> avdeyie
							
							#21:313 #22:45 (Директор по управлению и анализу рисков vs Начальник управления)
							#21:190 anokhinatb>  luchinata -> pogorelovdm
							#22:152 #22:281
							telukhla -> kda 
							#22:208 #21:288
							fesenkoev -> Perepechiniv
							#21:153 #22:274
							gejmanma -> skatovadd
							
							#21:198 #19:54
							>	tishakovoi -> Организационно-правовой департамент
							#22:180 #21:328
							pelenitsinam -> OVA
							#21:268 #19:14
							>	a.pronin -> Административный департамент
							#22:59 #22:66
							makedonskajaks -> rsm
							#21:227 #19:20
							>	mitichkinaea -> Управление по работе с ТСП
							#22:307 #21:117
							sedovavv -> kvv
							#21:242 #21:181
							sergeevro -> kalininia
							#22:84 #21:23
							reznichenkoks -> arsenevavv
							
							#22:306 #20:41
							SyulzyakovaVV -> Департамент маркетинга и коммуникаций
							#21:174 #22:76
							budaevaas -> kosarevavv
							#21:60 
							kuzmichjovdv -> Управление бренда и маркетинговых коммуникаций
							
							#21:203 ->(#19:45,#19:73)
							PodolskayaNI -> Департамент стратегического планирования и проектного управления
							Perepechiniv -> Управление стратегического планирования
							Karpushevamv -> Управление стратегических проектов
							
							gashigullinrr -> Управление по контролю рисков
							
							#21:59
							>	lopushanskijsv -> Административный департамент
							#22:95
							levitskayaaa -> Управление бюджетирования и управленческого учета
						*/
							
						//tests
						/*
						
gorevaps 
malkhasyanar 
zhiltsovaa
anokhinatb
makedonskajaks -> [\"rsm\"]
SyulzyakovaVV
reznichenkoks -> [\"arsenevavv\"]
Perepechiniv
gashigullinrr -> [\"anokhinatb\"]
levitskayaaa 
								
					}
					
					//Определить Сотрудников того же отдела, что и Сотрудник А.
					public void GetCollegesByAccount()
					{
						
var g=orient.getGraph();
var b=g.command("sql","select  in().Out('MainAssignment').sAMAccountName from person where [Name,sAMAccountName] LUCENE '%"+accountName+"%'");
return b;


	//tests
	/*
						
gorevaps -> "[\"gorevaps\",\"kapkaev\",\"kokuevol\"]"
malkhasyanar -> [\"malkhasyanar\",\"Pletnevov\",\"kvv\"]
zhiltsovaa
anokhinatb
makedonskajaks
SyulzyakovaVV
reznichenkoks
Perepechiniv
gashigullinrr
levitskayaaa -> [
				"krasotkinaei",
				"andreevatv",
				"Kushelevaib",
				"Belyakovpn",
				"kuzminay",
				"SinitsynaTV",
				"choi",
				"koganal",
				"levitskayaaa"
			]
								
	*/
	
					}
									
					//Определить цепочку руководителей от Сотрудника А до Генерального Директора
					public void GetManagerHierarhyByAccount()
					{

var g=orient.getGraph();
var b=g.command("sql","  select Acc as Name from ( select expand($e) let $x = ( select from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('"+accountName+"').r[0]    )  ,$a = (      /*From Person by Unit Hierarhy*/     select  Name as n, sAMAccountName as Acc, inE(\'MainAssignment\').outV(\'Unit\').Name[0] as d, inE(\'MainAssignment\').Weight[0] as w from (       select expand(inV()) from (            traverse inE(\'MainAssignment\',\'SubUnit\'),outE(\'MainAssignment\'),outV(\'Unit\',\'Person\') from (           select from person where 1=1 and sAMAccountName=$x.sAMAccountName[0] )           ) ) where 1=1      and (inE(\"MainAssignment\")[0].Disabled is null or inE(\"MainAssignment\")[0].Disabled >= sysdate() ) and (Disabled is null) and     (inE().State != \'Отпуск по уходу за ребенком\' and inE().State != \'Отпуск по беременности и родам\' )         /*If account name not assigned then deputy*/ 	and sAMAccountName is not null       ), $c = (      /*Select Header by Weight 0 */     select  Name as n, sAMAccountName as Acc, inE(\'MainAssignment\').outV(\'Unit\').Name[0] as d, inE(\'MainAssignment\').Weight[0] as w from (       select from Person where inE(\'MainAssignment\').Weight[0] = 0     )    ) , $e = unionall (      /*Union all Unit Headers and Directory (as ddirectory not in linear structure -> not binded to parent node*/     $a,$c    ), $b = (      /*From United Person by Unit Hierarhy minimal Wights in Unit*/     select d , min(w) as w from (       select expand($e)     ) group by d    )  )  where 1=1      and w in $b.w     and w != $x.inE(\'MainAssignment\').Weight[0] order by Name ");
return b;
						
						//tests
						/*
																		
gorevaps -> [\"gorevaps\",\"rsm\",\"kvv\"]
malkhasyanar -> [\"malkhasyanar\",\"Pletnevov\",\"kvv\"]
zhiltsovaa
anokhinatb
makedonskajaks
SyulzyakovaVV
reznichenkoks
Perepechiniv
gashigullinrr
levitskayaaa -> [\"choi\",\"koganal\",\"kvv\"]						 
							
						*/
		
		
	//<<<<<<<<<<<<<<<<<<<< Hierarhy ready





select  Acc as Name from (

  select expand($b3)

  let
  $x = (

    select from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('Evlanovav').r[0]

  )  ,$a = (

    /*From Person by Unit Hierarhy*/
    select  Name as n, sAMAccountName as Acc, inE('MainAssignment').outV('Unit').Name[0] as d, inE('MainAssignment').Weight[0] as w ,  inE('MainAssignment').Name[0] as a from (
      select expand(inV()) from (    
        traverse inE('MainAssignment','SubUnit'),outE('MainAssignment'),outV('Unit','Person') from (
          select from person where 1=1 and sAMAccountName=$x.sAMAccountName[0] )     
      ) ) where 1=1  
    and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate() ) and (Disabled is null) and
    (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )
    
    /*If account name not assigned then deputy*/
	and sAMAccountName is not null
    
  ), $c = (

    /*Select Header by Weight 0 */
    select  Name as n, sAMAccountName as Acc, inE('MainAssignment').outV('Unit').Name[0] as d, inE('MainAssignment').Weight[0] as w, inE('MainAssignment').Name[0] as a from (
      select from Person where inE('MainAssignment').Weight[0] = 0
    )

  ) , $e = unionall (

    /*Union all Unit Headers and Directory (as ddirectory not in linear structure -> not binded to parent node*/
    $a,$c

  ), $b = (

    /*From United Person by Unit Hierarhy minimal Wights in Unit by account*/
    select from  (
    select Acc,d,a, min(w) as w from (
      select expand($e)
    ) group by  Acc
      ) where 1=1 and w < $x.inE('MainAssignment').Weight[0] order by w

  ), $b2 = (

    /*Minuimal wight by department*/
    select from  (
    select d , min(w) as w from (
      select expand($e)
    ) group by d
      ) where 1=1 and w < $x.inE('MainAssignment').Weight[0] order by w

  ), $b3 = (
  	select from (select expand($b )) where w in $b2.w
  )

) 




	
		
	//<<<<<<<<<<<<<<<<<<<< Hierarhy 1

select from (
  select expand($f)

  let 


  $e= (

    /*min person by unit*/
    select 
    d,min(w) as w 

    from (
      select inE('MainAssignment').outV('SubUnit').Name[0] as d, inE('MainAssignment').Weight[0] as w from (
        select expand ( outE('MainAssignment').inV('Person')) from (traverse inE('MainAssignment','SubUnit'),outV('Unit')
                                                                    from ( select from Person where sAMAccountName='somovnv')) where @class='Unit'
      ) 
      where 1=1 

      and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and
      (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

    )

    group by d

  ) 
  , $f = (

    /*Names weight*/
    select sAMAccountName, Name , inE('MainAssignment').Weight[0] as w from (
      
      select expand ( outE('MainAssignment').inV('Person')) from (traverse inE('MainAssignment','SubUnit'),outV('Unit')
                                                                  from ( select from Person where sAMAccountName='somovnv')                                                                 
                                                                 ) where @class='Unit'
    ) 
    where 1=1 

    and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and
    (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )


  )
)
where w in $e.w


//<<<<<<<<<<<<<< hierarhy 2	


select 
 inV('Person').sAMAccountName as Name , Name
 from (   
 select    expand(Path)  
 from (     
 
 select	shortestpath($a,$c,'both',null,{"maxdepth":2}) as Path

 let 
 
 $a = ( select from person where sAMAccountName.toLowerCase() = 'somovnv')    
 , $b = (select from Unit where GUID = '00000000-0000-0000-0000-000000000000') 	
 , $c = (select from Person where inE().Weight[0]  = 0)
 , $e= (

    /*min person by unit*/
    select 
    d,min(w) as w 

    from (
      select inE('MainAssignment').outV('SubUnit').Name[0] as d, inE('MainAssignment').Weight[0] as w from (
        select expand ( outE('MainAssignment').inV('Person')) from (traverse inE('MainAssignment','SubUnit'),outV('Unit')
                                                                    from ( select from Person where sAMAccountName='somovnv')) where @class='Unit'
      ) 
      where 1=1 

      and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and
      (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

    )

    group by d

  ) 
  , $f = (

    /*Names weight*/
    select sAMAccountName, Name , inE('MainAssignment').Weight[0] as w from (
      
      select expand ( outE('MainAssignment').inV('Person')) from (traverse inE('MainAssignment','SubUnit'),outV('Unit')
                                                                  from ( select from Person where sAMAccountName='somovnv')                                                                 
                                                                 ) where @class='Unit'
    ) 
    where 1=1 

    and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and
    (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )


  )
   
 unwind Path
 )
 )
 where 1=1
 and @class = 'MainAssignment'
 and ( Disabled is null or Disabled > sysdate()) 
 and (inV().Disabled is null or inV().Disabled > sysdate()) 
 and (State !='Отпуск по уходу за ребенком' 
 and State != 'Отпуск по беременности и родам')
/*  and Weight <  $a.inE('MainAssignment')[0].Weight */
and Weight in $e.w
 
 
 
						
					}
					
					public void GetCollegesByAccount()
					{
						
var g=orient.getGraph();
var b=g.command("sql","  select in().Out('MainAssignment').sAMAccountName as Name from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('"+accountName+"').r[0]  and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' ) order by Name  "); 
return b; 


					}
					
					//Определить всех нижестоящих сотрудников относительно Сотрудника А.
					public void GetCollegesLowerByAccount()
					{

var g=orient.getGraph();
var b=g.command("sql","select sAMAccountName as Name from ( 	traverse out() from ( 	select in() from person where 1=1 and sAMAccountName='"+accountName+"' ) 	) 	where @class = \'Person\' 	and not ( 	(Name like \'%директор департамента%\') 	or ( Name like \'%ачальник %\') and (inE(\"MainAssignment\")[0].Disabled is null or inE(\"MainAssignment\")[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )	) order by Name");
return b;


/*
Perepechiniv -> ["fesenkoev","Averochkinaav", "Perepechiniv","diana.zainullina"]
*/															
					
					}
					
				}
								
				public void NewFunctions()
				{
					
					public void SerachPersonAll()
					{
var g=orient.getGraph();
var b=g.command("sql","select GUID as id, ifnull( if( eval(\"@class = 'Person'\"),in(\"MainAssignment\").Name[0],Name[0]) ,'0' ) as division , ifnull( if( eval(\"@class = 'Person'\"),in(\"MainAssignment\").GUID[0],PGUID[0]) ,'0' ) as parent, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, ifnull((inE('MainAssignment').Name[0]), Name) as description , GetDepartmentColor(GUID)[color][0] as itemTitleColor , if( eval(\"@class = 'Person'\"),'PersonTemplate','UnitTemplate' ) as templateName , if(eval('inE().ExpDate[0] is not null'), inE().State[0],null)  as state,  if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate, GetPositionBar(InE().Name[0].replace('\\\"',''))['groupTitle'][0] as groupTitle  , Birthday.format('dd.MM') as birthday  ,  GetDepartmentColorClass(GUID)[colorClass][0] as colorClass, GetDepartmentName(GUID)[departmentName][0] as departmentName, sAMAccountName as login from Person WHERE [Name, sAMAccountName] LUCENE \"/.*"+substr+".*/\" ");
return b;
					}
					
					// public void GetPersonActive()
					{
var g=orient.getGraph(); 
var b=g.command("sql",'select GetPersonPhoto(mail) as Photo, FirstName, GUID, PGUID ,Name,Disabled,Created,sAMAccountName,Changed,LastName,MiddleName,mail,telephoneNumber,userAccountControl,objectGUID from Person where GUID = "'+GUID+'"  and ((inE()[0].Disabled is null or inE()[0].Disabled >= sysdate() ) and (Disabled is null)  and ( ((@class = \'Person\') or (out(\"MainAssignment\").size() >0)  or (out(\"SubUnit\").size() >0)) or (Name = \'НСПК\')) and (inE().State != \'Отпуск по уходу за ребенком\' and inE().State != \'Отпуск по беременности и родам\'))'); 
return b;
					}

					public void GetLowerCase()
					{
						
var g=orient.getGraph();
var b=g.command("sql","select r.ToLowerCase() as r from (select '"+input+"' as r)");
return b;

					}
					
				}
			
			}

			public void FU()
			{

	
//<< I (try it out)
//inverted V E In Out
(v)-[e]->(v)
out e in 

[e]->(v)->[e]
in v out

//<< II
//Traverse out -> shows nested Nodes but select from (traverse ) =< not
//need to repeat in(),out syntax

//<< III
//parent Node 'NSPK' is not Unit -> its company

//<< IV (take it bit..h!)
//returning from if(eval,) returns json aray but not object [[]] -x {[]}

//<< V
//Начальник управления инфраструктуры_ !!! << empty char

//<< VI (ups!)
// different traverse and select results (solodale Отдел поддержки прикладных систем)
{
 select  Name as n, sAMAccountName as Acc, inE('MainAssignment').outV('Unit').Name[0] as d, inE('MainAssignment').Weight[0] as w from (
      select expand(inV()) from (    
        traverse inE('MainAssignment','SubUnit'),outE('MainAssignment'),outV('Unit','Person') from (
          select from person where 1=1 and sAMAccountName='Evlanovav' )     
      ) ) where 1=1  
	  
}

//<< VII (fairyland)
//function can be programmatically created but not Deleted
			
//<< VIII  (not so fast)
//mentioned traverse functions has no any effect
//SELECT traversedElement(-1, 3) FROM ( TRAVERSE out() FROM #34:3232 WHILE $depth <= 10 )

//<< IX (stink it)
//unpredicable commenaries

//<<X (i pee on you)
//insert create from sql throught let absolutely fucked up syntax
//http://orientdb.com/docs/last/Sequences-and-auto-increment.html
//inserting in batch is different either
//and this is described in docs Voila!


//XI (surpise motherfuc.er!!)
//not all properties seen in schema
//maybe cause script classses creation

//XII (basic maths problems - developer not accountant)
//How the fuck does this even works (..<2..>1..)?
//match {class:Person }.in("MainAssignment").out("SubUnit"){as: u, while: ($depth < 2),where: ($depth > 1)} return u
//More fucks with (..=2..<2..)
//and (=1 <1) or (>1 <1) for desert

//XIII (insert it here)
//creting fnctions from commands (JSON or HTTP POST param0 incorrect " escape
// \\" solves " but intrevals disappear

//XIV
//functions not visible from OFunction class

//XV
//batch not indeponent, class and property creation only from command or batch with let

//XVI
//content property in Nodes or Relations broke batch command

//XVIII
//GUID command unpredictable 
//ALTER PROPERTY CALSS.PROP DEFAULT uuid(); -> always same value
//ALTER PROPERTY CALSS.PROP DEFAULT "uuid()"; -> new guid every create															 
//XIX
//batch adtetime if not esaped \"\" read as iso 8061, while database format  DATEtime is date time
			
		}
					
		}
		
		public void Neo4J()
		{
			neo4j:root
			public void PlayMovie()
			{
				CREATE (TheMatrix:Movie {title:'The Matrix', released:1999, tagline:'Welcome to the Real World'})
	CREATE (Keanu:Person {name:'Keanu Reeves', born:1964})
	CREATE (Carrie:Person {name:'Carrie-Anne Moss', born:1967})
	CREATE (Laurence:Person {name:'Laurence Fishburne', born:1961})
	CREATE (Hugo:Person {name:'Hugo Weaving', born:1960})
	CREATE (LillyW:Person {name:'Lilly Wachowski', born:1967})
	CREATE (LanaW:Person {name:'Lana Wachowski', born:1965})
	CREATE (JoelS:Person {name:'Joel Silver', born:1952})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Neo']}]->(TheMatrix),
	  (Carrie)-[:ACTED_IN {roles:['Trinity']}]->(TheMatrix),
	  (Laurence)-[:ACTED_IN {roles:['Morpheus']}]->(TheMatrix),
	  (Hugo)-[:ACTED_IN {roles:['Agent Smith']}]->(TheMatrix),
	  (LillyW)-[:DIRECTED]->(TheMatrix),
	  (LanaW)-[:DIRECTED]->(TheMatrix),
	  (JoelS)-[:PRODUCED]->(TheMatrix)

	CREATE (Emil:Person {name:"Emil Eifrem", born:1978})
	CREATE (Emil)-[:ACTED_IN {roles:["Emil"]}]->(TheMatrix)

	CREATE (TheMatrixReloaded:Movie {title:'The Matrix Reloaded', released:2003, tagline:'Free your mind'})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Neo']}]->(TheMatrixReloaded),
	  (Carrie)-[:ACTED_IN {roles:['Trinity']}]->(TheMatrixReloaded),
	  (Laurence)-[:ACTED_IN {roles:['Morpheus']}]->(TheMatrixReloaded),
	  (Hugo)-[:ACTED_IN {roles:['Agent Smith']}]->(TheMatrixReloaded),
	  (LillyW)-[:DIRECTED]->(TheMatrixReloaded),
	  (LanaW)-[:DIRECTED]->(TheMatrixReloaded),
	  (JoelS)-[:PRODUCED]->(TheMatrixReloaded)

	CREATE (TheMatrixRevolutions:Movie {title:'The Matrix Revolutions', released:2003, tagline:'Everything that has a beginning has an end'})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Neo']}]->(TheMatrixRevolutions),
	  (Carrie)-[:ACTED_IN {roles:['Trinity']}]->(TheMatrixRevolutions),
	  (Laurence)-[:ACTED_IN {roles:['Morpheus']}]->(TheMatrixRevolutions),
	  (Hugo)-[:ACTED_IN {roles:['Agent Smith']}]->(TheMatrixRevolutions),
	  (LillyW)-[:DIRECTED]->(TheMatrixRevolutions),
	  (LanaW)-[:DIRECTED]->(TheMatrixRevolutions),
	  (JoelS)-[:PRODUCED]->(TheMatrixRevolutions)

	CREATE (TheDevilsAdvocate:Movie {title:"The Devil's Advocate", released:1997, tagline:'Evil has its winning ways'})
	CREATE (Charlize:Person {name:'Charlize Theron', born:1975})
	CREATE (Al:Person {name:'Al Pacino', born:1940})
	CREATE (Taylor:Person {name:'Taylor Hackford', born:1944})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Kevin Lomax']}]->(TheDevilsAdvocate),
	  (Charlize)-[:ACTED_IN {roles:['Mary Ann Lomax']}]->(TheDevilsAdvocate),
	  (Al)-[:ACTED_IN {roles:['John Milton']}]->(TheDevilsAdvocate),
	  (Taylor)-[:DIRECTED]->(TheDevilsAdvocate)

	CREATE (AFewGoodMen:Movie {title:"A Few Good Men", released:1992, tagline:"In the heart of the nation's capital, in a courthouse of the U.S. government, one man will stop at nothing to keep his honor, and one will stop at nothing to find the truth."})
	CREATE (TomC:Person {name:'Tom Cruise', born:1962})
	CREATE (JackN:Person {name:'Jack Nicholson', born:1937})
	CREATE (DemiM:Person {name:'Demi Moore', born:1962})
	CREATE (KevinB:Person {name:'Kevin Bacon', born:1958})
	CREATE (KieferS:Person {name:'Kiefer Sutherland', born:1966})
	CREATE (NoahW:Person {name:'Noah Wyle', born:1971})
	CREATE (CubaG:Person {name:'Cuba Gooding Jr.', born:1968})
	CREATE (KevinP:Person {name:'Kevin Pollak', born:1957})
	CREATE (JTW:Person {name:'J.T. Walsh', born:1943})
	CREATE (JamesM:Person {name:'James Marshall', born:1967})
	CREATE (ChristopherG:Person {name:'Christopher Guest', born:1948})
	CREATE (RobR:Person {name:'Rob Reiner', born:1947})
	CREATE (AaronS:Person {name:'Aaron Sorkin', born:1961})
	CREATE
	  (TomC)-[:ACTED_IN {roles:['Lt. Daniel Kaffee']}]->(AFewGoodMen),
	  (JackN)-[:ACTED_IN {roles:['Col. Nathan R. Jessup']}]->(AFewGoodMen),
	  (DemiM)-[:ACTED_IN {roles:['Lt. Cdr. JoAnne Galloway']}]->(AFewGoodMen),
	  (KevinB)-[:ACTED_IN {roles:['Capt. Jack Ross']}]->(AFewGoodMen),
	  (KieferS)-[:ACTED_IN {roles:['Lt. Jonathan Kendrick']}]->(AFewGoodMen),
	  (NoahW)-[:ACTED_IN {roles:['Cpl. Jeffrey Barnes']}]->(AFewGoodMen),
	  (CubaG)-[:ACTED_IN {roles:['Cpl. Carl Hammaker']}]->(AFewGoodMen),
	  (KevinP)-[:ACTED_IN {roles:['Lt. Sam Weinberg']}]->(AFewGoodMen),
	  (JTW)-[:ACTED_IN {roles:['Lt. Col. Matthew Andrew Markinson']}]->(AFewGoodMen),
	  (JamesM)-[:ACTED_IN {roles:['Pfc. Louden Downey']}]->(AFewGoodMen),
	  (ChristopherG)-[:ACTED_IN {roles:['Dr. Stone']}]->(AFewGoodMen),
	  (AaronS)-[:ACTED_IN {roles:['Man in Bar']}]->(AFewGoodMen),
	  (RobR)-[:DIRECTED]->(AFewGoodMen),
	  (AaronS)-[:WROTE]->(AFewGoodMen)

	CREATE (TopGun:Movie {title:"Top Gun", released:1986, tagline:'I feel the need, the need for speed.'})
	CREATE (KellyM:Person {name:'Kelly McGillis', born:1957})
	CREATE (ValK:Person {name:'Val Kilmer', born:1959})
	CREATE (AnthonyE:Person {name:'Anthony Edwards', born:1962})
	CREATE (TomS:Person {name:'Tom Skerritt', born:1933})
	CREATE (MegR:Person {name:'Meg Ryan', born:1961})
	CREATE (TonyS:Person {name:'Tony Scott', born:1944})
	CREATE (JimC:Person {name:'Jim Cash', born:1941})
	CREATE
	  (TomC)-[:ACTED_IN {roles:['Maverick']}]->(TopGun),
	  (KellyM)-[:ACTED_IN {roles:['Charlie']}]->(TopGun),
	  (ValK)-[:ACTED_IN {roles:['Iceman']}]->(TopGun),
	  (AnthonyE)-[:ACTED_IN {roles:['Goose']}]->(TopGun),
	  (TomS)-[:ACTED_IN {roles:['Viper']}]->(TopGun),
	  (MegR)-[:ACTED_IN {roles:['Carole']}]->(TopGun),
	  (TonyS)-[:DIRECTED]->(TopGun),
	  (JimC)-[:WROTE]->(TopGun)

	CREATE (JerryMaguire:Movie {title:'Jerry Maguire', released:2000, tagline:'The rest of his life begins now.'})
	CREATE (ReneeZ:Person {name:'Renee Zellweger', born:1969})
	CREATE (KellyP:Person {name:'Kelly Preston', born:1962})
	CREATE (JerryO:Person {name:"Jerry O'Connell", born:1974})
	CREATE (JayM:Person {name:'Jay Mohr', born:1970})
	CREATE (BonnieH:Person {name:'Bonnie Hunt', born:1961})
	CREATE (ReginaK:Person {name:'Regina King', born:1971})
	CREATE (JonathanL:Person {name:'Jonathan Lipnicki', born:1996})
	CREATE (CameronC:Person {name:'Cameron Crowe', born:1957})
	CREATE
	  (TomC)-[:ACTED_IN {roles:['Jerry Maguire']}]->(JerryMaguire),
	  (CubaG)-[:ACTED_IN {roles:['Rod Tidwell']}]->(JerryMaguire),
	  (ReneeZ)-[:ACTED_IN {roles:['Dorothy Boyd']}]->(JerryMaguire),
	  (KellyP)-[:ACTED_IN {roles:['Avery Bishop']}]->(JerryMaguire),
	  (JerryO)-[:ACTED_IN {roles:['Frank Cushman']}]->(JerryMaguire),
	  (JayM)-[:ACTED_IN {roles:['Bob Sugar']}]->(JerryMaguire),
	  (BonnieH)-[:ACTED_IN {roles:['Laurel Boyd']}]->(JerryMaguire),
	  (ReginaK)-[:ACTED_IN {roles:['Marcee Tidwell']}]->(JerryMaguire),
	  (JonathanL)-[:ACTED_IN {roles:['Ray Boyd']}]->(JerryMaguire),
	  (CameronC)-[:DIRECTED]->(JerryMaguire),
	  (CameronC)-[:PRODUCED]->(JerryMaguire),
	  (CameronC)-[:WROTE]->(JerryMaguire)

	CREATE (StandByMe:Movie {title:"Stand By Me", released:1986, tagline:"For some, it's the last real taste of innocence, and the first real taste of life. But for everyone, it's the time that memories are made of."})
	CREATE (RiverP:Person {name:'River Phoenix', born:1970})
	CREATE (CoreyF:Person {name:'Corey Feldman', born:1971})
	CREATE (WilW:Person {name:'Wil Wheaton', born:1972})
	CREATE (JohnC:Person {name:'John Cusack', born:1966})
	CREATE (MarshallB:Person {name:'Marshall Bell', born:1942})
	CREATE
	  (WilW)-[:ACTED_IN {roles:['Gordie Lachance']}]->(StandByMe),
	  (RiverP)-[:ACTED_IN {roles:['Chris Chambers']}]->(StandByMe),
	  (JerryO)-[:ACTED_IN {roles:['Vern Tessio']}]->(StandByMe),
	  (CoreyF)-[:ACTED_IN {roles:['Teddy Duchamp']}]->(StandByMe),
	  (JohnC)-[:ACTED_IN {roles:['Denny Lachance']}]->(StandByMe),
	  (KieferS)-[:ACTED_IN {roles:['Ace Merrill']}]->(StandByMe),
	  (MarshallB)-[:ACTED_IN {roles:['Mr. Lachance']}]->(StandByMe),
	  (RobR)-[:DIRECTED]->(StandByMe)

	CREATE (AsGoodAsItGets:Movie {title:'As Good as It Gets', released:1997, tagline:'A comedy from the heart that goes for the throat.'})
	CREATE (HelenH:Person {name:'Helen Hunt', born:1963})
	CREATE (GregK:Person {name:'Greg Kinnear', born:1963})
	CREATE (JamesB:Person {name:'James L. Brooks', born:1940})
	CREATE
	  (JackN)-[:ACTED_IN {roles:['Melvin Udall']}]->(AsGoodAsItGets),
	  (HelenH)-[:ACTED_IN {roles:['Carol Connelly']}]->(AsGoodAsItGets),
	  (GregK)-[:ACTED_IN {roles:['Simon Bishop']}]->(AsGoodAsItGets),
	  (CubaG)-[:ACTED_IN {roles:['Frank Sachs']}]->(AsGoodAsItGets),
	  (JamesB)-[:DIRECTED]->(AsGoodAsItGets)

	CREATE (WhatDreamsMayCome:Movie {title:'What Dreams May Come', released:1998, tagline:'After life there is more. The end is just the beginning.'})
	CREATE (AnnabellaS:Person {name:'Annabella Sciorra', born:1960})
	CREATE (MaxS:Person {name:'Max von Sydow', born:1929})
	CREATE (WernerH:Person {name:'Werner Herzog', born:1942})
	CREATE (Robin:Person {name:'Robin Williams', born:1951})
	CREATE (VincentW:Person {name:'Vincent Ward', born:1956})
	CREATE
	  (Robin)-[:ACTED_IN {roles:['Chris Nielsen']}]->(WhatDreamsMayCome),
	  (CubaG)-[:ACTED_IN {roles:['Albert Lewis']}]->(WhatDreamsMayCome),
	  (AnnabellaS)-[:ACTED_IN {roles:['Annie Collins-Nielsen']}]->(WhatDreamsMayCome),
	  (MaxS)-[:ACTED_IN {roles:['The Tracker']}]->(WhatDreamsMayCome),
	  (WernerH)-[:ACTED_IN {roles:['The Face']}]->(WhatDreamsMayCome),
	  (VincentW)-[:DIRECTED]->(WhatDreamsMayCome)

	CREATE (SnowFallingonCedars:Movie {title:'Snow Falling on Cedars', released:1999, tagline:'First loves last. Forever.'})
	CREATE (EthanH:Person {name:'Ethan Hawke', born:1970})
	CREATE (RickY:Person {name:'Rick Yune', born:1971})
	CREATE (JamesC:Person {name:'James Cromwell', born:1940})
	CREATE (ScottH:Person {name:'Scott Hicks', born:1953})
	CREATE
	  (EthanH)-[:ACTED_IN {roles:['Ishmael Chambers']}]->(SnowFallingonCedars),
	  (RickY)-[:ACTED_IN {roles:['Kazuo Miyamoto']}]->(SnowFallingonCedars),
	  (MaxS)-[:ACTED_IN {roles:['Nels Gudmundsson']}]->(SnowFallingonCedars),
	  (JamesC)-[:ACTED_IN {roles:['Judge Fielding']}]->(SnowFallingonCedars),
	  (ScottH)-[:DIRECTED]->(SnowFallingonCedars)

	CREATE (YouveGotMail:Movie {title:"You've Got Mail", released:1998, tagline:'At odds in life... in love on-line.'})
	CREATE (ParkerP:Person {name:'Parker Posey', born:1968})
	CREATE (DaveC:Person {name:'Dave Chappelle', born:1973})
	CREATE (SteveZ:Person {name:'Steve Zahn', born:1967})
	CREATE (TomH:Person {name:'Tom Hanks', born:1956})
	CREATE (NoraE:Person {name:'Nora Ephron', born:1941})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Joe Fox']}]->(YouveGotMail),
	  (MegR)-[:ACTED_IN {roles:['Kathleen Kelly']}]->(YouveGotMail),
	  (GregK)-[:ACTED_IN {roles:['Frank Navasky']}]->(YouveGotMail),
	  (ParkerP)-[:ACTED_IN {roles:['Patricia Eden']}]->(YouveGotMail),
	  (DaveC)-[:ACTED_IN {roles:['Kevin Jackson']}]->(YouveGotMail),
	  (SteveZ)-[:ACTED_IN {roles:['George Pappas']}]->(YouveGotMail),
	  (NoraE)-[:DIRECTED]->(YouveGotMail)

	CREATE (SleeplessInSeattle:Movie {title:'Sleepless in Seattle', released:1993, tagline:'What if someone you never met, someone you never saw, someone you never knew was the only someone for you?'})
	CREATE (RitaW:Person {name:'Rita Wilson', born:1956})
	CREATE (BillPull:Person {name:'Bill Pullman', born:1953})
	CREATE (VictorG:Person {name:'Victor Garber', born:1949})
	CREATE (RosieO:Person {name:"Rosie O'Donnell", born:1962})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Sam Baldwin']}]->(SleeplessInSeattle),
	  (MegR)-[:ACTED_IN {roles:['Annie Reed']}]->(SleeplessInSeattle),
	  (RitaW)-[:ACTED_IN {roles:['Suzy']}]->(SleeplessInSeattle),
	  (BillPull)-[:ACTED_IN {roles:['Walter']}]->(SleeplessInSeattle),
	  (VictorG)-[:ACTED_IN {roles:['Greg']}]->(SleeplessInSeattle),
	  (RosieO)-[:ACTED_IN {roles:['Becky']}]->(SleeplessInSeattle),
	  (NoraE)-[:DIRECTED]->(SleeplessInSeattle)

	CREATE (JoeVersustheVolcano:Movie {title:'Joe Versus the Volcano', released:1990, tagline:'A story of love, lava and burning desire.'})
	CREATE (JohnS:Person {name:'John Patrick Stanley', born:1950})
	CREATE (Nathan:Person {name:'Nathan Lane', born:1956})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Joe Banks']}]->(JoeVersustheVolcano),
	  (MegR)-[:ACTED_IN {roles:['DeDe', 'Angelica Graynamore', 'Patricia Graynamore']}]->(JoeVersustheVolcano),
	  (Nathan)-[:ACTED_IN {roles:['Baw']}]->(JoeVersustheVolcano),
	  (JohnS)-[:DIRECTED]->(JoeVersustheVolcano)

	CREATE (WhenHarryMetSally:Movie {title:'When Harry Met Sally', released:1998, tagline:'At odds in life... in love on-line.'})
	CREATE (BillyC:Person {name:'Billy Crystal', born:1948})
	CREATE (CarrieF:Person {name:'Carrie Fisher', born:1956})
	CREATE (BrunoK:Person {name:'Bruno Kirby', born:1949})
	CREATE
	  (BillyC)-[:ACTED_IN {roles:['Harry Burns']}]->(WhenHarryMetSally),
	  (MegR)-[:ACTED_IN {roles:['Sally Albright']}]->(WhenHarryMetSally),
	  (CarrieF)-[:ACTED_IN {roles:['Marie']}]->(WhenHarryMetSally),
	  (BrunoK)-[:ACTED_IN {roles:['Jess']}]->(WhenHarryMetSally),
	  (RobR)-[:DIRECTED]->(WhenHarryMetSally),
	  (RobR)-[:PRODUCED]->(WhenHarryMetSally),
	  (NoraE)-[:PRODUCED]->(WhenHarryMetSally),
	  (NoraE)-[:WROTE]->(WhenHarryMetSally)

	CREATE (ThatThingYouDo:Movie {title:'That Thing You Do', released:1996, tagline:'In every life there comes a time when that thing you dream becomes that thing you do'})
	CREATE (LivT:Person {name:'Liv Tyler', born:1977})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Mr. White']}]->(ThatThingYouDo),
	  (LivT)-[:ACTED_IN {roles:['Faye Dolan']}]->(ThatThingYouDo),
	  (Charlize)-[:ACTED_IN {roles:['Tina']}]->(ThatThingYouDo),
	  (TomH)-[:DIRECTED]->(ThatThingYouDo)

	CREATE (TheReplacements:Movie {title:'The Replacements', released:2000, tagline:'Pain heals, Chicks dig scars... Glory lasts forever'})
	CREATE (Brooke:Person {name:'Brooke Langton', born:1970})
	CREATE (Gene:Person {name:'Gene Hackman', born:1930})
	CREATE (Orlando:Person {name:'Orlando Jones', born:1968})
	CREATE (Howard:Person {name:'Howard Deutch', born:1950})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Shane Falco']}]->(TheReplacements),
	  (Brooke)-[:ACTED_IN {roles:['Annabelle Farrell']}]->(TheReplacements),
	  (Gene)-[:ACTED_IN {roles:['Jimmy McGinty']}]->(TheReplacements),
	  (Orlando)-[:ACTED_IN {roles:['Clifford Franklin']}]->(TheReplacements),
	  (Howard)-[:DIRECTED]->(TheReplacements)

	CREATE (RescueDawn:Movie {title:'RescueDawn', released:2006, tagline:"Based on the extraordinary true story of one man's fight for freedom"})
	CREATE (ChristianB:Person {name:'Christian Bale', born:1974})
	CREATE (ZachG:Person {name:'Zach Grenier', born:1954})
	CREATE
	  (MarshallB)-[:ACTED_IN {roles:['Admiral']}]->(RescueDawn),
	  (ChristianB)-[:ACTED_IN {roles:['Dieter Dengler']}]->(RescueDawn),
	  (ZachG)-[:ACTED_IN {roles:['Squad Leader']}]->(RescueDawn),
	  (SteveZ)-[:ACTED_IN {roles:['Duane']}]->(RescueDawn),
	  (WernerH)-[:DIRECTED]->(RescueDawn)

	CREATE (TheBirdcage:Movie {title:'The Birdcage', released:1996, tagline:'Come as you are'})
	CREATE (MikeN:Person {name:'Mike Nichols', born:1931})
	CREATE
	  (Robin)-[:ACTED_IN {roles:['Armand Goldman']}]->(TheBirdcage),
	  (Nathan)-[:ACTED_IN {roles:['Albert Goldman']}]->(TheBirdcage),
	  (Gene)-[:ACTED_IN {roles:['Sen. Kevin Keeley']}]->(TheBirdcage),
	  (MikeN)-[:DIRECTED]->(TheBirdcage)

	CREATE (Unforgiven:Movie {title:'Unforgiven', released:1992, tagline:"It's a hell of a thing, killing a man"})
	CREATE (RichardH:Person {name:'Richard Harris', born:1930})
	CREATE (ClintE:Person {name:'Clint Eastwood', born:1930})
	CREATE
	  (RichardH)-[:ACTED_IN {roles:['English Bob']}]->(Unforgiven),
	  (ClintE)-[:ACTED_IN {roles:['Bill Munny']}]->(Unforgiven),
	  (Gene)-[:ACTED_IN {roles:['Little Bill Daggett']}]->(Unforgiven),
	  (ClintE)-[:DIRECTED]->(Unforgiven)

	CREATE (JohnnyMnemonic:Movie {title:'Johnny Mnemonic', released:1995, tagline:'The hottest data on earth. In the coolest head in town'})
	CREATE (Takeshi:Person {name:'Takeshi Kitano', born:1947})
	CREATE (Dina:Person {name:'Dina Meyer', born:1968})
	CREATE (IceT:Person {name:'Ice-T', born:1958})
	CREATE (RobertL:Person {name:'Robert Longo', born:1953})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Johnny Mnemonic']}]->(JohnnyMnemonic),
	  (Takeshi)-[:ACTED_IN {roles:['Takahashi']}]->(JohnnyMnemonic),
	  (Dina)-[:ACTED_IN {roles:['Jane']}]->(JohnnyMnemonic),
	  (IceT)-[:ACTED_IN {roles:['J-Bone']}]->(JohnnyMnemonic),
	  (RobertL)-[:DIRECTED]->(JohnnyMnemonic)

	CREATE (CloudAtlas:Movie {title:'Cloud Atlas', released:2012, tagline:'Everything is connected'})
	CREATE (HalleB:Person {name:'Halle Berry', born:1966})
	CREATE (JimB:Person {name:'Jim Broadbent', born:1949})
	CREATE (TomT:Person {name:'Tom Tykwer', born:1965})
	CREATE (DavidMitchell:Person {name:'David Mitchell', born:1969})
	CREATE (StefanArndt:Person {name:'Stefan Arndt', born:1961})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Zachry', 'Dr. Henry Goose', 'Isaac Sachs', 'Dermot Hoggins']}]->(CloudAtlas),
	  (Hugo)-[:ACTED_IN {roles:['Bill Smoke', 'Haskell Moore', 'Tadeusz Kesselring', 'Nurse Noakes', 'Boardman Mephi', 'Old Georgie']}]->(CloudAtlas),
	  (HalleB)-[:ACTED_IN {roles:['Luisa Rey', 'Jocasta Ayrs', 'Ovid', 'Meronym']}]->(CloudAtlas),
	  (JimB)-[:ACTED_IN {roles:['Vyvyan Ayrs', 'Captain Molyneux', 'Timothy Cavendish']}]->(CloudAtlas),
	  (TomT)-[:DIRECTED]->(CloudAtlas),
	  (LillyW)-[:DIRECTED]->(CloudAtlas),
	  (LanaW)-[:DIRECTED]->(CloudAtlas),
	  (DavidMitchell)-[:WROTE]->(CloudAtlas),
	  (StefanArndt)-[:PRODUCED]->(CloudAtlas)

	CREATE (TheDaVinciCode:Movie {title:'The Da Vinci Code', released:2006, tagline:'Break The Codes'})
	CREATE (IanM:Person {name:'Ian McKellen', born:1939})
	CREATE (AudreyT:Person {name:'Audrey Tautou', born:1976})
	CREATE (PaulB:Person {name:'Paul Bettany', born:1971})
	CREATE (RonH:Person {name:'Ron Howard', born:1954})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Dr. Robert Langdon']}]->(TheDaVinciCode),
	  (IanM)-[:ACTED_IN {roles:['Sir Leight Teabing']}]->(TheDaVinciCode),
	  (AudreyT)-[:ACTED_IN {roles:['Sophie Neveu']}]->(TheDaVinciCode),
	  (PaulB)-[:ACTED_IN {roles:['Silas']}]->(TheDaVinciCode),
	  (RonH)-[:DIRECTED]->(TheDaVinciCode)

	CREATE (VforVendetta:Movie {title:'V for Vendetta', released:2006, tagline:'Freedom! Forever!'})
	CREATE (NatalieP:Person {name:'Natalie Portman', born:1981})
	CREATE (StephenR:Person {name:'Stephen Rea', born:1946})
	CREATE (JohnH:Person {name:'John Hurt', born:1940})
	CREATE (BenM:Person {name: 'Ben Miles', born:1967})
	CREATE
	  (Hugo)-[:ACTED_IN {roles:['V']}]->(VforVendetta),
	  (NatalieP)-[:ACTED_IN {roles:['Evey Hammond']}]->(VforVendetta),
	  (StephenR)-[:ACTED_IN {roles:['Eric Finch']}]->(VforVendetta),
	  (JohnH)-[:ACTED_IN {roles:['High Chancellor Adam Sutler']}]->(VforVendetta),
	  (BenM)-[:ACTED_IN {roles:['Dascomb']}]->(VforVendetta),
	  (JamesM)-[:DIRECTED]->(VforVendetta),
	  (LillyW)-[:PRODUCED]->(VforVendetta),
	  (LanaW)-[:PRODUCED]->(VforVendetta),
	  (JoelS)-[:PRODUCED]->(VforVendetta),
	  (LillyW)-[:WROTE]->(VforVendetta),
	  (LanaW)-[:WROTE]->(VforVendetta)

	CREATE (SpeedRacer:Movie {title:'Speed Racer', released:2008, tagline:'Speed has no limits'})
	CREATE (EmileH:Person {name:'Emile Hirsch', born:1985})
	CREATE (JohnG:Person {name:'John Goodman', born:1960})
	CREATE (SusanS:Person {name:'Susan Sarandon', born:1946})
	CREATE (MatthewF:Person {name:'Matthew Fox', born:1966})
	CREATE (ChristinaR:Person {name:'Christina Ricci', born:1980})
	CREATE (Rain:Person {name:'Rain', born:1982})
	CREATE
	  (EmileH)-[:ACTED_IN {roles:['Speed Racer']}]->(SpeedRacer),
	  (JohnG)-[:ACTED_IN {roles:['Pops']}]->(SpeedRacer),
	  (SusanS)-[:ACTED_IN {roles:['Mom']}]->(SpeedRacer),
	  (MatthewF)-[:ACTED_IN {roles:['Racer X']}]->(SpeedRacer),
	  (ChristinaR)-[:ACTED_IN {roles:['Trixie']}]->(SpeedRacer),
	  (Rain)-[:ACTED_IN {roles:['Taejo Togokahn']}]->(SpeedRacer),
	  (BenM)-[:ACTED_IN {roles:['Cass Jones']}]->(SpeedRacer),
	  (LillyW)-[:DIRECTED]->(SpeedRacer),
	  (LanaW)-[:DIRECTED]->(SpeedRacer),
	  (LillyW)-[:WROTE]->(SpeedRacer),
	  (LanaW)-[:WROTE]->(SpeedRacer),
	  (JoelS)-[:PRODUCED]->(SpeedRacer)

	CREATE (NinjaAssassin:Movie {title:'Ninja Assassin', released:2009, tagline:'Prepare to enter a secret world of assassins'})
	CREATE (NaomieH:Person {name:'Naomie Harris'})
	CREATE
	  (Rain)-[:ACTED_IN {roles:['Raizo']}]->(NinjaAssassin),
	  (NaomieH)-[:ACTED_IN {roles:['Mika Coretti']}]->(NinjaAssassin),
	  (RickY)-[:ACTED_IN {roles:['Takeshi']}]->(NinjaAssassin),
	  (BenM)-[:ACTED_IN {roles:['Ryan Maslow']}]->(NinjaAssassin),
	  (JamesM)-[:DIRECTED]->(NinjaAssassin),
	  (LillyW)-[:PRODUCED]->(NinjaAssassin),
	  (LanaW)-[:PRODUCED]->(NinjaAssassin),
	  (JoelS)-[:PRODUCED]->(NinjaAssassin)

	CREATE (TheGreenMile:Movie {title:'The Green Mile', released:1999, tagline:"Walk a mile you'll never forget."})
	CREATE (MichaelD:Person {name:'Michael Clarke Duncan', born:1957})
	CREATE (DavidM:Person {name:'David Morse', born:1953})
	CREATE (SamR:Person {name:'Sam Rockwell', born:1968})
	CREATE (GaryS:Person {name:'Gary Sinise', born:1955})
	CREATE (PatriciaC:Person {name:'Patricia Clarkson', born:1959})
	CREATE (FrankD:Person {name:'Frank Darabont', born:1959})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Paul Edgecomb']}]->(TheGreenMile),
	  (MichaelD)-[:ACTED_IN {roles:['John Coffey']}]->(TheGreenMile),
	  (DavidM)-[:ACTED_IN {roles:['Brutus "Brutal" Howell']}]->(TheGreenMile),
	  (BonnieH)-[:ACTED_IN {roles:['Jan Edgecomb']}]->(TheGreenMile),
	  (JamesC)-[:ACTED_IN {roles:['Warden Hal Moores']}]->(TheGreenMile),
	  (SamR)-[:ACTED_IN {roles:['"Wild Bill" Wharton']}]->(TheGreenMile),
	  (GaryS)-[:ACTED_IN {roles:['Burt Hammersmith']}]->(TheGreenMile),
	  (PatriciaC)-[:ACTED_IN {roles:['Melinda Moores']}]->(TheGreenMile),
	  (FrankD)-[:DIRECTED]->(TheGreenMile)

	CREATE (FrostNixon:Movie {title:'Frost/Nixon', released:2008, tagline:'400 million people were waiting for the truth.'})
	CREATE (FrankL:Person {name:'Frank Langella', born:1938})
	CREATE (MichaelS:Person {name:'Michael Sheen', born:1969})
	CREATE (OliverP:Person {name:'Oliver Platt', born:1960})
	CREATE
	  (FrankL)-[:ACTED_IN {roles:['Richard Nixon']}]->(FrostNixon),
	  (MichaelS)-[:ACTED_IN {roles:['David Frost']}]->(FrostNixon),
	  (KevinB)-[:ACTED_IN {roles:['Jack Brennan']}]->(FrostNixon),
	  (OliverP)-[:ACTED_IN {roles:['Bob Zelnick']}]->(FrostNixon),
	  (SamR)-[:ACTED_IN {roles:['James Reston, Jr.']}]->(FrostNixon),
	  (RonH)-[:DIRECTED]->(FrostNixon)

	CREATE (Hoffa:Movie {title:'Hoffa', released:1992, tagline:"He didn't want law. He wanted justice."})
	CREATE (DannyD:Person {name:'Danny DeVito', born:1944})
	CREATE (JohnR:Person {name:'John C. Reilly', born:1965})
	CREATE
	  (JackN)-[:ACTED_IN {roles:['Hoffa']}]->(Hoffa),
	  (DannyD)-[:ACTED_IN {roles:['Robert "Bobby" Ciaro']}]->(Hoffa),
	  (JTW)-[:ACTED_IN {roles:['Frank Fitzsimmons']}]->(Hoffa),
	  (JohnR)-[:ACTED_IN {roles:['Peter "Pete" Connelly']}]->(Hoffa),
	  (DannyD)-[:DIRECTED]->(Hoffa)

	CREATE (Apollo13:Movie {title:'Apollo 13', released:1995, tagline:'Houston, we have a problem.'})
	CREATE (EdH:Person {name:'Ed Harris', born:1950})
	CREATE (BillPax:Person {name:'Bill Paxton', born:1955})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Jim Lovell']}]->(Apollo13),
	  (KevinB)-[:ACTED_IN {roles:['Jack Swigert']}]->(Apollo13),
	  (EdH)-[:ACTED_IN {roles:['Gene Kranz']}]->(Apollo13),
	  (BillPax)-[:ACTED_IN {roles:['Fred Haise']}]->(Apollo13),
	  (GaryS)-[:ACTED_IN {roles:['Ken Mattingly']}]->(Apollo13),
	  (RonH)-[:DIRECTED]->(Apollo13)

	CREATE (Twister:Movie {title:'Twister', released:1996, tagline:"Don't Breathe. Don't Look Back."})
	CREATE (PhilipH:Person {name:'Philip Seymour Hoffman', born:1967})
	CREATE (JanB:Person {name:'Jan de Bont', born:1943})
	CREATE
	  (BillPax)-[:ACTED_IN {roles:['Bill Harding']}]->(Twister),
	  (HelenH)-[:ACTED_IN {roles:['Dr. Jo Harding']}]->(Twister),
	  (ZachG)-[:ACTED_IN {roles:['Eddie']}]->(Twister),
	  (PhilipH)-[:ACTED_IN {roles:['Dustin "Dusty" Davis']}]->(Twister),
	  (JanB)-[:DIRECTED]->(Twister)

	CREATE (CastAway:Movie {title:'Cast Away', released:2000, tagline:'At the edge of the world, his journey begins.'})
	CREATE (RobertZ:Person {name:'Robert Zemeckis', born:1951})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Chuck Noland']}]->(CastAway),
	  (HelenH)-[:ACTED_IN {roles:['Kelly Frears']}]->(CastAway),
	  (RobertZ)-[:DIRECTED]->(CastAway)

	CREATE (OneFlewOvertheCuckoosNest:Movie {title:"One Flew Over the Cuckoo's Nest", released:1975, tagline:"If he's crazy, what does that make you?"})
	CREATE (MilosF:Person {name:'Milos Forman', born:1932})
	CREATE
	  (JackN)-[:ACTED_IN {roles:['Randle McMurphy']}]->(OneFlewOvertheCuckoosNest),
	  (DannyD)-[:ACTED_IN {roles:['Martini']}]->(OneFlewOvertheCuckoosNest),
	  (MilosF)-[:DIRECTED]->(OneFlewOvertheCuckoosNest)

	CREATE (SomethingsGottaGive:Movie {title:"Something's Gotta Give", released:2003})
	CREATE (DianeK:Person {name:'Diane Keaton', born:1946})
	CREATE (NancyM:Person {name:'Nancy Meyers', born:1949})
	CREATE
	  (JackN)-[:ACTED_IN {roles:['Harry Sanborn']}]->(SomethingsGottaGive),
	  (DianeK)-[:ACTED_IN {roles:['Erica Barry']}]->(SomethingsGottaGive),
	  (Keanu)-[:ACTED_IN {roles:['Julian Mercer']}]->(SomethingsGottaGive),
	  (NancyM)-[:DIRECTED]->(SomethingsGottaGive),
	  (NancyM)-[:PRODUCED]->(SomethingsGottaGive),
	  (NancyM)-[:WROTE]->(SomethingsGottaGive)

	CREATE (BicentennialMan:Movie {title:'Bicentennial Man', released:1999, tagline:"One robot's 200 year journey to become an ordinary man."})
	CREATE (ChrisC:Person {name:'Chris Columbus', born:1958})
	CREATE
	  (Robin)-[:ACTED_IN {roles:['Andrew Marin']}]->(BicentennialMan),
	  (OliverP)-[:ACTED_IN {roles:['Rupert Burns']}]->(BicentennialMan),
	  (ChrisC)-[:DIRECTED]->(BicentennialMan)

	CREATE (CharlieWilsonsWar:Movie {title:"Charlie Wilson's War", released:2007, tagline:"A stiff drink. A little mascara. A lot of nerve. Who said they couldn't bring down the Soviet empire."})
	CREATE (JuliaR:Person {name:'Julia Roberts', born:1967})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Rep. Charlie Wilson']}]->(CharlieWilsonsWar),
	  (JuliaR)-[:ACTED_IN {roles:['Joanne Herring']}]->(CharlieWilsonsWar),
	  (PhilipH)-[:ACTED_IN {roles:['Gust Avrakotos']}]->(CharlieWilsonsWar),
	  (MikeN)-[:DIRECTED]->(CharlieWilsonsWar)

	CREATE (ThePolarExpress:Movie {title:'The Polar Express', released:2004, tagline:'This Holiday Season… Believe'})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Hero Boy', 'Father', 'Conductor', 'Hobo', 'Scrooge', 'Santa Claus']}]->(ThePolarExpress),
	  (RobertZ)-[:DIRECTED]->(ThePolarExpress)

	CREATE (ALeagueofTheirOwn:Movie {title:'A League of Their Own', released:1992, tagline:'Once in a lifetime you get a chance to do something different.'})
	CREATE (Madonna:Person {name:'Madonna', born:1954})
	CREATE (GeenaD:Person {name:'Geena Davis', born:1956})
	CREATE (LoriP:Person {name:'Lori Petty', born:1963})
	CREATE (PennyM:Person {name:'Penny Marshall', born:1943})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Jimmy Dugan']}]->(ALeagueofTheirOwn),
	  (GeenaD)-[:ACTED_IN {roles:['Dottie Hinson']}]->(ALeagueofTheirOwn),
	  (LoriP)-[:ACTED_IN {roles:['Kit Keller']}]->(ALeagueofTheirOwn),
	  (RosieO)-[:ACTED_IN {roles:['Doris Murphy']}]->(ALeagueofTheirOwn),
	  (Madonna)-[:ACTED_IN {roles:['"All the Way" Mae Mordabito']}]->(ALeagueofTheirOwn),
	  (BillPax)-[:ACTED_IN {roles:['Bob Hinson']}]->(ALeagueofTheirOwn),
	  (PennyM)-[:DIRECTED]->(ALeagueofTheirOwn)

	CREATE (PaulBlythe:Person {name:'Paul Blythe'})
	CREATE (AngelaScope:Person {name:'Angela Scope'})
	CREATE (JessicaThompson:Person {name:'Jessica Thompson'})
	CREATE (JamesThompson:Person {name:'James Thompson'})

	CREATE
	  (JamesThompson)-[:FOLLOWS]->(JessicaThompson),
	  (AngelaScope)-[:FOLLOWS]->(JessicaThompson),
	  (PaulBlythe)-[:FOLLOWS]->(AngelaScope)

	CREATE
	  (JessicaThompson)-[:REVIEWED {summary:'An amazing journey', rating:95}]->(CloudAtlas),
	  (JessicaThompson)-[:REVIEWED {summary:'Silly, but fun', rating:65}]->(TheReplacements),
	  (JamesThompson)-[:REVIEWED {summary:'The coolest football movie ever', rating:100}]->(TheReplacements),
	  (AngelaScope)-[:REVIEWED {summary:'Pretty funny at times', rating:62}]->(TheReplacements),
	  (JessicaThompson)-[:REVIEWED {summary:'Dark, but compelling', rating:85}]->(Unforgiven),
	  (JessicaThompson)-[:REVIEWED {summary:"Slapstick redeemed only by the Robin Williams and Gene Hackman's stellar performances", rating:45}]->(TheBirdcage),
	  (JessicaThompson)-[:REVIEWED {summary:'A solid romp', rating:68}]->(TheDaVinciCode),
	  (JamesThompson)-[:REVIEWED {summary:'Fun, but a little far fetched', rating:65}]->(TheDaVinciCode),
	  (JessicaThompson)-[:REVIEWED {summary:'You had me at Jerry', rating:92}]->(JerryMaguire)

	WITH TomH as a
	MATCH (a)-[:ACTED_IN]->(m)<-[:DIRECTED]-(d) RETURN a,m,d LIMIT 10
	;
			}
			
			public void CustomDBBoilerPlate()
			{
					
				public Queries(){
			
	//(Keanu)-[:ACTED_IN {roles:['Neo']}]->(TheMatrix),

	//create vertexes
	create (v_name1:v_typea{prop1:'v_name1', propn:'v_prop1n'})
	create (v_name2:v_typeb{prop1:'v_name2', propn:'v_prop2n'})

	//edge create: OK
	create
	(v_name2)-[:rel_to{e_name:'1->2'}]->(v_name1),
	(v_name2)-[:rel_to2{e_name:'1->2 2'}]->(v_name1)

	//edge create: OK
	match(a:v_typea),(b:v_typeb)
	where a.prop1 = 'v_name1' and b.prop1 = 'v_name2'
	create (a)-[r:e_type {e_name: a.prop1 + '-->' + b.prop1 }]->(b)
	return r


	//select
	match(a:v_typea {prop1: 'v_name1'})-[:e_type]->(b) return a,b

	//select with relation
	match(a:v_typea),(b:v_typeb)
	where a.prop1 = 'v_name1' and b.prop1 = 'v_name2'
	return a,b

	//
	match (a:v_typea)
	match (b:v_typeb)
	return a,b

	//bulk delete vertex
	match (a:v_typea) 
	match (b:v_typeb)
	detach delete  a,b




	//3n 2e one line
	v1-[e]->v2<-[e]-v3
	v4-[e]->v5<-[e]-v6
	
	v2-[e]->v5
	v2-[e2]->v5
	v5-[e3]->v2
	
	match(a:v_typea),(b:v_typeb) detach delete a,b

	v1-[e]->v2<-[e]-v3
	v4-[e]->v5<-[e]-v6
	
	create (v_name1:v_typeb{prop1:'v_name1', propn:'v_prop1n'})-
	[n1:e_type{e_name:'v_name1' + '-->' + 'v_name2'}]->
	(v_name2:v_typea{prop1:'v_name2', propn:'v_prop2n'})
	<-[n2:e_type{e_name:'v_name3' + '-->' + 'v_name2'}]
	-(v_name3:v_typeb{prop1:'v_name3', propn:'v_prop3n'})
	
	create (v_name4:v_typeb{prop1:'v_name4', propn:'v_prop4n'})-
	[n3:e_type{e_name:'v_name4' + '-->' + 'v_name5'}]->
	(v_name5:v_typea{prop1:'v_name5', propn:'v_prop5n'})
	<-[n4:e_type{e_name:'v_name6' + '-->' + 'v_name5'}]
	-(v_name6:v_typeb{prop1:'v_name6', propn:'v_prop6n'})

	//(Keanu)-[:ACTED_IN {roles:['Neo']}]->(TheMatrix)

	//realtions at initial creation
	v2-[e]->v5
	v2-[e2]->v5
	v5-[e3]->v2
	
	create 
	(v_name2)-[n5:e_type{e_name:'v2->v5'}]->(v_name5),
	(v_name2)-[n6:e_type2{e_name:'v2->v5 type 2'}]->(v_name5),
	(v_name5)-[n7:e_type3{e_name:'v5->v2'}]->(v_name2)

	//realtions after initial creation
	v2-[e1]->v5
	v2-[e1]->v5
	v2-[e3]->v5
	v2-[e]->v5
	v4-[eN]->v3
	
	match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (a)-[:e_type1]->(b)
	match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (a)-[:e_type2{name:'a->b'}]->(b)
	match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (b)-[:e_type3{name:'b->a'}]->(a)
	match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (b)-[:e_type{name:'b->a'}]->(a)
	match(b:v_typeb{prop1:'v_name4'}),(a:v_typeb{prop1:'v_name3'}) merge (a)-[:NEW_REL]->(b)

	//selections
	match(a:v_typeb)-[:e_type]->(b:v_typea) return a,b
	match(a:v_typeb)-[:e_type]->(b) return a,b
	match(a:v_typeb)-[relatedto]->(b) return a,b

	match(a:v_typea)-[:e_type]->(b:v_typea) return a,b

	match(a:v_typea),(b:v_typeb) return a,b
	match(a:v_typea),(b:v_typeb) detach delete a,b

				}
				
				public API(){
					
					
POST http://localhost:7474/db/data/transaction/commit
User-Agent: Fiddler
Connection: keep-alive
Authorization: Basic bmVvNGo6cm9vdA==
Accept: application/json; charset=UTF-8
Content-Type: application/json
Host: localhost:7474
Content-Length: 114

RAW JSON
<<<<<<<<<<<<<<

{
  "statements" : [ {
    "statement" : "CREATE (n) RETURN id(n)"
  } ]
}

<<<<<<<<<<<<<<

{
  "statements" : [
  {"statement" : "create (v_name1:v_typea{prop1:'v_name1', propn:'v_prop1n'})"}
  ,{"statement" : "create (v_name2:v_typeb{prop1:'v_name2', propn:'v_prop2n'})"}
  ,{"statement" : "match(a:v_typea),(b:v_typeb) where a.prop1 = 'v_name1' and b.prop1 = 'v_name2' create (a)-[r:e_type {e_name: a.prop1 + '-->' + b.prop1 }]->(b)"}
  ,{"statement" : "match (a:v_typea) match (b:v_typeb)detach delete  a,b"}
  ]
}

<<<<<<<<<<<<<<

{
"statements" : [
{"statement" : "create (v_name1:v_typeb{prop1:'v_name1', propn:'v_prop1n'})-[n1:e_type{e_name:'v_name1' + '-->' + 'v_name2'}]->(v_name2:v_typea{prop1:'v_name2', propn:'v_prop2n'})<-[n2:e_type{e_name:'v_name3' + '-->' + 'v_name2'}]	-(v_name3:v_typeb{prop1:'v_name3', propn:'v_prop3n'})"}
,{"statement" : "create (v_name4:v_typeb{prop1:'v_name4', propn:'v_prop4n'})-[n3:e_type{e_name:'v_name4' + '-->' + 'v_name5'}]->(v_name5:v_typea{prop1:'v_name5', propn:'v_prop5n'})<-[n4:e_type{e_name:'v_name6' + '-->' + 'v_name5'}]	-(v_name6:v_typeb{prop1:'v_name6', propn:'v_prop6n'})"}
]
}

<<<<<<<<<<<<<<

{
"statements" : [
{"statement" : "create (v_name1:v_typeb{prop1:'v_name1', propn:'v_prop1n'})-[n1:e_type{e_name:'v_name1' + '-->' + 'v_name2'}]->(v_name2:v_typea{prop1:'v_name2', propn:'v_prop2n'})<-[n2:e_type{e_name:'v_name3' + '-->' + 'v_name2'}]-(v_name3:v_typeb{prop1:'v_name3', propn:'v_prop3n'})"},{"statement" : "create (v_name4:v_typeb{prop1:'v_name4', propn:'v_prop4n'})-[n3:e_type{e_name:'v_name4' + '-->' + 'v_name5'}]->(v_name5:v_typea{prop1:'v_name5', propn:'v_prop5n'})<-[n4:e_type{e_name:'v_name6' + '-->' + 'v_name5'}]-(v_name6:v_typeb{prop1:'v_name6', propn:'v_prop6n'})"},{"statement" : "match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (a)-[:e_type2{name:'a->b'}]->(b)"},{"statement" : "match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (b)-[:e_type3{name:'b->a'}]->(a)"},{"statement" : "match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (b)-[:e_type{name:'b->a'}]->(a)"},{"statement" : "match(b:v_typeb{prop1:'v_name4'}),(a:v_typeb{prop1:'v_name3'}) merge (a)-[:NEW_REL]->(b)"}
]
}


				}
			
		}

		}
    
		public void MongoDb()
		{
		  Maintenance:[
			//install
			https://docs.mongodb.com/getting-started/shell/tutorial/install-mongodb-on-windows/
			//initial start with custom data path
			"C:\Program Files\MongoDB\Server\3.6\bin\mongod.exe" --dbpath d:\test\mongodb\data
			
			]
			,BoilerPlate[
			  //insert doucment
			  use test
			  db.users.insertOne({name:"sue",age:26,_id=1})
			  //from CMD command shell, cd to server files folder
			  mongoimport --db test --collection restaurants --drop --file G:\disk\Progs\MongoDB\import/primer-dataset.json
			  //select from
			  db.restaurants.find( {} )
			  //where
			  db.restaurants.find({"address.building": "10807"})
			  db.restaurants.find({"address.zipcode": "11694"})
			  //and
			  db.restaurants.find({"address.street": "Roosevelt Ave","address.zipcode": "11354"})          
			  //or
			  db.restaurants.find( { $or:[ {"address.street": "Roosevelt Ave"},{"address.zipcode": "11354"}]}) 
			  //sort
			  db.restaurants.find().sort( { "address.zipcode": 1 } )
			  //where sort
			  db.restaurants.find( { $or:[ {"address.street": "Roosevelt Ave"},{"address.zipcode": "11354"}]}).sort( { "address.zipcode": 1 } )
			  //where in
			  db.restaurants.find({"address.building": {$in:["10807","23059"]}})
			   
			  //greater then
			  db.restaurants.find( { "address.zipcode": { $gt: 11694 } } )        
			  db.inventory.find( { status: "A", qty: { $lt: 30 } } )
			  //in
			  db.inventory.find( { status: { $in: [ "A", "D" ] } } )
			  db.inventory.find( {status: "A", $or: [ { qty: { $lt: 30 } }, { item: /^p/ } ]} )
			  SELECT * FROM inventory WHERE status = "A" AND ( qty < 30 OR item LIKE "p%")
			  
			]
		}
		
	}
		
	#endregion
	
 	#region Editors
	
	Atom{
		
		Rebuild Angular Io project <- ctrl + s on filebrowser not in file			
		Refactor <- ctrl + d;
		
	}
		
	#endregion	
			
	#region OS		
		
		public Windows
		{
			public CMD
			{
				
				public void AsAdmin(){
				//add current user as admin
				runas /user:????????????? "net localgroup "??????????????" "neprintsevia" /ADD"
			
				}
				
				public void NetFolderFilesDelete()
				{
					pushd "\\Osrp\files\SHARE\Scripts\arh\Export\PREVIOUS_CNT\aa" 
					del /F /Q *.*
					popd
					pushd "\\Osrp\files\SHARE\Scripts\arh\Export\PREVIOUS_CNT" 
					del /F /Q  *.*
					popd
				}
				
				public void Power()
				{
					
					//shutdown
					SHUTDOWN -s -t 60
					//stop
					SHUTDOWN -a 
					
					powercfg -lastwake
					powercfg -devicequery wake_armed
					powercfg -devicedisablewake
					
					powercfg -devicedisablewake "HID Keyboard Device (001)"
					powercfg -devicedisablewake "Контроллер семейства Realtek PCIe GBE"
					powercfg -devicedisablewake "Realtek RTL8139/810x Family Fast Ethernet сетевой адаптер"
				}
				
				public void Unsorted()
				{
					
					netsat -> ips with ports
					netsh [http] [add,delete] [iplisten] -> bind http listener
					
				}
				
				public void PS()			
				{
					
					//powershell tools
					https://marketplace.visualstudio.com/items?itemName=TFSPowerToolsTeam.MicrosoftVisualStudioTeamFoundationServer2013Power
					
					C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell
					//ps64
					C:\Windows\System32\WindowsPowerShell\v1.0\powershell
					//ps 32
					
				}
				
			}
			
			public void Execute()
			{
				mstsc -> ??????????? ? ?????????? ???????? ?????
				cmd -> ???????
			}
			
			public void PS()			
			{
				
				//powershell tools
				https://marketplace.visualstudio.com/items?itemName=TFSPowerToolsTeam.MicrosoftVisualStudioTeamFoundationServer2013Power
				
				C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell
				//ps64
				C:\Windows\System32\WindowsPowerShell\v1.0\powershell
				//ps 32
				
			}
		}
		
		public UNIX
		{
			public Ubuntu
			{
				public HotKeys
				{
					
					public OS
					{
						super (hold) - help
						ctrl + alt + T - terminal
						ctrl + L -> nautilus path browser
					}
					
					public Terminal 
					{
						TAB - auto complete
						shift + ins (ctrl + shift + V ) - ctrl + V
						ctrl + ins (ctrl + shift + C )- ctrl + C
						ctrl + LeftArr/RightArr -> moove between params
						ctrl + U -> delete line
							 + K -> delete line after kursor
							 + W -> delete line before kursor
							 + R -< search command history for words
					}
					
				}
				
				public TerminalCommands
				{
					systemctl suspend -> suspend
					sudo apt-get update && sudo apt-get upgrade
					sudo apt-get -f install
					sudo dpkg --purge --force-depends libpowerdevilcore0 libtaskmanager4b
					sudo apt-get -f install
					sudo apt-get install build-essential
					sudo apt-get autoclean && sudo apt-get clear cache
					gksu nautilus /etc --open in browser
					sudo nano /etc/apt/sources.list -> 
						edit text				
					
					http://help.ubuntu.ru/wiki/%D0%B3%D0%BE%D1%80%D1%8F%D1%87%D0%B8%D0%B5_%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D1%88%D0%B8_%D0%B2_unity
					http://help.ubuntu.ru/manual/%D1%82%D0%B5%D1%80%D0%BC%D0%B8%D0%BD%D0%B0%D0%BB
					http://forum.ubuntu.ru/index.php?topic=14535.15
					
					lsb_release -a - current build version
					(alt + F2) gksu software-properties-gtk -> show ubuntu update center
					sudo rm -r -f /path -> force remove recursive
					sudo cd /path -> goto folder
						cd .. -> up 1 lvl
					sudo mkdir /path -> create directory
						-p /path -> create directory recursive
					sudo ls -> display content-map
						-a -> with hidden
					sudo systemctl restart network-manager -> restarn netweork				
					sudo ufw enable/disablemail- ????????? ? ?????????? ??????????? ??????
					sudo poweroff/reboot -> poweroff/reboot
					dpkg --get-selections -> installed pkgs
					dpkg --get-selections | grep -v deinstall > ~/Desktop/packages -> save to file				
						-L packageNmae -> find installed pakceg pathes
					mv /folder /folder -> rename folder
					command !& -> run command with previous typed parameter
					^command1^command2 -> run command2 with previous command1 params
					readlink -f foo.bar -> find path to file
					
				}
			
				public Troubleshooting
				{
					//No _apt sandbox user
					https://askubuntu.com/questions/810202/what-is-the-sandbox-user-apt-on-my-system
					adduser --force-badname --system --home /nonexistent  \
					--no-create-home --quiet _apt || true
					
					//Windows 7 don't have a permission to brows Ubuntu Fileshare
					uncomment browseable = yes in etc/samba/smb.conf
					https://askubuntu.com/questions/569333/windows-7-8-1-ubuntu-14-folder-sharing
				}
			
				public Pakets
				{
					public Samba
					{
						
https://help.ubuntu.com/community/How%20to%20Create%20a%20Network%20Share%20Via%20Samba%20Via%20CLI%20(Command-line%20interface/Linux%20Terminal)%20-%20Uncomplicated,%20Simple%20and%20Brief%20Way!
sudo apt-get update
sudo apt-get install samba
sudo smbpasswd -a <user_name>.
mkdir /home/<user_name>/<folder_name>
sudo cp /etc/samba/smb.conf ~
sudo nano /etc/samba/smb.conf

Once "smb.conf" has loaded, add this to the very end of the file:

[<folder_name>]
path = /home/<user_name>/<folder_name>
valid users = <user_name>
read only = no

sudo service smbd restart

//in windows file explorere
\\192.168.0.103\sharefolder

					}
					
					public Mercurial
					{
						sudo add-apt-repository universse
						sudo apt-get install mercurial
						sudo apt-get install mercurial meld
						
						hg -> main call
						hg version -> check installation
							init -> initialize in current directory
							clone path -> make copy of path in current directory
							clone path path ->
							
					}
					
					public Glances (resource monitor)
					{
						sudo apt-get install python-pip build-essential python-dev lm-sensors
						sudo pip install psutil logutils bottle batinfo https://bitbucket.org/gleb_zhulik/py3sensors/get/tip.tar.gz zeroconf netifaces pymdstat influxdb elasticsearch potsdb statsd pystache docker-py pysnmp pika py-cpuinfo bernhard
						sudo pip install glances
					}
				
				}
			}
			
		}
	
	#endregion
	
