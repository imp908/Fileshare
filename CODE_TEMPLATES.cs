///Hierarhy
namespace Parts{
	
	#region Names
	public Groups
	{
		public Technics
		{
			public Methods
			{
				
			}
		}
	}
	#endregion
	
}


	//Usefull links
	public void mostUsefullLinks()
	{
	
	//Books
	//The Art of Unit Testing: with Examples in .NET
	https://www.amazon.com/dp/1933988274/?tag=stackoverfl08-20
	//JS
	https://eloquentjavascript.net/index.html										  
	
	//SERIAL PROGRAMMING 	
	//RS-232
	http://cisco.opennet.ru/docs/RUS/serial_guide/index.html#2_2
	
	//Framework Design Guidelines
	https://www.amazon.co.uk/Framework-Design-Guidelines-Conventions-Development/dp/0321545613/		
		
	
	//TOPTAL
	https://www.toptal.com/developers/blog
	//Boilerplate code gen
	http://doc.postsharp.net/
	
	//dev guide
	https://msdn.microsoft.com/en-us/library/hh156542(v=vs.110).aspx

	//Applications essential
	https://msdn.microsoft.com/en-us/library/ms172157(v=vs.110).aspx

	//simple List<t> class
	https://msdn.microsoft.com/en-us/library/6sh2ey19(v=vs.110).aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-2


	//LINQ to DataSet
	http://blogs.msdn.com/b/adonet/archive/2007/01/26/querying-datasets-introduction-to-linq-to-dataset.aspx

	//correct d3 charts addition
	//<script type="application/javascript" charset="utf-8" src="http://d3js.org/d3.v3.js"></script>

	//charts from excel to poweerpoint copy
	https://social.msdn.microsoft.com/Forums/ru-RU/b00e1da3-908d-4ae1-8c68-2ea5108d1cd0/-excel-powerpoint-vba?forum=programminglanguageru

	//codplex library addres for excel files read
	http://exceldatareader.codeplex.com/

	//never use TWO DOTS
	http://www.thecodingforums.com/threads/asp-net-cant-kill-excel-exe-with-office-pia.123703/#post-528575

	//newtonsoft JSON serializer
	http://www.newtonsoft.com/json/help/html/serializingjson.htm

	//ASP.NET Web Deployment - Recommended Resources
	http://www.asp.net/whitepapers/aspnet-web-deployment-content-map

	//Advanced Entity Framework 6 Scenarios for an MVC 5 + usefull links
	http://www.asp.net/mvc/overview/getting-started/getting-started-with-ef-using-mvc/advanced-entity-framework-scenarios-for-an-mvc-web-application#rawsql

	//ASP.NET Data Access - Recommended Resources
	http://www.asp.net/whitepapers/aspnet-data-access-content-map

	//ASP.NET Data Access Options
	https://msdn.microsoft.com/en-us/library/ms178359.aspx#webservice

	//scafolding
	https://blogs.msdn.microsoft.com/webdev/2014/04/03/creating-a-custom-scaffolder-for-visual-studio/

	//Data Source Web Server Controls
	https://msdn.microsoft.com/en-us/library/ms247258.aspx

	//James chamber 30 days ov MVC
	http://jameschambers.com/2014/07/day-27-rendering-data-in-a-bootstrap-table/

	//Post javascrip to mvc action
	http://vault.lozanotek.com/archive/2010/04/16/posting_json_data_to_mvc_controllers.aspx

	///{LINQ}
	//Create dynamic "Select", "SelectMany" and "GroupBy" clauses
	http://drc.ideablade.com/xwiki/bin/view/Documentation/dynamic-projection

	//Programming Entity Framework, 2nd Edition
	https://www.safaribooksonline.com/library/view/programming-entity-framework/9780596807276/ch04.html

	//Dynamic LINQ Queries with Expression Trees
	https://www.simple-talk.com/dotnet/net-framework/dynamic-linq-queries-with-expression-trees/

	//Calling functions in LINQ queries
	http://tomasp.net/blog/linq-expand.aspx/

	//sql commands types
	https://msdn.microsoft.com/en-us/library/yy6y35y8(v=vs.110).aspx

	//HTML5 plupload
	http://www.plupload.com/

	//How to add Dynamic Behavior to Data-Bound Controls
	https://msdn.microsoft.com/en-us/library/cc488562.aspx

	//WebForms
	https://msdn.microsoft.com/en-us/library/jj822927(v=vs.110).aspx

	//ASP.NET Dynamic Data
	https://msdn.microsoft.com/en-us/library/ee845452.aspx

	//LINQ chaining
	https://blogs.msdn.microsoft.com/meek/2008/05/02/linq-to-entities-combining-predicates/
	
	//Sample plugin
	https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b6174b62
	
	
	
	//BLOGS
	//Jon Skeet's
	https://codeblog.jonskeet.uk/
	//CoddingHorror
	https://blog.codinghorror.com/
	
	
	
	//CONTINUOUS INTEGRATION
	http://www.eugeneduvenage.com/2011/11/continuous-integration-basics-part-1/
	
	
	
	//KATAs
	http://osherove.com/tdd-kata-1/
	https://github.com/garora/TDD-Katas/blob/develop/Src/cs/FizzBuzzKata/TestFizzBuzz.cs
	https://www.codeproject.com/Articles/886492/Learning-Test-Driven-Development-with-TDD-Katas
	
	
	
	//BUILD STRATEGIES
	//The Cathedral and the Bazaar
	https://en.wikipedia.org/wiki/The_Cathedral_and_the_Bazaar



	//NuGets
	//Lucene
	https://www.nuget.org/packages/Lucene.Net/4.8.0-beta00004
	//pagelist
	https://www.nuget.org/packages/PagedList
	//Reactive Extensions for JavaScript
	https://www.nuget.org/packages/RxJS-Main/1.0.10621



	//Security
	http://www.adambarth.com/papers/2008/barth-jackson-mitchell-b.pdf
	//MVC forms authentication providerName
	https://habrahabr.ru/post/176043/
	//Cookies
	https://www.nczonline.net/blog/2009/05/05/http-cookies-explained/
	//Custom antiforgery token
	http://prideparrot.com/blog/archive/2012/7/securing_all_forms_using_antiforgerytoken
	//App Security threats
	https://msdn.microsoft.com/en-us/library/f13d73y6.aspx
	//Your Password is Too Damn Short
	https://blog.codinghorror.com/your-password-is-too-damn-short/
	
	
	
	//MVC
	//Minimal folders and configs
	https://stackoverflow.com/questions/19949709/use-of-authconfig-bundleconfig-filterconfig-routeconfig-and-webapiconfig-in
	
	
	
	//WCF distributed
	https://chsakell.com/2013/04/17/distributed-transactions-in-wcf-services-part-1/
	//WCF sample
	https://www.codeproject.com/Articles/571813/A-Beginners-Tutorial-on-Creating-WCF-REST-Services
	//WCF with entity
	https://www.codeproject.com/Articles/127395/Implementing-a-WCF-Service-with-Entity-Framework
	//WCF generate contracts from POCO
	https://www.codeproject.com/Articles/1081015/Autogenerate-DataContracts-for-WCF-from-POCO-Class
	//WCF transactions
	https://www.codeproject.com/Articles/1160537/WCF-Windows-Communication-Foundation-Transaction-S
	//WCF vs aspx service
	http://www.csharptutorial.in/33/csharp-net-difference-between-webservice-and-wcf-service
	//WCF tutorials
	http://www.csharptutorial.in/wcf-tutorials
	//WCF host as a service
	https://docs.microsoft.com/en-us/dotnet/framework/wcf/how-to-host-and-run-a-basic-wcf-service
	https://docs.microsoft.com/en-us/dotnet/framework/wcf/getting-started-tutorial
	//WCF + Entity
	https://www.codeproject.com/Articles/127395/Implementing-a-WCF-Service-with-Entity-Framework
	//WCF IoC
	https://chsakell.com/2015/07/04/dependency-injection-in-wcf/
	
	
	
	//SOAP REST diff
	http://www.csharptutorial.in/296/wcf-tutorials-soap-vs-rest-web-services-or-difference-between-soap-and-rest-web-services
	
	

	//WebApi
	//Using Postman to POST API JSON request in raw
	https://support.brightcove.com/use-postman-api-requests
	//WebApi controller
	https://docs.microsoft.com/en-us/aspnet/web-api/overview/getting-started-with-aspnet-web-api/tutorial-your-first-web-api
	https://docs.microsoft.com/en-us/aspnet/web-api/overview/testing-and-debugging/mocking-entity-framework-when-unit-testing-aspnet-web-api-2
	//WCF WebApi
	http://blogs.microsoft.co.il/idof/2012/03/05/wcf-or-aspnet-web-apis-my-two-cents-on-the-subject/
	//WEB api with packets
	https://habrahabr.ru/post/143024/
	


	//vNext
	https://blogs.msdn.microsoft.com/dotnet/2014/05/12/the-next-generation-of-net-asp-net-vnext/



	//EF
	//Data acces content map
	https://docs.microsoft.com/en-us/aspnet/whitepapers/aspnet-data-access-content-map
	//Code first to database
	https://msdn.microsoft.com/en-us/data/jj200620
	//EF bulk insert
	https://weblog.west-wind.com/posts/2013/Dec/22/Entity-Framework-and-slow-bulk-INSERTs#ContextBloatandLargeLists
	//Entity Framework initializer methods
	https://blog.oneunicorn.com/2013/05/28/database-initializer-and-migrations-seed-methods/
	// Code First Migrations with an existing database
	https://msdn.microsoft.com/en-us/data/dn579398



	//REPOSITORY
	//Generic Repository is BAD
	http://rob.conery.io/2014/03/04/repositories-and-unitofwork-are-not-a-good-idea/
	//generic Repository
	http://techbrij.com/generic-repository-unit-of-work-entity-framework-unit-testing-asp-net-mvc
	//Generic repository
	https://docs.microsoft.com/en-us/aspnet/mvc/overview/older-versions/getting-started-with-ef-5-using-mvc-4/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application
	//A trully generic repository
	http://cpratt.co/truly-generic-repository/
	//Repo done right
	http://blog.gauffin.org/2013/01/repository-pattern-done-right/
	//Repo proof of concept
	http://web.archive.org/web/20150404154203/https://www.remondo.net/repository-pattern-example-csharp/
	//Generic repo in simple 2014
	http://www.codeguru.com/csharp/.net/net_asp/mvc/using-the-repository-pattern-with-asp.net-mvc-and-entity-framework.htm
	//Repository overall
	http://techbrij.com/generic-repository-unit-of-work-entity-framework-unit-testing-asp-net-mvc	
	//Not Generic REPOSITORY
	https://softwareengineering.stackexchange.com/questions/180851/why-shouldnt-i-use-the-repository-pattern-with-entity-framework/220126#220126
	
	
	
	//TESTING
	//Test Automation most complete answer
	https://stackoverflow.com/questions/1316101/automated-unit-testing-why-what-which#1316209
	//Unit test
	https://msdn.microsoft.com/en-us/library/hh694602.aspx
	https://lostechies.com/derekgreer/2011/03/28/effective-tests-a-test-first-example-part-1/
	https://www.rhyous.com/2012/03/17/unit-test-best-practices-and-guidelines/
	//nUnit
	http://severe-programmer.com/manual/unit-testing-v-visual-studio-s-ispolzovaniem-nunit-i-nsubstitute-chast-1/
	https://github.com/nunit/docs/wiki/TestCaseData
	//Moq Setup
	https://professorweb.ru/my/ASP_NET/mvc/level2/2_5.php
	//MOQ
	https://metanit.com/sharp/mvc5/18.5.php
	https://github.com/Moq/moq4/wiki/Quickstart
	https://msdn.microsoft.com/en-us/library/dn314429(v=vs.113).aspx
	https://msdn.microsoft.com/en-us/library/dn314431(v=vs.113).aspx
	https://msdn.microsoft.com/en-us/library/ff650441.aspx
	http://www.developerhandbook.com/unit-testing/writing-unit-tests-with-nunit-and-moq/
	//EF integration testing
	https://stackoverflow.com/questions/22690877/how-are-people-unit-testing-with-entity-framework-6-should-you-bother/22691703#22691703
	//Integration
	http://enterprisecraftsmanship.com/2015/07/13/integration-testing-or-how-to-sleep-well-at-nights/
	//Mocking idea descr
	https://stackoverflow.com/questions/19674363/when-to-use-a-mocking-framework
	


	//MOQ
	//Mock return item from list by ID 
	https://stackoverflow.com/questions/22010063/moq-a-retrieve-of-particular-list-item



	//Single Page Application
	https://docs.microsoft.com/en-us/aspnet/single-page-application/overview/introduction/knockoutjs-template

	//JS good practices
	http://james.padolsey.com/javascript/javascript-bad-practices/
	//JS no more frameworks
	https://bitworking.org/news/2014/05/zero_framework_manifesto

	//ORM vs plain sql strategies
	http://softwareengineering.stackexchange.com/questions/117357/is-entity-framework-suitable-for-high-traffic-websites

	//msdn C# posts
	https://blogs.msdn.microsoft.com/ruericlippert/tag/type-inference/

	//TOP 10 C# errors
	https://www.upwork.com/hiring/development/common-mistakes-in-c-sharp-programming/
	https://www.toptal.com/c-sharp/top-10-mistakes-that-c-sharp-programmers-make

	//SOLID
	http://sergeyteplyakov.blogspot.ru/2014/10/solid.html
	http://www.c-sharpcorner.com/uploadfile/damubetha/solid-principles-in-c-sharp/
	https://www.codeproject.com/Articles/703634/SOLID-architecture-principles-using-simple-Csharp

	//Learn C# building-a-simple-rpg-index
	http://scottlilly.com/learn-c-by-building-a-simple-rpg-index/

	//Loading type MSDN + (Loading types, lazy loading turning off)
	https://msdn.microsoft.com/en-us/library/jj574232(v=vs.113).aspx

	//C# Delegates, Actions, Funcs, Lambdas?Keeping it super simple
	https://blogs.msdn.microsoft.com/brunoterkaly/2012/03/02/c-delegates-actions-funcs-lambdaskeeping-it-super-simple/



	/*
	filtering inherited types classes in base class list of classes
	google
	c# base class list contains inherited classes
	stack
	*/
	http://stackoverflow.com/questions/2074779/identifying-derived-types-from-a-list-of-base-class-objects


	/*ECM possible FuckUps*/
	
	https://www.directum.ru/
	docsvision
	intraservise
	elma
	
	
	}
	
	
	#region TODO
	
		public class Utility
		{

0 neo4jAPI 
	-> CRUD
	-> boilerplate code sample nodes db with rel creation <- done
0 JS hacks (ajax to form)
	-> bind result js to site
	-> sample hack Select2 to API calls loc + interactive <- done	
0 HTTP,JSON,Orient Managers
	-> extend existing managers
	-> HttpManager, JSON, string managers, queryManager <- done
0 PersonAPI
	-> redeploy with new addressbook
	-> HttpManager <- done
	-> JSONmanager <- done
	-> PersonManager <- done
	-> WebApiConfig <- done
0 Repo
-> Repo (against SQL base and Northwind base)
-> Repo (Chaining IRepo implementation for Date + list filter)
0 UOW
-> Finilize for all
0 WCF - move t oREST API most likely due to unclear configuration while mooving
-> POCO to DataContract converter
-> ServiceContract Operation contract(implementation utilises repo) - Iservice - Irepo (IUow)
-> Add BLL Business logic layer between POCOs and UOW
-> Add JS multiple model items update at one time
-> to DLL
0 WebAPI
-> between repo and MVC site
1 PresentationSite
-> parsing excel file to objects method decompose to several
	///Sector type from filename
	///Fist file input determines merchant sector
	parse file mask;
	
	if parsed then
	{
	
		get sector id from filename; --from config
		get property fields; --from config
		if(no merchant column then error); --from parser

		foreach row
		{
			check merchant doubles for this sector; --from UOF
			remove doubles; --from UOF
			insert; --from UOF
		}
		
	}

-> Export to excel
-> Type converter for migration (
Add SQL to CLR type conversion ; 
SQLEntity to DWH entity converter; 
Converter logic to string name or type name;)
-> Add WCF between Repo and Site <- done bad idea WCF diff to config. REST API instead
-> UOW bind repo to generic with as and type conversion <- done
-> UOW bind context to every repo  <- done
-> Specific repository for every entity <- done
-> IRepository<T> with CRUD operations lightweight  <- done
SB , Repo and UOF to different projects  <- done
Northwind -> change login employee get from TempData to model  <- done
Northwind -> add complex model add  <- done
Tables migration - test with repo <- done
-> Emplicit implicit repos
1-explicit repo (mostly type by merchant)
Repo<T>() { GetItem1<T>() where T: IOne{}; ... GetItemn<T>() where T: In{}}
2-implicit repo (mostly one type by repo instance)
Repo<T>() where T: IOne { GetByOne(); }
...
Repo<T>() where T: In { GetByN(); } <- done
		}
		
		public class Mastery
		{
II:Mastery
0 Polinom Parse -> parse *^/ to expressions and add priorities for exprs
0 Command line Console parameters parse app dll -> to SB
0 Multithread socket message ping pong -> to SB
0 CollectionsComparison -> to SB
		}
		
		public class Infrastructure
		{
III:Infrastructure
0 Testng automate
0 Build automate
0 Correct decoupling of projects
		}
		
		public class Miscellaneous
		{
			
	
	IV:Miscellaneous ˌmɪs(ə)'leɪnɪəs
Actual:
Theory to SB;
	Merge CT,TODO, and notepads txt;
JdeveloperInstall;
	VS2017 install->
	check .NET Core2;
Revise:
	equality, string, default null init, inheritance, events
		}
			

	#endregion
		
	#region SourceControl

	public Bug Trackers
	{
		public GIT hub
		{
			
			MERGE PROJECTS ON FIRST COMMIT AFTER REMOTE BRANCH CREATEION
			git pull origin branchname --allow-unrelated-histories			
			//recommended
			git clone
			
			git push -u origin branchname {!!!<pushing to branch>!!!}
			
			git remote -v -> check remotes
			git branch -> check what branch you are in
			
			EXISTING LOCAL PROJECT TO NEW GIT REPO FIRST PUSH
			create new in git web
			cd -> moove to directory		
			git remote add origin \\url_to_project
			git pull origin master
			git init -> initialize git
			git add . -a //no files changed
			git add -u //only indexed files
			
			git commit -m "Commit text"
			git push -u origin master
			
			NEW BRANCH
			create new branch in web
			git checkout -b \\url to branch		
			add commit push section 
			
			REMOVE REPO
			git remote rm origin
					
		}

	}

	public Issuer Trackers
	{
		
	}

	#endregion

	#region C#

	//Forums
	public stackoverflow
	{


	/*
	filtering inherited types classes in base class list of classes
	google
	c# base class list contains inherited classes
	stack
	*/
	http://stackoverflow.com/questions/2074779/identifying-derived-types-from-a-list-of-base-class-objects

	//wrong CompiledQuery
	http://stackoverflow.com/questions/8125581/pre-compiling-linq-queries-when-using-entity-framework

	//null false grouping in linq to entities
	http://stackoverflow.com/questions/33286297/linq-groupby-with-a-dynamic-group-of-columns

	//HttpPostedFileBase always return null in ASP.NET MVC
	http://stackoverflow.com/questions/8551528/httppostedfilebase-always-return-null-in-asp-net-mvc

	//MVC Upload,DOwnload
	http://www.mikesdotnetting.com/article/125/asp-net-mvc-uploading-and-downloading-files
	http://rachelappel.com/upload-and-download-files-using-asp-net-mvc/

	//MVC values in postback
	https://www.syncfusion.com/kb/5427/how-to-get-the-form-control-values-in-postback

	//IIS max size change
	https://www.iis.net/configreference/system.webserver/security/requestfiltering/requestlimits

	//C++ stdio include
	http://stackoverflow.com/questions/31736361/visual-studio-2015-gives-me-errors-upon-creating-a-simple-test-console-program

	//c# linq datetime filter type to oracle database entity context
	http://stackoverflow.com/questions/4146300/linq-to-entityframework-datetime

	//Bookmarks Toolbar include
	http://stackoverflow.com/questions/29742174/how-to-add-bookmark-toolbar-in-visual-studio-2012

	//validation errors publish
	http://stackoverflow.com/questions/5400530/validation-failed-for-one-or-more-entities-while-saving-changes-to-sql-server-da

	//get current method name
	http://stackoverflow.com/questions/2652460/how-to-get-the-name-of-the-current-method-from-code
	http://stackoverflow.com/questions/2652460/how-to-get-the-name-of-the-current-method-from-code

	//Json null date fromate
	https://stackoverflow.com/questions/18635599/specifying-a-custom-datetime-format-when-serializing-with-json-net
	
	}

	//structure
	public OverallC#
	{
		
		public Description()
		{
			annonymous Type - varibale type from code context
			weak reference - allow GC collect large class even if referenced
			generics default - default(T) bind default value to generic varibale
			generic with generic parameter - interface IGarrage<TCar,TOther> where TCar : IGenericCar<TOther> { ... }
			c++\CLI - wrap c++ code in .net
			CAS - Computer Algebra Systems
		}
		
		public Platform()
		{
			.net 2.0 - delegates begininvoke endinvoke
			--anonimous 
			.net 3.0 - lambda
			.net 4.0 - System.Threading.tasks - task parallel lib
			.net 4.5 - task based asynchronous (async,await)
		}	
		
		public Ideas()
		{
			DRY:
			Common library - leads to a lot links to one unrelated code
			Common source code - file in proj folder leds to diverse versions/getting-started-with-ef-5-using-mvc-4/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application
			Service - one service in use. Large progects with latency and failures understood and managed
			NuGET - managing layers
			
			
			Interfaces use not only to loose coupling
			Highly Generic code could be used from many places
			
		}
	
		public class Examples
		{
			
			public void Theory()
			{			
				
				public class Equality(){
					
					GetType():
					a = new b
					gettype == typeof() -> b

					IS:
					a = new b
					a is b -> true => a : b
					a is b -> false => a !: b || a : Ib

					EQUALS:
					a.Equals(b) -> true => a=b
									
				}
				
				public class OperatorOverload()	{
					...
					protected static ret operator[+,...,*] (){...};
					...
				}
				
				public class StringMutability(){
					
					STRING MUTABILITY:
					string a; //a==null
					string[] arr


					method2(string a ){cahnge a;}// unchanged global; cahnged local}
					method2(string[] arr ){cahnge arrr;}// cahnged global refernce type}
					method1(){cahnge a;}// cahnged global}
				}
				
				public class SealedMethodChange(){
						public sealed class Circle
						{
							private double radius;
							public double Calculate(Func<double, double> op)
							{
								return op(radius);
							}
						}
				   
				   ...
				   
				   circle.clculate(r=>Math.PI*dbl);
				}

				public class Disposing(){
					public void NullOrNotNull()
					{
						https://blogs.msdn.microsoft.com/clyon/2004/12/01/to-null-or-not-to-null/
					}
					public void GC_SuppressFinilize()
					{
						https://msdn.microsoft.com/en-us/library/system.gc.suppressfinalize(v=vs.110).aspx
					}				
				}
			
				public class UnitTesting(){
					
					public void Overall_Recommendations(){
						
						https://msdn.microsoft.com/en-us/library/aa730844(v=vs.80).aspx
						/*
							Runs fast. fast.
							Main purpose -> developer concerns about program + selfdocummented code
							All dependencies : DB,IO & s.o. -> mocked or stubbed.
							LIC -> Limited,Isolated,Clear;
							FLIMR - > Fast,Limited,Isolated,Mocked,Revealing;
						*/
						
					}
					
				}			
				
			}
			
			//Override reminder
			public void OverrideReminder()
			{


				//override reminder exmpl
				//------------------------------------
				public class test1
				{
				public int a = 1;
				public test1()
				{

				}
				public virtual void countt()
				{
				a = a * 2;
				}
				public virtual int getA()
				{
				return a;
				}
				}
				public class test2 : test1
				{
				public int a = 1;
				public test2()
				{

				}
				public override void countt()
				{
				a = a * 3;
				}
				public override int getA()
				{
				return a;
				}
				}
				public class testt
				{
				public test1 t1;

				public testt(test1 t_)
				{
				t1 = t_;
				}
				}
				public int overridetest()
				{
				testt tt = new testt(new test1());
				tt.t1.countt();
				return tt.t1.getA();
				}
				//------------------------------------


			}
			
			public void MVC()
			{
					
				public void MVC_Template()
				{
					
					+ references
					System.Web.Mvc;
					System.Web.Razor;
					System.Web.Entity;
					System.Web.Helpers;
					System.Web.ApplicationServices;
					
					App_Data

					App_Start						
						RouteConfig.cs
							using System.Web.Mvc;
							using System.Web.Routing;
							public class RouteConfig
							{
								public void RegisterRoutes(RouteCollection routes)
								{
									
									routes.IgnoreRoute("{resuource}.axd{*pathInfo}");
									
									routes.MapRoute(
										name: "Default",
										url: "/{controller/{action}/{id}}",
										defaults: new {controller = "Default", action = "DefaultView", id = UrlParameter.Optional }
									);
								}
							}
						BundleConfig.cs						
							using System.Web.MVC;
							using System.Web.Optimization;
							public class BundleConfig()
							{
								public static void RegisterBundles(BundleCollection bundles)
								{
									bundles.Add(new ScriptBundle("~/bundles/jquery").Include("~/Scripts/jquery-{version}.js"));
									bundles.Add(new StyleBundle("~/Content/css").Include("~/Content/site.css"));
								}
							}
							
						FilterConfig.cs
							using System.Web.MVC;
							public class FilterConfig()
							{
								public static void RegisterGlobalFilters(GlobalFilterCollection filters)
								{
									filters.Add(new HandleErrorAttribute());
								}
							}
							
						Startup.cs
						
					Models

					Controllers
						using System.Web;
						using System.Web.MVC;
						DefaultController.cs
							public ActionResult Default : Controllers{
									return View();
							}
							
					Views
						Default
							DefaultView
							<h2>Header native</h2>
						Shared
							_Layout.cshtml
								<DOCTYPE html>
								<head><h1>@ViewBag.Title</h1></head>
								<body>@RenderBody()</body>
						_ViewStart.cshtml
							@{Layout=@"~/Views/Shared/_Layout.cshtml"}
								
								Global.asax
									
									using System.Web.Mvc;
									
									using System.Web.Routing;
									
									using System.Web.Optimization;
										
									using System.Web.Helpers;												
									using System.Security.Claims;
									
									public class App : System.Web.HttpApplication
									{
										
										public void Application_Start()
										{
										
					`						AreaRegistration.RegisterAllAreas();
											FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
																	
											RouteConfig.RegisterRoutes(RouteTable.Routes);						
										
											BundleConfig.RegisterBundles(BundleTable.Bundles);
																
											AntiForgeryConfig.UniqueClaimTypeIdentifier = ClaimTypes.Authentication;
											
										}
										
									}
																		
				}
		
				public void DAL()
				{
								
					/// <summary>
					/// Context with recreate if model changes
					/// </summary>
					public class SQLDB_CHANGE : DbContext
					{
						
						public SQLDB_CHANGE()
							: base("name=SQLDB_J")
						{
							Database.SetInitializer<SQLDB_CHANGE>(new DropCreateDatabaseIfModelChanges<SQLDB_CHANGE>());
							//CreateDatabaseIfNotExists
							//DropCreateDatabaseAlways
						}

						public SQLDB_CHANGE(string ConnectionName)
							: base(ConnectionName)
						{							
							//Database.SetInitializer<SQLDB_CHANGE>(new DropCreateDatabaseIfModelChanges<SQLDB_CHANGE>());
							
							//set initializer method
							Database.SetInitializer(new InitializerAtCreation());
							
							//force initialization
							Database.Initialize(true);
						}
							
						protected override void OnModelCreating(DbModelBuilder modelBuilder)
						{
							base.OnModelCreating(modelBuilder);
						}
						
						//initializer class with seed method
						//runs at DB creation
						public class InitializerAtCreation : DropCreateDatabaseIfModelChanges<SQLDB_CHANGE>
						{
							protected override void Seed(SQLDB_CHANGE context)
							{
								IList<KEY_CLIENTS_SQL> kk = new List<KEY_CLIENTS_SQL>()
								{
									new KEY_CLIENTS_SQL {SECTOR_ID = 1, MERCHANT = 9290000000 },
									new KEY_CLIENTS_SQL {SECTOR_ID = 2, MERCHANT = 9290000001 },
									new KEY_CLIENTS_SQL {SECTOR_ID = 2, MERCHANT = 9290000003 }
								};

								context.KEY_CLIENTS.AddRange(kk);
								context.SaveChanges();

								IList<REFMERCHANTS_SQL> rm = new List<REFMERCHANTS_SQL>()
								{
									new REFMERCHANTS_SQL { MERCHANT = 9290000000 },
									new REFMERCHANTS_SQL { MERCHANT = 9290000001 },
									new REFMERCHANTS_SQL { MERCHANT = 9290000002 },
									new REFMERCHANTS_SQL { MERCHANT = 9290000003 },
									new REFMERCHANTS_SQL { MERCHANT = 9290000004 },
								};

								context.REFMERCHANTS_SQL.AddRange(rm);
								context.SaveChanges();

								List<MERCHANT_LIST_SQL> ml = new List<MERCHANT_LIST_SQL>() {
									new MERCHANT_LIST_SQL() { MERCHANT = 9290000000, USER_ID =0, UPDATE_DATE = DateTime.Now },
									new MERCHANT_LIST_SQL() { MERCHANT = 9290000001, USER_ID =0, UPDATE_DATE = DateTime.Now },
									new MERCHANT_LIST_SQL() { MERCHANT = 9290000002, USER_ID =0, UPDATE_DATE = DateTime.Now }
								};

								context.MERCHANT_LIST.AddRange(ml);
								context.SaveChanges();

								base.Seed(context);
							}
						}
					}
					
					///<summary>
					/// Northwind context with OWIN security attached
					/// </summary>
					public partial class NorthwindModel : IdentityDbContext<ApplicationUser>
					{
						public NorthwindModel()
							: base("name=NorthwindConn_J")
						{
						}

						public static NorthwindModel Create()
						{
							return new NorthwindModel();
						}
					  
						public virtual DbSet<Category> Categories { get; set; }
						public virtual DbSet<CustomerDemographic> CustomerDemographics { get; set; }
						public virtual DbSet<Customer> Customers { get; set; }
						public virtual DbSet<Employees> Employees { get; set; }
						public virtual DbSet<Order_Detail> Order_Details { get; set; }
						public virtual DbSet<Order> Orders { get; set; }
						public virtual DbSet<Product> Products { get; set; }
						public virtual DbSet<Region> Regions { get; set; }
						public virtual DbSet<Shipper> Shippers { get; set; }
						public virtual DbSet<Supplier> Suppliers { get; set; }
						public virtual DbSet<Territory> Territories { get; set; }

						
						protected override void OnModelCreating(DbModelBuilder modelBuilder)
						{

							//modelBuilder.Entity<Login>().HasRequired(t => t.employee).WithOptional(t=>t.Account);

							modelBuilder.Entity<Employees>().HasOptional(t => t.Account).WithOptionalPrincipal(t=>t.employee);

							modelBuilder.Entity<CustomerDemographic>()
								.Property(e => e.CustomerTypeID)
								.IsFixedLength();

							modelBuilder.Entity<CustomerDemographic>()
								.HasMany(e => e.Customers)
								.WithMany(e => e.CustomerDemographics)
								.Map(m => m.ToTable("CustomerCustomerDemo").MapLeftKey("CustomerTypeID").MapRightKey("CustomerID"));

							modelBuilder.Entity<Customer>()
								.Property(e => e.CustomerID)
								.IsFixedLength();

							modelBuilder.Entity<Employees>()
								.HasMany(e => e.Employees1)
								.WithOptional(e => e.Employee1)
								.HasForeignKey(e => e.ReportsTo);

							modelBuilder.Entity<Employees>()
								.HasMany(e => e.Territories)
								.WithMany(e => e.Employees)
								.Map(m => m.ToTable("EmployeeTerritories").MapLeftKey("EmployeeID").MapRightKey("TerritoryID"));

							modelBuilder.Entity<Order_Detail>()
								.Property(e => e.UnitPrice)
								.HasPrecision(19, 4);

							modelBuilder.Entity<Order>()
								.Property(e => e.CustomerID)
								.IsFixedLength();

							modelBuilder.Entity<Order>()
								.Property(e => e.Freight)
								.HasPrecision(19, 4);

							modelBuilder.Entity<Order>()
								.HasMany(e => e.Order_Details)
								.WithRequired(e => e.Order)
								.WillCascadeOnDelete(false);

							modelBuilder.Entity<Product>()
								.Property(e => e.UnitPrice)
								.HasPrecision(19, 4);

							modelBuilder.Entity<Product>()
								.HasMany(e => e.Order_Details)
								.WithRequired(e => e.Product)
								.WillCascadeOnDelete(false);

							modelBuilder.Entity<Region>()
								.Property(e => e.RegionDescription)
								.IsFixedLength();

							modelBuilder.Entity<Region>()
								.HasMany(e => e.Territories)
								.WithRequired(e => e.Region)
								.WillCascadeOnDelete(false);

							modelBuilder.Entity<Shipper>()
								.HasMany(e => e.Orders)
								.WithOptional(e => e.Shipper)
								.HasForeignKey(e => e.ShipVia);

							modelBuilder.Entity<Territory>()
								.Property(e => e.TerritoryDescription)
								.IsFixedLength();

							base.OnModelCreating(modelBuilder);
						}					
					}					
					
				}
				
				public void Model()
				{
					///Model attributes
					//class table name
					[Table(@"REFMERCHANTS_SQL")]
					//column as PK , not null
					[Key],[Required]
					//Column ID by database genereated
					[DatabaseGenerated(DatabaseGeneratedOption.Computed)]
					[DatabaseGenerated(DatabaseGeneratedOption.Identity)]												
					
				}
				
				public void NorthwindDBModel()
				{
					
					#region HR
					public partial class REGIONS : Repo_.IEntityInt
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public REGIONS()
						{
							this.COUNTRIES = new HashSet<COUNTRIES>();
						}

						[Key]
						//Change column name anfd type in DB
						[Column("REGION_ID", TypeName = "decimal")]
						public int ID { get; set; }
						public string REGION_NAME { get; set; }

						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<COUNTRIES> COUNTRIES { get; set; }
					}

					public partial class LOCATIONS : Repo_.IEntity
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public LOCATIONS()
						{
							this.DEPARTMENTS = new HashSet<DEPARTMENTS>();
						}

						[Key]
						[Column("LOCATION_ID", TypeName = "varchar")]
						public string ID { get; set; }
						public string STREET_ADDRESS { get; set; }
						public string POSTAL_CODE { get; set; }
						public string CITY { get; set; }
						public string STATE_PROVINCE { get; set; }
						public string COUNTRY_ID { get; set; }

						public virtual COUNTRIES COUNTRIES { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<DEPARTMENTS> DEPARTMENTS { get; set; }
					}

					public partial class JOBS
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public JOBS()
						{
							this.EMPLOYEES = new HashSet<EMPLOYEES>();
							this.JOB_HISTORY = new HashSet<JOB_HISTORY>();
						}

						[Key]
						public string JOB_ID { get; set; }
						public string JOB_TITLE { get; set; }
						public Nullable<int> MIN_SALARY { get; set; }
						public Nullable<int> MAX_SALARY { get; set; }

						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<EMPLOYEES> EMPLOYEES { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<JOB_HISTORY> JOB_HISTORY { get; set; }
					}

					public partial class JOB_HISTORY
					{
						[Key]
						public int EMPLOYEE_ID { get; set; }
						public System.DateTime START_DATE { get; set; }
						public System.DateTime END_DATE { get; set; }
						public string JOB_ID { get; set; }
						public Nullable<short> DEPARTMENT_ID { get; set; }
						public Nullable<int> EMPLOYEES_EMPLOYEE_ID { get; set; }

						public virtual DEPARTMENTS DEPARTMENTS { get; set; }
						public virtual EMPLOYEES EMPLOYEES { get; set; }
						public virtual JOBS JOBS { get; set; }
					}

					public partial class COUNTRIES
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public COUNTRIES()
						{
							this.LOCATIONS = new HashSet<LOCATIONS>();
						}

						[Key]
						public string COUNTRY_ID { get; set; }
						public string COUNTRY_NAME { get; set; }
						public Nullable<decimal> REGION_ID { get; set; }

						public virtual REGIONS REGIONS { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<LOCATIONS> LOCATIONS { get; set; }
					}

					public partial class DEPARTMENTS
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public DEPARTMENTS()
						{
							this.EMPLOYEES2 = new HashSet<EMPLOYEES>();
							this.EMPLOYEES3 = new HashSet<EMPLOYEES>();
							this.JOB_HISTORY = new HashSet<JOB_HISTORY>();
						}

						[Key]
						public short DEPARTMENT_ID { get; set; }
						public string DEPARTMENT_NAME { get; set; }
						public Nullable<int> MANAGER_ID { get; set; }
						public Nullable<short> LOCATION_ID { get; set; }
						public Nullable<int> EMPLOYEES_EMPLOYEE_ID { get; set; }
						public Nullable<int> EMPLOYEES_EMPLOYEE_ID1 { get; set; }

						public virtual EMPLOYEES EMPLOYEES { get; set; }
						public virtual EMPLOYEES EMPLOYEES1 { get; set; }
						public virtual LOCATIONS LOCATIONS { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<EMPLOYEES> EMPLOYEES2 { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<EMPLOYEES> EMPLOYEES3 { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<JOB_HISTORY> JOB_HISTORY { get; set; }
					}

					public partial class EMPLOYEES
					{
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2214:DoNotCallOverridableMethodsInConstructors")]
						public EMPLOYEES()
						{
							this.DEPARTMENTS = new HashSet<DEPARTMENTS>();
							this.DEPARTMENTS1 = new HashSet<DEPARTMENTS>();
							this.EMPLOYEES1 = new HashSet<EMPLOYEES>();
							this.JOB_HISTORY = new HashSet<JOB_HISTORY>();
						}

						[Key]
						public int EMPLOYEE_ID { get; set; }
						public string FIRST_NAME { get; set; }
						public string LAST_NAME { get; set; }
						public string EMAIL { get; set; }
						public string PHONE_NUMBER { get; set; }
						public System.DateTime HIRE_DATE { get; set; }
						public string JOB_ID { get; set; }
						public Nullable<decimal> SALARY { get; set; }
						public Nullable<decimal> COMMISSION_PCT { get; set; }
						public Nullable<int> MANAGER_ID { get; set; }
						public Nullable<short> DEPARTMENT_ID { get; set; }
						public Nullable<short> DEPARTMENTS1_DEPARTMENT_ID { get; set; }
						public Nullable<int> EMPLOYEES2_EMPLOYEE_ID { get; set; }
						public Nullable<short> DEPARTMENTS_DEPARTMENT_ID { get; set; }

						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<DEPARTMENTS> DEPARTMENTS { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<DEPARTMENTS> DEPARTMENTS1 { get; set; }
						public virtual DEPARTMENTS DEPARTMENTS2 { get; set; }
						public virtual DEPARTMENTS DEPARTMENTS3 { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<EMPLOYEES> EMPLOYEES1 { get; set; }
						public virtual EMPLOYEES EMPLOYEES2 { get; set; }
						public virtual JOBS JOBS { get; set; }
						[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Usage", "CA2227:CollectionPropertiesShouldBeReadOnly")]
						public virtual ICollection<JOB_HISTORY> JOB_HISTORY { get; set; }
					}
					#endregion
		
				}
								
				public class CustomAttribute()
				{
					
					public class Quth : AuthorizeAttribute
					{

						const();
						
						public override void OnAuthorization(Syste.Wb.http.HttpActionContext at)
						{
						
							base.()OnAuthorization(at);
							
						}
						
					}
					
				}
				
			}
			
			public void OrientDB()
			{
				public void DriversInstall()
				{
					Update-Package Microsoft.AspNet.Mvc -Reinstall
					Install-Package Microsoft.AspNet.Mvc -Version 3.2
					Install-Package Microsoft.ApplicationInsights.Web
					Update-Package Microsoft.ApplicationInsights.Web -Reinstall
				}
			}
							
			public void Testing()
			{
				
				//Expected Actual
				public void Moq()
				{
					//Setup phase 
					//sample type callback
					 kkRepo.Setup(m => m.Add(It.IsAny<KEY_CLIENTS_SQL>())).Callback<KEY_CLIENTS_SQL>(
					(KEY_CLIENTS_SQL s) => { client = s; });
					
					//Cllaback hosting object 
					kkRepo.Setup(m => m.Add(It.IsAny<KEY_CLIENTS_SQL>())).Callback(
					(KEY_CLIENTS_SQL s) => { clientsL.Add(s);});
				
					//return item by ID
					kkRepo.Setup(m => m.GetByID(It.IsAny<int>())).Returns<int>(id => clientsQ.SingleOrDefault(r => r.ID == id));
					
					
					//DELETEBYLIST example
					kkRepo.Object.DeleteByList(clientsDel.AsQueryable());
					kkRepo.Verify(s => s.DeleteByList(It.IsAny<IQueryable<KEY_CLIENTS_SQL>>()));
					Assert.AreEqual(clientsL.Count(), clientsAfterListDeleteCount);
				}				
							
			}
					
			public class Unsorted 
			{
				
			//delete from oracle table and link parametrized insert command to connection
			public class oracle_queries(){
			oracleConnection.Open();
			oracleDeleteCommand.Connection = oracleConnection;
			oracleDeleteCommand.CommandText = oracleQueriesBank.unparametrizedDelete;
			oracleDeleteCommand.ExecuteNonQuery();

			OracleCommand oracleInsertCommand = new OracleCommand();
			oracleInsertCommand.Connection = oracleConnection;
			oracleInsertCommand.CommandText = oracleQueriesBank.parametrizedInsert;

			oracleConnection.Open();
			oracleTablePresence.Connection = oracleConnection;
			oracleTablePresence.CommandText = oracleQueriesBank.tablePresenceTest;
			oracleTablePresence.Parameters.Add(new OracleParameter("tablename", "MERCHANT_LIST"));
			tablecount = oracleTablePresence.ExecuteScalar().ToString();

			oracleTablePresence.CommandText = oracleQueriesBank.tableColumnTest;
			oracleTablePresence.Parameters.Add(new OracleParameter("tablename", "MERCHANT_LIST"));
			oracleTablePresence.Parameters.Add(new OracleParameter("columnname", "ID_MERCHANT"));
			columncount = oracleTablePresence.ExecuteScalar().ToString();

			connectionInitialize(oracleConnection);
			OracleCommand oracleTableCount = new OracleCommand();
			oracleConnection.Open();
			oracleTableCount.Connection = oracleConnection;
			oracleTableCount.CommandText = oracleQueriesBank.unparametrizedRowCount;

			oracleTableCount.CommandText = oracleQueriesBank.tableColumnTest;
			rowcount = oracleTableCount.ExecuteScalar().ToString();
			}

			//oracle service query texts
			public class servi?e_queries(){
			//used for parametrized insert from import datagridview to oracle table
			//occurs in dataGridView_Import_DoubleClick throught OracleQueryExecutor class
			sampleInsert = "insert into merchant_list (ID_MERCHANT) values ('test_val')";

			unparametrizedDelete = "delete from merchant_list";
			parametrizedInsert = "insert into merchant_list values (:value)";
			unparametrizedRowCount = "select max(rownum) from merchant_list";

			//used for detecting marchant_list table presence and it's creation
			tablePresenceTest = "select max(rownum) from user_tables where table_name = (:tablename)";
			//detecting rownumbers in table
			tableColumnTest = "select max(rownum) from user_tab_columns where table_name = (:tablename) and column_name = (:columnname)";
			createTable = "create table MERCHANT_LIST (ID_MERCHANT varchar(50))";
			}

			//SERIALIZE DESERIALIZE
			public class serealization_deserialization(){
			public void Serialize(String path, List<OracleQueriesListClass> myArray)
			{
			BinaryFormatter formatter = new BinaryFormatter();
			using (FileStream stream = new FileStream(path, FileMode.Create, FileAccess.Write))
			{
			formatter.Serialize(stream, myArray);
			}
			}

			public List<OracleQueriesListClass> DeserializeList(String path)
			{
			BinaryFormatter formatter = new BinaryFormatter();
			using (FileStream stream = new FileStream(path, FileMode.Open, FileAccess.Read))
			{
			List<OracleQueriesListClass> myList = (List<OracleQueriesListClass>)formatter.Deserialize(stream);
			return myList;
			}
			}
			}

			//app setting connstrings example
			public class connstrings(){

			//requesting connString from appsettings
			System.Configuration.ConfigurationSettings.AppSettings["ConnectionString"];
			System.Configuration.ConfigurationManager.ConnectionStrings["connectionStringName"].ConnectionString;
			</startup>
			<appSettings>
			<add key="ConnectionString" value="Data Source=dwh.rs.ru;User ID=LoginReplacePatch;Password=PasswordReplacePatch" />
			<add key="ClientSettingsProvider.ServiceUri" value="" />
			<add key="excelConnectionString" value="OLEDB;Provider=MSDAORA.1;Password=PasswordReplacePatch;User ID=LoginReplacePatch;Data Source=dwh.rs.ru;" />
			</appSettings>
			}

			public class ExcelIntegration(){
				

			//create excel xlsx with OPEN xml
			private void OPENxmlCreate(){
			string fileName = @"C:\111\test.xlsx";
			using (SpreadsheetDocument document = SpreadsheetDocument.Create(fileName, SpreadsheetDocumentType.Workbook))
			{
			WorkbookPart workbookPart = document.AddWorkbookPart();
			workbookPart.Workbook = new Workbook();

			WorksheetPart worksheetPart = workbookPart.AddNewPart<WorksheetPart>();
			worksheetPart.Worksheet = new Worksheet(new SheetData());

			Sheets sheets = workbookPart.Workbook.AppendChild(new Sheets());

			Sheet sheet = new Sheet() { Id = workbookPart.GetIdOfPart(worksheetPart), SheetId = 1, Name = "Test Sheet" };

			sheets.Append(sheet);

			workbookPart.Workbook.Save();
			}
			}

			}

			/////

			//connection strings
			public void connectionStrings()
			{

			//connection to local SQL express from MVC
			//<add name="BookContext" connectionString="Data Source=.\SQLEXPRESS2;Initial Catalog=text_db;Integrated Security=SSPI;" providerName="System.Data.SqlClient"/>

			//<add name="SoocerContext" connectionString="Data Source=.\SQLEXPRESS2;Initial Catalog=tempdb;Integrated Security=SSPI;" providerName="System.Data.SqlClient"/>

			//connection from console app
			//string connectionString = @"Initial Catalog=tempdb;Data Source=.\SQLEXPRESS2;Integrated Security=SSPI;";

			//string connectionStringORCL = @"User Id=neprintsev_ia; password = awsedrDRSEAW; Data Source = dwh.rs.ru; Pooling=false;";
			//string connectionStringSQL = @"Data Source=.\SQLEXPRESS;Initial Catalog=DWH_replica;Integrated Security=SSPI;";

			}

			//----------------------------------------------


			//mvc tempaltes
			public void MVC_templates()
			{

			//view add button with rediraect
			<input type="button" value="ClickMe" onclick="location.href='@Url.Action("Migrate","Home")'"

			//view submit button
			<input type="submit" value="Save" class="btn btn-default" />

			//view actionlink
			@Html.ActionLink("Back to List", "Index")

			// Refresh model in controller if passing values after changes in layer
			if(ModelState.IsValid)
			{
			ModelState.Clear();
			}

			//start wcf service async
			Task.Run(() => migrateService.migrate_((DateTime)DateFrom, (DateTime)DateTo));

			//one of multiple buttons
			//controller part
			[HttpPost]
			[MultipleButton(Name = "action", Argument = "Stop")]
			public ActionResult Stop(int ID, DateTime? DateFrom, DateTime? DateTo)
			{}

			//view part
			<td>
			<input type="submit" value="Stop" name="action:Stop" />
			</td>

			//pass multiple parameters to controller from view
			<td>
			<input type="text" id="DateTo" name="DateTo" value="@tab.DateTo" />
			</td>

			//parametrized groupping linq to entity
			var a = from s in db.FD_ACQ_D
			where DbFunctions.CreateDateTime(s.DT_REG.Year, s.DT_REG.Month,01,0,0,0) ==
			DbFunctions.CreateDateTime(fromDate.Year, fromDate.Month, 01, 0, 0, 0)
			group s by new { DT_REG= DbFunctions.CreateDateTime(s.DT_REG.Year, s.DT_REG.Month, 01, 0, 0, 0), TYPE_TRANSACTION=s.TYPE_TRANSACTION, PAY_SYSTEM=s.PAY_SYS} into g
			select new
			{
			DT_REG = g.Key.DT_REG,
			TYPE_TRANSACTION = g.Key.TYPE_TRANSACTION,
			PAY_SYSTEM=g.Key.PAY_SYSTEM,
			AMT = g.Sum(s => s.AMT)
			};
			foreach(var b in a)
			{
			this.FD_ACQ_D.Add(new FD_RES { DT_REG = b.DT_REG, TYPE_TRANSACTION = b.TYPE_TRANSACTION, AMT = b.AMT, PAY_SYS=b.PAY_SYSTEM });
			}


			//return json from controller public string GetJson()
			{
			ml.GetACQ(db);
			string jsn = JsonConvert.SerializeObject(ml.FD_ACQ_D);
			return jsn;
			}

			}

			//json serialization with newtonsoft dll
			public void jsonserialization()
			{

			string json2 = JsonConvert.SerializeObject(jst1, Formatting.Indented);
			File.WriteAllText(@"C:\test\insert\json.json", json2);

			string json3 = "";
			json3 = File.ReadAllText(@"C:\test\insert\json.json");
			json_tst_par jDes = JsonConvert.DeserializeObject<json_tst_par>(json3);

			}

			public void StoreValuesToSettings()
			{

			//storing values to settings
			WindowsFormsApplication2.Properties.Settings.Default.Upgrade();
			//changes
			WindowsFormsApplication2.Properties.Settings.Default.Save();

			//Initializing Form Elements in form methods
			TextBox tb = (TextBox)sender;

			//datetime defenition
			DateTime dt = new DateTime(1, 1, 1, 0, 0, 0)
			}

			//default connection strings for oracle and excel
			public void connectionStrings()
			{
			<appSettings>
			<add key="ConnectionString" value="Data Source=dwh.rs.ru;User ID=LoginReplacePatch;Password=PasswordReplacePatch;" />
			<add key="ClientSettingsProvider.ServiceUri" value="" />
			<add key="excelConnectionString" value="OLEDB;Provider=MSDAORA.1;Password=PasswordReplacePatch;User ID=LoginReplacePatch;Data Source=dwh.rs.ru;Pooling=false;" />
			</appSettings>
			}

			//List object on excel list REFRESH
			if (lob.Name == liobName)
			{
			lob.QueryTable.CommandText = queryText__;
			lob.QueryTable.Connection = connectionString;
			lob.QueryTable.BackgroundQuery = true;
			lob.QueryTable.SaveData = true;
			lob.QueryTable.EnableRefresh = true;
			//lob.QueryTable.Refresh(false);
			try
			{
			lob.QueryTable.Refresh(false);
			}
			catch (Exception e)
			{

			}
			}

			//List object on excel list PLACE
			if (ws.Name==wsName)
			{

			ExcelInterop.Range worksheetRange = ws.get_Range("A1");
			string tableName=Path.GetRandomFileName().Replace(".","");
			tableName = Regex.Replace(tableName, @"\d", "");


			ExcelInterop.ListObject ListObject = ws.ListObjects.Add(ExcelInterop.XlListObjectSourceType.xlSrcQuery,
			((object)connectionString), false, ExcelInterop.XlYesNoGuess.xlYes, worksheetRange);

			//ListObject.QueryTable.CommandText = ((object)excelCommand);
			ListObject.QueryTable.CommandText = ((object)queryText__);
			ListObject.QueryTable.RowNumbers = false;
			ListObject.QueryTable.FillAdjacentFormulas = false;
			ListObject.QueryTable.PreserveFormatting = true;
			ListObject.QueryTable.RefreshOnFileOpen = false;
			ListObject.QueryTable.BackgroundQuery = true;
			ListObject.QueryTable.SavePassword = false;
			ListObject.QueryTable.SaveData = true;
			ListObject.QueryTable.AdjustColumnWidth = true;
			ListObject.QueryTable.RefreshPeriod = 10;
			ListObject.QueryTable.PreserveColumnInfo = true;
			ListObject.QueryTable.ListObject.DisplayName = tableName; //tabName;
			ListObject.QueryTable.EnableRefresh = true;
			ListObject.QueryTable.Refresh(false);

			}

			//searchs all processes and finds id for passed main window title
			//apl.Caption for excell aplications
			public int GetProcessIdByWindowTitle(string windowTitle)
			{

			int processID;
			processID = 0;
			foreach (System.Diagnostics.Process proc in System.Diagnostics.Process.GetProcessesByName("Excel"))
			{
			if (proc.MainWindowTitle == windowTitle)
			processID = proc.Id;
			}
			return processID;
			}

			//kills process with current ID
			public void processKill(int ID)
			{
			foreach (System.Diagnostics.Process proc in System.Diagnostics.Process.GetProcessesByName("Excel"))
			{
			if (proc.Id == ID)
			proc.Kill();
			}
			}

			//creates file for current excel workbook with path
			public void fileSave(ExcelInterop.Workbook wb, string OutputFileName)
			{
			if (!Directory.Exists(Path.GetDirectoryName(OutputFileName)))
			{
			Directory.CreateDirectory(Path.GetDirectoryName(OutputFileName));
			}

			wb.SaveAs(OutputFileName, ExcelInterop.XlFileFormat.xlWorkbookDefault,
			Missing.Value, Missing.Value, Missing.Value, Missing.Value,
			ExcelInterop.XlSaveAsAccessMode.xlExclusive,
			Missing.Value, Missing.Value, Missing.Value,
			Missing.Value, Missing.Value);
			wb.Close();
			}

			//correct excel application killing
			public void ExcelApplicationTest()
			{
			xlNS.Application apl2;
			apl2 = new xlNS.Application();

			xlNS.Workbooks wbs2;
			wbs2 = apl2.Workbooks;

			xlNS.Workbook wb2;
			xlNS.Worksheet ws2;

			 

			if(!File.Exists(ExcelPath))
			{
			wb2 = wbs2.Add(xlNS.XlWBATemplate.xlWBATWorksheet);
			//ws2 = (xlNS.Worksheet)wb2.Worksheets[1];
			wb2.SaveAs(ExcelPath);
			}
			else
			{
			wb2 = wbs2.Open(ExcelPath);
			}

			wb2.Close();
			apl2.Quit();
			wbs2.Close();

			Marshal.ReleaseComObject(wb2);
			Marshal.ReleaseComObject(wbs2);
			Marshal.ReleaseComObject(apl2);

			wb2 = null;
			apl2 = null;
			wbs2 = null;

			}

			//Opens filedialog and inserts results from excel to datagrid view
			public void dataGridSelectedFill(DataGridView dg, FilePath FilePath_)
			{
			OpenFileDialog ofd = new OpenFileDialog();
			Stream stream = null;

			ofd.Filter = "excel files (*.xls)|*.xls|excel files (*.xlsx)|*.xlsx";
			ofd.FilterIndex = 2;
			ofd.RestoreDirectory = true;

			if (ofd.ShowDialog() == DialogResult.OK)
			{
			if (File.Exists(ofd.FileName))
			{
			FilePath_.inputFilePath = ofd.FileName;

			try
			{
			ofd.InitialDirectory = FilePath_.inputFileFolder;

			try
			{
			if ((stream = ofd.OpenFile()) != null)
			{
			WindowsFormsApplication2.Properties.Settings.Default.InputFilePath = ofd.FileName;
			WindowsFormsApplication2.Properties.Settings.Default.Save();

			using (stream)
			{
			//calls main method for excel file from filedialog open and dataset to datagrid bnding
			dg.DataSource = StreamToGrid(stream, ofd.FileName);
			//new BindingSource(result.Tables[0], null);
			}

			}
			}
			catch (Exception ex)
			{
			MessageBox.Show("Error: Could not read file from disk. Original error: " + ex.Message);
			}

			}
			catch (Exception ex)
			{
			MessageBox.Show("Error: no file folder exists!" + ex.Message);
			}
			}
			}
			}

			//converts stream of file to datagrid for xls,xlsx
			//with CodePlex data reader http://exceldatareader.codeplex.com/
			public DataTable StreamToGrid(Stream stream, string ofd)
			{
			IExcelDataReader excelReader = null;
			DataSet result = new DataSet();

			string ExcelExtension= Path.GetExtension(ofd);


			if (ExcelExtension == ".xls")
			{
			excelReader = ExcelReaderFactory.CreateBinaryReader(stream);
			result = excelReader.AsDataSet();
			}

			if (ExcelExtension == ".xlsx")
			{
			excelReader = ExcelReaderFactory.CreateOpenXmlReader(stream);
			excelReader.IsFirstRowAsColumnNames = true;
			result = excelReader.AsDataSet();
			}


			//6. Free resources (IExcelDataReader is IDisposable)
			excelReader.Close();

			return result.Tables[0];

			}

			 

			//Initializes and starts new form from another one (for excel worksheet selection)
			private void wsSelectShow(ExcelInterop.Workbook wb, ExcelExport ee, string connectionString)
			{
			ListObjects_ liob = new ListObjects_();
			wsSelect wsSelect_ = new wsSelect(wb, ee, connectionString);
			wsSelect_.Show();
			}

			//publishing of excel list object
			public void listObjectPublish(){

			ExcelInterop.ListObject ListObject = ws.ListObjects.Add(ExcelInterop.XlListObjectSourceType.xlSrcQuery,
			((object)connectionString), false, ExcelInterop.XlYesNoGuess.xlYes, worksheetRange);

			//ListObject.QueryTable.CommandText = ((object)excelCommand);
			ListObject.QueryTable.CommandText = ((object)queryText__);
			ListObject.QueryTable.RowNumbers = false;
			ListObject.QueryTable.FillAdjacentFormulas = false;
			ListObject.QueryTable.PreserveFormatting = true;
			ListObject.QueryTable.RefreshOnFileOpen = false;
			ListObject.QueryTable.BackgroundQuery = true;
			ListObject.QueryTable.SavePassword = false;
			ListObject.QueryTable.SaveData = true;
			ListObject.QueryTable.AdjustColumnWidth = true;
			ListObject.QueryTable.RefreshPeriod = 10;
			ListObject.QueryTable.PreserveColumnInfo = true;
			ListObject.QueryTable.ListObject.DisplayName = tableName; //tabName;
			ListObject.QueryTable.EnableRefresh = true;
			ListObject.QueryTable.Refresh(false);
			}

			//refreshing of list objects on excel
			public void ListObject refresh()
			{
			lob.QueryTable.CommandText = queryText__;
			lob.QueryTable.Connection = connectionString;
			lob.QueryTable.BackgroundQuery = true;
			lob.QueryTable.SaveData = true;
			lob.QueryTable.EnableRefresh = true;
			lob.QueryTable.Refresh(false);
			}

			//Connection string and query for reading excel files with OLEDB and storing to datatable to excel
			public void readExcelOledbStoreDTtoExcel()
			{
			//string for oledb to excel query
			string conString = @"Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + fileToParse + ";" + "Extended Properties=" + "\"" + @"Excel 12.0;HDR=NO;TypeGuessRows=0;ImportMixedTypes=Text""";

			OleDbConnection oleCon = new OleDbConnection(conString);
			OleDbCommand oleCmd = new OleDbCommand(req, oleCon);
			DataTable dt = new DataTable("Output");

			oleCon.Open();
			dt.Load(oleCmd.ExecuteReader());

			//save dt as xml
			dt.WriteXml(folder + @"\" + @"output.xml",XmlWriteMode.WriteSchema, false);

			Excel.Application excel_ = new Excel.Application();
			Excel.Workbook wb_ = excel_.Workbooks.Add(true);
			Excel.Worksheet ws_ = wb_.Worksheets[1];

			ws_ = wb_.Worksheets[1];


			//worksheet.Cells["A1"].LoadFromDataTable(dataToExcel, true,


			//passing datatable to array of objects dim to dim
			var data = new object[dt.Rows.Count+1, dt.Columns.Count+1];
			int drC = 0;
			int drR = 0;

			foreach(DataRow dr in dt.Rows)
			{
			drR = drR + 1;
			foreach(DataColumn dc in dt.Columns)
			{
			drC = drC + 1;
			data[drR, drC] = dt.Rows[drR-1][drC-1];
			}
			drC = 0;
			}

			var startCell = (Excel.Range)ws_.Cells[1, 1];
			var endCell = (Excel.Range)ws_.Cells[dt.Rows.Count + 1, dt.Columns.Count + 1];
			var writeRange = ws_.Range[startCell, endCell];

			//passing array of objects to excel list
			writeRange.Value2 = data;
			wb_.SaveAs(folder + @"\" + @"output.xlsx");

			wb_.Close();

			//read stored xml to datatable increases values if datatable not empty
			dt.ReadXml(folder + @"\" + @"output.xml");
			dt.WriteXml(folder + @"\" + @"output2.xml", XmlWriteMode.WriteSchema, false);

			oleCon.Close();

			}

			//Get current application folder console
			public void ApplicationFolder()
			{
			Application.StartupPath
			System.IO.Path.GetDirectoryName(
			System.Reflection.Assembly.GetExecutingAssembly().Location)
			AppDomain.CurrentDomain.BaseDirectory //Priority
			System.IO.Directory.GetCurrentDirectory()
			Environment.CurrentDirectory
			System.IO.Path.GetDirectoryName(
			System.Reflection.Assembly.GetExecutingAssembly().GetName().CodeBase)
			System.IO.Path.GetDirectory(Application.ExecutablePath)
			}

			//Get current application folder models
			public void Application folder()
			{
			AppDomain.CurrentDomain.GetData("DataDirectory").ToString();
			}

			//Get current application folder view
			public void Application_view()
			{
			HttpContext.Server.MapPath("~/App_Date/");
			}

			//using Interface IENUMERABLE for looping throught dates in list
			public void loopThroughDates()
			{

			public IEnumerable<DateTime> EachDay(DateTime from, DateTime thru)
			{
			for (var day = from.Date; day.Date <= thru.Date; day = day.AddDays(1))
			yield return day;
			}

			foreach(DateTime date in EachDay(startDate,finishDate))
			{
			DatesRequested.Add(date);
			}
			}

			//reads excel contents into datatable and stores it as xml
			public void readExceloledb()
			{

			public string oledbRequest = "SELECT F2,sum(F3) FROM [????1$] where F4 like '929%' or F4 like '959%' and F2 <> '' and F2 is not null group by F2 ";

			string conString = @"Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + fileToParse + ";" + "Extended Properties=" + "\"" + @"Excel 12.0;HDR=NO;TypeGuessRows=0;ImportMixedTypes=Text""";

			OleDbConnection oleCon = new OleDbConnection(conString);
			OleDbCommand oleCmd = new OleDbCommand(req, oleCon);
			DataTable dt = new DataTable("Output");

			oleCon.Open();

			//dt is datatable
			dt.Load(oleCmd.ExecuteReader());

			//save dt as xml
			dt.WriteXml(folder + @"\" + @"output.xml",XmlWriteMode.WriteSchema, false);

			}

			//reads datatable , convets it to excel array on worksheet and saves xlsx
			public void storeDatatableAsXLSX()
			{

			Excel.Application excel_ = new Excel.Application();
			Excel.Workbook wb_ = excel_.Workbooks.Add(true);
			Excel.Worksheet ws_ = wb_.Worksheets[1];

			ws_ = wb_.Worksheets[1];


			//worksheet.Cells["A1"].LoadFromDataTable(dataToExcel, true,


			//passing datatable to array of objects dim to dim
			var data = new object[dt.Rows.Count+1, dt.Columns.Count+1];
			int drC = 0;
			int drR = 0;

			foreach(DataRow dr in dt.Rows)
			{
			drR = drR + 1;
			foreach(DataColumn dc in dt.Columns)
			{
			drC = drC + 1;
			data[drR, drC] = dt.Rows[drR-1][drC-1];
			}
			drC = 0;
			}


			var startCell = (Excel.Range)ws_.Cells[1, 1];
			var endCell = (Excel.Range)ws_.Cells[dt.Rows.Count + 1, dt.Columns.Count + 1];
			var writeRange = ws_.Range[startCell, endCell];

			//passing array of objects to excel list
			writeRange.Value2 = data;
			wb_.SaveAs(folder + @"\" + @"output.xlsx");

			}



			//openXMLread
			public void openXML()
			{
			// open the document read-only
			SpreadsheetDocument document = SpreadsheetDocument.Open(fileName, false);
			SharedStringTable sharedStringTable = document.WorkbookPart.SharedStringTablePart.SharedStringTable;
			string cellValue = null;

			foreach (WorksheetPart worksheetPart in document.WorkbookPart.WorksheetParts)
			{
			foreach (SheetData sheetData in worksheetPart.Worksheet.Elements<SheetData>())
			{
			if (sheetData.HasChildren)
			{
			foreach (Row row in sheetData.Elements<Row>())
			{
			foreach (Cell cell in row.Elements<Cell>())
			{
			cellValue = cell.InnerText;

			/*
			try
			{
			if (cell.DataType == CellValues.SharedString)
			{
			Console.WriteLine("cell val: " + sharedStringTable.ElementAt(Int32.Parse(cellValue)).InnerText);
			}
			else
			{
			Console.WriteLine("cell val: " + cellValue);
			}
			}
			catch(Exception e)
			{
			if(e.Message=="Error in implicit conversion. Cannot convert null object.")
			{
			MessageBox.Show(e.Message);
			}
			}
			* */
			}
			}
			}
			}
			}
			document.Close();

			}


			//select max ID from list of classes
			public void LINQlogic()
			{
			//add list of objects to ienumerable
			IEnumerable<QueryTextNew> Queries =
			from QueryTextNew in querytextList
			select QueryTextNew;

			//select max ID catching empty element exception
			int itemsMax;

			try
			{
			itemsMax = Queries.Max(x => x.ID);
			}
			catch(Exception e )
			{
			itemsMax = 0;
			}

			}

			//creating procedure for dataset return
			public void oracleprocedurefordataset()
			{
			create or replace
			procedure get_daily(out_dt out SYS_REFCURSOR)
			AS
			BEGIN
			OPEN out_dt FOR SELECT * FROM neprintsev_ia.temp_acq_d where rownum <=10;
			END get_daily;
			}

			//get dataset from oracle procedure and store result datatable in xml
			public void datasetget()
			{

			string fileToParse = @"C:\test\daily\output\01022015report + fee2.xlsx";
			string oledbRequest = @"SELECT F5,F4,sum(F9) FROM [????1$] where F2 like '929%' or F2 like '959%' and F3 <> '' and F3 is not null group by F5,F4 ";
			string conString = @"Provider=Microsoft.ACE.OLEDB.12.0;" + "Data Source=" + fileToParse + ";" + "Extended Properties=" + "\"" + @"Excel 12.0;HDR=NO;TypeGuessRows=0;ImportMixedTypes=Text""";

			string connString = @"Data Source=dwh.rs.ru;User ID=neprintsev_ia;Password=awsedrRDESWA;";
			string oracleQuery = "get_daily";

			OracleConnection oracleConn = new OracleConnection(connString);

			OracleCommand oracleComm = new OracleCommand(oracleQuery, oracleConn);
			oracleComm.CommandType = CommandType.StoredProcedure;
			DataSet orads = new DataSet();
			oracleComm.Parameters.Add("out_dt", OracleType.Cursor).Direction=ParameterDirection.Output;

			oracleConn.Open();
			oracleComm.ExecuteNonQuery();

			OracleDataReader reader =
			oracleComm.Parameters["out_dt"].Value as OracleDataReader;

			OracleDataAdapter oracleAdapt = new OracleDataAdapter(oracleComm);

			oracleAdapt.Fill(orads);

			foreach (DataTable dtt in orads.Tables)
			{
			dtt.WriteXml(Path.GetDirectoryName(fileToParse) + @"\" + @"f_output.xml", XmlWriteMode.WriteSchema, false);
			}


			}

			//populate datatable to excel for current rowcolumn number
			public void populatedatatble to excel()
			{

			public void populateDataTable(DataTable dt,Excel.Worksheet ws_,int x,int y )
			{
			var data = new object[dt.Rows.Count , dt.Columns.Count ];
			int drC = -1;
			int drR = -1;

			foreach (DataRow drr in dt.Rows)
			{
			drR = drR + 1;
			foreach (DataColumn dcc in dt.Columns)
			{
			drC = drC + 1;
			data[drR, drC] = dt.Rows[drR ][drC];
			}
			drC = -1;
			}


			var startCell = (Excel.Range)ws_.Cells[x, y];
			var endCell = (Excel.Range)ws_.Cells[x+dt.Rows.Count-1, y+dt.Columns.Count-1];
			var writeRange = ws_.Range[startCell, endCell];

			writeRange.Value2 = data;

			}

			}

			//copy as embedded cahrt to powerpoint (editable) with smoexecute
			public void copytopowerpoiny(){
			pptSlide.Application.CommandBars.ExecuteMso("PasteExcelChartSourceFormatting");
			}


			//copy as ambeded and select object in powerpoint
			public void powerPoint(){
			//chartobject
			ch.Copy();

			pptSlide.Application.CommandBars.ExecuteMso("PasteExcelChartSourceFormatting");
			Thread.Sleep(1000);
			var a = pptSlide.Application.ActiveWindow.Selection;

			a.ShapeRange.Left = 10;
			a.ShapeRange.Top = 10;
			a.ShapeRange.Height = 200;
			a.ShapeRange.Width = 200;
			}


			//JSON serialization
			//Read write to filestream using memorystream
			public void JSONserialize(){

			MemoryStream ms = new MemoryStream();
			DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(rQueries_ih));
			ser.WriteObject(ms, q);

			ms.Position = 0;

			using (FileStream fs = new FileStream(@"C:\test\insert\json.txt",
			FileMode.Create, System.IO.FileAccess.Write))
			{
			ms.WriteTo(fs);
			ms.Close();
			}

			using (FileStream fs = new FileStream(@"C:\test\insert\json.txt",
			FileMode.Open, System.IO.FileAccess.Read))
			{
			MemoryStream ms2 = new MemoryStream();
			byte[] bytes = new byte[fs.Length];
			fs.Read(bytes, 0, (int)fs.Length);
			ms2.Write(bytes, 0, (int)fs.Length);

			ms2.Position = 0;
			q2 = (rQueries_ih)ser.ReadObject(ms2);
			ms2.Close();
			}

			}


			//inheritance
			public Inheritance()
			{
			A:B:C:D
			void -> new (virtual)-> virtual -> override
			void -> virtual-> override -> override
			A : D(C) => A

			virtual -> new virtual -> override
			A:C(D) =>A

			A:B:C:D
			virtual -> override-> virtual -> override
			A(B):D => B, C(D):D => D

			A,B:A,C:A
			virtual -> new
			B:B => A
			virtual -> override
			C:C => C


			}

			//copy past excel range to powwerpoint
			public void CopyRangeEmbeded(xlNS.Range rn_, pptNS.Slide ptSld, pptNS.Shape sh)
			{

			rn_.Application.Visible = true;
			rn_.Worksheet.Activate();
			rn_.Select();
			rn_.Copy();
			ptSld.Select();
			sh.Select();

			//needs thread sleep activation - unstable
			/*
			Thread.Sleep(500);
			sh.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
			Application.DoEvents();
			*/

			//copy but with standart format
			//ptSld.Application.ActiveWindow.View.PasteSpecial();
			//ptSld.Application.ActiveWindow.View.Paste();


			//ptSld.Shapes.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault, Microsoft.Office.Core.MsoTriState.msoFalse, "", 0, "", Microsoft.Office.Core.MsoTriState.msoTrue);
			//ptSld.Shapes.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault,,,,,);

			//ptSld.Application.ActiveWindow.View.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault);


			//PasteDestinationTheme
			//PasteAsEmbedded
			//PasteSourceFormatting
			//PasteExcelTableSourceFormatting


			//powerpointApplication.ActiveWindow.View.PasteSpecial();

			//only working example with correct shape and format
			//worked after first type commenting
			try
			{
			sh.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
			}
			catch (Exception e)
			{
			Logger.LogAddDebug(e.Message);
			}

			//sh.Application.ActiveWindow.Selection.Unselect();
			//sl.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
			}

			//copy pasy excel sheet to powwerpoint
			public void CopyChartEmbeded(xlNS.Shape ch, pptNS.Slide sl, pptNS.Shape sh)
			{
			ch.Copy();
			sl.Select();
			sh.Select();

			//paste as link
			//pptSlide.Shapes.PasteSpecial(pptNS.PpPasteDataType.ppPasteDefault, Microsoft.Office.Core.MsoTriState.msoFalse, "", 0, "", Microsoft.Office.Core.MsoTriState.msoTrue);
			//sh.Application.CommandBars.ExecuteMso("PasteSourceFormatting");
			//sh.Application.ActiveWindow.Selection.Unselect();
			//sl.Application.CommandBars.ExecuteMso("PasteSourceFormatting");

			try
			{
			sl.Application.CommandBars.ExecuteMso("PasteExcelChartSourceFormatting");
			}
			catch (Exception e)
			{
			Logger.LogAddDebug(e.Message);
			}
			//Thread.Sleep(1000);
			var a = sl.Application.ActiveWindow.Selection;
			}

		}
		
			public class Deploy()
			{
				
				public void IIS()
				{
					
					public void Mnual()
					{
						https://msdn.microsoft.com/en-us/library/1y1404zt.aspx
						1) Build Web API
						2) Create folder in IIS visible area
						3) CopyPast project
						4) Add site in iis -> set folder -> configure bindings (no name possible)
					}
					
				}
			
			}
		
		}

	}

	public class External_Libraries()
	{
				
	//reading excel
	http://epplus.codeplex.com/
	//Entity Framework extensions
	http://entityframework-extensions.net/
	//nUnit
	https://github.com/nunit/nunit
	
	
	
	}

	public class IssuesErrors()
	{

		//Issues\Errors
		public void .NET()
		{

		
			public CannotFindObject()
			{
			WHEN:
			incorrect connection string in : DbContext initialization parameters

			WHAT:
			Cannot find the object because it does not exist or you do not have permissions

			HOW:
			correct DbContext initialization
			}

			public ReferencePermissionWasDenied()
			{
			WHEN:
			migrating with code first model, with navigation properties and collection.
			Creating foreign key, constraint.

			WHAT:
			error:
			the reference permission was denied on the object '' database '', schema ''
			Cannot find the object '' because it does not exist or you do not have permissions
			could not create constraint.

			HOW:
			simle:
			(trying to migrate one after another commenting out not works - migrates both simultaneosly )
			create table with primary key. In sql manager give to users pemission rights
			Create table with collection.

			correct:
			change model to correct collection - navigation property. Collection in parent,
			foreign key with patent item property in child
			grant privilages
			use DWH_REPLICA;
			grant references To guest;
			go
			}

			public MethodFunctionNotFound()
			{
			WHEN:
			no EF in project referencing repository project

			WHAT: update EF
			}

			public System.Security.SecurityException()
			{
				WHEN:
				while windows service with InstallUtil.exe installation
				
				WHAT:
				Syste.Security.SecurityException
				
				WHOW:
				start console with administrative
			}
			
			public WCFhttpREGerror()
			{
				
				WHAT:
Протоколу HTTP не удалось зарегистрировать URL-адрес http://+:8000/Service1/. Текущий процесс не имеет прав доступа к этому 
пространству имен (подробнее см. на веб-странице http://go.microsoft.com/fwlink/?LinkId=70353)
				
				WHEN:
WCF service under console host
					
				HOW:
recommended to register port:
netsh http add urlacl url=http://+:8000/ServiceModelSamples/Service user=mylocaluser
				OR 
				start VS under admin 
			}
			
			public WCFCannot_btain_etadata_rom()
			{
				WHAT:
				Error: Cannot obtain Metadata from http://localhost:57495/WCF2.svc If this is a Windows (R) Communication Foundation service to which you have 
access, please check that you have enabled metadata publishing at the specified address.
				WHEN:
					testing wcf.svc from VS
				HOW:
					NOT enough memory free 
				OR: 
					
				
			}
		
			public sgen_exe()
			{
				sgen.exe exited with code 1
				//xml serialization turn off project options->build->xml 

				}

		public void SSAS()
		{
			
			///Installation
			///Donload instal SSDT from MS VS
			///Create Analysis services projects from VS templates
		
			public void Impersonation()
			{
				
				WHEN:
				While trying to proccess any item of olap cube from VS to create new database
				
				WHAT:
				Severity	Code	Description	Project	File	Line	Suppression State
				Error		?????????????? ??????????: ???????? ????????? ??? ??????? ImpersonationInfo. ???? ???????? ImpersonateAccount ???????????? ?????? ImpersonationInfo, ???????? Account ?? ????? ???? ??????.			0	
				
				HOW:
				in datasourses name rightclick ViewDesigner, in Impersonation Information input credentials
							
			}
		
			public void Database NameChange()
			{
				
				WHEN:
				
				WHAT:
				change olap database name
				
				WHOW:
				rtclck project properties - > deployment
				
			}
			
			public void DimensionProcessError()
			{
				
				WHEN:
				connecting via wrong login (Datasource base login instead of OLAP base)
				
				WHAT:
				cannot connect to database while login 
				
				WHOW:
				change credentials
				
			}
						
		}
		
	}	
	
		
	}
	
	#endregion 

	#region C++ 

	public Code theory
	{
		
		Escape characters{
			\n //new line
			\r //carriage return
			\t //tab
			\\ //backslash \
			\" quotation "
		}
		
		Operators
		{
			a %= b //a = a % b; 1 = 5/2;
			
			((cond) ? "true" : "false"); // ((i>2) ? "yes" :: "no");
			
			//pointers declaration
			int* a;
			int *a;
			
			
			
		}
		
		Structures
		{

			class enum Name 
			{
				T field
				,T2 field2
			};
			
			struct Name{
				T field;
				T2 field2;
			};		
			
			Pointers {
				//pointers with int address initialize
				int b=0;
				//&b - > address of b
				a=&b;
				//*a - > get pointed variable value with Dereference Operator
				
				char* pstr ;
				
				//Pointer addresses substraction
				char buffer[50];
				char* pbuffer = &buffer[0];
				while(*pbuffer){pbuffer++};
				int sbstr = pbuffer - buffer;
				
				double bean[3][4];
				double* pbean = &bean[0][0];
				double pb = *(*(bean+0)+0);
				double pb2 = *(bean[1]+2);
				double pb3 = *(bean+1)[2];
				double pb4 = (*(bean+1))[2];

				*(*(arr+i)+j)
			}
							
			
			
		}

		
		
	}

	public Code Examples
	{
		
		HowTo's
		{		
			sample_empty{
				
				//standart minimum include for cout
				#include <iostream>

				//namespace initialization
				using namespace std;

				int main()
				{
				cout << "HW";
				return 0;
				}
			}
			
			custom namespaceAdd{
				
	//standart minimum include for cout
	#include <iostream>

	//namespace initialization
	using namespace std;

	//custom namespace
	namespace ms {
		//function in namespace
		int return_zero()
		{
			return 0;
		}

		//void func
		void foo()
		{
			std::cout << "Empty foo() callsed";
		};
	}

	int main()
	{
		cout << "HW \n";

		//using void fucnt
		ms::foo();
		//using custom namespace
		return ms::return_zero();
	}

			}
			
			HelowWorld extended{
	//standart minimum include for cout
	#include <iostream>
	#include <array>

	//namespace initialization
	using namespace std;

	//class structures
	namespace Classes_
	{
		//enum classs
		enum class MyEnum
		{
			value1, value2 = 10, value3
		};

		//struc 
		struct Record {
			int ID;
			int num;
			char letter;
		};
	}

	namespace Functions_
	{
		void Function1()
		{	
			std::cout << "Function started - > " << __func__ << "; \r\n";
		}

		int Function2(int a, int b)
		{
			std::cout << "Function started - > " << __func__ << "; \r\n";
			return 0;
		}
		
		auto Function3() -> int
		{
			return 0;
		}

		auto Function4(double a, double b)
		{
			if (b == 0) { std::cout << "1" << __func__ << a / b; }
			std::cout << "2" << __func__ << a / b;
			return a / b;
		}
	}
	//custom namespace
	namespace ms {

		//function in namespace
		int return_zero()
		{
			return 0;
		}

		//void func
		void foo()
		{
			std::cout << "Empty foo() callsed";
		};

		void nl()
		{
			std::cout << "\r\n";
		}
		
		//Variables demonstration
		void Variables()
		{
			int uninitialized = 12;
			int initialized = 11;

			nl();

			std::cout << "Uninitialized->" << uninitialized << "\r\n";
			std::cout << "Initialized->" << uninitialized << "\r\n";

			std:cout << "nl->" << nl;
		}

		//Int cast and operator
		void Operators()
		{
			int i, x;
			i = 8;
			x = 2;
			i %= x;

			float flt = 1.234;
			int y;

			nl();
			std::cout << "  i % = x -> " << i << " i,x: " << i << ";" << x;
			
			nl();
			std::cout << "Float(f): " << flt << " (int)f -> " << (int)flt << "\r\n";
			std::cout << "Float(f): " << flt << " int(f) -> " << int(flt) << "\r\n";
			std::cout << "Float(f): " << flt << " static_cast<int>(f) -> " << static_cast<int>(flt) << "\r\n";

			nl();
			int i2 = 32767;
			short shrt;

			i2 *= 20;
			i2 += 153;

			i2 = 32769;

			nl();
			std::cout << "i2 -> " << i2;
			
			shrt = static_cast<short>(i2);

			nl();
			std::cout << "i2 % 32767 -> " << i2 % 32767 << "\r\n";
			std::cout << "shrt -> " << shrt;

			std::cout << "short 32768 to int -> " << static_cast<int>((short)32767) << "\r\n";
			std::cout << "short 32768 to int -> " << static_cast<int>((short)32768) << "\r\n";
			std::cout << "short 32769 to int -> " << static_cast<int>((short)32769) << "\r\n";
			std::cout << "short 32770 to int -> " << static_cast<int>((short)32770) << "\r\n";

			std::cout << "short 32770 to int -> " << static_cast<int>((short)(32768*2)) << "\r\n";
		}

		//enumerator print
		void EnumPrint()
		{
			Classes_::MyEnum  i = Classes_::MyEnum::value1;
			
			nl();
			std::cout<< "Classes_::MyEnum::Value1 -> " << (int)i;
			std::cout << "Classes_::MyEnum::Value1 -> " << (int)Classes_::MyEnum::value2;
		}
		
		//struct print
		void StructPrint()
		{
			Classes_::Record record = Classes_::Record();
			record.ID = 1;
			record.num = 15;
			record.letter = 'A';

			nl();
			std::cout << "Record -> " << record.ID << " " << record.letter << " " << record.num ;

			nl();
			
		}
		
		void Array()
		{
			std::array<int, 4> arr1;
			arr1 = { 9,8,7,6 };

			nl();
			for (int i = 0; i < arr1.size(); i++)
			{
				std::cout << " i=" << i << "; Arr[i]=" << arr1[i] << "; ";
			}


			//unexpected for i > declared
			//nl();
			//for (int i : arr1)
			//{
			//	std::cout << " i=" << i << "; Arr[i]=" << arr1[i] << "; ";
			//}

		}
		
		void Functions()
		{
			nl();
			Functions_::Function1();
			nl();
			Functions_::Function2(0, 1);
			nl();
			Functions_::Function3();
			nl();
			Functions_::Function4(5, 0);
			nl();
			Functions_::Function4(5, 3);
		}

		void Pointers()
		{
			int a = 10;
			int* p = &a;
			int** c = &p;

			std::cout << "a p &p &a *p-> " << a << " " << p << " " << &a << " " << &p << " " << *p;
			ms::nl();
			std::cout << "p c &p &c *p *c-> " << p << " " << c << " " << &p << " " << &c << " " << *p << " " << *c;
		}

	}


	int main()
	{
		cout << "HW \n";
		
		//using void fucnt
		ms::foo();

		ms::Variables();
		
		ms::Operators();

		ms::EnumPrint();

		ms::StructPrint();

		ms::Array();

		ms::Functions();

		//using custom namespace
		return ms::return_zero();
	}



			}
			
		}
		
	}

	#endregion

	#region JS5

	//js templates
	public void JS_templates()
	{
		public void JSLibs(){
			
			//awasomplete
			http://leaverou.github.io/awesomplete/
			//promitive.js
			https://ondras.github.io/primitive.js/
			//metro js
			http://www.drewgreenwell.com/projects/metrojs
			//treant js
			http://fperucic.github.io/treant-js/

		}
		public void Unsorted(){
	$(document).ready(function () {

	$(function () {
	var data = [50, 90, 30, 10, 70, 20];
	var w = 500;
	var h = 100;
	var svg = d3.select("#barChart")
	.attr("width", w)
	.attr("height", h);

	svg.selectAll("rect")
	.data(data)
	.enter()
	.append("rect")
	.attr("x", function (d, i) {
	return i * 21; //Bar width of 20 plus 1 for padding
	})
	.attr("y", function (d) {
	return h - d; //Height minus data value
	})
	.attr("width", 20)
	.attr("height", function (d) {
	return d; //Just the data value
	})
	.attr("fill", function (d) {
	return "rgb(0, 0, " + (d * 3) + ")";
	});
	});

	$("#GO").click(
	function () {

	//load data from Json action
	//$.getJSON("/Home/GetJson", databind);

	$.getJSON("GetJson", databind);

	//add d3 container
	var tableDiv = d3.select('body').append('div').attr('id', 'tableDiv').attr('class', 'table table-hover');
	console.log("Added container : ", tableDiv);

	//bind data from callback
	function databind(data) {
	console.log(data);

	var data3 = JSON.parse(JSON.stringify(data));
	console.log(data3);

	tabulate(data3, ['DT_REG', 'PAY_SYS', 'AMT']);

	};

	 

	}
	);


	});

	function tabulate(data, columns) {
	console.log('Started tabulate for ', data);
	var table = d3.select('body').append('table').attr('id', 'tabulated').attr('class', 'table table-hover');
	var thead = table.append('thead');
	var tbody = table.append('tbody');

	// append the header row
	thead.append('tr')
	.selectAll('th')
	.data(columns).enter()
	.append('th')
	.text(function (column) { return column; });

	// create a row for each object in the data
	var rows = tbody.selectAll('tr')
	.data(data)
	.enter()
	.append('tr');

	// create a cell in each row for each column
	var cells = rows.selectAll('td')
	.data(function (row) {
	return columns.map(function (column) {
	return { column: column, value: row[column] };
	});
	})
	.enter()
	.append('td')
	.text(function (d) { return d.value; });

	return table;
	}
		}
		
 public void Templates(){
			
			public void select2Template(){
				
var data_arr={};

function query_cleverence(processF,bindF){

	var restServerURL = "http://10.31.14.76/cleverence_ui/hs/IntraService/location/full"; 
	
	$.ajax({
	  type:"GET",
	  url: restServerURL ,
	  accepts: "application/json",
	  dataType:"json",	 	 	  
	  success: function(data, xhr, textStatus){
					 
		console.log("query_cleverenceSt")
		data_arr = processF(data);
		//console.log(data_arr);
		bindF('#input1');
		return data_arr;
		
	  },
	  error:function(jqXHR, textStatus, errorThrown){
					   alert(errorThrown);
	  }
	});
}

function processData(data){
	console.log('processData');
	var res = Object.keys(data).map(function(k) { return { id: data[k].GUID, text: data[k]["Адрес"] } });
	//console.log(res);
	return res;
}
function bindSelect2ToItem(item){
	var dt =[];	
	console.log("bindSelect2ToItem");
	$(item).select2({data: data_arr});	
}	

function registerSelect2(item,placeholder){
	$(item).select2({
		placeholder: placeholder,
		minimumInputLength: 3
	});
}
function registerSelect2Data(item)
{
	console.log("dt2 change");
	$(item).select2({data:data_arr});
}
function registerSelect2_FIO(item,placeholder){
	$(item).select2({
		tags: false,
		minimumInputLength: 3,
		placeholder: placeholder,
		language: "ru",
		ajax: {
			url: 'http://msk1-vm-inapp01.nspk.ru:81/api/structure/searchperson/',
			headers: {
					"authorization": "Basic cm9vdDptUiVtekpVR3ExRQ=="
				},
			dataType: "json",
			type: "GET",
			data: function (params) {

				var queryParameters = {
					p2: params.term
				}
				return queryParameters;
			},
			processResults: function (data) {
					console.log(data);
				return {
				
					results: $.map(data, function (item) {
						return {
							text: item.label ,
							id: item.login
						}
					})
				};
			}
			
		}
	});
}



function FireAndRegister(){
	query_cleverence(processData,bindSelect2ToItem);	
	registerSelect2("#input1",'Поиск GUID по адресу');
	registerSelect2Data("#input1");
	registerSelect2_FIO("#input2",'Поиск ФИО из 1С');
}

$(document).ready(function(){
	
	//console.log("Doc ready started")
	FireAndRegister()	
	
	// $("#input1").on("select2:focus", function(e) { console.log ("focus");})
	// .on("select2:selecting", function(e) { console.log ("selecting");})
	// .on("select2:highlight", function(e) { console.log ("highlight");})
	// .on("select2:change", function(e) { console.log ("change");})
	// .on("change", function(e) { console.log ("change2");})
	// .on("select2-blur", function(e) { console.log ("blur");})
	// .on("select2:blur", function(e) { console.log ("blur2");})
	
	//$("#input3").mouseenter(function(e){  registerSelect2Data("#input1"); console.log("mouseenter");})
	//$('.select2-search__field').on('keyup',function(e){  console.log("hover"); })
	//console.log("Doc ready finished")
	
});


			}
			
			public void CallBackSample1(){
				
							
				function f1(a,b){
					console.log("F1 " + a);
					b(a);
				};
				function f2(c)
				{
					console.log("F2 " + c);
				};

				function f3(a,b){
					console.log("F3 " + a);	
				};
				function f4()
				{
					console.log("F4 cb");
				};

				
			}
			
			public void CallBackSample2(){
	function cl(){ return "cl"; }

	function ret(a){ return a; }

	function cla(b){ return ret(b); }

	function call_cl(){
		return cl();
	}
	function call_ret(){
		return ret("ret");
	}
	function call_cla(){
		return cla("cla");	
	}

	function call_cl_a(){
		setTimeout ( function(){return cl();},1000);
	}
	function call_ret_a(){ 
		setTimeout ( function(){return ret("ret");},1000);
	}
	function call_cla_a(){
		setTimeout ( function(){return cla("cla");	},1000);
	}

	function sync_call() {
		clog(call_cl());
		clog(call_ret());
		clog(call_cla());
		
	};
	function async_call() {
		
			
		clog(call_cl_a());
		clog(call_ret_a());
		clog(call_cla_a());
	};

	function clog(a){ console.log(a); }

	$(document).ready(function(){
		console.log("Doc ready started")
		async_call();
		sync_call();
		console.log("Doc ready finished")
		
	});

			}
			
			public void Clousures(){
				
var x = "abovec";

function placeElement(e,v){
	v(e);
}
function log(e){
	console.log(e);
}
function mult(i_){
	for(i=0;i<i_;i++)
	{
		console.log(i);
	}
}

//self containing clousure
var z = (function(){return function(){console.log(z)}})();
//minimal closure
var a = (function(){
	return function () {
		return console.log("a");
	}
})();
//parametrized closure 
//can be used for function text exposure
var b = (function(d){
	return function (d) {
	return console.log(d);
	}
})();
//clousure exmpl
var add = (function(){
    var counter = 0;
    return function(){ console.log(counter); return counter += 1;}
})(); 

$(document).ready(function(){
	console.log("Document ready st");
	add();
	a();
	b(a);
	b(b);
	z();
	console.log("Document ready fn");
})

			}
						
			public void Callbacks(){
				
				
function log(a){console.log(a)}

//callback
function a(n){return function(b){console.log("A->" + n + " B->" + b)}}
//function callback
function L1(l1){return function(L2){ l1(L2); }}

//function reference callback
function cond1(a,b)
{
	if(a){ b() ;}
}
function ex(a,b)
{
	for(var i=0;i<a;i++)
	{
		b(i);
	}
}

var a_ = a("A1");


$(document).ready(function(){
	console.log("Document ready st");	
	a_();
	a_("B1");
	a("C1")("D1");
	
	L1(log)("L2");
	
	//condition callback
	cond1(5>2,function(){log(5)});
	
	//repeat callback
	ex(3,function(n){log(n);});
	
	//repeat from condition callback
	ex(5,function(n){
		cond1(n%2,function(){
			log(n);
		})
	});
	
	console.log("Document ready fn");
	
})


				
			}
			
			
			
		}
	}
	//JS vendors
	public void JSvendors()
	{
	<!--Links from vendors JQuery, jQyery UI, Bootstrap, D3 + styles-->
	<!--
	<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
	<link rel="nofollow" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/themes/smoothness/jquery-ui.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js"></script>
	<script type="application/javascript" charset="utf-8" src="http://d3js.org/d3.v3.min.js"></script>
	<link rel="nofollow" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	-->
	}


	//----------------------------------------------
	#endregion

	#region DB
	
	public void SQL()
	{
		
		//ORACLE
		//PL - sql server script templates
		public void PL_SQL()
		{
			
			public protected class ScriptExmaples()
			{
				
				public internal class TestDB()
				{

					public void WithConstraints() {
	/*
	alter table test3
	add primary key (C3)

	alter table test2
	add constraint test_pk 
	foreign key (c3) 
	references test3(c3)
	;

	delete from test2;

	insert into test2 (c1,c2) values ('TEST1','TEST1');
	insert into test2 (c1,c2) values ('TEST2','TEST2');
	insert into test2 (c1,c2) values ('TEST3','TEST3');
	commit;

	select to_char(c3,'dd.mm.yyyy hh24:mi:ss') from test2;
	commit;

	drop table purge;
	*/



					create table test_product(
					ID number constraint prod_id_pk primary key,
					INS_DATE date,
					product_name varchar(50)
					);

					create table test_types(
					ID number  constraint type_id_pk primary key,
					INS_DATE date,
					product_type varchar(50)
					);

					create table test_price(
					ID number ,
					INS_DATE date,
					DATE_FROM date,
					DATE_TO date,
					price number,
					prodcut_id  constraint test_product_price_PK references test_product(ID)
					);

					create table test_product_type (
					ID number ,
					INS_DATE date,
					product_id number,
					type_id number
					);


					/*Product table ID, date trigger on insert*/
					create or replace trigger test_prod_trg_ins
					before insert on test_product
					for each row
					declare 
					var_1 number;
					begin
					select max(ID) into var_1 from test_product;
					if var_1 is null
					then var_1 := 0;
					else
					var_1 := var_1+1;
					end if;
					:new.ID :=var_1;
					select sysdate into :new.INS_DATE from dual;
					end;
					/



					/*Product table date trigger on update*/
					create or replace trigger test_prod_trg_upd
					before update on test_product
					for each row
					begin
					select sysdate into :new.INS_DATE from dual;
					end;
					/




					/*Product table ID, date trigger on insert*/
					create or replace trigger test_prod_type_ins
					before insert on test_types
					for each row
					declare 
					var_1 number;
					begin
					select max(ID) into var_1 from test_types;
					if var_1 is null
					then var_1 := 0;
					else
					var_1 := var_1+1;
					end if;
					:new.ID :=var_1;
					select sysdate into :new.INS_DATE from dual;
					end;
					/

					/*Product table date trigger on update*/
					create or replace trigger test_prod_type_upd
					before update on test_types
					for each row
					begin
					select sysdate into :new.INS_DATE from dual;
					end;
					/



					/*Product table ID, date trigger on insert*/
					create or replace trigger test_price_ins
					before insert on test_price
					for each row
					declare 
					var_1 number;
					begin
					select max(ID) into var_1 from test_price;
					if var_1 is null
					then var_1 := 0;
					else
					var_1 := var_1+1;
					end if;
					:new.ID :=var_1;
					select sysdate into :new.INS_DATE from dual;
					end;
					/

					/*Product table date trigger on update*/
					create or replace trigger test_price_upd
					before update on test_price
					for each row
					begin
					select sysdate into :new.INS_DATE from dual;
					end;
					/


					alter table test_product_type
					add constraint test_product_type_PK
					foreign key (product_id) 
					references test_product(ID)
					;

					alter table test_product_type
					add constraint test_product_types_PK
					foreign key (type_id) 
					references test_types(ID)
					;



					insert into test_product (product_name) values ('Product_3');
					insert into test_product (product_name) values ('Product_5');
					insert into test_product (product_name) values ('Product_6');
					insert into test_product (product_name) values ('Product_7');
					insert into test_product (product_name) values ('Product_8');

					update test_product set product_name ='Product_3' where product_name='Product_2';
					update test_product set product_name ='Product_2' where product_name='Product_3';


					insert into test_types (product_type) values ('Product_type_1');
					insert into test_types (product_type) values ('Product_type_2');
					insert into test_types (product_type) values ('Product_type_3');


					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('01.01.2017','dd.mm.yyyy'),to_date('10.01.2017','dd.mm.yyyy'),1,10);
					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('15.01.2017','dd.mm.yyyy'),to_date('20.01.2017','dd.mm.yyyy'),1,20);
					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('25.01.2017','dd.mm.yyyy'),null,1,15);

					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('01.01.2017','dd.mm.yyyy'),to_date('10.01.2017','dd.mm.yyyy'),2,25);
					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('15.01.2017','dd.mm.yyyy'),to_date('20.01.2017','dd.mm.yyyy'),2,30);
					insert into test_price (date_from,date_to,prodcut_id,price) values (to_date('25.01.2017','dd.mm.yyyy'),null,2,45);


					insert into test_product_type(product_id,type_id) values (1,1);
					insert into test_product_type(product_id,type_id) values (2,1);
					insert into test_product_type(product_id,type_id) values (3,2);
					insert into test_product_type(product_id,type_id) values (4,2);
					insert into test_product_type(product_id,type_id) values (0,3);

					select * from test_product;
					select * from test_types; 
					select * from test_product_type;
					select * from test_price;


					/* !!!DANGER!!!
					execute maintain();
					*/

				}
					
					public void GollandDB()
					{
						
	--create 
	-------------------
	drop table employees;
	drop table project;
	drop table emp_pro;

	create table employees (
	emp_no int primary key,Name varchar(15), Address varchar(15), Profession varchar(15), dept_no int,
	manager_no int, Salary number );

	create table project (pro_name varchar(10), pro_no int , pro_mng int );

	create table emp_pro ( p_no int, emp_no int , precent_time number  );
	-------------------


	--insert
	-------------------
	insert into employees values (1001,'NAME 1001','Address_4','Proffession_7',1,1015,20000);
	insert into employees values (1002,'NAME 1002','Address_3','Proffession_4',4,1015,45000);
	insert into employees values (1003,'NAME 1003','Address_4','Proffession_7',1,1010,15000);
	insert into employees values (1004,'NAME 1004','Address_3','Proffession_2',3,1015,50000);
	insert into employees values (1005,'NAME 1005','Address_1','Proffession_3',4,1015,10000);
	insert into employees values (1006,'NAME 1006','Address_2','Proffession_3',2,1009,40000);
	insert into employees values (1007,'NAME 1007','Address_4','Proffession_5',2,1012,20000);
	insert into employees values (1008,'NAME 1008','Address_2','Proffession_7',1,1014,20000);
	insert into employees values (1009,'NAME 1009','Address_1','Proffession_3',4,1015,35000);
	insert into employees values (1010,'NAME 1010','Address_4','Proffession_7',4,1013,15000);
	insert into employees values (1011,'NAME 1011','Address_2','Proffession_5',2,1012,20000);
	insert into employees values (1012,'NAME 1012','Address_1','Proffession_3',2,1013,20000);
	insert into employees values (1013,'NAME 1013','Address_3','Proffession_3',4,1014,45000);
	insert into employees values (1014,'NAME 1014','Address_5','Proffession_2',4,1016,50000);
	insert into employees values (1015,'NAME 1015','Address_1','Proffession_3',4,1016,55000);
	insert into employees values (1016,'NAME 1016','Address_1','Proffession_7',3,1016,45000);



	insert into project values ('Prog 1',1,1001);
	insert into project values ('Prog 2',2,1003);
	insert into project values ('Prog 3',3,1001);
	insert into project values ('Prog 4',4,1001);
	insert into project values ('Prog 5',5,1003);
	insert into project values ('Prog 6',6,1008);
	insert into project values ('Prog 7',7,1001);
	insert into project values ('Prog 8',8,1001);
	insert into project values ('Prog 9',9,1003);
	insert into project values ('Prog 10',10,1008);
	insert into project values ('Prog 11',11,1002);
	insert into project values ('Prog 12',12,1004);
	insert into project values ('Prog 13',13,1004);
	insert into project values ('Prog 14',14,1003);
	insert into project values ('Prog 15',15,1004);
	insert into project values ('Prog 16',16,1005);



	insert into emp_pro values (1,1001,50);
	insert into emp_pro values (2,1003,21);
	insert into emp_pro values (3,1001,41);
	insert into emp_pro values (4,1001,76);
	insert into emp_pro values (5,1003,63);
	insert into emp_pro values (6,1008,3);
	insert into emp_pro values (7,1001,60);
	insert into emp_pro values (8,1001,98);
	insert into emp_pro values (9,1003,97);
	insert into emp_pro values (10,1008,68);
	insert into emp_pro values (11,1002,91);
	insert into emp_pro values (12,1004,55);
	insert into emp_pro values (13,1004,97);
	insert into emp_pro values (14,1003,5);
	insert into emp_pro values (15,1004,62);
	insert into emp_pro values (16,1005,74);
	-------------------




	--Q/A
	-------------------

	--1) All employes with the same Profession,dept_no as employee with id 1006
	with t as (
	select Profession,dept_no from employees
	where emp_no = '1006')
	, t2 as (
	select * from employees
	)
	select * from t2 
	join t on t2.Profession = t.Profession and t2.dept_no=t.dept_no;

	--2) progect number and progect manager name
	/*
	assuming, that manager of project is employee and we need not his name but
	to populate name of employee who is manager of an employee who is, in his turn,
	manager of a progect 
	*/
	select ep.pro_name,em2.Name from project ep
	left join employees em on ep.pro_mng = em.emp_no
	left join employees em2 on em2.emp_no=em.manager_no
	;

	--3) select amployees with salary > then their manager
	select em.emp_no,em.Name from employees em
	join employees em2 on em.manager_no=em2.emp_no
	where (em.salary > em2.salary)
	;

	--4) all amployees working on > 3 projects
	select * from employees em where em.emp_no in (
	select emp_no from emp_pro group by emp_no having (count (emp_no) >3)
	);

	--5) professions and salary of employees from same address as employee with max salary
	with t as(
	select em.profession,em.salary,em.address from employees em
	where em.salary =( select max(salary) from employees)
	)
	select em2.profession,em2.salary 
	from employees em2 join t on em2.address = t.address
	;
	-------------------

					}
				
				}
				public internal class Selection()
				{
					
					public datetime()
					{
						
						define ReqFnDate=to_date('30.06.2017 23:59:59','dd.mm.yyyy hh24:mi:ss');
						define ReqStDate=add_months(trunc(&ReqFnDate,'mm'),0);
						define TrStDate=add_months(&ReqStDate,-5);
						define TrFnDate=add_months(&ReqFnDate,+1);
						
					}

					public tableCreate()
					{
						
						//table with prim,sec keys
						create table teble(
						ID int not null identity(0,1), --not nullable id increasing from 0 by 1 every insert
						SEC_ID int null, --foreign key
						primary key(ID), -- indicates primary key
						foreign key(SEC_ID) references SEC_NAMES(ID), -- indicates secondary key and according key in other table
						)

						//create table add key add foreign key
						create table DWH_replica.dbo.table2 (
						ID int not null identity(0,1),
						TXT varchar(50),
						DT Datetime);

						alter table DWH_replica.dbo.table2
						add primary key (ID);

						create table DWH_replica.dbo.table1 (
						ID int not null identity(0,1),
						SEC_ID int null,
						primary key (ID),
						foreign key (SEC_ID) references DWH_replica.dbo.table2(ID));

					}
								
					public join_update()
					{
						
						/*update from join*/
						--\\\\\\\\\\\\\\\\\\
						update acquiring_month tt
						set (center,division) = (
						select f.rc,f.rp from tms.v_merchants t 
						join mtr_rc_rp_fins f on f.GEOGRAPHIC=t.GEOGRAPHIC_GID 
						where t.merchant=tt.merchant
						)
						where exists(
						select t.merchant,f.rc,f.rp from tms.v_merchants t 
						join mtr_rc_rp_fins f on f.GEOGRAPHIC=t.GEOGRAPHIC_GID 
						where t.merchant=tt.merchant
						)
						and tt.center is null and tt.division is null 
						--//////////////////


						--update from join with merge into 
						--\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

						select * from test1;
						select * from test2;

						delete from test1; delete from test2;

						insert into test1 (c1,c2) values ('A','1');
						insert into test1 (c1,c2) values ('B','1');
						insert into test1 (c1,c2) values ('C','1');
						insert into test1 (c1,c2) values ('D','1');
						insert into test1 (c1,c2) values ('E','1');
						insert into test1 (c1,c2) values ('F','1');

						insert into test2 (c1,c2) values ('A','2');
						insert into test2 (c1,c2) values ('B','3');
						insert into test2 (c1,c2) values ('C','4');

						merge into test1 t1
						using (select * from test2 t2) p
						on (t1.c1=p.c1)
						when matched then
						update set t1.c2=p.c2
						;

						--//////////////////////////////

					}

					public LEVEL()
					{
						
					--//level1
					SELECT * FROM

					(SELECT LEVEL R0 FROM dual CONNECT BY LEVEL <3),
					(SELECT LEVEL R1 FROM dual CONNECT BY LEVEL <5),
					(SELECT LEVEL R2 FROM dual CONNECT BY LEVEL <4)
					--///

					--// levle2
					select * from 
					( select level "C1" from dual connect by level <=10 ) t1
					full outer join ( select level "C1" from dual connect by level <=3 ) t2 on t1.c1<>t2.c1

					union all

					select * from 
					( select level "C1" from dual connect by level <=10 ) t1
					join ( select level "C1" from dual connect by level <=3 ) t2 on t1.c1=t2.c1
					--///

					}

					public partition_over()
					{
						
					select 
					min(rownum) 
					from (
					select t.*,count(*) over (partition by t.bin,t.bank) "CNT" from neprintsev_ia.ref_bin t
					) where cnt>1 group by bin,bank

					}

					public delete_duplicates()
					{
						
					delete from neprintsev_ia.ref_bin 
					where rowid in (
					select min(rowid) "RN" from neprintsev_ia.ref_bin  where bin in (
					select bin from neprintsev_ia.ref_bin having count(bin)>1 group by bin
					) group by bin
					)

					}

					public CURSOR()
					{
						/*SAMPLE CURSOR*/
						set serveroutput on;
						begin
						for cr in ( select merchant,reg_nr from ref_merchants )
						loop 
						  dbms_output.put_line('drop table ' || cr.merchant || ';');
						end loop;
						end ;

					}
					
					public CrossReference()
					{
											
											
						drop table Customers;
						drop table Invoices;

						create table customers ("ID" int primary key not null, Name varchar(10), "REF" int,
						constraint fk_ref foreign key("REF") references customers ("ID"));

						create table Invoices (id int primary key not null, Billing date,CustomerID int,
						constraint fk_inv foreign key(CustomerID) references customers (ID) );


						insert into customers values (0,'A',null);
						insert into customers values (1,'B',null);
						insert into customers values (2,'C',0);
						insert into customers values (3,'D',null);
						insert into customers values (4,'F',0);
						insert into customers values (5,'G',2);
						insert into customers values (6,'H',3);
						insert into customers values (7,'I',0);

						insert into invoices values (0,sysdate,0);
						insert into invoices values (1,sysdate,0);
						insert into invoices values (2,sysdate,2);
						insert into invoices values (3,sysdate,4);
						insert into invoices values (4,sysdate,3);
						insert into invoices values (5,sysdate,6);
						insert into invoices values (6,sysdate,7);
						insert into invoices values (7,sysdate,null);

						select * from Customers;
						select * from invoices t;

						select t.id,t.billing,t2.name,t3.name 
						from invoices t
						--left
						join Customers t2 on t2.id=t.customerId
						left join Customers t3 on t3.ID = t2.REF
						order by t.BILLING;



					}
					
					public UpdateCase()
					{
						
						drop table swap;
						create table swap (id int,c1 varchar(10), c2 varchar(10));
						insert into swap values (0,'f','m');
						insert into swap values (1,'m','f');
						insert into swap values (2,'f','m');

						update swap t
						set c1 = case when c1 is null then null when c1 = 'f' then 'm' else 'f' end  ;

						select * from swap;
					}
					
					public IntersectMinus()
					{
											
						drop table test_a;
						drop table test_b;

						create table test_a(id numeric,val varchar(10));
						create table test_b(id numeric,val varchar(10));

						insert into test_a values (10,'a');
						insert into test_a values (20,'b');
						insert into test_a values (30,'c');
						insert into test_a values (40,'d');
						insert into test_a values (50,'f');

						insert into test_b values (10,'a');
						insert into test_b values (30,'d');
						insert into test_b values (50,'f');

						with t as (select * from test_a t) ,
						t2 as (select * from test_b t)
						select * from t
						intersect
						select * from t2
						;

						with t as (select * from test_a t) ,
						t2 as (select * from test_b t)
						select * from t
						minus
						select * from t2
						;
					}
					
					public Rank()
					{
						
						--For Golland DbContext
						--RANK
	select * from (
	select ep.*, row_number() over(order by ep.salary desc) "RN"
	from employees ep
	) where "RN" = 10
	;

	with t as (
	select t.*,row_number() over (order by t.SAL desc ) "RN" from (
	select distinct ep.salary "SAL" from employees ep order by "SAL" desc
	) t ) 
	, t2 as (
	select * from employees ep
	)
	select * from t2
	join t on t2.salary = t.sal
	;

	select ep.dept_no,ep.name,max(ep.salary) "MAX",
	dense_rank() over (partition by ep.dept_no order by max(ep.salary) desc) "RANK"
	from employees ep
	group by ep.dept_no,ep.name
	order by "MAX" desc;


	select ep.*,
	max(ep.salary)  over (partition by ep.dept_no) as "MAX_DEP_SAL",
	avg(ep.salary)  over (partition by ep.dept_no) as "AVG_DEP_SAL",
	avg(ep.salary)  over (partition by ep.profession) as "AVG_PROF_SAL"
	from employees ep
	order by "MAX_DEP_SAL" desc;


	select 
	ep.*, 
	max(ep.salary) over() as "SAL"
	from employees ep
	;


	select ep.name,ep.dept_no
	--, max(ep.salary) over (partition by ep.dept_no order by ep.salary desc) "RANK"
	, max(ep.salary) keep (dense_rank first order by ep.salary desc) "RANK"
	from employees ep
	group by ep.name,ep.dept_no
	order by"RANK" desc

	; 


					}
					
				}
				
				public internal class MAINTANANCE()
				{
					
					public REFERENCES()
					{
						
						--//roles
						select * from role_tab_privs
						--//granted privileges
						select * from table_privileges
						revoke  select on acquiring_month from kokorina_jv
						--//all  user objects
						select * from user_objects
						--// TABLE modifications INSERT,DELETE,UPDATE
						select * from user_tab_modifications;
						//Objects source code
						select * from all_source
						//Procedure texts 
						select * from user_source  
						
						/*Unreferenced table names*/
						select distinct table_name,'select * from ' || table_name || ';' from all_tables where owner like '%NEPRIN%'
						and table_name not in (
						select distinct "REFERENCED_NAME" from user_dependencies 
						)
						;

						/*Unref and ungranted tables*/
						select distinct table_name,'select * from ' || table_name || ';' from all_tables where 1=1 
						and owner like '%NEPRIN%'
						--all tables that referenced from smwh
						and table_name not in (select distinct "REFERENCED_NAME" from user_dependencies )
						--all tables granted to somb
						and table_name not in (select table_name from user_tab_privs where owner like '%NEPRIN%')
						and table_name not like 'REF%'
						order by table_name asc
						;

						/*TABLE SIZE*/
						select segment_name "TABLE_NAME",bytes /1024/1024  "SIZE_MB" from 
						user_segments 
						order by "SIZE_MB" desc 
						;
						
					}			
								
					public Priviledges
					{
						revoke  select on acquiring_month from kokorina_jv
					}
					
					public TABLES_ALTER()
					{
						//change column type
						alter table ref_mc_ird_rates modify mcc varchar (50) 
					}
					
					public EXPLAIN_PLAN()
					{

						--//eplain table
						delete from PLAN_TABLE;
						EXPLAIN PLAN for
						select * from dual;
						select operation,options,object_name,cost , t.* from PLAN_TABLE t;
						SELECT * FROM TABLE (dbms_xplan.display);
						--//


						--//display cursor
						select * from table (DBMS_XPLAN.DISPLAY_CURSOR(null,null,'basic'))
						--// privilege needed: SELECT privilege on V$SQL_PLAN, V$SQL_PLAN_DETAIL,SELECT_CATALOG_ROLE
						--//

						--//Gather statistic
						Execute DBMS_STATS.GATHER_TABLE_STATS('neprintsev_ia','AMS_MC_BINS_',method_opt=>'FOR COLUMNS SIZE 254 columnName')
						--//

					}
					
					public DB_LINK()
					{
						
						
					drop  DATABASE LINK "DB_LINK.US.ORACLE.COM";

					CREATE DATABASE LINK "DB_LINK.US.ORACLE.COM"
					CONNECT TO DACQ_NEPRINTSEV
					IDENTIFIED BY  x2y4uecbbo
					USING '  (DESCRIPTION=
						(ADDRESS=
						  (PROTOCOL=TCP)
						  (HOST=exdt01-scan.rs.ru)
						  (PORT=1521)
						)
						(CONNECT_DATA=
						  (SERVER=dedicated)
						  (SERVICE_NAME=BUS)
						)
					  )
					'
					;
					}
							
					public JOBS()
					{
						
						select job,broken,interval,what,last_date,last_sec,next_date,next_sec from user_jobs order by job desc;
					
						DECLARE
						l_job NUMBER := 0;
						BEGIN
						DBMS_JOB.SUBMIT( l_job,what=>'P_TEMPLATE_DATE(sysdate,null,null);', 
						next_date=>trunc(sysdate,'dd')+1+2.5/24/60/60, -- start next hour 
						interval => 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+3+2.5/24');
						commit;
						END;
						
						DECLARE
						l_job NUMBER := 0;
						BEGIN
						DBMS_JOB.SUBMIT( l_job,what=>'p_gns_date(add_months(trunc(sysdate,''mm''),-1),add_months(trunc(sysdate,''mm''),0)-1/24/60/60,''GNS_JOB'');', 
						next_date=>trunc(sysdate,'dd')+1+2.5/24/60/60, -- start next hour 
						interval => 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+2+2.5/24');
						commit;
						END;

						exec dbms_job.run(163038);commit;

						BEGIN
						DBMS_JOB.REMOVE(131572);
						COMMIT;
						END;
					
					
						begin
						dbms_job.change(210250, null,to_date('19.08.2017 08:00:00','dd.mm.yyyy hh24:mi:ss'), 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+7+8/24');
						end;
						begin
						dbms_job.change(214250, null,to_date('19.08.2017 08:15:00','dd.mm.yyyy hh24:mi:ss'), 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+7+8/24');
						end;
						
						
						
						select * from user_jobs where job in (210250,214250,213974);


						begin
						dbms_job.change(210250, null,to_date('23.08.2017 13:30:00','dd.mm.yyyy hh24:mi:ss'), 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+7+8/24');
						commit;
						end;
						begin
						dbms_job.change(214250, null,to_date('08.09.2017 08:15:00','dd.mm.yyyy hh24:mi:ss'), 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+7+8/24');
						commit;
						end;
						begin
						dbms_job.change(213974, null,to_date('23.08.2017 14:20:00','dd.mm.yyyy hh24:mi:ss'), 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+7+8/24');
						commit;
						end;

						
						
						execute DBMS_JOB.BROKEN(212730,FALSE);
						execute dbms_job.change(212730, null,sysdate+0.15/24, 'next_day(trunc(sysdate,''dd''),''ВТОРНИК'')+0.3/24');

		
						begin
						dbms_job.change(212730, null,to_date('08.08.2017 00:00:00','dd.mm.yyyy hh24:mi:ss'), 'next_day(trunc(sysdate,' || '''' || 'mm' || '''' ||'),' || '''' || 'ВТОРНИК' || '''' ||  ')+0.3/24');
						end;

						--unBroke JOB
						EXEC DBMS_JOB.BROKEN(206923,FALSE);

						--change next date time
						EXECUTE dbms_job.change(206923,null,to_date('03.04.2017 00:00:00','dd.mm.yyyy hh24:mi:ss'),'add_months(trunc(sysdate,''mm''),1)+3');
				
				 begin 
				 DBMS_JOB.CHANGE
				   (213653
				   ,'P_BANK_FN(sysdate,''%*%'');'
				   ,trunc(sysdate,'dd')+1+1.5/24/60
				   ,'add_months(TRUNC(SYSDATE,''mm''),1)+3+1.5/24');
				   end ;
				   
					exec dbms_job.run(131571);commit;

					BEGIN
					   DBMS_JOB.REMOVE(131572);
					   COMMIT;
					END;
					
					/*JOBS UNBROKE*/
					/* Filename on companion disk: job5.sql */*
					CREATE OR REPLACE PROCEDURE job_fixer
					AS
				   /*
				   || calls DBMS_JOB.BROKEN to try and set
				   || any broken jobs to unbroken
				   */
				   
				   /* cursor selects user's broken jobs */
				   CURSOR broken_jobs_cur
				   IS
				   SELECT job
					 FROM user_jobs
					WHERE broken = 'Y';
						
					BEGIN
					   FOR job_rec IN broken_jobs_cur
					   LOOP
						  DBMS_JOB.BROKEN(job_rec.job,FALSE);
					   END LOOP;
					END job_fixer;
																				
					}
					
					public alter_session_lang()
					{
						ALTER SESSION SET NLS_DATE_LANGUAGE = 'ENGLISH'
						select to_char(sysdate,'Month') from dual 
					}
					
					public DROP_TABLES_BY_LIST()
					{
					-------------------------
					drop table temp3;
					drop table temp4;

					create table temp3 (c1 varchar (10));
					create table temp4 (c1 varchar (10),C2 INT);

					insert into temp3 (c1) values ('aa b aa');
					insert into temp3 (c1) values ('aa c aa');
					insert into temp3 (c1) values ('aa d aa');
					insert into temp3 (c1) values ('aa e aa');

					insert into temp4 (c1) values ('c');
					insert into temp4 (c1) values ('e');

					commit;

					set serveroutput on
					begin
					for c_c1 in (select c1 from temp3) loop
						for c_c2 in (select c1 from temp4) loop         
						  if c_c1.c1  like  '%' || c_c2.c1  || '%' then 
						  dbms_output.put_line(c_c1.c1  || ' like ' || '''%' || c_c2.c1  || '%'''); 
						  --insert into T_output (c1) VALUES (c_c1.c1  || ' like ' || '''%' || c_c2.c1  || '%''');
						  UPDATE TEMP4 SET C2 =1 WHERE C1=c_c2.C1;
						  end if;
						end loop;
					  end loop;
					end;
					-------------------------


					--BATTLE--
					-------------------------

					drop table t_table_to_delete;
					create table t_table_to_delete (t_name varchar(250),inprocedures int);

					--search selected tables in procedures and if used mark inprocedures as 1
					set serveroutput on
					begin
					for c_c1 in ( SELECT TEXT  FROM USER_SOURCE) loop
						for c_c2 in ( SELECT T_NAME   FROM T_TABLE_TO_DELETE) loop         
						  if c_c1.TEXT  like  '%' || c_c2.T_NAME  || '%' then 
						  dbms_output.put_line(c_c1.TEXT  || ' like ' || '''%' || c_c2.T_NAME  || '%'''); 
						  update T_TABLE_TO_DELETE set inprocedures =1 where t_name =c_c2.T_NAME and t_name not in 
						  (select distinct table_name from table_privileges );
						  end if;
						end loop;
					  end loop;
					end;


					--very very bad drop;
					set serveroutput on
					begin
					for c_c in (select * from t_table_to_delete where inprocedures !=1 and t_name not in 
						  (select distinct table_name from table_privileges )) loop
					  execute immediate ('drop table ' || c_c.t_name );
					  dbms_output.put_line('dropped :' || c_c.t_name);
					end loop;
					end ;
					-------------------------
					}
											
				}
				
				public internal class PLsql()
				{
					
					public P_TEMPLATE()
					{
						
						create or replace
						PROCEDURE P_EWALLET_D (ReqStIn date, ReqFnIn date, comment_ varchar )
						AUTHID CURRENT_USER
						IS
						jobStarted date; --sysdate of currentprocedure started
						jobFinished date; --sysdate of currentprocedure finished

						ReqStDate date;
						ReqFnDate date;

						rows_processed number;
						commentary varchar(200);

						BEGIN
						DBMS_OUTPUT.PUT_LINE('\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\');
						DBMS_OUTPUT.PUT_LINE('P_EWALLET_D STARTED');
						jobStarted := sysdate;
						rows_processed := 0;



						if(comment_ is null or comment_ = '' ) then 
						commentary := 'UNKNOWN' ;
						else
						commentary := comment_;
						end if;

						if(ReqStIn is not null and ReqFnIn is not null ) then
						ReqStDate := trunc(ReqStIn,'mm') ;
						ReqFnDate := trunc(ReqFnIn,'mm') ;
						else
						if(ReqStIn is null and ReqFnIn is null ) then
						ReqStDate := add_months(trunc(sysdate,'mm'),-1);
						ReqFnDate := add_months(ReqStDate,1)-1/24/60/60;
						else

						if(ReqStIn is null) then
						ReqStDate := trunc(ReqFnIn,'mm');
						ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
						end if;

						if(ReqFnIn is null) then 
						ReqStDate := trunc(ReqStIn,'mm');
						ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
						end if;
						end if;

						end if;









						--printing all date values to log

						DBMS_OUTPUT.PUT_LINE('Actual sysdate - ' || to_char(sysdate,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Received sysdate - ' || to_char(jobStarted,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Data period start date  - ' || to_char(ReqStDate,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Data period finish date  - ' || to_char(ReqFnDate,'dd.mm.yyyy hh24:mi:ss') || ';');


						--all procedure specific code goes here
						-->>>HERE<<<

						/*
						delete from T_EWALLETS_D where DATE_D between ReqStDate  and ReqFnDate;

						insert into T_EWALLETS_D


						select 
						trunc(m.request_date,'dd') "DATE_D",
						cast(fld_042 as varchar(10)) "MERCHANT",
						CASE
						WHEN fld_119 LIKE '%061150139059239%'
						THEN 'APP'
						WHEN fld_119 LIKE '%061150110030273%'
						THEN 'SMP'
						WHEN fld_119 LIKE '%061150120834693%'
						THEN 'ARP'
						ELSE '0'
						END "EWALLET",

						sum(m.FLD_004/100) "AMT",
						count(m.FLD_004) "CNT"

						FROM tms.RTPS_MESSAGES_LOG m
						where 1=1
						and m.request_date between ReqStDate  and ReqFnDate
						and cast(fld_042 as varchar(10)) in (
						select merchant from ref_merchants --where reg_nr = '7743543761'
						)
						and FLD_039 = '000'

						group by trunc(m.request_date,'dd') , cast(m.fld_042 as varchar(10)) ,
						CASE
						WHEN fld_119 LIKE '%061150139059239%'
						THEN 'APP'
						WHEN fld_119 LIKE '%061150110030273%'
						THEN 'SMP'
						WHEN fld_119 LIKE '%061150120834693%'
						THEN 'ARP'
						ELSE '0'
						END
						;

						commit;
						*/

						--ref_report_table
						--select max(rownum) into rows_processed from neprintsev_ia.T_ACQ_D where "DATE" between startRefresh and endRefresh;
						jobFinished:=sysdate;
						insert into neprintsev_ia.ref_report_table ("NAME",job_started,job_finished,data_start,data_finish,rows_processed, commentary) 
						values ('P_EWALLET_D', jobStarted,jobFinished,ReqStDate,ReqFnDate,rows_processed,commentary);
						DBMS_OUTPUT.PUT_LINE('P_EWALLET_D EXECUTED');
						DBMS_OUTPUT.PUT_LINE('//////////////////////////////////////////////////////////');

						--current procedure execution example
						/*
						set serveroutput on;
						execute P_TEMPLATE(sysdate);
						*/
						END P_EWALLET_D;
					}
					
					public P_TEMPLATE_DATE()
					{
						
						create or replace
						PROCEDURE P_TEMPLATE_DATE (ReqStIn date, ReqFnIn date, comment_ varchar )
						AUTHID CURRENT_USER
						IS
						jobStarted date; --sysdate of currentprocedure started
						jobFinished date; --sysdate of currentprocedure finished

						dataDate date;  --date wich is default for data quering (sysdate-2 for acquiring queries)
						dataStart date; --data period start date
						dataFinish date; --data period finish date

						rows_processed number;
						commentary varchar(200);

						ReqStDate date;
						ReqFnDate date;


						BEGIN
						DBMS_OUTPUT.PUT_LINE('\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\');
						DBMS_OUTPUT.PUT_LINE('P_TEMPLATE_DATE STARTED');
						jobStarted := sysdate;
						rows_processed := 0;


						if(comment_ is null or comment_ = '' ) then 
						commentary := 'UNKNOWN' ;
						else
						commentary := comment_;
						end if;

						if(ReqStIn is not null and ReqFnIn is not null ) then
						ReqStDate := trunc(ReqStIn,'mm') ;
						ReqFnDate := trunc(ReqFnIn,'mm') ;
						else
						if(ReqStIn is null and ReqFnIn is null ) then
						ReqStDate := add_months(trunc(sysdate,'mm'),-1);
						ReqFnDate := add_months(ReqStDate,1)-1/24/60/60;
						else

						if(ReqStIn is null) then
						ReqStDate := trunc(ReqFnIn,'mm');
						ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
						end if;

						if(ReqFnIn is null) then 
						ReqStDate := trunc(ReqStIn,'mm');
						ReqFnDate :=  add_months(ReqStDate,1)-1/24/60/60;
						end if;
						end if;

						end if;

						dataDate:=sysdate-2; --data default for most reports sysdate - 2
						dataStart:=trunc(dataDate,'mm'); --defining data date range start of month 
						dataFinish:=trunc(dataStart,'dd')-1/24/60/60; --defining data date range finish of month

						--printing all date values to log

						DBMS_OUTPUT.PUT_LINE('Actual sysdate - ' || to_char(sysdate,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Received sysdate - ' || to_char(jobStarted,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Data sysdate defined - ' || to_char(dataDate,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Data period start date  - ' || to_char(dataStart,'dd.mm.yyyy hh24:mi:ss') || ';');
						DBMS_OUTPUT.PUT_LINE('Data period finish date  - ' || to_char(dataFinish,'dd.mm.yyyy hh24:mi:ss') || ';');


						--all procedure specific code goes here
						-->>>HERE<<<


						--ref_report_table
						--select max(rownum) into rows_processed from neprintsev_ia.T_ACQ_D where "DATE" between startRefresh and endRefresh;
						jobFinished:=sysdate;
						insert into neprintsev_ia.ref_report_table ("NAME",job_started,job_finished,data_start,data_finish,rows_processed, commentary) 
						values ('P_TEMPLATE_DATE', jobStarted,jobFinished,dataStart,dataFinish,rows_processed,comment_);
						DBMS_OUTPUT.PUT_LINE('P_TEMPLATE_DATE EXECUTED');
						DBMS_OUTPUT.PUT_LINE('//////////////////////////////////////////////////////////');

						--current procedure execution example
						/*
						set serveroutput on;
						execute P_TEMPLATE(sysdate);
						*/
						END P_TEMPLATE_DATE;
						
					}
					
					public LoopByNumWithLevel()
					{
						
						set serveroutput on
						begin 
						for c1 in ( SELECT LEVEL R0 FROM dual CONNECT BY LEVEL <3 ) loop

						/*
						define dt = add_months(trunc(sysdate,'dd'),0) ;
						set serveroutput on
						execute P_ECOM_M_REFRESH(&dt);
						commit;
						*/
						DBMS_OUTPUT.put_line('Print ' || c1.R0 );

						end loop;
						end ;

					}
				}
				
				public internal class UNSORTED()
				{
				

		with t1 as
		(
		select 
		b.slip_count sCnt,
		b.department dep
		from tms.batches b
		where 
		b.card_type IN ('32','01','02','10','21','95','99','50')
		AND b.batch_date>='08.07.2013'
		AND b.batch_date <='14.07.2013'
		and b.department=9293963112
		)
		,
		t2 as (
		select 
		m.merchant merch
		from tms.merchants m
		join temp2 t on m.merchant=t.c1
		--where m.merchant=9290575240
		)

		select 
		t2.merch,
		sum(t1.sCnt) 
		from t1
		join t2 on t1.dep=t2.merch

		group by 
		t2.merch



		with t1 as
		(
		select 
		b.slip_count sCnt,
		b.department dep
		from tms.batches b
		where 
		b.card_type IN ('32','01','02','10','21','95','99','50')
		AND to_char(b.batch_date,'IW')='28'
		and b.department=9293963112
		)
		,
		t2 as (
		select 
		m.merchant merch,
		m.street address
		from tms.merchants m
		join temp2 t on m.merchant=t.c1
		--where m.merchant=9290575240
		)

		select 
		t2.merch,
		t2.address,
		sum(t1.sCnt) 
		from t1
		join t2 on t1.dep=t2.merch

		group by 
		t2.merch,
		t2.address



		select * from (
		with t1 as
		(
		select 
		b.slip_count sCnt,
		b.department dep,
		to_char(b.batch_date,'IW') wCnt
		from tms.batches b
		where 
		b.card_type IN ('32','01','02','10','21','95','99','50')
		AND to_char(b.batch_date,'IW') between '27' and '30'
		and to_char(b.batch_date,'yyyy') = '2013'
		and b.department=9293963112
		),t2 as (
		select 
		m.merchant merch,
		m.street address
		from tms.merchants m
		join temp2 t on m.merchant=t.c1
		--where m.merchant=9290575240
		)

		select 
		t2.merch,
		t2.address,
		t1.wCnt wCnt ,
		sum(t1.sCnt)  sCnt
		from t1
		join t2 on t1.dep=t2.merch

		group by 
		t2.merch,
		t2.address,
		t1.wCnt
		)
		pivot 
		(
		sum(sCnt) for wCnt in ('27','28','29','30')
		)



		/*disaster*/
		select  * from (
		with t1 as
		(
		select 
		b.slip_count sCnt,
		b.department dep,
		to_char(b.batch_date,'IW') wCnt
		from tms.batches b
		where 
		b.card_type IN ('32','01','02','10','21','95','99','50')
		AND to_char(b.batch_date,'IW') between '27' and '32'
		and to_char(b.batch_date,'yyyy') = '2013'
		--and b.department=9293963112
		)
		,
		t2 as (
		select 
		m.merchant merch,
		m.street address
		from tms.merchants m
		join temp2 t on m.merchant=t.c1
		--where m.merchant=9290575240
		)

		select 
		t2.merch,
		t2.address,
		t1.wCnt wCnt ,
		sum(t1.sCnt)  sCnt
		from t1
		join t2 on t1.dep=t2.merch

		group by 
		t2.merch,
		t2.address,
		t1.wCnt
		)
		pivot 
		(
		sum(sCnt) for wCnt in ('27','28','29','30','31','32')
		)




		create table disaster2  as

		select
		t.merchant merch,
		sum(sCnt) sCnt,
		t1.yYear || '_' || t1.wWeek wekkYear

		from 
		reg_journal_merchants t

		left join 
		(select 
		substr(p.chr1,instr(p.chr1,'#')+1, length(p.chr1)-instr(p.chr1,'#')) men_aqu,
		o.main_industry ind,
		m.merchant merch,
		m.street address,
		b.slip_count sCnt,
		b.department dep,
		to_char(b.batch_date,'IW') wWeek,
		to_char(b.batch_date,'yyyy') yYear

		from tms.merchants m

		join tms.batches b on b.department=m.merchant
		join orabis1.industry_code o on o.mcc=m.mcc
		join tms.merchant_par p on p.merchant=m.merchant

		where 
		b.card_type IN ('32','01','02','10','21','95','99','50')
		--where m.merchant=9290575240
		and to_char(b.batch_date,'IW')= '30'
		and to_char(b.batch_date,'yyyy') ='2013'
		)t1 on t.merchant=t1.merch

		group by 
		t.merchant,
		t1.yYear || '_' || t1.wWeek 


		select
		us.segment_name tName
		,to_char(us.bytes/us.max_size*100,'999.999') "AMT_RATE"
		,to_char((us.bytes/1024)/1024,'9999') "AMT_MBs"
		,to_char((us.max_size/1024)/1024 ,'9999') "mMax_(Mbs)"
		from
		user_segments us
		order by "AMT_MBs" desc
		;


		"
		"select
		us.segment_name tName
		,to_char(us.bytes/us.max_size*100,'90.99') "amount_%"
		,to_char((us.bytes/1024)/1024,'9999') "iIs_(Mbs)"
		,to_char((us.max_size/1024)/1024 ,'9999') "mMax_(Mbs)"
		from
		user_segments us

		union all 

		select 
		'All',
		to_char(sum(us2.bytes)/us2.max_size*100,'90,99')
		,to_char(sum(us2.bytes)/1024/1024,'9999')
		,to_char(us2.max_size/1024/1024,'9999')
		from user_segments us2
		group by 
		'all',us2.max_size
		"
		"select
		us.segment_name,
		to_char(us.bytes/1024/1024,'999990.99') "MB",
		to_char(us.max_size/1024/1024,'9999') "MD",
		to_char((us.bytes/1024/1024)/(us.max_size/1024/1024)*100,'9.99')
		from 
		user_segments us
		"
		"select * from temp4 
		select * from user_jobs;
		select * from user_procedures;




		execute  send_mail('ia-neprintsev@rsb.ru','ia-neprintsev@rsb.ru','EX-MB-05.rs.ru',25)

		create table disaster_tst
		as 

		select 
		t1.ind industry,t1.merch merchant,t2.yCnt || '_' || t2.wCnt week,sum(t2.sCnt) sCnt
		from 
		(
		select
		substr(p.chr1,instr(p.chr1,'#')+1, length(p.chr1)-instr(p.chr1,'#')) men_aqu,
		o.main_industry ind,
		m.merchant merch,
		m.street address
		from 
		tms.merchants m
		join reg_Journal_merchants t on m.merchant=t.merchant
		join orabis1.industry_code o on o.mcc=m.mcc
		join tms.merchant_par p on p.merchant=m.merchant
		where
		M.REGION='082' AND (M.MERCHANT LIKE '929%' OR M.MERCHANT LIKE '959%')
		) t1

		left join

		(
		select
		b.slip_count sCnt,
		b.department dep,
		to_char(b.batch_date,'IW') wCnt,
		to_char(b.batch_date,'yyyy') yCnt
		from
		tms.batches b
		where 
		b.card_type IN ('32','01','02','10','21','95','99','50')
		AND to_char(b.batch_date,'IW') between '29' and '29'
		and to_char(b.batch_date,'yyyy') = '2013'
		)t2

		on t1.merch=t2.dep

		group by

		t1.ind,t1.merch,t2.yCnt || '_' || t2.wCnt"
		"insert into DC_hash (mMonth,dt_reg , pay_sys,  type_transaction
		, abrv_name ,main_industry , merchant, issuer_type ,rc 
		,dbv_rub ,merchant_fee ,cnt_trans )

		SELECT /*+  ordered parallel(s,8) full(T) */ 
		to_char(s.dt_reg,'yyyy') || '_' || to_char(s.dt_reg,'mm') ,
			   s.dt_reg,
			   s.pay_sys pay_sys,      
			   s.type_transaction,     
			   m.abrv_name,
			   nvl(MC.main_industry,'Lodging') MAIN_INDUSTRY,
			   m.merchant,
			   s.issuer_type,
			   decode(rc.center,'??????','?????????????',rc.center) RC, 
			   SUM (-s.vl_rub) dbv_rub,
			   SUM (s.fee_merchant) merchant_fee,
			   SUM(s.cnt) cnt_trans 
		FROM vitr.V$SLIP_ACQ_D@db_link S
		LEFT JOIN TMS.MERCHANTS M ON (S.merchant=m.merchant)
		LEFT JOIN PRIV_DRR.ACQUIRING_REGION RC ON RC.REG_ID=M.REGION
		LEFT JOIN orabis1.industry_code MC ON (m.mcc = mc.MCC)
		where (s.type_transaction in ('Goods and service','Returns'))
		and s.merchant not in (9900000003, 9900000005, 9292121431, 9292296399, 9292434867, 9292886660, 9293471306) 
		AND nvl (s.acquire_bank, 'RS_RUS') != 'RS_UKR'      
		AND m.abrv_name NOT LIKE 'IB %'                                                     
		AND M.FULL_NAME NOT LIKE '%?????????%'
		AND M.FULL_NAME  != '??? ?? ???????'
		AND m.full_name  != '??? ??? ????????? ??????? ??????'  
		AND s.is_linked = 'N'
		AND s.dt_reg BETWEEN 
		TO_DATE('01.08.2013'||' 00:00:00','dd.mm.yyyy hh24:mi:ss') 
		AND 
		TO_DATE('24.08.2013'||' 23:59:59','dd.mm.yyyy hh24:mi:ss')

		GROUP BY  
		to_char(s.dt_reg,'yyyy') || '_' || to_char(s.dt_reg,'mm') ,
		s.dt_reg,
		s.pay_sys,      
		s.type_transaction,     
		m.abrv_name,
		nvl(MC.main_industry,'Lodging'),
		m.merchant,
		s.issuer_type,
		decode(rc.center,'??????','?????????????',rc.center) 
		  "
		"create table temp (c1 varchar(50),c2 varchar(50))

		insert into dc_base (merchant,create_date,year_num,week_num)

		select 
		t.c1,to_date(t.c2,'mm.dd.yyyy'),'2013','2'
		from
		temp t
		"
		"select * from temp4 
		select * from user_jobs;
		select * from user_procedures;


		DECLARE
		  l_job NUMBER := 0;
		BEGIN
		  DBMS_JOB.SUBMIT( l_job,what=>'P_CONTACTLESS;', 
		   next_date=>trunc(sysdate,'dd')+1, -- start next hour 
		   interval=>'trunc(sysdate,' || '''' || 'dd' || '''' ||')+1+1/24' );
		   commit;
		END;


		exec dbms_job.run(163038);commit;

		BEGIN
		   DBMS_JOB.REMOVE(131572);
		   COMMIT;
		END;

		begin 
		dbms_job.change(158018, null,to_date('12.09.2014 18:00:00','dd.mm.yyyy hh24:mi:ss'), 'trunc(sysdate+2,' || '''' ||  'dd' || '''' ||  ')+18/24');
		end;


		select to_char ( 'trunc(sysdate,' || '''' || 'dd' || '''' ||'+1/24' ) from dual 

		"
		"
		--jobs
		DECLARE
		  l_job NUMBER := 0;
		BEGIN
		  DBMS_JOB.SUBMIT( l_job,what=>'procedure1;',
		   next_date=>SYSDATE, -- start next hour 
		   interval=>'SYSDATE+5/1440');
		   commit;
		END;

		'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+2'

		exec dbms_job.interval(131622, 'sysdate+1/86400'); --every second
		exec dbms_job.interval(131622, 'trunc(sysdate)+24/24+6/24');

		select * from user_jobs;

		exec dbms_job.run(131634);commit;
		--11:15:43 11:17:49

		BEGIN
		   DBMS_JOB.REMOVE(131623);
		   COMMIT;
		END;
		"
		"select
		us.segment_name tName
		,to_char(us.bytes/us.max_size*100,'90.99') "amount_%"
		,to_char((us.bytes/1024)/1024,'9999') "iIs_(Mbs)"
		,to_char((us.max_size/1024)/1024 ,'9999') "mMax_(Mbs)"
		from
		user_segments us

		union all 

		select 
		'All',
		to_char(sum(us2.bytes)/us2.max_size*100,'90,99')
		,to_char(sum(us2.bytes)/1024/1024,'9999')
		,to_char(us2.max_size/1024/1024,'9999')
		from user_segments us2
		group by 
		'all',us2.max_size
		"
		"select
		us.segment_name,
		to_char(us.bytes/1024/1024,'999990.99') "MB",
		to_char(us.max_size/1024/1024,'9999') "MD",
		to_char((us.bytes/1024/1024)/(us.max_size/1024/1024)*100,'9.99')
		from 
		user_segments us
		"
		"create or replace
		PROCEDURE P_CONTACTLESS
		IS

		T_START VARCHAR2(256);
		T_END VARCHAR2(256);


		BEGIN
		  
		  T_START := TO_CHAR(sysdate, 'DD-MON-YYYY HH24:MI:SS');
		  
		 
		  DELETE T_CONTACTLESS
		  WHERE  TR_DATETIME >= TO_DATE(TO_CHAR(TRUNC(SYSDATE-7),'dd.mm.yyyy')||' 00:00:00','dd.mm.yyyy hh24:mi:ss');
		  
		  COMMIT;
		  
		  
		  
		  insert into T_CONTACTLESS ( IDMERCHANT,
									  TERM_ID,
									  TR_DATETIME,
									  REG_DATETIME,
									  CARD,
									  PROC_CODE,
									  TR_AMOUNT_RUR,
									  TR_COMMISSION_RUR,
									  FULL_NAME,
									  ABRV_NAME,
									  PAY_SYSTEM,
									  STREET,
									  DIVISION,
									  RC  
									)                 
		  WITH MSTR_F_SL AS (SELECT /*+ parallel(T,4) full(T) full(M) full(RC) */
											 T.IDMERCHANT,
											 T.TERM_ID,
											 T.BATCH_NR,
											 T.SLIP,
											 T.TR_DATE AS TR_DATETIME, -- ???? ? ????? ??????????
											 T.REG_DATE AS REG_DATETIME, -- ???? ? ????? ???????????
											 T.CARD,
											 T.BIN,
											 CASE WHEN T.PROC_CODE='20'
												  THEN 'Returns'
												  WHEN T.PROC_CODE='00'
												  THEN 'Goods and service'
											 END AS PROC_CODE,                                       
											 T.AMOUNT_RUR AS TR_AMOUNT_RUR,
											 T.COMMISSION_RUR AS TR_COMMISSION_RUR,
											 M.FULL_NAME,
											 M.ABRV_NAME,
											 M.CITY,
											 M.STREET,
										  CASE WHEN T.PAY_SYSTEM_ID=1
											   THEN 'A'
											   WHEN T.PAY_SYSTEM_ID=2
											   THEN 'V'
											   WHEN T.PAY_SYSTEM_ID IN (3,4) AND T.CARD_TYPE NOT IN ('85','80','60','70')
											   THEN 'M'
											   ELSE 'OTHER'
										  END AS PAY_SYSTEM,
										  RC.DIVISION,
										  DECODE(RC.CENTER,'??????','?????????????',RC.CENTER) RC 
										FROM MART.STG_MPCS_SLIPS_FACT T
										 LEFT JOIN TMS.MERCHANTS M ON TO_CHAR(T.IDMERCHANT)=M.MERCHANT
										 LEFT JOIN PRIV_DRR.ACQUIRING_REGION RC ON RC.REG_ID=M.REGION
							  WHERE T.TR_DATE>=TO_DATE(TO_CHAR(TRUNC(SYSDATE-30),'dd.mm.yyyy')||' 00:00:00','dd.mm.yyyy hh24:mi:ss')
								AND T.TR_DATE<=TO_DATE(TO_CHAR(TRUNC(SYSDATE),'dd.mm.yyyy')||' 23:59:59','dd.mm.yyyy hh24:mi:ss')
								AND 
								   (
									  (    T.PROC_CODE IN ('20')
										  AND T.TR_TYPE = '06'
									  )
									 OR (    T.PROC_CODE IN ('00')
											 AND T.TR_TYPE = '05'
										)
									)
						   )
		  SELECT /*+ parallel(A12,4) full(a11) full(a12) */
		  A11.IDMERCHANT,
		  A11.TERM_ID,
		  A11.TR_DATETIME,
		  A11.REG_DATETIME,
		  A11.CARD,
		  A11.PROC_CODE,
		  A11.TR_AMOUNT_RUR,
		  A11.TR_COMMISSION_RUR,
		  A11.FULL_NAME,
		  A11.ABRV_NAME,
		  A11.PAY_SYSTEM,
		  A11.STREET,
		  A11.DIVISION,
		  A11.RC
		  FROM MSTR_F_SL A11 
		  JOIN   MART.V_MSTR_SLIPS_FEATURES A12 ON  A11.BATCH_NR = A12.BATCH_NR  
												AND A11.SLIP = A12.SLIP 
												AND A12.POINT_CODE_7='M'
												AND A12.TR_DATE>=TO_DATE(TO_CHAR(TRUNC(SYSDATE-7),'dd.mm.yyyy')||' 00:00:00','dd.mm.yyyy hh24:mi:ss')
												AND A12.TR_DATE<=TO_DATE(TO_CHAR(TRUNC(SYSDATE),'dd.mm.yyyy')||' 23:59:59','dd.mm.yyyy hh24:mi:ss');

		  COMMIT;

		  T_END := TO_CHAR(sysdate, 'DD-MON-YYYY HH24:MI:SS');
		  
		END P_CONTACTLESS;"
		SELECT * FROM V$VERSION
		" select
		   r.row_numb as "1_UTRNNO",
		   'POS' as "2_TERMINAL_TYPE",
		   r.FLD_041 as "3_ORGDEV",
		   to_char(r.request_date,'ddmmyyyy') "4_UDATE",
		   to_char(r.request_date,'hh24:mi:ss') "5_TIME",
		   r.FLD_039 as "6_RESPCODE",
		   r.FLD_004/100 as "7_REQAMT",
		   
		   case
			  when FLD_039 <> '000'  and FLD_039 <> '400' then  r.FLD_004/100 
			  else 0
		   end 
		   as "8_ACTAMT",
		   
		   case 
			  when fld_003 like '00%' then 'purchase'
			  when fld_003 like '20%'then 'refund'
			  else 'other_value'
		   end 
		   as "9_TRANS_TYPE",
		   
		   case
			  when msg_type_in='1420' then 1
			  else   0
		   end
		   as "10_REVERSAL",
		   
		   FLD_026 as "11_MERCHANT",
		   
		   FLD_042 as "12_MERCHANT_ID",
		   
		   m.city,m.p_street,fld_043, --15-17 for columns
		   
		   case
			  when  cast(bg.bank_name as varchar2 (30 byte)) = '??????? ????????' then 47
			  else 0
			  end 
		   as "16_NWINDICATOR",

		case
		when substr(fld_022,7,1) = '9' then '2'
		when substr(fld_022,7,1) = '5' then '5'
		when substr(fld_022,7,1) = '6' then '6'
		when substr(fld_022,7,1) = 'M' then 'I'
		when substr(fld_022,7,1) = 'A' then 'B'
		else 'Z'
		end as "17_POS_DATA_CODE",

		case
		when substr(fld_022,8,1) = '0' then 0
		when substr(fld_022,8,1) = '1' then 1
		when substr(fld_022,8,1) = '5' then 5
		else 999
		end as "18_POS_DATA_CODE2",

		case 
		when substr(fld_022,8,1) = '1' then 0
		else 1
		end as "19_PINBLK",

		case 
		when substr(fld_022,9,1) = '1' then 3
		when substr(fld_022,9,1) = '1' then 0
		end as "20_PINBLK2"

		   from tms.RTPS_MESSAGES_LOG partition (P_20140101) r 
		   join tms.merchants m on cast(m.merchant as char(15 byte)) = r.fld_042
		   
		   left join MART.DQ_VITR_bin_guide bg 
		   on cast( bg.bin as VARCHAR2(30 BYTE)) =substr( r.fld_002,1,6)
		   
		   where FLD_042 
		   in (
			  select  cast(m.merchant as CHAR(15 BYTE) ) from tms.merchants m where abrv_name like '%MCDONALD%'
		   )
			   
		"
		"set serveroutput on
		"
		http://www.f-notes.info/oracle:what_where
		"/*PARTITION BY DATE + SUBPARTIOTION BY PAY_SYS + ROWMOVEMENT*/
		create table test5_p (
		C1 NUMBER,
		C2 VARCHAR2(50 BYTE),
		C3 date)

		partition by range (c3)
		subpartition by list (c2)
		(
		   partition P_1 values less than (to_date('01.01.2014 00:00:00','dd.mm.yyyy hh24:mi:ss'))
			  (
			  subpartition A_1 values ('A'),
			  subpartition V_1 values ('V'),
			  subpartition MC_1 values ('M'),
			  subpartition OTHER_1 values('OTHER'),
			  subpartition DEFAULT_1 values (DEFAULT)
			  ),
			 partition P_2 values less than (to_date('01.02.2014 00:00:00','dd.mm.yyyy hh24:mi:ss'))
			  (
			  subpartition A_2 values ('A'),
			  subpartition V_2 values ('V'),
			  subpartition MC_2 values ('M'),
			  subpartition OTHER_2 values('OTHER'),
			  subpartition DEFAULT_2 values (DEFAULT)
			  )

		)ENABLE ROW MOVEMENT;"
		"/*testing for unique values*/

		insert into test3 values (1,'a',1);
		insert into test3 values (1,'b',2);
		insert into test3 values (2,'a',2);
		insert into test3 values (3,'a',2);
		insert into test3 values (3,'b',1);
		insert into test3 values (4,'b',1);



		insert into test3 values (1,'c',1);
		insert into test3 values (2,'a',3);
		insert into test3 values (3,'c',3);
		insert into test3 values (4,'b',3);



		with t1 as (

		select  distinct c1,case when c2 ='b'  then  'b' else 'nb' end "C2"  from test3 where c2='b'

		union all

		select distinct  c1,case when c2 = 'b' then 'b' else 'nb' end "C2"  from test3 where c2<>'b'
		and c1 not in (select c1 from test3 where c2='b')

		), 
		t2 as (
		/*select if just one 2 then 2 if none 2 then a unique c3*/
		select  distinct c1,case when c3 =2 then 'two' else 'ntwo' end "C3"  from test3 where c3=2

		union all

		select  distinct c1,case when c3 =2 then 'two' else 'ntwo' end "C3"  from test3 where c3<>2
		and c1 not in (
		select  c1 from test3 where c3=2)

		)
		select 
		t1.c1,t1.c2,t2.c3
		from t1 
		join t2 on t2.c1=t1.c1



		"/*GRANT OVERAL*/
		begin 
		for temp_name in (
		  select table_name from user_tables 
		  --where table_name in ('TEMP','TEMP2','TEMP3','TEMP4') 
		  ) loop
		  execute immediate 'grant select,insert,delete  on neprintsev_ia.' || temp_name.table_name || ' to neprintsev_ia';
		  end loop;
		  end ;
		  "
		"/*REPORT TABLE*/
		select  
		finished,name_,to_char(started,'dd.mm.yyyy hh24:mi:ss'),to_char(finished,'dd.mm.yyyy hh24:mi:ss'),execution_time,date_from,date_to,rows_count
		from report_table 
		"
		"/*DISTINCT LEFT JOIN SELECT FOR SEVERAL LISTS*/
		create table test1(c1 varchar(10),c2 date,c3 number);
		create table test2(c1 varchar(10),c2 date,c3 number);
		create table test3(c1 varchar(10),c2 date,c3 number);

		insert into test1 values  ('A',sysdate-3,1);
		insert into test1 values ('A',sysdate-3,2);
		insert into test1 values ('A',sysdate-3,3);
		insert into test1 values ('B',sysdate-3,1);
		insert into test1 values ('B',sysdate-3,2);
		insert into test1 values ('B',sysdate-3,3);

		insert into test1 values  ('A',sysdate-4,1);
		insert into test1 values ('A',sysdate-4,2);
		insert into test1 values ('A',sysdate-4,3);
		insert into test1 values ('B',sysdate-4,1);
		insert into test1 values ('B',sysdate-4,2);
		insert into test1 values ('B',sysdate-4,3);

		insert into test2 values ('A',sysdate-4,1);
		insert into test2 values ('A',sysdate-4,2);
		insert into test2 values ('A',sysdate-4,3);
		insert into test2 values ('B',sysdate-3,1);
		insert into test2 values ('B',sysdate-3,2);
		insert into test2 values ('B',sysdate-3,3);

		insert into test3 (c1) values ('A');
		insert into test3 (c1) values ('B');
		insert into test3 (c1) values ('C');
		insert into test3 (c1) values ('D');



		with t3 as (select t3.c1 "C1" from test3 t3 ),
		t2 as(
		select t1.c1 "C1",sum(t2.c3*t1.c3) "C3" from test1 t1
		left join test2 t2 on t1.c1=t2.c1
		where trunc(t1.c2,'dd') = trunc(sysdate-3,'dd')
		group by  t1.c1
		)
		select 
		t3.c1,t2.c3 from t3 
		left join t2 on t2.c1=t3.c1;"
		"/*IB*/
		select * from ORAWH.IB_CLIENT_MV where client_name like '%?????????%'
		select * from ORAWH.IB_REQ_MV where client_id ='3595559'
		select * from ORAWH.IB_QNA_MV where user_id = '3576169'
		select * from ORAWH.IB_USERS_MV where user_id = '3576169'

		--client person user
		'3595559' '3595802' '3576169'
		3595802


		select * from ORAWH.IB_ACCOUNT_MV
		select * from ORAWH.IB_USER_LOCK_MV
		select * from ORAWH.MB_ABONENT_LIST
		select * from ORAWH.V_IB_CLIENT_ID
		select * from ORAWH.IB_INTERNAL_PMT_REQ_MV
		select * from ORAWH.IB_DEP_REQ_MV
		select * from ORAWH.IB_DOMESTIC_PMT_MV
		select * from ORAWH.IB_PUBLIC_SERVICE_REPMT_REQ_MV
		select * from ORAWH.IB_PUBLIC_SRV_REPMT_REQ_PAR_MV
		select * from ORAWH.IB_BEN_PHONE_PMT_MV
		select * from ORAWH.IB_BANK_CARD_ISSUE_REQ_MV
		select * from ORAWH.IB_REQ_TMPL_MV
		select * from ORAWH.IB_REQ_SIGN_MV
		select * from ORAWH.IB_SERVICE_ENABLE_REQ_MV
		select * from ORAWH.IB_BANK_CARD_OD_LIMIT_REQ_MV
		select * from ORAWH.IB_AGR_LIM_REQ_LIM_MV
		select * from ORAWH.IB_CARD_PMT_REQ_MV
		select * from ORAWH.IB_REGUL_ORDER_MV
		"
		"create or replace
		PROCEDURE P_REGEX
		AUTHID CURRENT_USER
		IS
		pattern  varchar(250);
		Cursor CR is select t.REGEX_PATTERN from neprintsev_ia.ref_regex_pattern t where t.REGEX_PATTERN is not null;

		BEGIN
		delete from neprintsev_ia.ref_regex_ent;
		 DBMS_OUTPUT.PUT_LINE('Deleted from ref_regex_ent');  
		 
		  for C1 in CR loop
			insert into neprintsev_ia.ref_regex_ent(ENTITY,REGEX_PATTERN) select m.merchant,C1.REGEX_PATTERN  from neprintsev_ia.ref_merchants m where regexp_like(upper(m.street),trim(upper(C1.REGEX_PATTERN))) and m.city ='MOSKVA';
			--insert into neprintsev_ia.ref_regex_ent(ENTITY,REGEX_PATTERN) select m.merchant,C1.REGEX_PATTERN from neprintsev_ia.ref_merchants m;--regexp_like(upper(m.street),upper(C1.C3));
			DBMS_OUTPUT.PUT_LINE(C1.REGEX_PATTERN);    
		  end loop;  
		END P_REGEX;"
		"set serveroutput on
		DECLARE
		   TYPE EmpCurTyp IS REF CURSOR;
		   emp_cv   EmpCurTyp;
		   emp_rec  ref_regex_pattern%ROWTYPE;
		   sql_stmt VARCHAR2(250);
		   sql_stmt2 varchar(250);
		   v_job   number := 10;
		BEGIN
		   sql_stmt := 'SELECT * FROM ref_regex_pattern WHERE rownum <= :j';
		   sql_stmt2 := 'INSERT INTO temp7(c1) select m.merchant from ref_merchants m where regexp_like(upper(m.street),upper(:a)) ';
		   OPEN emp_cv FOR sql_stmt USING v_job;
		   LOOP
			 FETCH emp_cv INTO emp_rec;
			 EXIT WHEN emp_cv%NOTFOUND;
			 DBMS_OUTPUT.PUT_LINE('Name: ' || emp_rec."NAME");
			 execute immediate sql_stmt2 using emp_rec."NAME";
		   END LOOP;
		   CLOSE emp_cv;
		END;

		"
		"define fnRegDate = trunc(sysdate,'dd')-1/24/60/60
		define stRegDate = trunc(&fnRegDate,'mm')

		define stSLDate = add_months(trunc(&stRegDate,'mm'),-5)
		define fnSLDate = trunc(add_months(trunc(&fnRegDate,'mm'),+2),'mm')-(1/24/60/60)


		select
		to_char(&fnRegDate,'dd.mm.yyyy hh24:mi:ss') "FNREG",
		to_char(&stRegDate,'dd.mm.yyyy hh24:mi:ss') "STREG",
		to_char(&fnSLDate,'dd.mm.yyyy hh24:mi:ss') "FNSL",
		to_char(&stSLDate,'dd.mm.yyyy hh24:mi:ss') "STSL"
		from dual;
		"
		"create type emp_obj is object (empno number, ename varchar2(10));
		create type emp_tab is table of emp_obj;

		create or replace function all_emps return emp_tab
			is
			  l_emp_tab emp_tab := emp_tab();
			   n integer := 0;
		   begin
		   
			  for r in (select c1 empno, c2 ename from temp)
			  
			  loop
				  l_emp_tab.extend;
				  n := n + 1;
				l_emp_tab(n) := emp_obj(r.empno, r.ename);
			  end loop;
			  
			  return l_emp_tab;
		   end;
		   
		select * from table (all_emps);"
		"CREATE OR REPLACE function get_daily
		  RETURN SYS_REFCURSOR
		AS
		  my_cursor SYS_REFCURSOR;
		BEGIN
		  OPEN my_cursor FOR SELECT * FROM temp_acq_d;
		  RETURN my_cursor;
		END get_daily;


		begin 
		select get_daily from dual;
		end ;
		"
		"create or replace
		procedure get_daily(out_dt out SYS_REFCURSOR)
		 AS
		BEGIN
		  OPEN out_dt FOR SELECT * FROM neprintsev_ia.temp_acq_d where rownum <=10;
		END get_daily;"
		CREATE USER 'test_user3'@'localhost' IDENTIFIED BY 'QwErT234';
		GRANT create,select ON temp_db.* TO 'test_user2'@'10.14.16.48' IDENTIFIED BY 'QwErT234';
		"insert into temp2 (c1,c2,c3) values ('1',to_date('01.01.2015','dd.mm.yyyy'),'3');
		insert into temp2 (c1,c2,c3) values ('1',to_date('02.01.2015','dd.mm.yyyy'),'0');
		insert into temp2 (c1,c2,c3) values ('2',to_date('01.01.2015','dd.mm.yyyy'),'0');
		insert into temp2 (c1,c2,c3) values ('3',to_date('01.01.2015','dd.mm.yyyy'),'0');
		insert into temp2 (c1,c2,c3) values ('4',to_date('03.01.2015','dd.mm.yyyy'),'0');
		insert into temp2 (c1,c2,c3) values ('4',to_date('04.01.2015','dd.mm.yyyy'),'3');


		with t as (
		select c1,max(c2) c2 from temp2 group by c1
		) ,
		t2 as (
		select t.c1,t.c2,t.c3 from temp2 t
		)

		select t2.* from t2 
		join t on t2.c1=t.c1 and t2.c2=t.c2
		"
		"//------------------------------------

		create table t_daily_d
		(
		"ID" number not null,
		"PAY_SYS" varchar(10) not null,
		constraint pk_daily_id primary key ("ID")
		)

		------------------------------------
		drop sequence seq_d ;
		Create sequence seq_d start with 1
		increment by 1
		minvalue 1
		maxvalue 1000000000;

		------------------------------------

		insert into t_daily_d 
		values
		(seq_d.nextval,'A')

		------------------------------------"
		"create table test1 (c1 date,c2 varchar(10),c3 varchar(10),c4 number) ;


		insert into test1 select sysdate-68,'2','10',0.564032697547684  from dual ;
		insert into test1 select sysdate-97,'4','15',0.329087048832272  from dual ;
		insert into test1 select sysdate-140,'1','15',1.66015625  from dual ;
		insert into test1 select sysdate-165,'4','12',0.630021141649049  from dual ;
		insert into test1 select sysdate-171,'5','14',1.21212121212121  from dual ;
		insert into test1 select sysdate-220,'2','13',0.805111821086262  from dual ;
		insert into test1 select sysdate-227,'3','10',0.878048780487805  from dual ;
		insert into test1 select sysdate-283,'4','10',1.50922509225092  from dual ;
		insert into test1 select sysdate-338,'3','10',0.868217054263566  from dual ;
		insert into test1 select sysdate-383,'3','14',2.36526946107784  from dual ;
		insert into test1 select sysdate-429,'1','13',0.316062176165803  from dual ;
		insert into test1 select sysdate-499,'3','13',0.92817679558011  from dual ;
		insert into test1 select sysdate-547,'3','15',0.226299694189602  from dual ;
		insert into test1 select sysdate-609,'1','13',0.809128630705394  from dual ;
		insert into test1 select sysdate-628,'5','13',0.0595238095238095  from dual ;
		insert into test1 select sysdate-635,'3','13',1.03562945368171  from dual ;
		insert into test1 select sysdate-674,'3','12',0.242811501597444  from dual ;
		insert into test1 select sysdate-715,'1','11',0.80672268907563  from dual ;
		insert into test1 select sysdate-787,'4','15',2.21739130434783  from dual ;
		insert into test1 select sysdate-834,'5','15',0.651764705882353  from dual ;
		insert into test1 select sysdate-879,'2','10',0.799086757990868  from dual ;
		insert into test1 select sysdate-944,'1','13',0.60958904109589  from dual ;
		insert into test1 select sysdate-958,'1','10',0.462222222222222  from dual ;
		insert into test1 select sysdate-1021,'5','10',2.50617283950617  from dual ;
		insert into test1 select sysdate-1054,'1','11',1.04618937644342  from dual ;
		insert into test1 select sysdate-1076,'1','11',0.0290909090909091  from dual ;
		insert into test1 select sysdate-1109,'2','11',1.10096153846154  from dual ;
		insert into test1 select sysdate-1143,'3','14',0.514285714285714  from dual ;
		insert into test1 select sysdate-1191,'2','13',0.123711340206186  from dual ;
		insert into test1 select sysdate-1211,'4','15',0.469565217391304  from dual ;
		insert into test1 select sysdate-1245,'1','10',0.176339285714286  from dual ;
		insert into test1 select sysdate-1322,'5','15',0.324786324786325  from dual ;
		insert into test1 select sysdate-1384,'5','11',1.01793721973094  from dual ;
		insert into test1 select sysdate-1437,'4','13',0.264018691588785  from dual ;
		insert into test1 select sysdate-1466,'3','13',0.794029850746269  from dual ;
		insert into test1 select sysdate-1486,'5','11',0.507418397626113  from dual ;
		insert into test1 select sysdate-1513,'1','10',0.302884615384615  from dual ;
		insert into test1 select sysdate-1555,'5','12',0.864406779661017  from dual ;
		insert into test1 select sysdate-1633,'3','15',0.612385321100917  from dual ;
		insert into test1 select sysdate-1661,'4','10',0.545454545454545  from dual ;
		insert into test1 select sysdate-1731,'4','12',0.51875  from dual ;
		insert into test1 select sysdate-1747,'3','12',0.952479338842975  from dual ;
		insert into test1 select sysdate-1823,'1','12',0.35978835978836  from dual ;
		insert into test1 select sysdate-1894,'3','15',0.380129589632829  from dual ;
		insert into test1 select sysdate-1924,'5','10',0.603723404255319  from dual ;
		insert into test1 select sysdate-1936,'3','10',0.665271966527197  from dual ;
		insert into test1 select sysdate-1944,'2','11',1.48262548262548  from dual ;
		insert into test1 select sysdate-2009,'2','11',0.0341463414634146  from dual ;
		insert into test1 select sysdate-2082,'2','13',2.70285714285714  from dual ;
		insert into test1 select sysdate-2123,'2','14',0.912955465587045  from dual ;
		insert into test1 select sysdate-2203,'5','11',4.46728971962617  from dual ;
		insert into test1 select sysdate-2279,'4','10',0.127348643006263  from dual ;
		insert into test1 select sysdate-2296,'1','12',1.04892966360856  from dual ;
		insert into test1 select sysdate-2354,'5','13',1  from dual ;
		insert into test1 select sysdate-2412,'4','12',1.02762430939227  from dual ;
		insert into test1 select sysdate-2440,'3','10',0.911458333333333  from dual ;


		--select maximum by indexed column from date
		with t as (
		select
		--c4 "RT",
		c2 || '_' || c3 "IND",
		max(c1) "DATE"
		from test1
		group by c2 || '_' || c3
		)
		,
		t2 as (
		select
		c4 "RT",
		c2 || '_' || c3 "IND",
		c1 "DATE"
		from test1
		)

		select t2.* from t2
		join t on t.IND = t2.IND and t."DATE"=t2."DATE"
		"
		"drop table test_number;
		drop table test_number_min_max;

		CREATE TABLE test_number("ID_T" NUMBER,SEQ NUMBER,text VARCHAR2(5));
		INSERT INTO test_number VALUES(1,1,'AA');
		INSERT INTO test_number VALUES(1,3,'CC');
		INSERT INTO test_number VALUES(1,4,'DD');
		INSERT INTO test_number VALUES(1,5,'EE');
		INSERT INTO test_number VALUES(1,6,'FF');
		INSERT INTO test_number VALUES(1,7,'GG');
		INSERT INTO test_number VALUES(1,8,'HH');
		INSERT INTO test_number VALUES(1,10,'JJ');
		INSERT INTO test_number VALUES(2,1,'KK');
		INSERT INTO test_number VALUES(2,2,'LL');
		INSERT INTO test_number VALUES(2,3,'MM');
		INSERT INTO test_number VALUES(2,4,'NN');
		INSERT INTO test_number VALUES(2,6,'PP');
		INSERT INTO test_number VALUES(2,7,'QQ');
		INSERT INTO test_number VALUES(3,1,'TT');
		INSERT INTO test_number VALUES(3,4,'ZZ');
		INSERT INTO test_number VALUES(3,5,'XX');

		--///////////////////
		--//min max
		create table test_number_min_max("ID_T2" number,"MIN" number,"MAX" number);
		INSERT INTO test_number_min_max VALUES(1,1,12);
		INSERT INTO test_number_min_max VALUES(2,1,9);
		INSERT INTO test_number_min_max VALUES(3,1,5);

		--"oldschool" syntax
		SELECT "RWN" "ID_T3","ROWN" seq FROM 

		(SELECT ROWNUM "ROWN" FROM all_objects WHERE ROWNUM <13),
		(SELECT ROWNUM "RWN" FROM all_objects WHERE ROWNUM <4),
		test_number_min_max m

		WHERE "RWN"="ID_T2" AND "ROWN" >= "MIN" AND "ROWN" <= "MAX" AND ("RWN","ROWN") NOT IN
		(SELECT "ID_T",seq FROM test_number)


		--join syntax
		select t."RWN",t3."ROWN" from
		(SELECT ROWNUM "RWN" FROM all_objects WHERE ROWNUM <4) t
		join test_number_min_max t2 on t2."ID_T2" = t."RWN"
		join (SELECT ROWNUM "ROWN" FROM all_objects WHERE ROWNUM <13) t3 on t3."ROWN" >= t2."MIN" and  t3."ROWN" <= t2."MAX"

		where (t."RWN",t3."ROWN" ) not in (SELECT "ID_T",seq FROM test_number)

		--//\\\\\\\\\\\\\\\\\\\\\\\
				}
			}
				
				public class procedures()
				{
					
					public void MAINTAIN()
					{
						
						create or replace
	procedure maintain as
	begin


	begin
	  for rec in (
	select * from all_objects where owner like '%NEPRIN%' and (object_name like 'TEMP_%' or object_name like '%TEST%') 
	)
	  loop  
		begin 
		  if rec.object_type= 'TABLE' then 
		   EXECUTE IMMEDIATE 'DROP '
								  || rec.object_type
								  || ' "'
								  || rec.object_name
								  || '" CASCADE CONSTRAINTS';
			 ELSE
				EXECUTE IMMEDIATE 'DROP '
								  || rec.object_type
								  || ' "'
								  || rec.object_name
								  || '"';
		end if;
	  end;
	  end loop;
	end;

	end;
	/

	create or replace
	procedure P_CHECK as
	  begin
	  
	  
	  begin
		for rec in (
	  select * from all_objects where owner like '%NEPRIN%' and (object_name = 'MAINTAIN') 
	  )
		loop  
		  begin 
			if rec.object_type= 'TABLE' then 
			 EXECUTE IMMEDIATE 'DROP '
									|| rec.object_type
									|| ' "'
									|| rec.object_name
									|| '" CASCADE CONSTRAINTS';
			   ELSE
				  EXECUTE IMMEDIATE 'DROP '
									|| rec.object_type
									|| ' "'
									|| rec.object_name
									|| '"';
		  end if;
		end;
		end loop;
	  end;
	  
	  end;
	  /
	  
	 begin
	dbms_job.change(210250, null,add_months(trunc(sysdate,'mm'),1)+6+8/24, 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+6+8/24');
	end;
	/

	begin
	dbms_job.change(214250, null,add_months(trunc(sysdate,'mm'),1)+6+8.15/24, 'add_months(trunc(sysdate,' || '''' || 'mm' || '''' ||'),1)+6+8.15/24');
	end;
	/
					}
				
				}
			
			}

			public protected class ORACLE()
			{
				public internal class Insertion()
				{
					
					public SQL_LOADER()
					{
						//ctl example
						//-----
						load data
						infile 'c:\test\sql_loader\terminals\load.txt'
						replace into table t_terminals3
						--append into table merchant_list
						fields terminated by "|" TRAILING NULLCOLS
						("TERMINAL","MERCHANT" 
						,"OPEN_DATE" DATE 'DD.MM.YYYY HH24:MI:SS'
						,"CLOSE_DATE" DATE 'DD.MM.YYYY HH24:MI:SS'
						,"STATUS"				
						--( "NAME" ,"DEPARTMENT" ,"TERM_ID","TR_DATE" DATE 'DD.MM.YYYY HH24:MI:SS',"P_SYS","A_CARD","A_ACQ_B","A_CARD_ISS"
						--,"A_AMT" "TO_NUMBER(replace(:A_AMT,'.',','))"
						--,"A_FEE" "TO_NUMBER(replace(:A_FEE,'.',','))"
						--,"A_FEE_AMT" "TO_NUMBER(replace(:A_FEE_AMT,'.',','))"
						--,"A_P_AMT" "TO_NUMBER(replace(:A_P_AMT,'.',','))"
						--,"A_CCY","A_SLIP","A_APR_CODE","A_TR_TYPE" ,"A_P_MERCH","A_F_NAME","A_ARN"
						)
						
						//load par example
						DATA=C:\test\sql_loader\terminals\load.txt
						USERID=neprintsev_ia/awsedrDRSEAW@dwh
						CONTROL=C:\test\sql_loader\ctl.ctl
						LOG=C:\test\sql_loader\terminals\log.txt
						
					}
				
				}
			}
			
		}

		//SQL SERVER
		//T SQL
		public void T_SQL()
		{
					
			public internal classs Theory()
			{
				public class Procedures_Functions_difference()
				{
					+---------------------------------+----------------------------------------+
					| Stored Procedure (SP)           | Function (UDF - User Defined           |
					|                                 | Function)                              |
					+---------------------------------+----------------------------------------+
					| SP can return zero , single or  | Function must return a single value    |
					| multiple values.                | (which may be a scalar or a table).    |
					+---------------------------------+----------------------------------------+
					| We can use transaction in SP.   | We can't use transaction in UDF.       |
					+---------------------------------+----------------------------------------+
					| SP can have input/output        | Only input parameter.                  |
					| parameter.                      |                                        |
					+---------------------------------+----------------------------------------+
					| We can call function from SP.   | We can't call SP from function.        |
					+---------------------------------+----------------------------------------+
					| We can't use SP in SELECT/      | We can use UDF in SELECT/ WHERE/       |
					| WHERE/ HAVING statement.        | HAVING statement.                      |
					+---------------------------------+----------------------------------------+
					| We can use exception handling   | We can't use Try-Catch block in UDF.   |
					| using Try-Catch block in SP.    |                                        |
					+---------------------------------+----------------------------------------+
				}
				
			}
			
			public internal class Insertion()
			{
					public Shitty_Callendar()
					{
						
						drop table  master.dbo.calendar ;
						create table master.dbo.calendar (id int ,"DATE" date
						, primary key (ID)
						);

						delete from master.dbo.calendar;

						declare @cnt int ;
						declare @max int;
						select @cnt = 0;
						set @max = 12*10;

						while @cnt < @max
						begin
						set @cnt = @cnt+1;
						print(dateadd(month,-(@max-@cnt),dateadd(MONTH,DATEDIFF(MONTH,0,getdate()),0)));

						insert into master.dbo.calendar (ID,DATE)
						values (
						@cnt,
						dateadd(month,-(@max-@cnt),dateadd(MONTH,DATEDIFF(MONTH,0,getdate()),0))
						);
						--print(- @cnt);
						end ;


						select * from master.dbo.calendar



					}
			}
			
			public internal class Selection()
			{
				
				public datetime()
				{
					
					--trunc by month
					select dateadd (yy,DATEDIFF(yy, 0,GETDATE()),0)
					select CONVERT(date,GETDATE(),103) where CONVERT(date,GETDATE(),103) = '01/09/2016'
					CONVERT(datetime,"DATE",104)
					select @@ROWCOUNT from DWH_replica.dbo.FD_ACQ_D
					
					select  
					format(
					getdate()
					,'dd.MM.yyyy hh:mm:ss');
					
					select convert(varchar,getdate(),120);
					select convert(date,getdate(),113);
					
				}

			}
			
			public internal class MAINTANANCE()
			{
				
				public tableCreate()
				{
									
					//table with prim,sec keys
					create table teble(
					ID int not null identity(0,1), --not nullable id increasing from 0 by 1 every insert
					SEC_ID int null, --foreign key
					primary key(ID), -- indicates primary key
					foreign key(SEC_ID) references SEC_NAMES(ID), -- indicates secondary key and according key in other table
					)

					//create table add key add foreign key
					create table DWH_replica.dbo.table2 (
					ID int not null identity(0,1),
					TXT varchar(50),
					DT Datetime);

					alter table DWH_replica.dbo.table2
					add primary key (ID);

					create table DWH_replica.dbo.table1 (
					ID int not null identity(0,1),
					SEC_ID int null,
					primary key (ID),
					foreign key (SEC_ID) references DWH_replica.dbo.table2(ID));

				}

			}
		
			public void Queries()
			{
				
				public void Cases()
				{
					
--Sample get max value for col1 by col2
create table #Temp(
	 EmplID int,DepID int ,Sal dec, primary key (EmplID)
)

declare @counter1 smallint;
declare @counter2 smallint;
declare @counter3 smallint;
declare @sal dec;

set @counter1 = 0;
set @counter2 = 0;
set @counter3 = 0;

while @counter1 < 50
	begin	
		while @counter2 < 5
		begin
			set @sal = rand()*1000;
			insert into #Temp (EmplID,DepID,Sal) values(@counter1,@counter3,@sal);
			set @counter1=@counter1+1;
			set @counter2=@counter2+1;
		end;
		set @counter2=0;
		set @counter3=@counter3+1;
	end;
go

select * from #Temp;

select t2.EmplID, t.DepID,t."SAL" from (select DepID, max(Sal) "SAL" from #Temp group by DepID) t
left join (select EmplID,Sal from #Temp) t2 on t."SAL" = t2.Sal

drop table #Temp;



--Exists instead of not null
create table #Colors(Color varchar(10) primary key);
create table #Clothes(Color varchar(10),Clothes varchar(10));

insert into #Colors (Color) values ('Red');
insert into #Colors (Color) values ('Blue');
insert into #Colors (Color) values ('Green');
insert into #Colors (Color) values ('Cyan');
insert into #Colors (Color) values ('Yellow');

insert into #Clothes values('Red','Trouses');
insert into #Clothes values('Blue','Skit');
insert into #Clothes values(null,'Coat');

select * from #Colors;
select * from #Clothes;


select * from #Colors t
where not exists (select * from #Clothes c where c.Color=t.Color);


drop table #Colors;
drop table #Clothes;





--check cast varchar to int
create table #Account(Name varchar(20) ,Val varchar(20));

insert into #Account values ('name1','abc');
insert into #Account values ('name2',1);
insert into #Account values ('name3',2);
insert into #Account values ('name4','4');
insert into #Account values ('name5','as');

select 
*
from #Account where 1=1 
--and  Val not like '%[^0-9]%'
and 
case when Val not like '%[^0-9]%' then cast(Val as int) 
 end > 0;

drop table #Account;


				}
			
			}			
		
		}
	
	}
		
	public void NoSQL()
	{

		public void OrientDB()
		{
				
			public void REST_API()
			{

host:port/ApiType/dbName/
host:port/ApiType/dbName/FunctionName/Params
host:port/ApiType/dbName/sql/commandText


//get database
http://msk1-vm-ovisp02:2480/database/news_test1
//geet class
http://msk1-vm-ovisp02:2480/class/news_test1/Entity
http://msk1-vm-ovisp02:2480/class/news_test1/Person
http://msk1-vm-ovisp02:2480/class/news_test1/Authorship
//execute indeponent function
http://msk1-vm-ovisp02:2480/function/news_test1/GetEntity/100

//GET sql
http://msk1-vm-ovisp02:2480/query/news_test1/sql/select * from Entity
//POST sql 
http://msk1-vm-ovisp02:2480/command/news_test1/sql/select * from Entity
//Fucntion (indeponent)
http://msk1-vm-ovisp02:2480/function/news_test1/GetEntity/100
//call to HW API
api/Orient/GetByID/1

//batch

http://msk1-vm-ovisp02:2480/batch/news_test3/

{ "transaction" : true,
  "operations" : [
    {
      "type" : "script",
      "language" : "sql",
      "script" : [
		  "create vertex Object set Content=\"A\""
		  ,"create vertex Object set Content=\"A\""
	  ]
    }
  ]
}

delete vertex from  object where Content="A"

		}

			public void Maintenance()
			{
//Query metadata
//get calsess
select expand(classes) from metadata:schema
//get properties for classes
select expand(properties) from (select expand(classes) from metadata:schema)
	
	public CreateFunctQuery()
	{
		
CREATE FUNCTION test "var g=orient.getGraph(); var b=g.command(\"sql\",\"select if(eval(\'1=2\'),2,3) \" ); return b;" 
PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT
	
CREATE FUNCTION test "var g=orient.getGraph(); var b=g.command(\"sql\",\"select from Person where sAMAccountName = 'kpa' \" ); return b;" 
PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT

CREATE FUNCTION test "var g=orient.getGraph(); var b=g.command(\"sql\",\"select if(eval(\'1=2\'),2,3) \" ); return b;" 
PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT
		
	}
	
	public void Initial_NewsApi_Queries()
	{
		
CREATE CLASS VSC extends V;

CREATE PROPERTY VSC.Name STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.GUID STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.Created DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.Changed DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY VSC.PGUID STRING;
CREATE PROPERTY VSC.Disabled DATETIME;

ALTER PROPERTY VSC.GUID DEFAULT uuid();
ALTER PROPERTY VSC.Created DEFAULT "sysdate()";
ALTER PROPERTY VSC.Changed DEFAULT "sysdate()";


CREATE CLASS ESC extends E;

CREATE PROPERTY ESC.Name STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.GUID STRING (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.Created DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.Changed DATETIME (MANDATORY TRUE, NOTNULL TRUE);
CREATE PROPERTY ESC.PGUID STRING;
CREATE PROPERTY ESC.Disabled DATETIME;

ALTER PROPERTY ESC.GUID DEFAULT uuid();
ALTER PROPERTY ESC.Created DEFAULT "sysdate()";
ALTER PROPERTY ESC.Changed DEFAULT "sysdate()";

create class Unit extends VSC;
create class Person extends VSC;

create class SubUnit extends E;
create class MainAssignment extends ESC;
create class InExtAssignment extends ESC;
create class OutExtAssignment extends ESC;
create class OldMainAssignment extends ESC;

delete vertex Unit;
delete vertex Person;
delete edge SubUnit;
delete edge MainAssignment;
delete edge InExtAssignment;
delete edge OutExtAssignment;
delete edge OldMainAssignment;

ALTER PROPERTY ESC.GUID DEFAULT uuid();
ALTER PROPERTY ESC.Created DEFAULT sysdate();
ALTER PROPERTY ESC.Changed DEFAULT sysdate();
ALTER PROPERTY VSC.GUID DEFAULT uuid();
ALTER PROPERTY VSC.Created DEFAULT sysdate();
ALTER PROPERTY VSC.Changed DEFAULT sysdate();
ALTER PROPERTY VSC.Seed DEFAULT "sequence('intranet_seed').next()"

alter database custom standardElementConstraints=false

CREATE PROPERTY MainAssignment.Weight INTEGER;

/*Lowerest level Weight*/
update MainAssignment set Weight = 1000;

/*Managment hierarhy*/
update MainAssignment set Weight = 0 where Name = 'Генеральный директор'
update MainAssignment set Weight = 1 where Name = 'Заместитель Генерального директора'
update MainAssignment set Weight = 50 where Name = 'Директор Административного департамента - Финансовый директор'
update MainAssignment set Weight = 50 where Name = 'Директор департамента'
update MainAssignment set Weight = 50 where Name = 'Директор департамента / Главный архитектор'
update MainAssignment set Weight = 50 where Name = 'Директор Департамента ИТ'
update MainAssignment set Weight = 50 where Name = 'Директор Департамента маркетинга и развития бренда'
update MainAssignment set Weight = 50 where Name = 'Директор Департамента стратегического планирования и проектного управления'
update MainAssignment set Weight = 50 where Name = 'Директор Организационно-правового департамента'
update MainAssignment set Weight = 50 where Name = 'Директор по персоналу, руководитель Службы персонала'
update MainAssignment set Weight = 50 where Name = 'Коммерческий директор - директор департамента'
update MainAssignment set Weight = 51 where Name = 'Заместитель директора департамента'
update MainAssignment set Weight = 51 where Name = 'Заместитель директора Департамента архитектуры и разработки ПО'
update MainAssignment set Weight = 51 where Name = 'Заместитель директора департамента ИТ'
update MainAssignment set Weight = 51 where Name = 'Заместитель директора департамента-HR директор'
update MainAssignment set Weight = 100 where Name = 'Начальник управления'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления cпециальных проектов и PR'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления администрации и делопроизводства'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления безопасности'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления бухгалтерского учета и отчетности - Главный бухгалтер'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления бюджетирования и управленческого учета'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления внутреннего аудита (контроля)'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления инноваций'
update MainAssignment set Weight = 100 where Name = 'Начальник управления инфраструктуры'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления по работе с платежными системами'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления развития продуктов и партнерских программ'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления разработки ПО'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления разработки правил НСПК'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления разработки программного обеспечения'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления регламентации и процедур'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления тарифов и отчетности'
update MainAssignment set Weight = 100 where Name = 'Начальник Управления технологий'
update MainAssignment set Weight = 100 where Name = 'Начальник Юридического управления'
update MainAssignment set Weight = 101 where Name = 'Заместитель начальника отдела'
update MainAssignment set Weight = 101 where Name = 'Заместитель начальника Отдела взаимоотношений с поставщиками'
update MainAssignment set Weight = 101 where Name = 'Заместитель начальника управления'
update MainAssignment set Weight = 101 where Name = 'Заместитель начальника Управления безопасности'
update MainAssignment set Weight = 101 where Name = 'Заместитель начальника Управления бухгалтерского учета и отчетности'
update MainAssignment set Weight = 101 where Name = 'Заместитель начальника Управления развития продуктов и партнерских программ'
update MainAssignment set Weight = 150 where Name = 'Начальник отдела'
update MainAssignment set Weight = 150 where Name = 'Начальник отдела - заместитель начальника управления'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела администрирования инфраструктурных сервисов'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела взаимоотношений с поставщиками'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела внутренней безопасности'
update MainAssignment set Weight = 150 where Name = 'Начальник отдела инфраструктурного мониторинга'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела криптографической защиты информации'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела международных проектов'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела мониторинга бизнес-процессов'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела мониторинга и контроля информационной безопасности'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела по договорной работе'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела по корпоративно-правовой работе'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела правового сопровождения НСПК'
update MainAssignment set Weight = 150 where Name = 'Начальник отдела протокола'
update MainAssignment set Weight = 150 where Name = 'Начальник отдела разработки программных комплексов'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела сопровождения информационной безопасности и развития систем защиты'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела статистики и отчетности'
update MainAssignment set Weight = 150 where Name = 'Начальник Отдела тестирования'
update MainAssignment set Weight = 150 where Name = 'Начальник отдела тестирования онлайн систем'
update MainAssignment set Weight = 150 where Name = 'Начальник отдела технического администрирования'

	}

	public void Initial_NewsApi_Functions()
	{
		//create function 
		//CREATE FUNCTION test "var g=orient.getGraph();var b=g.command(\"sql\",\"select from Person where sAMAccountName =  '\"+accountName+\"' \");return b;" PARAMETERS [accountName]  IDEMPOTENT true LANGUAGE JAVASCRIPT	
		
		/*GetUnitByAccount*/

		CREATE FUNCTION GetLowerCase "var g=orient.getGraph(); var b=g.command(\"sql\",\" select r.ToLowerCase() as r from (select '\"+input+\"' as r) \"); return b;" PARAMETERS [input] IDEMPOTENT true LANGUAGE JAVASCRIPT ;
		CREATE FUNCTION GetUnitByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\"select in(\\\"MainAssignment\\\").Name[0] as Name from Person WHERE sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0] and (inE(\\\"MainAssignment\\\")[0].Disabled is null or inE(\\\"MainAssignment\\\")[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )\"); return b;" PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetDepartmentByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\" select Name from ( traverse in('MainAssignment','SubUnit') from (select from Person where sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0] ) ) where PGUID='00000000-0000-0000-0000-000000000000'  \" ); return b;" PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetManagerByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\"select r.Name as Name from ( select from ( select   /*If person Weight is smallest -> header of Unit => get PUnit header   else Unit Header   */ if(eval('$z.w[0]=$a.w[0]'),$f,$e) as r let   x = (select sAMAccountName as n  from Person where sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0]  ) 	/*person Weight*/   ,$z = (       select Weight as w from (select expand(inE('MainAssignment')) from Person where sAMAccountName=$x.n[0])   where (Disabled is null or Disabled >= sysdate() and (State !=\'Отпуск по уходу за ребенком' and State !=\'Отпуск по беременности и родам' ))   )   /*Min weigth in Person Unit*/   ,$a = (	   select min(Weight) as w from (select expand(inE('MainAssignment').outV('Unit').outE('MainAssignment')) from Person where sAMAccountName=$x.n[0]  )   where (Disabled is null or Disabled >= sysdate() and  (State !=\'Отпуск по уходу за ребенком' and State !=\'Отпуск по беременности и родам' )) ) /*Min weigth in Person PUnit*/   , $b = (     select min(Weight) as w from (       select expand(inE('MainAssignment').outV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')  ) from Person where sAMAccountName=$x.n[0]     ) where (Disabled is null or Disabled >= sysdate() and  (State !=\'Отпуск по уходу за ребенком' and State !=\'Отпуск по беременности и родам' ))   )   /*Person Unit person appointment*/   	, $c = (        select Weight as w , inV('Person').sAMAccountName as Name from (select expand(inE('MainAssignment').outV('Unit').outE('MainAssignment')) from Person where sAMAccountName=$x.n[0]  )   where (Disabled is null or Disabled >= sysdate() and  (State !=\'Отпуск по уходу за ребенком' and State !=\'Отпуск по беременности и родам' ))     )   /*Person PUnit person appointment*/   ,$d =(      select Weight as w , inV('Person').sAMAccountName as Name from (       select expand(inE('MainAssignment').outV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')  ) from Person where sAMAccountName=$x.n[0]     ) where (Disabled is null or Disabled >= sysdate() and  (State !=\'Отпуск по уходу за ребенком' and State !=\'Отпуск по беременности и родам' ))   )   /*Person Unit Header $a->$c */   , $e = ( select from ( select expand($c)) where 1=1 and w = $a.w[0]   )     /*Person PUnit Header $a->$c */ , $f = ( select from ( select expand($d)) where 1=1 and w = $b.w[0] ))) /* where 1=1 and w = $a.w[0] */ \"); return b;" PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetManagerHierarhyByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\"  select Acc as Name from ( select expand($e) let $x = ( select from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0]    )   ,$a = (      /*From Person by Unit Hierarhy*/     select  Name as n, sAMAccountName as Acc, inE('MainAssignment').outV('Unit').Name[0] as d,   inE('MainAssignment').Weight[0] as w from (       select expand(inV()) from ( traverse inE('MainAssignment','SubUnit')   ,outE('MainAssignment'),outV('Unit','Person') from (           select from person where 1=1 and sAMAccountName=$x.sAMAccountName[0] )           ) ) where 1=1        and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() )   and (Disabled is null) and     (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )      /*If account name not assigned then deputy*/ 	and sAMAccountName is not null       ),   $c = (      /*Select Header by Weight 0 */     select  Name as n, sAMAccountName as Acc,   inE('MainAssignment').outV('Unit').Name[0] as d, inE('MainAssignment').Weight[0] as w   from (       select from Person where inE('MainAssignment').Weight[0] = 0     )    ) ,   $e = unionall (      /*Union all Unit Headers and Directory (as ddirectory not in linear structure -> not binded to parent node*/     $a,$c    )   , $b = (      /*From United Person by Unit Hierarhy minimal Wights in Unit*/     select d , min(w) as w from (       select expand($e)     ) group by d    )  )  where 1=1      and w in $b.w     and w != $x.inE('MainAssignment').Weight[0] order by Name \"); return b; " PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetCollegesByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\"  select in().Out('MainAssignment').sAMAccountName as Name from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0]  and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' ) order by Name  \"); return b; " PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		CREATE FUNCTION GetCollegesLowerByAccount "var g=orient.getGraph(); var b=g.command(\"sql\",\"  select sAMAccountName as Name from ( 	traverse out() from ( 	select in() from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('\"+accountName+\"').r[0]  ) 	) 	where @class = \'Person\' 	and not ( 	(Name like '%директор департамента%') 	or ( Name like '%ачальник %') and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )	) order by Name  \"); return b; " PARAMETERS [accountName] IDEMPOTENT true LANGUAGE JAVASCRIPT;
		
	}
			}

			public void Queries()
			{

https://stackoverflow.com/questions/35323242/orientdb-sql-check-if-multiple-pairs-of-vertices-are-connected
https://stackoverflow.com/questions/33345305/orientdb-traverse-until-condition-on-node

public NestedAggr() {
	
select  from (
select expand($a) 

let
$b = (
  
select  
 max($depth ) as d  
  from (
  traverse inE('MainAssignment','SubUnit'),outV(),outE('MainAssignment'),outE('SubUnit')
  ,outE(),inE(),outV()
  from (

	select
	from person where 1=1
	and sAMAccountName='kpa'
	/* and in().Out('MainAssignment').inE() is null */
	and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and (Disabled is null) and
	(inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

  )) where @Class = 'Unit'
  
),
$a = (

select  
  GUID,Name, $depth as d
  
  from (
  traverse inE('MainAssignment','SubUnit'),outV(),outE('MainAssignment'),outE('SubUnit')
  ,outE(),inE(),outV()
  from (

	select
	from person where 1=1
	and sAMAccountName='kpa'
	/* and in().Out('MainAssignment').inE() is null */
	and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and (Disabled is null) and
	(inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

  )) where @Class = 'Unit'
  
)

) where 1=1
and d=$b.d[0]

}

public traversePath(){
//path 
traverse inE('MainAssignment','SubUnit'),outV() 


traverse inE('MainAssignment','SubUnit'),outV()  from (
select from person where 1=1 and sAMAccountName='lobanovamg'
/* and in().Out('MainAssignment').inE() is null */
and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate() ) and (Disabled is null) and
(inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )
)
}

public PersonFilter(){

//default person select no Fired or in maternity leave
select expand(in().Out('MainAssignment').inE()) as p
from person where 1=1 and sAMAccountName='lobanovamg'
/* and in().Out('MainAssignment').inE() is null */
and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate() ) and (Disabled is null) and
(inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

}

public PersonLower(){
	
	 select Name,sAMAccountName as Acc,  inE('MainAssignment').Name as nm,inE('MainAssignment').Weight as w, inE('MainAssignment').Disabled as d,
    inE('MainAssignment').State as s from person where 1=1 and sAMAccountName in ['filimonovats','eliseevavv','kpa']
    
	
}

public LevelParody(){
	
//something like MOTHERFUCKING LEVEL
//unpredictable inE(), outV() and "while $depth" working
select from (
traverse both() from (
select from (
traverse inE() from (

select
from person where 1=1
and sAMAccountName='kpa'
/* and in().Out('MainAssignment').inE() is null */
and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and (Disabled is null) and
(inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

) while $depth <=2
) where 1=1
/* and @class = 'Object' */
) while $depth <=5
) where 1=1
/* and  @class = 'Object' */
and $depth >=1
and $depth <=4

}

public ConditionalSelect(){


select

if(eval('$a.r[0]=0'),$b.Name,'a') as r

from (
select $b,$c
let 
$b = (select from Person),
$c = (select from Unit),
$a =(
  select min(r) as r from (

	select if( eval('GUID=\'4e28f31a-89b8-11e4-bab2-00c2c66d13b0\''),0,1) as r from Person where GUID in (
	  select GUID from Person where GUID in
	  ['4e28f31a-89b8-11e4-bab2-00c2c66d13b0','0963f5ee-cbae-11e4-b849-f80f41d3dd35','f58c67e4-ab78-11e4-b308-f80f41d3dd35'])

  )
)

)



}

public Unsorted(){


//returns nothing
select from Person where MainAssignment[GUID] = '4e28f319-89b8-11e4-bab2-00c2c66d13b0'
select from Person where '4e28f319-89b8-11e4-bab2-00c2c66d13b0' in MainAssignment[GUID]
select from Person where '4e28f319-89b8-11e4-bab2-00c2c66d13b0' in MainAssignment[GUID].asString()

//returns something
select * from Person where In()[GUID]=["62c0871f-ed9a-11e4-b696-f80f41d3dd35"]
select * from Person where ["62c0871f-ed9a-11e4-b696-f80f41d3dd35"] in In()[GUID]

//Person name or Parent unit name
select Name, if(eval('@class=\"Unit\"'),In("SubUnit").Name,In("MainAssignment").Name) as Parent from VSC where @class='Unit'

//Traverse
traverse out('MainAssignment','SubUnit')
from (select from Unit where Name = 'НСПК') strategy BREADTH_FIRST
//strategy DEPTH_FIRST


//traverse path
traverse in('MainAssignment','SubUnit')
from (select from Person where sAMAccountName ='somovnv')


//Shortest path shortestpath/dijkstra
SELECT expand(Path) FROM ( select shortestpath($a,$b,'both',null,{"masdepth":2}) as Path
let $a = (select from Unit where Name = "Управление развития и поддержки программы лояльности"),
$b = (select from Person where Name = "Новошинская Наталья Валерьевна")
unwind Path)

//Shortest path dijkstra
SELECT expand(Path) FROM ( select dijkstra($a,$b,null,'both') as Path
let $a = (select from Unit where GUID='00000000-0000-0000-0000-000000000000'),
$b = (select from Person where Name = "Арсеньева Виктория Викторовна")
unwind Path)

//whole structure
traverse in() from (
SELECT expand(Path) FROM ( select dijkstra($a,$b,null,'both') as Path
let $a = (select from Unit where GUID='00000000-0000-0000-0000-000000000000'),
$b = (select from Person where [Name,sAMAccountName] LUCENE "%nesterovayv%" )
unwind Path) )


//Structure
select 
from (
traverse both('MainAssignment','SubUnit') from
(select from Unit where Name = 'НСПК')
)
where (inE()[0].Disabled is null and Disabled is null)


//Path from start to GUID
traverse in() from (
select expand(Path) from  ( select shortestpath($a,$b,'both',null,{"maxdepth":1}) as Path
let $a = (select from Unit where Name = "Управление развития и поддержки программы лояльности"),
$b = (select from Unit where GUID = '00000000-0000-0000-0000-000000000000')
unwind Path) )

//Traverse 
select from (
traverse in() from (
select expand(Path) from  ( select shortestpath($a,$b,'both',null,{"maxdepth":1}) as Path
let $a = (select from Unit where Name = "Управление развития и поддержки программы лояльности"),
$b = (select from Unit where GUID = '00000000-0000-0000-0000-000000000000')
unwind Path) ) while $depth <=1 ) where $depth >=1

//Select level by case
	select Name from (
	select Name , 
	if(eval('Name like "%епартамент%"'),1,if(eval('Name like "%правление%"'),2,0)) as Cnt
	from (traverse in() from (select from Person where [Name,sAMAccountName] LUCENE '%rsm%' )) 
	)

	let $mx = (
	select Max(Cnt) as Cnt from (
	select Name , 
	if(eval('Name like "%епартамент%"'),1,if(eval('Name like "%правление%"'),2,0)) as Cnt
	from (traverse in() from (select from Person where [Name,sAMAccountName] LUCENE '%rsm%' )) 
	)
	)
	
	where Cnt = $mx[Cnt][0]


//select relative level
	select Name from (
	select
	Name , 
	if(eval('Name like "%Правление%"'),1,if(eval('Name like "%епартамент%"'),2,if(eval('Name like "%правление%"'),3,0))) as Cnt
	/*   ,
	$a.Cnt.asString() as cnt,
	$a[Cnt][0] as cnt2,
	if(eval(' \"2\" in $a[Cnt][0] '),1,0) as cond */
	from (
	select expand(Path) from (select dijkstra((select from Person where [Name,sAMAccountName] LUCENE '%shashkovamj%' ), (select from Unit where Name = 'НСПК'),null,'in') as Path ) 
	)
	)
	let $a = (
	  
	select
	Max(if(eval('Name like "%Правление%"'),1,if(eval('Name like "%епартамент%"'),2,if(eval('Name like "%правление%"'),3,0)))  ) as Cnt
	from (
	select expand(Path) from (select dijkstra((select from Person where [Name,sAMAccountName] LUCENE '%shashkovamj%' ), (select from Unit where Name = 'НСПК'),null,'in') as Path ) 
	)
	  
	)
	
	
//DEPTH
	select from (
	traverse in("MainAssignment","SubUnit") from (
	select
	from person
	where [Name,sAMAccountName] LUCENE '%popovaav%'
	) while $depth <=4
	)
	where $depth >=3

	
//DEPTH BY COND
	select
	/* @this.Name,in(),out() , in().Name[0],out().Name[0] */
	from (
	traverse both() from (
	select from Unit where Name = 'НСПК'
	limit 1

	) while $depth <=6
	/* strategy DEPTH_FIRST */
	) where $depth >=4
	and (
	in().Name[0] != ''
	)



//FETCHPLAN
	select from (
		traverse in() from (
			select from  person
			where [Name,sAMAccountName] LUCENE '%prohorovaos%'
			fetchPlan in_*:-2 out_*:-2
		)
	)
	

}


			}

			public void Functions()
			{
				
				public void PersonsAPI()
				{
										
					//к какому подразделению принадлежит Сотрудник А.								
					public void GetUnitByAccount()
					{
						
						/*

db3 kpa 21:265 	db2 22:187

						*/
						
						
var g=orient.getGraph();
var b=g.command("sql","select in(\"MainAssignment\").Name[0] as Name from Person WHERE sAMAccountName = \""+accountName+"\" and (inE(\"MainAssignment\")[0].Disabled is null or inE(\"MainAssignment\")[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )");
return b;


					}
					
					//Определить Управление\Департамент Сотрудника А.
					public void GetDepartmentByAccount()
					{

					
var g=orient.getGraph();
var b=g.command("sql","select Name from (select expand($d) let $b = (select from Unit where GUID = '00000000-0000-0000-0000-000000000000'),$dep = (select expand(in()[0]) from Person WHERE sAMAccountName like '%"+accountName+"%' and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate()) and (Disabled is null) and (inE().State !='Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам')),$c = (select shortestpath($dep,$b,'both',null,null) as Path),$d=( select if(eval(\'Name like \"%правление%\"\'),2,if(eval(\'Name like \"%партамент%\"\'),1,-1)) as Depth,Name,GUID from (traverse in() from ( select expand($c) as Path) limit 3) ), $e=( select max(Depth) as Depth from (select expand($d)))) where 1=1 and $e.Depth[0] = Depth and GUID != '00000000-0000-0000-0000-000000000000' ");
return b;

//2 департмент после НСПК
select Name from (
traverse in('MainAssignment','SubUnit')
from (select from Person where sAMAccountName ='somovnv')
) where PGUID='00000000-0000-0000-0000-000000000000' 

var g=orient.getGraph();
var b=g.command("sql","select Name from (  traverse in('MainAssignment','SubUnit') from (select from Person where sAMAccountName ='"+accountName+"')  ) where PGUID='00000000-0000-0000-0000-000000000000' ");
return b;




//weighted for General 0, Departmens 50, Managements 100, Units 150, others 1000

select Weight,Name, inV('Person').sAMAccountName, $a.inE()[0].Weight,$a.inE()[0].Name from (
select
/* Path.Name,Path.inE().Name, Path.in().Name, Path.in().outE() */
expand(Path.in().outE())
from (
select	shortestpath($a,$c,'both',null,{"maxdepth":2}) as Path
let $a = ( select from person where sAMAccountName = 'DegterevaSV' )
, $b = (select from Unit where GUID = '00000000-0000-0000-0000-000000000000')
, $c = (select from Person where inE().Weight[0]  = 0)
unwind Path
)   
) where 1=1 
and @class = 'MainAssignment' 
and ( Disabled is null or Disabled > sysdate()) 
and (inV().Disabled is null or inV().Disabled > sysdate())
and (State !='Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам') 
and Weight <  $a.inE()[0].Weight


var g=orient.getGraph();
var b=g.command("sql","select Name from (  traverse in('MainAssignment','SubUnit') from (select from Person where sAMAccountName ='"+accountName+"')  ) where PGUID='00000000-0000-0000-0000-000000000000' ");
return b;



						/*testcase
							
							#22:321
							gorevaps -> Управление сертификации
							#21:0
							meshkovav -> Управление сопровождения технологических процессов
							
							#21:66
							malkhasyanar -> Управление регламентации и процедур
							#21:177
							avdeyie -> Управление тарифов и отчетности
							#21:275
							zhiltsovaa -> Управление тарифов и отчетности
							
							#21:313
							luchinata -> Управление по контролю рисков
							#22:152
							telukhla -> Управление стратегических проектов
							#22:208
							fesenkoev -> Управление стратегического планирования
							#21:153
							gejmanma -> Управление стратегических проектов
							
							#21:198 #19:54
							>	tishakovoi -> Организационно-правовой департамент
							#22:180 #19:74
							pelenitsinam -> Управление безопасности
							#21:268 #19:14
							>	a.pronin -> Административный департамент
							#22:59 #19:89
							makedonskajaks -> Департамент развития продуктов и бизнеса
							#21:227 #19:20
							>	mitichkinaea -> 500
							#22:307 #20:82
							sedovavv -> Руководство
							#21:242 #20:61
							sergeevro -> Управление сопровождения технологических процессов
							#22:84 #20:61
							reznichenkoks -> Управление сопровождения технологических процессов
							
							#22:306 #20:41
							SyulzyakovaVV -> Департамент маркетинга и коммуникаций
							#21:174 #20:63
							budaevaas -> Управление бренда и маркетинговых коммуникаций
							#21:60
							kuzmichjovdv -> Управление бренда и маркетинговых коммуникаций
							
							#21:203 ->(#19:45,#19:73)
							PodolskayaNI -> Департамент стратегического планирования и проектного управления
							Perepechiniv -> Управление стратегического планирования
							Karpushevamv -> Управление стратегических проектов
							
							gashigullinrr -> Управление по контролю рисков
							
							#21:59
							>	lopushanskijsv -> Административный департамент
							#22:95
							levitskayaaa -> Управление бюджетирования и управленческого учета
							
						*/
					
					}
					
					//Определить непосредственного Руководителя Сотрудника А.
					public void GetManagerByAccount()
					{

/*
var g=orient.getGraph();
var b=g.command("sql","select $h.Acc[0] as Name let $c = (select min(Wg) as Wg from ( select value as Wg from ( select expand(inV().inE().Weight) as Wg from ( select expand(in().OutE(\"MainAssignment\")) as Wg from Person where [Name,sAMAccountName] LUCENE \"%"+accountName+"%\")))) , $d = ( select inV().Name as Name,inV().sAMAccountName as Acc,inV().@rid as pId ,inV().inE().Weight[0] as Wg,inV().inE().Name[0] as Name2,inV().inE().outV().@rid[0] as uId from ( select expand(in().OutE(\"MainAssignment\")) as Wg from Person where [Name,sAMAccountName] LUCENE \"%"+accountName+"%\") where $c.Wg[0]=Weight ), $e = (select min(Wg) as Wg from (select value as Wg from (  select expand(inV().inE().Weight) as Wg from (  select expand(in().in().OutE(\"MainAssignment\")) as Wg from Person where [Name,sAMAccountName] LUCENE \"%"+accountName+"%\" )))) , $f = ( select inV().Name as Name,inV().sAMAccountName as Acc,inV().@rid as pId ,inV().inE().Weight[0] as Wg,inV().inE().Name[0] as Name2,inV().inE().outV().@rid[0] as uId from ( select expand(in().in().OutE(\"MainAssignment\")) as Wg from Person where [Name,sAMAccountName] LUCENE \"%"+accountName+"%\") where $e.Wg[0]=Weight), $g = ( select inE().Weight[0] as Wg from Person where [Name,sAMAccountName] LUCENE \"%"+accountName+"%\"),$h = (select expand(if(eval(' $g.Wg[0]=$d.Wg[0]'),$f,$d)) )");
return b;
*/

var g=orient.getGraph();
var b=g.command("sql","select r.Name as Name from ( select from ( select   /*If person Weight is smallest -> header of Unit => get PUnit header   else Unit Header   */ if(eval('$z.w[0]=$a.w[0]'),$f,$e) as r let   x = (select sAMAccountName as n  from Person where sAMAccountName='"+accountName+"' ) 	/*person Weight*/   ,$z = (       select Weight as w from (select expand(inE('MainAssignment')) from Person where sAMAccountName=$x.n[0])   where (Disabled is null or Disabled >= sysdate() and (State !=\'Отпуск по уходу за ребенком' and State !=\'Отпуск по беременности и родам' ))   )   /*Min weigth in Person Unit*/   ,$a = (	   select min(Weight) as w from (select expand(inE('MainAssignment').outV('Unit').outE('MainAssignment')) from Person where sAMAccountName=$x.n[0]  )   where (Disabled is null or Disabled >= sysdate() and  (State !=\'Отпуск по уходу за ребенком' and State !=\'Отпуск по беременности и родам' )) ) /*Min weigth in Person PUnit*/   , $b = (     select min(Weight) as w from (       select expand(inE('MainAssignment').outV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')  ) from Person where sAMAccountName=$x.n[0]     ) where (Disabled is null or Disabled >= sysdate() and  (State !=\'Отпуск по уходу за ребенком' and State !=\'Отпуск по беременности и родам' ))   )   /*Person Unit person appointment*/   	, $c = (        select Weight as w , inV('Person').sAMAccountName as Name from (select expand(inE('MainAssignment').outV('Unit').outE('MainAssignment')) from Person where sAMAccountName=$x.n[0]  )   where (Disabled is null or Disabled >= sysdate() and  (State !=\'Отпуск по уходу за ребенком' and State !=\'Отпуск по беременности и родам' ))     )   /*Person PUnit person appointment*/   ,$d =(      select Weight as w , inV('Person').sAMAccountName as Name from (       select expand(inE('MainAssignment').outV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')  ) from Person where sAMAccountName=$x.n[0]     ) where (Disabled is null or Disabled >= sysdate() and  (State !=\'Отпуск по уходу за ребенком' and State !=\'Отпуск по беременности и родам' ))   )   /*Person Unit Header $a->$c */   , $e = ( select from ( select expand($c)) where 1=1 and w = $a.w[0]   )     /*Person PUnit Header $a->$c */ , $f = ( select from ( select expand($d)) where 1=1 and w = $b.w[0] ))) /* where 1=1 and w = $a.w[0] */");
return b;


//NEW manager query
//<<<<<<<<<<<<<<<<<


select 
  /*
  If person Weight is smallest -> header of Unit => get PUnit header
  else Unit Header
  */
if(eval('$z.w[0]=$a.w[0]'),if(eval('$x.inE(\'MainAssignment\').outV(\'Unit\').PGUID =\'00000000-0000-0000-0000-000000000000\''),'kvv',$f),$e) as r
/* if(eval('1=2'),1,if(eval('1=2'),2,3)) */



let
  $x = ( select  from Person where sAMAccountName=GetLowerCase('"+accountName+"').r[0])
	/*person Weight*/
  ,$z = (
      select Weight as w from (select expand(inE('MainAssignment')) from Person where sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase())
  where (inE('MainAssignment').Disabled is null or inE('MainAssignment').Disabled >= sysdate() and (inE('MainAssignment').State != 'Отпуск по уходу за ребенком' and inE('MainAssignment').State != 'Отпуск по беременности и родам' ))
  )
  /*Min weigth in Person Unit*/
  ,$a = (
    
select min(Weight) as w from (
select expand(inE('MainAssignment').OutV('SubUnit').outE('MainAssignment')) from Person where  sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase()
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

)
/*Min weigth in Person PUnit*/
  , $b = ( 
    
  select min(Weight) as w from (
select expand(inE('MainAssignment').OutV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')) from Person where  sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase()
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

  )
  /*Person Unit person appointment*/
  	, $c = (
   
   select Name as d ,Weight as w,inV('Person').sAMAccountName as Name from (
select expand(inE('MainAssignment').OutV('SubUnit').outE('MainAssignment')) from Person where  sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase()
) where    (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

    )
  /*Person PUnit person appointment*/
  ,$d =(
    
    select Name as d ,Weight as w,inV('Person').sAMAccountName as Name from (
select expand(inE('MainAssignment').OutV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')) from Person where sAMAccountName.ToLowerCase()=$x.sAMAccountName[0].ToLowerCase()
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null
    
  )
  /*Person Unit Header $a->$c */
  , $e = (
     select from ( select expand($c)) where 1=1 and w =  $a.w[0]
  )
    /*Person PUnit Header $a->$c */
  , $f = (
     select from ( select expand($d)) where 1=1 and w = $b.w[0]
  )

  
  
  
  
  
//<<<<<<<<<<<<<<<

select r.Name[0] as Name from (

select 
  /*If person Weight is smallest -> header of Unit => get PUnit header 
  else Unit Header
  */
if(eval('$z.w[0]=$a.w[0]'),$f,$e) as r
/* expand($e) */
  
let
  x = ( select  from Person where sAMAccountName='YablokovAE' )
	/*person Weight*/
  ,$z = (
      select Weight as w from (select expand(inE('MainAssignment')) from Person where sAMAccountName=$x.sAMAccountName[0])
  where (inE('MainAssignment').Disabled is null or inE('MainAssignment').Disabled >= sysdate() and (inE('MainAssignment').State != 'Отпуск по уходу за ребенком' and inE('MainAssignment').State != 'Отпуск по беременности и родам' ))
  )
  /*Min weigth in Person Unit*/
  ,$a = (
    
select min(Weight) as w from (
select expand(inE('MainAssignment').OutV('SubUnit').outE('MainAssignment')) from Person where sAMAccountName=$x.sAMAccountName[0]
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

)
/*Min weigth in Person PUnit*/
  , $b = ( 
    
  select min(Weight) as w from (
select expand(inE('MainAssignment').OutV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')) from Person where sAMAccountName=$x.sAMAccountName[0]
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

  )
  /*Person Unit person appointment*/
  	, $c = (
   
   select Name as d ,Weight as w,inV('Person').sAMAccountName as Name from (
select expand(inE('MainAssignment').OutV('SubUnit').outE('MainAssignment')) from Person where sAMAccountName=$x.sAMAccountName[0]
) where    (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null

    )
  /*Person PUnit person appointment*/
  ,$d =(
    
    select Name as d ,Weight as w,inV('Person').sAMAccountName as Name from (
select expand(inE('MainAssignment').OutV('Unit').inE('SubUnit').outV('Unit').outE('MainAssignment')) from Person where sAMAccountName=$x.sAMAccountName[0]
) where (Disabled is null or Disabled >= sysdate()) and  (State != 'Отпуск по уходу за ребенком' and State != 'Отпуск по беременности и родам' )  and inV('Person').sAMAccountName is not null
    
  )
  /*Person Unit Header $a->$c */
  , $e = (
     select from ( select expand($c)) where 1=1 and w =  $a.w[0]
  )
    /*Person PUnit Header $a->$c */
  , $f = (
     select from ( select expand($d)) where 1=1 and w = $b.w[0]
  )

  )
   




						//tests
						/*
							#22:321 #22:66
							gorevaps -> rsm
							#21:0 #21:91
							meshkovav -> pak
							
							#21:66 
							malkhasyanar -> Управление регламентации и процедур
							#21:177 #21:198
							#22:265 samovichevasa >	avdeyie -> tishakovoi
							#21:275 #21:177
							zhiltsovaa -> avdeyie
							
							#21:313 #22:45 (Директор по управлению и анализу рисков vs Начальник управления)
							#21:190 anokhinatb>  luchinata -> pogorelovdm
							#22:152 #22:281
							telukhla -> kda 
							#22:208 #21:288
							fesenkoev -> Perepechiniv
							#21:153 #22:274
							gejmanma -> skatovadd
							
							#21:198 #19:54
							>	tishakovoi -> Организационно-правовой департамент
							#22:180 #21:328
							pelenitsinam -> OVA
							#21:268 #19:14
							>	a.pronin -> Административный департамент
							#22:59 #22:66
							makedonskajaks -> rsm
							#21:227 #19:20
							>	mitichkinaea -> Управление по работе с ТСП
							#22:307 #21:117
							sedovavv -> kvv
							#21:242 #21:181
							sergeevro -> kalininia
							#22:84 #21:23
							reznichenkoks -> arsenevavv
							
							#22:306 #20:41
							SyulzyakovaVV -> Департамент маркетинга и коммуникаций
							#21:174 #22:76
							budaevaas -> kosarevavv
							#21:60 
							kuzmichjovdv -> Управление бренда и маркетинговых коммуникаций
							
							#21:203 ->(#19:45,#19:73)
							PodolskayaNI -> Департамент стратегического планирования и проектного управления
							Perepechiniv -> Управление стратегического планирования
							Karpushevamv -> Управление стратегических проектов
							
							gashigullinrr -> Управление по контролю рисков
							
							#21:59
							>	lopushanskijsv -> Административный департамент
							#22:95
							levitskayaaa -> Управление бюджетирования и управленческого учета
						*/
							
						//tests
						/*
						
gorevaps 
malkhasyanar 
zhiltsovaa
anokhinatb
makedonskajaks -> [\"rsm\"]
SyulzyakovaVV
reznichenkoks -> [\"arsenevavv\"]
Perepechiniv
gashigullinrr -> [\"anokhinatb\"]
levitskayaaa 
								
					}
					
					//Определить Сотрудников того же отдела, что и Сотрудник А.
					public void GetCollegesByAccount()
					{
						
var g=orient.getGraph();
var b=g.command("sql","select  in().Out('MainAssignment').sAMAccountName from person where [Name,sAMAccountName] LUCENE '%"+accountName+"%'");
return b;


	//tests
	/*
						
gorevaps -> "[\"gorevaps\",\"kapkaev\",\"kokuevol\"]"
malkhasyanar -> [\"malkhasyanar\",\"Pletnevov\",\"kvv\"]
zhiltsovaa
anokhinatb
makedonskajaks
SyulzyakovaVV
reznichenkoks
Perepechiniv
gashigullinrr
levitskayaaa -> [
				"krasotkinaei",
				"andreevatv",
				"Kushelevaib",
				"Belyakovpn",
				"kuzminay",
				"SinitsynaTV",
				"choi",
				"koganal",
				"levitskayaaa"
			]
								
	*/
	
					}
									
					//Определить цепочку руководителей от Сотрудника А до Генерального Директора
					public void GetManagerHierarhyByAccount()
					{

var g=orient.getGraph();
var b=g.command("sql","  select Acc as Name from ( select expand($e) let $x = ( select from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('"+accountName+"').r[0]    )  ,$a = (      /*From Person by Unit Hierarhy*/     select  Name as n, sAMAccountName as Acc, inE(\'MainAssignment\').outV(\'Unit\').Name[0] as d, inE(\'MainAssignment\').Weight[0] as w from (       select expand(inV()) from (            traverse inE(\'MainAssignment\',\'SubUnit\'),outE(\'MainAssignment\'),outV(\'Unit\',\'Person\') from (           select from person where 1=1 and sAMAccountName=$x.sAMAccountName[0] )           ) ) where 1=1      and (inE(\"MainAssignment\")[0].Disabled is null or inE(\"MainAssignment\")[0].Disabled >= sysdate() ) and (Disabled is null) and     (inE().State != \'Отпуск по уходу за ребенком\' and inE().State != \'Отпуск по беременности и родам\' )         /*If account name not assigned then deputy*/ 	and sAMAccountName is not null       ), $c = (      /*Select Header by Weight 0 */     select  Name as n, sAMAccountName as Acc, inE(\'MainAssignment\').outV(\'Unit\').Name[0] as d, inE(\'MainAssignment\').Weight[0] as w from (       select from Person where inE(\'MainAssignment\').Weight[0] = 0     )    ) , $e = unionall (      /*Union all Unit Headers and Directory (as ddirectory not in linear structure -> not binded to parent node*/     $a,$c    ), $b = (      /*From United Person by Unit Hierarhy minimal Wights in Unit*/     select d , min(w) as w from (       select expand($e)     ) group by d    )  )  where 1=1      and w in $b.w     and w != $x.inE(\'MainAssignment\').Weight[0] order by Name ");
return b;
						
						//tests
						/*
																		
gorevaps -> [\"gorevaps\",\"rsm\",\"kvv\"]
malkhasyanar -> [\"malkhasyanar\",\"Pletnevov\",\"kvv\"]
zhiltsovaa
anokhinatb
makedonskajaks
SyulzyakovaVV
reznichenkoks
Perepechiniv
gashigullinrr
levitskayaaa -> [\"choi\",\"koganal\",\"kvv\"]						 
							
						*/
		
		
	//<<<<<<<<<<<<<<<<<<<< Hierarhy ready

select Acc as Name from (

  select expand($e)

  let
  $x = (

    select from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('filimonovats').r[0]

  )  ,$a = (

    /*From Person by Unit Hierarhy*/
    select  Name as n, sAMAccountName as Acc, inE('MainAssignment').outV('Unit').Name[0] as d, inE('MainAssignment').Weight[0] as w from (
      select expand(inV()) from (    
        traverse inE('MainAssignment','SubUnit'),outE('MainAssignment'),outV('Unit','Person') from (
          select from person where 1=1 and sAMAccountName=$x.sAMAccountName[0] )     
      ) ) where 1=1  
    and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate() ) and (Disabled is null) and
    (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )
    
    /*If account name not assigned then deputy*/
	and sAMAccountName is not null
    
  ), $c = (

    /*Select Header by Weight 0 */
    select  Name as n, sAMAccountName as Acc, inE('MainAssignment').outV('Unit').Name[0] as d, inE('MainAssignment').Weight[0] as w from (
      select from Person where inE('MainAssignment').Weight[0] = 0
    )

  ) , $e = unionall (

    /*Union all Unit Headers and Directory (as ddirectory not in linear structure -> not binded to parent node*/
    $a,$c

  ), $b = (

    /*From United Person by Unit Hierarhy minimal Wights in Unit*/
    select d , min(w) as w from (
      select expand($e)
    ) group by d

  )

)

where 1=1

    and w in $b.w
    and w != $x.inE('MainAssignment').Weight[0]

	
		
	//<<<<<<<<<<<<<<<<<<<< Hierarhy 1

select from (
  select expand($f)

  let 


  $e= (

    /*min person by unit*/
    select 
    d,min(w) as w 

    from (
      select inE('MainAssignment').outV('SubUnit').Name[0] as d, inE('MainAssignment').Weight[0] as w from (
        select expand ( outE('MainAssignment').inV('Person')) from (traverse inE('MainAssignment','SubUnit'),outV('Unit')
                                                                    from ( select from Person where sAMAccountName='somovnv')) where @class='Unit'
      ) 
      where 1=1 

      and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and
      (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

    )

    group by d

  ) 
  , $f = (

    /*Names weight*/
    select sAMAccountName, Name , inE('MainAssignment').Weight[0] as w from (
      
      select expand ( outE('MainAssignment').inV('Person')) from (traverse inE('MainAssignment','SubUnit'),outV('Unit')
                                                                  from ( select from Person where sAMAccountName='somovnv')                                                                 
                                                                 ) where @class='Unit'
    ) 
    where 1=1 

    and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and
    (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )


  )
)
where w in $e.w


//<<<<<<<<<<<<<< hierarhy 2	


select 
 inV('Person').sAMAccountName as Name , Name
 from (   
 select    expand(Path)  
 from (     
 
 select	shortestpath($a,$c,'both',null,{"maxdepth":2}) as Path

 let 
 
 $a = ( select from person where sAMAccountName.toLowerCase() = 'somovnv')    
 , $b = (select from Unit where GUID = '00000000-0000-0000-0000-000000000000') 	
 , $c = (select from Person where inE().Weight[0]  = 0)
 , $e= (

    /*min person by unit*/
    select 
    d,min(w) as w 

    from (
      select inE('MainAssignment').outV('SubUnit').Name[0] as d, inE('MainAssignment').Weight[0] as w from (
        select expand ( outE('MainAssignment').inV('Person')) from (traverse inE('MainAssignment','SubUnit'),outV('Unit')
                                                                    from ( select from Person where sAMAccountName='somovnv')) where @class='Unit'
      ) 
      where 1=1 

      and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and
      (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )

    )

    group by d

  ) 
  , $f = (

    /*Names weight*/
    select sAMAccountName, Name , inE('MainAssignment').Weight[0] as w from (
      
      select expand ( outE('MainAssignment').inV('Person')) from (traverse inE('MainAssignment','SubUnit'),outV('Unit')
                                                                  from ( select from Person where sAMAccountName='somovnv')                                                                 
                                                                 ) where @class='Unit'
    ) 
    where 1=1 

    and (inE("MainAssignment")[0].Disabled is null or inE("MainAssignment")[0].Disabled >= sysdate()) and
    (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )


  )
   
 unwind Path
 )
 )
 where 1=1
 and @class = 'MainAssignment'
 and ( Disabled is null or Disabled > sysdate()) 
 and (inV().Disabled is null or inV().Disabled > sysdate()) 
 and (State !='Отпуск по уходу за ребенком' 
 and State != 'Отпуск по беременности и родам')
/*  and Weight <  $a.inE('MainAssignment')[0].Weight */
and Weight in $e.w
 
 
 
						
					}
					
					public void GetCollegesByAccount()
					{
						
var g=orient.getGraph();
var b=g.command("sql","  select in().Out('MainAssignment').sAMAccountName as Name from person where 1=1 and sAMAccountName.ToLowerCase()=GetLowerCase('"+accountName+"').r[0]  and (inE('MainAssignment')[0].Disabled is null or inE('MainAssignment')[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' ) order by Name  "); 
return b; 

					}
					
					//Определить всех нижестоящих сотрудников относительно Сотрудника А.
					public void GetCollegesLowerByAccount()
					{

var g=orient.getGraph();
var b=g.command("sql","select sAMAccountName as Name from ( 	traverse out() from ( 	select in() from person where 1=1 and sAMAccountName='"+accountName+"' ) 	) 	where @class = \'Person\' 	and not ( 	(Name like \'%директор департамента%\') 	or ( Name like \'%ачальник %\') and (inE(\"MainAssignment\")[0].Disabled is null or inE(\"MainAssignment\")[0].Disabled >= sysdate() ) and (Disabled is null) and (inE().State != 'Отпуск по уходу за ребенком' and inE().State != 'Отпуск по беременности и родам' )	) order by Name");
return b;


/*
Perepechiniv -> ["fesenkoev","Averochkinaav", "Perepechiniv","diana.zainullina"]
*/															
					
					}
					
				}
								
				public void NewFunctions()
				{
					
					public void SerachPersonAll()
					{
var g=orient.getGraph();
var b=g.command("sql","select GUID as id, ifnull( if( eval(\"@class = 'Person'\"),in(\"MainAssignment\").Name[0],Name[0]) ,'0' ) as division , ifnull( if( eval(\"@class = 'Person'\"),in(\"MainAssignment\").GUID[0],PGUID[0]) ,'0' ) as parent, ifnull(telephoneNumber, ' ') as phone, ifnull( mail,'&nbsp')as mail, Name as title, Name as label, ifnull((inE('MainAssignment').Name[0]), Name) as description , GetDepartmentColor(GUID)[color][0] as itemTitleColor , if( eval(\"@class = 'Person'\"),'PersonTemplate','UnitTemplate' ) as templateName , if(eval('inE().ExpDate[0] is not null'), inE().State[0],null)  as state,  if( eval('inE().ExpDate[0] is not null'),inE().ExpDate[0].format('dd.MM.YYYY'),null) as expDate, GetPositionBar(InE().Name[0].replace('\\\"',''))['groupTitle'][0] as groupTitle  , Birthday.format('dd.MM') as birthday  ,  GetDepartmentColorClass(GUID)[colorClass][0] as colorClass, GetDepartmentName(GUID)[departmentName][0] as departmentName, sAMAccountName as login from Person WHERE [Name, sAMAccountName] LUCENE \"/.*"+substr+".*/\" ");
return b;
					}
					
					// public void GetPersonActive()
					{
var g=orient.getGraph(); 
var b=g.command("sql",'select GetPersonPhoto(mail) as Photo, FirstName, GUID, PGUID ,Name,Disabled,Created,sAMAccountName,Changed,LastName,MiddleName,mail,telephoneNumber,userAccountControl,objectGUID from Person where GUID = "'+GUID+'"  and ((inE()[0].Disabled is null or inE()[0].Disabled >= sysdate() ) and (Disabled is null)  and ( ((@class = \'Person\') or (out(\"MainAssignment\").size() >0)  or (out(\"SubUnit\").size() >0)) or (Name = \'НСПК\')) and (inE().State != \'Отпуск по уходу за ребенком\' and inE().State != \'Отпуск по беременности и родам\'))'); 
return b;
					}

					public void GetLowerCase()
					{
						
var g=orient.getGraph();
var b=g.command("sql","select r.ToLowerCase() as r from (select '"+input+"' as r)");
return b;

					}
					
				}
			
			}

			public void DriverNotes()
			{
				Connection:Connect:IOperation{Request,Response}-
				Request.MemoryStream.Send;IOperation(Response.Receive(NetworkStream.ReadByte()))->
				Document
			}

			public void FU()
			{

//<< I
//inverted V E In Out
(v)-[e]->(v)
out e in 

[e]->(v)->[e]
in v out

//<< II
//Traverse out -> shows nested Nodes but select from (traverse ) =< not
//need to repeat in(),out syntax

//<< III
//parent Node 'NSPK' is not Unit -> its company


			}

		}

		public void Neo4J()
		{
			
			public void PlayMovie()
			{
				CREATE (TheMatrix:Movie {title:'The Matrix', released:1999, tagline:'Welcome to the Real World'})
	CREATE (Keanu:Person {name:'Keanu Reeves', born:1964})
	CREATE (Carrie:Person {name:'Carrie-Anne Moss', born:1967})
	CREATE (Laurence:Person {name:'Laurence Fishburne', born:1961})
	CREATE (Hugo:Person {name:'Hugo Weaving', born:1960})
	CREATE (LillyW:Person {name:'Lilly Wachowski', born:1967})
	CREATE (LanaW:Person {name:'Lana Wachowski', born:1965})
	CREATE (JoelS:Person {name:'Joel Silver', born:1952})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Neo']}]->(TheMatrix),
	  (Carrie)-[:ACTED_IN {roles:['Trinity']}]->(TheMatrix),
	  (Laurence)-[:ACTED_IN {roles:['Morpheus']}]->(TheMatrix),
	  (Hugo)-[:ACTED_IN {roles:['Agent Smith']}]->(TheMatrix),
	  (LillyW)-[:DIRECTED]->(TheMatrix),
	  (LanaW)-[:DIRECTED]->(TheMatrix),
	  (JoelS)-[:PRODUCED]->(TheMatrix)

	CREATE (Emil:Person {name:"Emil Eifrem", born:1978})
	CREATE (Emil)-[:ACTED_IN {roles:["Emil"]}]->(TheMatrix)

	CREATE (TheMatrixReloaded:Movie {title:'The Matrix Reloaded', released:2003, tagline:'Free your mind'})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Neo']}]->(TheMatrixReloaded),
	  (Carrie)-[:ACTED_IN {roles:['Trinity']}]->(TheMatrixReloaded),
	  (Laurence)-[:ACTED_IN {roles:['Morpheus']}]->(TheMatrixReloaded),
	  (Hugo)-[:ACTED_IN {roles:['Agent Smith']}]->(TheMatrixReloaded),
	  (LillyW)-[:DIRECTED]->(TheMatrixReloaded),
	  (LanaW)-[:DIRECTED]->(TheMatrixReloaded),
	  (JoelS)-[:PRODUCED]->(TheMatrixReloaded)

	CREATE (TheMatrixRevolutions:Movie {title:'The Matrix Revolutions', released:2003, tagline:'Everything that has a beginning has an end'})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Neo']}]->(TheMatrixRevolutions),
	  (Carrie)-[:ACTED_IN {roles:['Trinity']}]->(TheMatrixRevolutions),
	  (Laurence)-[:ACTED_IN {roles:['Morpheus']}]->(TheMatrixRevolutions),
	  (Hugo)-[:ACTED_IN {roles:['Agent Smith']}]->(TheMatrixRevolutions),
	  (LillyW)-[:DIRECTED]->(TheMatrixRevolutions),
	  (LanaW)-[:DIRECTED]->(TheMatrixRevolutions),
	  (JoelS)-[:PRODUCED]->(TheMatrixRevolutions)

	CREATE (TheDevilsAdvocate:Movie {title:"The Devil's Advocate", released:1997, tagline:'Evil has its winning ways'})
	CREATE (Charlize:Person {name:'Charlize Theron', born:1975})
	CREATE (Al:Person {name:'Al Pacino', born:1940})
	CREATE (Taylor:Person {name:'Taylor Hackford', born:1944})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Kevin Lomax']}]->(TheDevilsAdvocate),
	  (Charlize)-[:ACTED_IN {roles:['Mary Ann Lomax']}]->(TheDevilsAdvocate),
	  (Al)-[:ACTED_IN {roles:['John Milton']}]->(TheDevilsAdvocate),
	  (Taylor)-[:DIRECTED]->(TheDevilsAdvocate)

	CREATE (AFewGoodMen:Movie {title:"A Few Good Men", released:1992, tagline:"In the heart of the nation's capital, in a courthouse of the U.S. government, one man will stop at nothing to keep his honor, and one will stop at nothing to find the truth."})
	CREATE (TomC:Person {name:'Tom Cruise', born:1962})
	CREATE (JackN:Person {name:'Jack Nicholson', born:1937})
	CREATE (DemiM:Person {name:'Demi Moore', born:1962})
	CREATE (KevinB:Person {name:'Kevin Bacon', born:1958})
	CREATE (KieferS:Person {name:'Kiefer Sutherland', born:1966})
	CREATE (NoahW:Person {name:'Noah Wyle', born:1971})
	CREATE (CubaG:Person {name:'Cuba Gooding Jr.', born:1968})
	CREATE (KevinP:Person {name:'Kevin Pollak', born:1957})
	CREATE (JTW:Person {name:'J.T. Walsh', born:1943})
	CREATE (JamesM:Person {name:'James Marshall', born:1967})
	CREATE (ChristopherG:Person {name:'Christopher Guest', born:1948})
	CREATE (RobR:Person {name:'Rob Reiner', born:1947})
	CREATE (AaronS:Person {name:'Aaron Sorkin', born:1961})
	CREATE
	  (TomC)-[:ACTED_IN {roles:['Lt. Daniel Kaffee']}]->(AFewGoodMen),
	  (JackN)-[:ACTED_IN {roles:['Col. Nathan R. Jessup']}]->(AFewGoodMen),
	  (DemiM)-[:ACTED_IN {roles:['Lt. Cdr. JoAnne Galloway']}]->(AFewGoodMen),
	  (KevinB)-[:ACTED_IN {roles:['Capt. Jack Ross']}]->(AFewGoodMen),
	  (KieferS)-[:ACTED_IN {roles:['Lt. Jonathan Kendrick']}]->(AFewGoodMen),
	  (NoahW)-[:ACTED_IN {roles:['Cpl. Jeffrey Barnes']}]->(AFewGoodMen),
	  (CubaG)-[:ACTED_IN {roles:['Cpl. Carl Hammaker']}]->(AFewGoodMen),
	  (KevinP)-[:ACTED_IN {roles:['Lt. Sam Weinberg']}]->(AFewGoodMen),
	  (JTW)-[:ACTED_IN {roles:['Lt. Col. Matthew Andrew Markinson']}]->(AFewGoodMen),
	  (JamesM)-[:ACTED_IN {roles:['Pfc. Louden Downey']}]->(AFewGoodMen),
	  (ChristopherG)-[:ACTED_IN {roles:['Dr. Stone']}]->(AFewGoodMen),
	  (AaronS)-[:ACTED_IN {roles:['Man in Bar']}]->(AFewGoodMen),
	  (RobR)-[:DIRECTED]->(AFewGoodMen),
	  (AaronS)-[:WROTE]->(AFewGoodMen)

	CREATE (TopGun:Movie {title:"Top Gun", released:1986, tagline:'I feel the need, the need for speed.'})
	CREATE (KellyM:Person {name:'Kelly McGillis', born:1957})
	CREATE (ValK:Person {name:'Val Kilmer', born:1959})
	CREATE (AnthonyE:Person {name:'Anthony Edwards', born:1962})
	CREATE (TomS:Person {name:'Tom Skerritt', born:1933})
	CREATE (MegR:Person {name:'Meg Ryan', born:1961})
	CREATE (TonyS:Person {name:'Tony Scott', born:1944})
	CREATE (JimC:Person {name:'Jim Cash', born:1941})
	CREATE
	  (TomC)-[:ACTED_IN {roles:['Maverick']}]->(TopGun),
	  (KellyM)-[:ACTED_IN {roles:['Charlie']}]->(TopGun),
	  (ValK)-[:ACTED_IN {roles:['Iceman']}]->(TopGun),
	  (AnthonyE)-[:ACTED_IN {roles:['Goose']}]->(TopGun),
	  (TomS)-[:ACTED_IN {roles:['Viper']}]->(TopGun),
	  (MegR)-[:ACTED_IN {roles:['Carole']}]->(TopGun),
	  (TonyS)-[:DIRECTED]->(TopGun),
	  (JimC)-[:WROTE]->(TopGun)

	CREATE (JerryMaguire:Movie {title:'Jerry Maguire', released:2000, tagline:'The rest of his life begins now.'})
	CREATE (ReneeZ:Person {name:'Renee Zellweger', born:1969})
	CREATE (KellyP:Person {name:'Kelly Preston', born:1962})
	CREATE (JerryO:Person {name:"Jerry O'Connell", born:1974})
	CREATE (JayM:Person {name:'Jay Mohr', born:1970})
	CREATE (BonnieH:Person {name:'Bonnie Hunt', born:1961})
	CREATE (ReginaK:Person {name:'Regina King', born:1971})
	CREATE (JonathanL:Person {name:'Jonathan Lipnicki', born:1996})
	CREATE (CameronC:Person {name:'Cameron Crowe', born:1957})
	CREATE
	  (TomC)-[:ACTED_IN {roles:['Jerry Maguire']}]->(JerryMaguire),
	  (CubaG)-[:ACTED_IN {roles:['Rod Tidwell']}]->(JerryMaguire),
	  (ReneeZ)-[:ACTED_IN {roles:['Dorothy Boyd']}]->(JerryMaguire),
	  (KellyP)-[:ACTED_IN {roles:['Avery Bishop']}]->(JerryMaguire),
	  (JerryO)-[:ACTED_IN {roles:['Frank Cushman']}]->(JerryMaguire),
	  (JayM)-[:ACTED_IN {roles:['Bob Sugar']}]->(JerryMaguire),
	  (BonnieH)-[:ACTED_IN {roles:['Laurel Boyd']}]->(JerryMaguire),
	  (ReginaK)-[:ACTED_IN {roles:['Marcee Tidwell']}]->(JerryMaguire),
	  (JonathanL)-[:ACTED_IN {roles:['Ray Boyd']}]->(JerryMaguire),
	  (CameronC)-[:DIRECTED]->(JerryMaguire),
	  (CameronC)-[:PRODUCED]->(JerryMaguire),
	  (CameronC)-[:WROTE]->(JerryMaguire)

	CREATE (StandByMe:Movie {title:"Stand By Me", released:1986, tagline:"For some, it's the last real taste of innocence, and the first real taste of life. But for everyone, it's the time that memories are made of."})
	CREATE (RiverP:Person {name:'River Phoenix', born:1970})
	CREATE (CoreyF:Person {name:'Corey Feldman', born:1971})
	CREATE (WilW:Person {name:'Wil Wheaton', born:1972})
	CREATE (JohnC:Person {name:'John Cusack', born:1966})
	CREATE (MarshallB:Person {name:'Marshall Bell', born:1942})
	CREATE
	  (WilW)-[:ACTED_IN {roles:['Gordie Lachance']}]->(StandByMe),
	  (RiverP)-[:ACTED_IN {roles:['Chris Chambers']}]->(StandByMe),
	  (JerryO)-[:ACTED_IN {roles:['Vern Tessio']}]->(StandByMe),
	  (CoreyF)-[:ACTED_IN {roles:['Teddy Duchamp']}]->(StandByMe),
	  (JohnC)-[:ACTED_IN {roles:['Denny Lachance']}]->(StandByMe),
	  (KieferS)-[:ACTED_IN {roles:['Ace Merrill']}]->(StandByMe),
	  (MarshallB)-[:ACTED_IN {roles:['Mr. Lachance']}]->(StandByMe),
	  (RobR)-[:DIRECTED]->(StandByMe)

	CREATE (AsGoodAsItGets:Movie {title:'As Good as It Gets', released:1997, tagline:'A comedy from the heart that goes for the throat.'})
	CREATE (HelenH:Person {name:'Helen Hunt', born:1963})
	CREATE (GregK:Person {name:'Greg Kinnear', born:1963})
	CREATE (JamesB:Person {name:'James L. Brooks', born:1940})
	CREATE
	  (JackN)-[:ACTED_IN {roles:['Melvin Udall']}]->(AsGoodAsItGets),
	  (HelenH)-[:ACTED_IN {roles:['Carol Connelly']}]->(AsGoodAsItGets),
	  (GregK)-[:ACTED_IN {roles:['Simon Bishop']}]->(AsGoodAsItGets),
	  (CubaG)-[:ACTED_IN {roles:['Frank Sachs']}]->(AsGoodAsItGets),
	  (JamesB)-[:DIRECTED]->(AsGoodAsItGets)

	CREATE (WhatDreamsMayCome:Movie {title:'What Dreams May Come', released:1998, tagline:'After life there is more. The end is just the beginning.'})
	CREATE (AnnabellaS:Person {name:'Annabella Sciorra', born:1960})
	CREATE (MaxS:Person {name:'Max von Sydow', born:1929})
	CREATE (WernerH:Person {name:'Werner Herzog', born:1942})
	CREATE (Robin:Person {name:'Robin Williams', born:1951})
	CREATE (VincentW:Person {name:'Vincent Ward', born:1956})
	CREATE
	  (Robin)-[:ACTED_IN {roles:['Chris Nielsen']}]->(WhatDreamsMayCome),
	  (CubaG)-[:ACTED_IN {roles:['Albert Lewis']}]->(WhatDreamsMayCome),
	  (AnnabellaS)-[:ACTED_IN {roles:['Annie Collins-Nielsen']}]->(WhatDreamsMayCome),
	  (MaxS)-[:ACTED_IN {roles:['The Tracker']}]->(WhatDreamsMayCome),
	  (WernerH)-[:ACTED_IN {roles:['The Face']}]->(WhatDreamsMayCome),
	  (VincentW)-[:DIRECTED]->(WhatDreamsMayCome)

	CREATE (SnowFallingonCedars:Movie {title:'Snow Falling on Cedars', released:1999, tagline:'First loves last. Forever.'})
	CREATE (EthanH:Person {name:'Ethan Hawke', born:1970})
	CREATE (RickY:Person {name:'Rick Yune', born:1971})
	CREATE (JamesC:Person {name:'James Cromwell', born:1940})
	CREATE (ScottH:Person {name:'Scott Hicks', born:1953})
	CREATE
	  (EthanH)-[:ACTED_IN {roles:['Ishmael Chambers']}]->(SnowFallingonCedars),
	  (RickY)-[:ACTED_IN {roles:['Kazuo Miyamoto']}]->(SnowFallingonCedars),
	  (MaxS)-[:ACTED_IN {roles:['Nels Gudmundsson']}]->(SnowFallingonCedars),
	  (JamesC)-[:ACTED_IN {roles:['Judge Fielding']}]->(SnowFallingonCedars),
	  (ScottH)-[:DIRECTED]->(SnowFallingonCedars)

	CREATE (YouveGotMail:Movie {title:"You've Got Mail", released:1998, tagline:'At odds in life... in love on-line.'})
	CREATE (ParkerP:Person {name:'Parker Posey', born:1968})
	CREATE (DaveC:Person {name:'Dave Chappelle', born:1973})
	CREATE (SteveZ:Person {name:'Steve Zahn', born:1967})
	CREATE (TomH:Person {name:'Tom Hanks', born:1956})
	CREATE (NoraE:Person {name:'Nora Ephron', born:1941})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Joe Fox']}]->(YouveGotMail),
	  (MegR)-[:ACTED_IN {roles:['Kathleen Kelly']}]->(YouveGotMail),
	  (GregK)-[:ACTED_IN {roles:['Frank Navasky']}]->(YouveGotMail),
	  (ParkerP)-[:ACTED_IN {roles:['Patricia Eden']}]->(YouveGotMail),
	  (DaveC)-[:ACTED_IN {roles:['Kevin Jackson']}]->(YouveGotMail),
	  (SteveZ)-[:ACTED_IN {roles:['George Pappas']}]->(YouveGotMail),
	  (NoraE)-[:DIRECTED]->(YouveGotMail)

	CREATE (SleeplessInSeattle:Movie {title:'Sleepless in Seattle', released:1993, tagline:'What if someone you never met, someone you never saw, someone you never knew was the only someone for you?'})
	CREATE (RitaW:Person {name:'Rita Wilson', born:1956})
	CREATE (BillPull:Person {name:'Bill Pullman', born:1953})
	CREATE (VictorG:Person {name:'Victor Garber', born:1949})
	CREATE (RosieO:Person {name:"Rosie O'Donnell", born:1962})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Sam Baldwin']}]->(SleeplessInSeattle),
	  (MegR)-[:ACTED_IN {roles:['Annie Reed']}]->(SleeplessInSeattle),
	  (RitaW)-[:ACTED_IN {roles:['Suzy']}]->(SleeplessInSeattle),
	  (BillPull)-[:ACTED_IN {roles:['Walter']}]->(SleeplessInSeattle),
	  (VictorG)-[:ACTED_IN {roles:['Greg']}]->(SleeplessInSeattle),
	  (RosieO)-[:ACTED_IN {roles:['Becky']}]->(SleeplessInSeattle),
	  (NoraE)-[:DIRECTED]->(SleeplessInSeattle)

	CREATE (JoeVersustheVolcano:Movie {title:'Joe Versus the Volcano', released:1990, tagline:'A story of love, lava and burning desire.'})
	CREATE (JohnS:Person {name:'John Patrick Stanley', born:1950})
	CREATE (Nathan:Person {name:'Nathan Lane', born:1956})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Joe Banks']}]->(JoeVersustheVolcano),
	  (MegR)-[:ACTED_IN {roles:['DeDe', 'Angelica Graynamore', 'Patricia Graynamore']}]->(JoeVersustheVolcano),
	  (Nathan)-[:ACTED_IN {roles:['Baw']}]->(JoeVersustheVolcano),
	  (JohnS)-[:DIRECTED]->(JoeVersustheVolcano)

	CREATE (WhenHarryMetSally:Movie {title:'When Harry Met Sally', released:1998, tagline:'At odds in life... in love on-line.'})
	CREATE (BillyC:Person {name:'Billy Crystal', born:1948})
	CREATE (CarrieF:Person {name:'Carrie Fisher', born:1956})
	CREATE (BrunoK:Person {name:'Bruno Kirby', born:1949})
	CREATE
	  (BillyC)-[:ACTED_IN {roles:['Harry Burns']}]->(WhenHarryMetSally),
	  (MegR)-[:ACTED_IN {roles:['Sally Albright']}]->(WhenHarryMetSally),
	  (CarrieF)-[:ACTED_IN {roles:['Marie']}]->(WhenHarryMetSally),
	  (BrunoK)-[:ACTED_IN {roles:['Jess']}]->(WhenHarryMetSally),
	  (RobR)-[:DIRECTED]->(WhenHarryMetSally),
	  (RobR)-[:PRODUCED]->(WhenHarryMetSally),
	  (NoraE)-[:PRODUCED]->(WhenHarryMetSally),
	  (NoraE)-[:WROTE]->(WhenHarryMetSally)

	CREATE (ThatThingYouDo:Movie {title:'That Thing You Do', released:1996, tagline:'In every life there comes a time when that thing you dream becomes that thing you do'})
	CREATE (LivT:Person {name:'Liv Tyler', born:1977})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Mr. White']}]->(ThatThingYouDo),
	  (LivT)-[:ACTED_IN {roles:['Faye Dolan']}]->(ThatThingYouDo),
	  (Charlize)-[:ACTED_IN {roles:['Tina']}]->(ThatThingYouDo),
	  (TomH)-[:DIRECTED]->(ThatThingYouDo)

	CREATE (TheReplacements:Movie {title:'The Replacements', released:2000, tagline:'Pain heals, Chicks dig scars... Glory lasts forever'})
	CREATE (Brooke:Person {name:'Brooke Langton', born:1970})
	CREATE (Gene:Person {name:'Gene Hackman', born:1930})
	CREATE (Orlando:Person {name:'Orlando Jones', born:1968})
	CREATE (Howard:Person {name:'Howard Deutch', born:1950})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Shane Falco']}]->(TheReplacements),
	  (Brooke)-[:ACTED_IN {roles:['Annabelle Farrell']}]->(TheReplacements),
	  (Gene)-[:ACTED_IN {roles:['Jimmy McGinty']}]->(TheReplacements),
	  (Orlando)-[:ACTED_IN {roles:['Clifford Franklin']}]->(TheReplacements),
	  (Howard)-[:DIRECTED]->(TheReplacements)

	CREATE (RescueDawn:Movie {title:'RescueDawn', released:2006, tagline:"Based on the extraordinary true story of one man's fight for freedom"})
	CREATE (ChristianB:Person {name:'Christian Bale', born:1974})
	CREATE (ZachG:Person {name:'Zach Grenier', born:1954})
	CREATE
	  (MarshallB)-[:ACTED_IN {roles:['Admiral']}]->(RescueDawn),
	  (ChristianB)-[:ACTED_IN {roles:['Dieter Dengler']}]->(RescueDawn),
	  (ZachG)-[:ACTED_IN {roles:['Squad Leader']}]->(RescueDawn),
	  (SteveZ)-[:ACTED_IN {roles:['Duane']}]->(RescueDawn),
	  (WernerH)-[:DIRECTED]->(RescueDawn)

	CREATE (TheBirdcage:Movie {title:'The Birdcage', released:1996, tagline:'Come as you are'})
	CREATE (MikeN:Person {name:'Mike Nichols', born:1931})
	CREATE
	  (Robin)-[:ACTED_IN {roles:['Armand Goldman']}]->(TheBirdcage),
	  (Nathan)-[:ACTED_IN {roles:['Albert Goldman']}]->(TheBirdcage),
	  (Gene)-[:ACTED_IN {roles:['Sen. Kevin Keeley']}]->(TheBirdcage),
	  (MikeN)-[:DIRECTED]->(TheBirdcage)

	CREATE (Unforgiven:Movie {title:'Unforgiven', released:1992, tagline:"It's a hell of a thing, killing a man"})
	CREATE (RichardH:Person {name:'Richard Harris', born:1930})
	CREATE (ClintE:Person {name:'Clint Eastwood', born:1930})
	CREATE
	  (RichardH)-[:ACTED_IN {roles:['English Bob']}]->(Unforgiven),
	  (ClintE)-[:ACTED_IN {roles:['Bill Munny']}]->(Unforgiven),
	  (Gene)-[:ACTED_IN {roles:['Little Bill Daggett']}]->(Unforgiven),
	  (ClintE)-[:DIRECTED]->(Unforgiven)

	CREATE (JohnnyMnemonic:Movie {title:'Johnny Mnemonic', released:1995, tagline:'The hottest data on earth. In the coolest head in town'})
	CREATE (Takeshi:Person {name:'Takeshi Kitano', born:1947})
	CREATE (Dina:Person {name:'Dina Meyer', born:1968})
	CREATE (IceT:Person {name:'Ice-T', born:1958})
	CREATE (RobertL:Person {name:'Robert Longo', born:1953})
	CREATE
	  (Keanu)-[:ACTED_IN {roles:['Johnny Mnemonic']}]->(JohnnyMnemonic),
	  (Takeshi)-[:ACTED_IN {roles:['Takahashi']}]->(JohnnyMnemonic),
	  (Dina)-[:ACTED_IN {roles:['Jane']}]->(JohnnyMnemonic),
	  (IceT)-[:ACTED_IN {roles:['J-Bone']}]->(JohnnyMnemonic),
	  (RobertL)-[:DIRECTED]->(JohnnyMnemonic)

	CREATE (CloudAtlas:Movie {title:'Cloud Atlas', released:2012, tagline:'Everything is connected'})
	CREATE (HalleB:Person {name:'Halle Berry', born:1966})
	CREATE (JimB:Person {name:'Jim Broadbent', born:1949})
	CREATE (TomT:Person {name:'Tom Tykwer', born:1965})
	CREATE (DavidMitchell:Person {name:'David Mitchell', born:1969})
	CREATE (StefanArndt:Person {name:'Stefan Arndt', born:1961})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Zachry', 'Dr. Henry Goose', 'Isaac Sachs', 'Dermot Hoggins']}]->(CloudAtlas),
	  (Hugo)-[:ACTED_IN {roles:['Bill Smoke', 'Haskell Moore', 'Tadeusz Kesselring', 'Nurse Noakes', 'Boardman Mephi', 'Old Georgie']}]->(CloudAtlas),
	  (HalleB)-[:ACTED_IN {roles:['Luisa Rey', 'Jocasta Ayrs', 'Ovid', 'Meronym']}]->(CloudAtlas),
	  (JimB)-[:ACTED_IN {roles:['Vyvyan Ayrs', 'Captain Molyneux', 'Timothy Cavendish']}]->(CloudAtlas),
	  (TomT)-[:DIRECTED]->(CloudAtlas),
	  (LillyW)-[:DIRECTED]->(CloudAtlas),
	  (LanaW)-[:DIRECTED]->(CloudAtlas),
	  (DavidMitchell)-[:WROTE]->(CloudAtlas),
	  (StefanArndt)-[:PRODUCED]->(CloudAtlas)

	CREATE (TheDaVinciCode:Movie {title:'The Da Vinci Code', released:2006, tagline:'Break The Codes'})
	CREATE (IanM:Person {name:'Ian McKellen', born:1939})
	CREATE (AudreyT:Person {name:'Audrey Tautou', born:1976})
	CREATE (PaulB:Person {name:'Paul Bettany', born:1971})
	CREATE (RonH:Person {name:'Ron Howard', born:1954})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Dr. Robert Langdon']}]->(TheDaVinciCode),
	  (IanM)-[:ACTED_IN {roles:['Sir Leight Teabing']}]->(TheDaVinciCode),
	  (AudreyT)-[:ACTED_IN {roles:['Sophie Neveu']}]->(TheDaVinciCode),
	  (PaulB)-[:ACTED_IN {roles:['Silas']}]->(TheDaVinciCode),
	  (RonH)-[:DIRECTED]->(TheDaVinciCode)

	CREATE (VforVendetta:Movie {title:'V for Vendetta', released:2006, tagline:'Freedom! Forever!'})
	CREATE (NatalieP:Person {name:'Natalie Portman', born:1981})
	CREATE (StephenR:Person {name:'Stephen Rea', born:1946})
	CREATE (JohnH:Person {name:'John Hurt', born:1940})
	CREATE (BenM:Person {name: 'Ben Miles', born:1967})
	CREATE
	  (Hugo)-[:ACTED_IN {roles:['V']}]->(VforVendetta),
	  (NatalieP)-[:ACTED_IN {roles:['Evey Hammond']}]->(VforVendetta),
	  (StephenR)-[:ACTED_IN {roles:['Eric Finch']}]->(VforVendetta),
	  (JohnH)-[:ACTED_IN {roles:['High Chancellor Adam Sutler']}]->(VforVendetta),
	  (BenM)-[:ACTED_IN {roles:['Dascomb']}]->(VforVendetta),
	  (JamesM)-[:DIRECTED]->(VforVendetta),
	  (LillyW)-[:PRODUCED]->(VforVendetta),
	  (LanaW)-[:PRODUCED]->(VforVendetta),
	  (JoelS)-[:PRODUCED]->(VforVendetta),
	  (LillyW)-[:WROTE]->(VforVendetta),
	  (LanaW)-[:WROTE]->(VforVendetta)

	CREATE (SpeedRacer:Movie {title:'Speed Racer', released:2008, tagline:'Speed has no limits'})
	CREATE (EmileH:Person {name:'Emile Hirsch', born:1985})
	CREATE (JohnG:Person {name:'John Goodman', born:1960})
	CREATE (SusanS:Person {name:'Susan Sarandon', born:1946})
	CREATE (MatthewF:Person {name:'Matthew Fox', born:1966})
	CREATE (ChristinaR:Person {name:'Christina Ricci', born:1980})
	CREATE (Rain:Person {name:'Rain', born:1982})
	CREATE
	  (EmileH)-[:ACTED_IN {roles:['Speed Racer']}]->(SpeedRacer),
	  (JohnG)-[:ACTED_IN {roles:['Pops']}]->(SpeedRacer),
	  (SusanS)-[:ACTED_IN {roles:['Mom']}]->(SpeedRacer),
	  (MatthewF)-[:ACTED_IN {roles:['Racer X']}]->(SpeedRacer),
	  (ChristinaR)-[:ACTED_IN {roles:['Trixie']}]->(SpeedRacer),
	  (Rain)-[:ACTED_IN {roles:['Taejo Togokahn']}]->(SpeedRacer),
	  (BenM)-[:ACTED_IN {roles:['Cass Jones']}]->(SpeedRacer),
	  (LillyW)-[:DIRECTED]->(SpeedRacer),
	  (LanaW)-[:DIRECTED]->(SpeedRacer),
	  (LillyW)-[:WROTE]->(SpeedRacer),
	  (LanaW)-[:WROTE]->(SpeedRacer),
	  (JoelS)-[:PRODUCED]->(SpeedRacer)

	CREATE (NinjaAssassin:Movie {title:'Ninja Assassin', released:2009, tagline:'Prepare to enter a secret world of assassins'})
	CREATE (NaomieH:Person {name:'Naomie Harris'})
	CREATE
	  (Rain)-[:ACTED_IN {roles:['Raizo']}]->(NinjaAssassin),
	  (NaomieH)-[:ACTED_IN {roles:['Mika Coretti']}]->(NinjaAssassin),
	  (RickY)-[:ACTED_IN {roles:['Takeshi']}]->(NinjaAssassin),
	  (BenM)-[:ACTED_IN {roles:['Ryan Maslow']}]->(NinjaAssassin),
	  (JamesM)-[:DIRECTED]->(NinjaAssassin),
	  (LillyW)-[:PRODUCED]->(NinjaAssassin),
	  (LanaW)-[:PRODUCED]->(NinjaAssassin),
	  (JoelS)-[:PRODUCED]->(NinjaAssassin)

	CREATE (TheGreenMile:Movie {title:'The Green Mile', released:1999, tagline:"Walk a mile you'll never forget."})
	CREATE (MichaelD:Person {name:'Michael Clarke Duncan', born:1957})
	CREATE (DavidM:Person {name:'David Morse', born:1953})
	CREATE (SamR:Person {name:'Sam Rockwell', born:1968})
	CREATE (GaryS:Person {name:'Gary Sinise', born:1955})
	CREATE (PatriciaC:Person {name:'Patricia Clarkson', born:1959})
	CREATE (FrankD:Person {name:'Frank Darabont', born:1959})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Paul Edgecomb']}]->(TheGreenMile),
	  (MichaelD)-[:ACTED_IN {roles:['John Coffey']}]->(TheGreenMile),
	  (DavidM)-[:ACTED_IN {roles:['Brutus "Brutal" Howell']}]->(TheGreenMile),
	  (BonnieH)-[:ACTED_IN {roles:['Jan Edgecomb']}]->(TheGreenMile),
	  (JamesC)-[:ACTED_IN {roles:['Warden Hal Moores']}]->(TheGreenMile),
	  (SamR)-[:ACTED_IN {roles:['"Wild Bill" Wharton']}]->(TheGreenMile),
	  (GaryS)-[:ACTED_IN {roles:['Burt Hammersmith']}]->(TheGreenMile),
	  (PatriciaC)-[:ACTED_IN {roles:['Melinda Moores']}]->(TheGreenMile),
	  (FrankD)-[:DIRECTED]->(TheGreenMile)

	CREATE (FrostNixon:Movie {title:'Frost/Nixon', released:2008, tagline:'400 million people were waiting for the truth.'})
	CREATE (FrankL:Person {name:'Frank Langella', born:1938})
	CREATE (MichaelS:Person {name:'Michael Sheen', born:1969})
	CREATE (OliverP:Person {name:'Oliver Platt', born:1960})
	CREATE
	  (FrankL)-[:ACTED_IN {roles:['Richard Nixon']}]->(FrostNixon),
	  (MichaelS)-[:ACTED_IN {roles:['David Frost']}]->(FrostNixon),
	  (KevinB)-[:ACTED_IN {roles:['Jack Brennan']}]->(FrostNixon),
	  (OliverP)-[:ACTED_IN {roles:['Bob Zelnick']}]->(FrostNixon),
	  (SamR)-[:ACTED_IN {roles:['James Reston, Jr.']}]->(FrostNixon),
	  (RonH)-[:DIRECTED]->(FrostNixon)

	CREATE (Hoffa:Movie {title:'Hoffa', released:1992, tagline:"He didn't want law. He wanted justice."})
	CREATE (DannyD:Person {name:'Danny DeVito', born:1944})
	CREATE (JohnR:Person {name:'John C. Reilly', born:1965})
	CREATE
	  (JackN)-[:ACTED_IN {roles:['Hoffa']}]->(Hoffa),
	  (DannyD)-[:ACTED_IN {roles:['Robert "Bobby" Ciaro']}]->(Hoffa),
	  (JTW)-[:ACTED_IN {roles:['Frank Fitzsimmons']}]->(Hoffa),
	  (JohnR)-[:ACTED_IN {roles:['Peter "Pete" Connelly']}]->(Hoffa),
	  (DannyD)-[:DIRECTED]->(Hoffa)

	CREATE (Apollo13:Movie {title:'Apollo 13', released:1995, tagline:'Houston, we have a problem.'})
	CREATE (EdH:Person {name:'Ed Harris', born:1950})
	CREATE (BillPax:Person {name:'Bill Paxton', born:1955})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Jim Lovell']}]->(Apollo13),
	  (KevinB)-[:ACTED_IN {roles:['Jack Swigert']}]->(Apollo13),
	  (EdH)-[:ACTED_IN {roles:['Gene Kranz']}]->(Apollo13),
	  (BillPax)-[:ACTED_IN {roles:['Fred Haise']}]->(Apollo13),
	  (GaryS)-[:ACTED_IN {roles:['Ken Mattingly']}]->(Apollo13),
	  (RonH)-[:DIRECTED]->(Apollo13)

	CREATE (Twister:Movie {title:'Twister', released:1996, tagline:"Don't Breathe. Don't Look Back."})
	CREATE (PhilipH:Person {name:'Philip Seymour Hoffman', born:1967})
	CREATE (JanB:Person {name:'Jan de Bont', born:1943})
	CREATE
	  (BillPax)-[:ACTED_IN {roles:['Bill Harding']}]->(Twister),
	  (HelenH)-[:ACTED_IN {roles:['Dr. Jo Harding']}]->(Twister),
	  (ZachG)-[:ACTED_IN {roles:['Eddie']}]->(Twister),
	  (PhilipH)-[:ACTED_IN {roles:['Dustin "Dusty" Davis']}]->(Twister),
	  (JanB)-[:DIRECTED]->(Twister)

	CREATE (CastAway:Movie {title:'Cast Away', released:2000, tagline:'At the edge of the world, his journey begins.'})
	CREATE (RobertZ:Person {name:'Robert Zemeckis', born:1951})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Chuck Noland']}]->(CastAway),
	  (HelenH)-[:ACTED_IN {roles:['Kelly Frears']}]->(CastAway),
	  (RobertZ)-[:DIRECTED]->(CastAway)

	CREATE (OneFlewOvertheCuckoosNest:Movie {title:"One Flew Over the Cuckoo's Nest", released:1975, tagline:"If he's crazy, what does that make you?"})
	CREATE (MilosF:Person {name:'Milos Forman', born:1932})
	CREATE
	  (JackN)-[:ACTED_IN {roles:['Randle McMurphy']}]->(OneFlewOvertheCuckoosNest),
	  (DannyD)-[:ACTED_IN {roles:['Martini']}]->(OneFlewOvertheCuckoosNest),
	  (MilosF)-[:DIRECTED]->(OneFlewOvertheCuckoosNest)

	CREATE (SomethingsGottaGive:Movie {title:"Something's Gotta Give", released:2003})
	CREATE (DianeK:Person {name:'Diane Keaton', born:1946})
	CREATE (NancyM:Person {name:'Nancy Meyers', born:1949})
	CREATE
	  (JackN)-[:ACTED_IN {roles:['Harry Sanborn']}]->(SomethingsGottaGive),
	  (DianeK)-[:ACTED_IN {roles:['Erica Barry']}]->(SomethingsGottaGive),
	  (Keanu)-[:ACTED_IN {roles:['Julian Mercer']}]->(SomethingsGottaGive),
	  (NancyM)-[:DIRECTED]->(SomethingsGottaGive),
	  (NancyM)-[:PRODUCED]->(SomethingsGottaGive),
	  (NancyM)-[:WROTE]->(SomethingsGottaGive)

	CREATE (BicentennialMan:Movie {title:'Bicentennial Man', released:1999, tagline:"One robot's 200 year journey to become an ordinary man."})
	CREATE (ChrisC:Person {name:'Chris Columbus', born:1958})
	CREATE
	  (Robin)-[:ACTED_IN {roles:['Andrew Marin']}]->(BicentennialMan),
	  (OliverP)-[:ACTED_IN {roles:['Rupert Burns']}]->(BicentennialMan),
	  (ChrisC)-[:DIRECTED]->(BicentennialMan)

	CREATE (CharlieWilsonsWar:Movie {title:"Charlie Wilson's War", released:2007, tagline:"A stiff drink. A little mascara. A lot of nerve. Who said they couldn't bring down the Soviet empire."})
	CREATE (JuliaR:Person {name:'Julia Roberts', born:1967})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Rep. Charlie Wilson']}]->(CharlieWilsonsWar),
	  (JuliaR)-[:ACTED_IN {roles:['Joanne Herring']}]->(CharlieWilsonsWar),
	  (PhilipH)-[:ACTED_IN {roles:['Gust Avrakotos']}]->(CharlieWilsonsWar),
	  (MikeN)-[:DIRECTED]->(CharlieWilsonsWar)

	CREATE (ThePolarExpress:Movie {title:'The Polar Express', released:2004, tagline:'This Holiday Season… Believe'})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Hero Boy', 'Father', 'Conductor', 'Hobo', 'Scrooge', 'Santa Claus']}]->(ThePolarExpress),
	  (RobertZ)-[:DIRECTED]->(ThePolarExpress)

	CREATE (ALeagueofTheirOwn:Movie {title:'A League of Their Own', released:1992, tagline:'Once in a lifetime you get a chance to do something different.'})
	CREATE (Madonna:Person {name:'Madonna', born:1954})
	CREATE (GeenaD:Person {name:'Geena Davis', born:1956})
	CREATE (LoriP:Person {name:'Lori Petty', born:1963})
	CREATE (PennyM:Person {name:'Penny Marshall', born:1943})
	CREATE
	  (TomH)-[:ACTED_IN {roles:['Jimmy Dugan']}]->(ALeagueofTheirOwn),
	  (GeenaD)-[:ACTED_IN {roles:['Dottie Hinson']}]->(ALeagueofTheirOwn),
	  (LoriP)-[:ACTED_IN {roles:['Kit Keller']}]->(ALeagueofTheirOwn),
	  (RosieO)-[:ACTED_IN {roles:['Doris Murphy']}]->(ALeagueofTheirOwn),
	  (Madonna)-[:ACTED_IN {roles:['"All the Way" Mae Mordabito']}]->(ALeagueofTheirOwn),
	  (BillPax)-[:ACTED_IN {roles:['Bob Hinson']}]->(ALeagueofTheirOwn),
	  (PennyM)-[:DIRECTED]->(ALeagueofTheirOwn)

	CREATE (PaulBlythe:Person {name:'Paul Blythe'})
	CREATE (AngelaScope:Person {name:'Angela Scope'})
	CREATE (JessicaThompson:Person {name:'Jessica Thompson'})
	CREATE (JamesThompson:Person {name:'James Thompson'})

	CREATE
	  (JamesThompson)-[:FOLLOWS]->(JessicaThompson),
	  (AngelaScope)-[:FOLLOWS]->(JessicaThompson),
	  (PaulBlythe)-[:FOLLOWS]->(AngelaScope)

	CREATE
	  (JessicaThompson)-[:REVIEWED {summary:'An amazing journey', rating:95}]->(CloudAtlas),
	  (JessicaThompson)-[:REVIEWED {summary:'Silly, but fun', rating:65}]->(TheReplacements),
	  (JamesThompson)-[:REVIEWED {summary:'The coolest football movie ever', rating:100}]->(TheReplacements),
	  (AngelaScope)-[:REVIEWED {summary:'Pretty funny at times', rating:62}]->(TheReplacements),
	  (JessicaThompson)-[:REVIEWED {summary:'Dark, but compelling', rating:85}]->(Unforgiven),
	  (JessicaThompson)-[:REVIEWED {summary:"Slapstick redeemed only by the Robin Williams and Gene Hackman's stellar performances", rating:45}]->(TheBirdcage),
	  (JessicaThompson)-[:REVIEWED {summary:'A solid romp', rating:68}]->(TheDaVinciCode),
	  (JamesThompson)-[:REVIEWED {summary:'Fun, but a little far fetched', rating:65}]->(TheDaVinciCode),
	  (JessicaThompson)-[:REVIEWED {summary:'You had me at Jerry', rating:92}]->(JerryMaguire)

	WITH TomH as a
	MATCH (a)-[:ACTED_IN]->(m)<-[:DIRECTED]-(d) RETURN a,m,d LIMIT 10
	;
			}
			
			public void CustomDBBoilerPlate()
			{
					
				public Queries(){
			
	//(Keanu)-[:ACTED_IN {roles:['Neo']}]->(TheMatrix),

	//create vertexes
	create (v_name1:v_typea{prop1:'v_name1', propn:'v_prop1n'})
	create (v_name2:v_typeb{prop1:'v_name2', propn:'v_prop2n'})

	//edge create: OK
	create
	(v_name2)-[:rel_to{e_name:'1->2'}]->(v_name1),
	(v_name2)-[:rel_to2{e_name:'1->2 2'}]->(v_name1)

	//edge create: OK
	match(a:v_typea),(b:v_typeb)
	where a.prop1 = 'v_name1' and b.prop1 = 'v_name2'
	create (a)-[r:e_type {e_name: a.prop1 + '-->' + b.prop1 }]->(b)
	return r


	//select
	match(a:v_typea {prop1: 'v_name1'})-[:e_type]->(b) return a,b

	//select with relation
	match(a:v_typea),(b:v_typeb)
	where a.prop1 = 'v_name1' and b.prop1 = 'v_name2'
	return a,b

	//
	match (a:v_typea)
	match (b:v_typeb)
	return a,b

	//bulk delete vertex
	match (a:v_typea) 
	match (b:v_typeb)
	detach delete  a,b




	//3n 2e one line
	v1-[e]->v2<-[e]-v3
	v4-[e]->v5<-[e]-v6
	
	v2-[e]->v5
	v2-[e2]->v5
	v5-[e3]->v2
	
	match(a:v_typea),(b:v_typeb) detach delete a,b

	v1-[e]->v2<-[e]-v3
	v4-[e]->v5<-[e]-v6
	
	create (v_name1:v_typeb{prop1:'v_name1', propn:'v_prop1n'})-
	[n1:e_type{e_name:'v_name1' + '-->' + 'v_name2'}]->
	(v_name2:v_typea{prop1:'v_name2', propn:'v_prop2n'})
	<-[n2:e_type{e_name:'v_name3' + '-->' + 'v_name2'}]
	-(v_name3:v_typeb{prop1:'v_name3', propn:'v_prop3n'})
	
	create (v_name4:v_typeb{prop1:'v_name4', propn:'v_prop4n'})-
	[n3:e_type{e_name:'v_name4' + '-->' + 'v_name5'}]->
	(v_name5:v_typea{prop1:'v_name5', propn:'v_prop5n'})
	<-[n4:e_type{e_name:'v_name6' + '-->' + 'v_name5'}]
	-(v_name6:v_typeb{prop1:'v_name6', propn:'v_prop6n'})

	//(Keanu)-[:ACTED_IN {roles:['Neo']}]->(TheMatrix)

	//realtions at initial creation
	v2-[e]->v5
	v2-[e2]->v5
	v5-[e3]->v2
	
	create 
	(v_name2)-[n5:e_type{e_name:'v2->v5'}]->(v_name5),
	(v_name2)-[n6:e_type2{e_name:'v2->v5 type 2'}]->(v_name5),
	(v_name5)-[n7:e_type3{e_name:'v5->v2'}]->(v_name2)

	//realtions after initial creation
	v2-[e1]->v5
	v2-[e1]->v5
	v2-[e3]->v5
	v2-[e]->v5
	v4-[eN]->v3
	
	match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (a)-[:e_type1]->(b)
	match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (a)-[:e_type2{name:'a->b'}]->(b)
	match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (b)-[:e_type3{name:'b->a'}]->(a)
	match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (b)-[:e_type{name:'b->a'}]->(a)
	match(b:v_typeb{prop1:'v_name4'}),(a:v_typeb{prop1:'v_name3'}) merge (a)-[:NEW_REL]->(b)

	//selections
	match(a:v_typeb)-[:e_type]->(b:v_typea) return a,b
	match(a:v_typeb)-[:e_type]->(b) return a,b
	match(a:v_typeb)-[relatedto]->(b) return a,b

	match(a:v_typea)-[:e_type]->(b:v_typea) return a,b

	match(a:v_typea),(b:v_typeb) return a,b
	match(a:v_typea),(b:v_typeb) detach delete a,b

				}
				
				public API(){
					
					
POST http://localhost:7474/db/data/transaction/commit
Accept: application/json; charset=UTF-8
Content-Type: application/json

RAW JSON
<<<<<<<<<<<<<<

{
  "statements" : [ {
    "statement" : "CREATE (n) RETURN id(n)"
  } ]
}

<<<<<<<<<<<<<<

{
  "statements" : [
  {"statement" : "create (v_name1:v_typea{prop1:'v_name1', propn:'v_prop1n'})"}
  ,{"statement" : "create (v_name2:v_typeb{prop1:'v_name2', propn:'v_prop2n'})"}
  ,{"statement" : "match(a:v_typea),(b:v_typeb) where a.prop1 = 'v_name1' and b.prop1 = 'v_name2' create (a)-[r:e_type {e_name: a.prop1 + '-->' + b.prop1 }]->(b)"}
  ,{"statement" : "match (a:v_typea) match (b:v_typeb)detach delete  a,b"}
  ]
}

<<<<<<<<<<<<<<

{
"statements" : [
{"statement" : "create (v_name1:v_typeb{prop1:'v_name1', propn:'v_prop1n'})-[n1:e_type{e_name:'v_name1' + '-->' + 'v_name2'}]->(v_name2:v_typea{prop1:'v_name2', propn:'v_prop2n'})<-[n2:e_type{e_name:'v_name3' + '-->' + 'v_name2'}]	-(v_name3:v_typeb{prop1:'v_name3', propn:'v_prop3n'})"}
,{"statement" : "create (v_name4:v_typeb{prop1:'v_name4', propn:'v_prop4n'})-[n3:e_type{e_name:'v_name4' + '-->' + 'v_name5'}]->(v_name5:v_typea{prop1:'v_name5', propn:'v_prop5n'})<-[n4:e_type{e_name:'v_name6' + '-->' + 'v_name5'}]	-(v_name6:v_typeb{prop1:'v_name6', propn:'v_prop6n'})"}
]
}

<<<<<<<<<<<<<<

{
"statements" : [
{"statement" : "create (v_name1:v_typeb{prop1:'v_name1', propn:'v_prop1n'})-[n1:e_type{e_name:'v_name1' + '-->' + 'v_name2'}]->(v_name2:v_typea{prop1:'v_name2', propn:'v_prop2n'})<-[n2:e_type{e_name:'v_name3' + '-->' + 'v_name2'}]-(v_name3:v_typeb{prop1:'v_name3', propn:'v_prop3n'})"},{"statement" : "create (v_name4:v_typeb{prop1:'v_name4', propn:'v_prop4n'})-[n3:e_type{e_name:'v_name4' + '-->' + 'v_name5'}]->(v_name5:v_typea{prop1:'v_name5', propn:'v_prop5n'})<-[n4:e_type{e_name:'v_name6' + '-->' + 'v_name5'}]-(v_name6:v_typeb{prop1:'v_name6', propn:'v_prop6n'})"},{"statement" : "match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (a)-[:e_type2{name:'a->b'}]->(b)"},{"statement" : "match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (b)-[:e_type3{name:'b->a'}]->(a)"},{"statement" : "match(a:v_typea{prop1:'v_name2'}),(b:v_typea{prop1:'v_name5'}) merge (b)-[:e_type{name:'b->a'}]->(a)"},{"statement" : "match(b:v_typeb{prop1:'v_name4'}),(a:v_typeb{prop1:'v_name3'}) merge (a)-[:NEW_REL]->(b)"}
]
}


				}
			
		}

		}

	}
	
	#endregion
		
	#region OS
	
		public Windows
		{
			public CMD
			{
				
				public void AsAdmin(){
				//add current user as admin
				runas /user:????????????? "net localgroup "??????????????" "neprintsevia" /ADD"
			
				}
				
				public void NetFolderFilesDelete()
				{
					pushd "\\Osrp\files\SHARE\Scripts\arh\Export\PREVIOUS_CNT\aa" 
					del /F /Q *.*
					popd
					pushd "\\Osrp\files\SHARE\Scripts\arh\Export\PREVIOUS_CNT" 
					del /F /Q  *.*
					popd
				}
			
				public void Unsorted()
				{
					
					netsat -> ips with ports
					netsh [http] [add,delete] [iplisten] -> bind http listener
					
				}
			}
			
			public void Execute()
			{
				mstsc -> ??????????? ? ?????????? ???????? ?????
				cmd -> ???????
			}
		}
		
		public UNIX
		{
			public Ubuntu
			{
				public HotKeys
				{
					
					public OS
					{
						super (hold) - help
						ctrl + alt + T - terminal
						ctrl + L -> nautilus path browser
					}
					
					public Terminal 
					{
						TAB - auto complete
						shift + ins (ctrl + shift + V ) - ctrl + V
						ctrl + ins (ctrl + shift + C )- ctrl + C
						ctrl + LeftArr/RightArr -> moove between params
						ctrl + U -> delete line
							 + K -> delete line after kursor
							 + W -> delete line before kursor
							 + R -< search command history for words
					}
					
				}
				
				public TerminalCommands
				{				
					sudo apt-get update && sudo apt-get upgrade
					sudo apt-get -f install
					sudo dpkg --purge --force-depends libpowerdevilcore0 libtaskmanager4b
					sudo apt-get -f install
					sudo apt-get install build-essential
					sudo apt-get autoclean && sudo apt-get clear cache
					gksu nautilus /etc --open in browser
					sudo nano  /etc/apt/sources.list				
					
					http://help.ubuntu.ru/wiki/%D0%B3%D0%BE%D1%80%D1%8F%D1%87%D0%B8%D0%B5_%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D1%88%D0%B8_%D0%B2_unity
					http://help.ubuntu.ru/manual/%D1%82%D0%B5%D1%80%D0%BC%D0%B8%D0%BD%D0%B0%D0%BB
					http://forum.ubuntu.ru/index.php?topic=14535.15
					
					lsb_release -a - current build version
					(alt + F2) gksu software-properties-gtk -> show ubuntu update center
					sudo rm -r -f /path -> force remove recursive
					sudo cd /path -> goto folder
						cd .. -> up 1 lvl
					sudo mkdir /path -> create directory
						-p /path -> create directory recursive
					sudo ls -> display content-map
						-a -> with hidden
					sudo systemctl restart network-manager -> restarn netweork				
					sudo ufw enable/disablemail- ????????? ? ?????????? ??????????? ??????
					sudo poweroff/reboot -> poweroff/reboot
					dpkg --get-selections -> installed pkgs
					dpkg --get-selections | grep -v deinstall > ~/Desktop/packages -> save to file				
						-L packageNmae -> find installed pakceg pathes
					mv /folder /folder -> rename folder
					command !& -> run command with previous typed parameter
					^command1^command2 -> run command2 with previous command1 params
					
				}
			
				public Troubleshooting
				{
					//No _apt sandbox user
					https://askubuntu.com/questions/810202/what-is-the-sandbox-user-apt-on-my-system
					adduser --force-badname --system --home /nonexistent  \
					--no-create-home --quiet _apt || true
					
					//Windows 7 don't have a permission to brows Ubuntu Fileshare
					uncomment browseable = yes in etc/samba/smb.conf
					https://askubuntu.com/questions/569333/windows-7-8-1-ubuntu-14-folder-sharing
				}
			
				public Pakets
				{
					public Mercurial
					{
						sudo add-apt-repository universse
						sudo apt-get install mercurial
						sudo apt-get install mercurial meld
						
						hg -> main call
						hg version -> check installation
							init -> initialize in current directory
							clone path -> make copy of path in current directory
							clone path path ->
							
					}
					
					public Glances (resource monitor)
					{
						sudo apt-get install python-pip build-essential python-dev lm-sensors
						sudo pip install psutil logutils bottle batinfo https://bitbucket.org/gleb_zhulik/py3sensors/get/tip.tar.gz zeroconf netifaces pymdstat influxdb elasticsearch potsdb statsd pystache docker-py pysnmp pika py-cpuinfo bernhard
						sudo pip install glances
					}
				}
			}
		}
	
	#endregion
	
